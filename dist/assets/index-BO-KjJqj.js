(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function a(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(i){if(i.ep)return;i.ep=!0;const u=a(i);fetch(i.href,u)}})();function jd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mf={exports:{}},wi={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lp;function pk(){if(lp)return wi;lp=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(s,i,u){var f=null;if(u!==void 0&&(f=""+u),i.key!==void 0&&(f=""+i.key),"key"in i){u={};for(var d in i)d!=="key"&&(u[d]=i[d])}else u=i;return i=u.ref,{$$typeof:e,type:s,key:f,ref:i!==void 0?i:null,props:u}}return wi.Fragment=n,wi.jsx=a,wi.jsxs=a,wi}var ip;function gk(){return ip||(ip=1,Mf.exports=pk()),Mf.exports}var c=gk(),Lf={exports:{}},We={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cp;function vk(){if(cp)return We;cp=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function k(B){return B===null||typeof B!="object"?null:(B=b&&B[b]||B["@@iterator"],typeof B=="function"?B:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,N={};function _(B,A,q){this.props=B,this.context=A,this.refs=N,this.updater=q||y}_.prototype.isReactComponent={},_.prototype.setState=function(B,A){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,A,"setState")},_.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function O(){}O.prototype=_.prototype;function E(B,A,q){this.props=B,this.context=A,this.refs=N,this.updater=q||y}var L=E.prototype=new O;L.constructor=E,w(L,_.prototype),L.isPureReactComponent=!0;var G=Array.isArray;function H(){}var R={H:null,A:null,T:null,S:null},Z=Object.prototype.hasOwnProperty;function Y(B,A,q){var V=q.ref;return{$$typeof:e,type:B,key:A,ref:V!==void 0?V:null,props:q}}function Q(B,A){return Y(B.type,A,B.props)}function K(B){return typeof B=="object"&&B!==null&&B.$$typeof===e}function ee(B){var A={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(q){return A[q]})}var Ee=/\/+/g;function Ne(B,A){return typeof B=="object"&&B!==null&&B.key!=null?ee(""+B.key):A.toString(36)}function me(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(H,H):(B.status="pending",B.then(function(A){B.status==="pending"&&(B.status="fulfilled",B.value=A)},function(A){B.status==="pending"&&(B.status="rejected",B.reason=A)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function J(B,A,q,V,T){var z=typeof B;(z==="undefined"||z==="boolean")&&(B=null);var ne=!1;if(B===null)ne=!0;else switch(z){case"bigint":case"string":case"number":ne=!0;break;case"object":switch(B.$$typeof){case e:case n:ne=!0;break;case g:return ne=B._init,J(ne(B._payload),A,q,V,T)}}if(ne)return T=T(B),ne=V===""?"."+Ne(B,0):V,G(T)?(q="",ne!=null&&(q=ne.replace(Ee,"$&/")+"/"),J(T,A,q,"",function(ke){return ke})):T!=null&&(K(T)&&(T=Q(T,q+(T.key==null||B&&B.key===T.key?"":(""+T.key).replace(Ee,"$&/")+"/")+ne)),A.push(T)),1;ne=0;var Te=V===""?".":V+":";if(G(B))for(var ge=0;ge<B.length;ge++)V=B[ge],z=Te+Ne(V,ge),ne+=J(V,A,q,z,T);else if(ge=k(B),typeof ge=="function")for(B=ge.call(B),ge=0;!(V=B.next()).done;)V=V.value,z=Te+Ne(V,ge++),ne+=J(V,A,q,z,T);else if(z==="object"){if(typeof B.then=="function")return J(me(B),A,q,V,T);throw A=String(B),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return ne}function se(B,A,q){if(B==null)return B;var V=[],T=0;return J(B,V,"","",function(z){return A.call(q,z,T++)}),V}function Ae(B){if(B._status===-1){var A=B._result;A=A(),A.then(function(q){(B._status===0||B._status===-1)&&(B._status=1,B._result=q)},function(q){(B._status===0||B._status===-1)&&(B._status=2,B._result=q)}),B._status===-1&&(B._status=0,B._result=A)}if(B._status===1)return B._result.default;throw B._result}var ae=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},Ce={map:se,forEach:function(B,A,q){se(B,function(){A.apply(this,arguments)},q)},count:function(B){var A=0;return se(B,function(){A++}),A},toArray:function(B){return se(B,function(A){return A})||[]},only:function(B){if(!K(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return We.Activity=v,We.Children=Ce,We.Component=_,We.Fragment=a,We.Profiler=i,We.PureComponent=E,We.StrictMode=s,We.Suspense=m,We.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,We.__COMPILER_RUNTIME={__proto__:null,c:function(B){return R.H.useMemoCache(B)}},We.cache=function(B){return function(){return B.apply(null,arguments)}},We.cacheSignal=function(){return null},We.cloneElement=function(B,A,q){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var V=w({},B.props),T=B.key;if(A!=null)for(z in A.key!==void 0&&(T=""+A.key),A)!Z.call(A,z)||z==="key"||z==="__self"||z==="__source"||z==="ref"&&A.ref===void 0||(V[z]=A[z]);var z=arguments.length-2;if(z===1)V.children=q;else if(1<z){for(var ne=Array(z),Te=0;Te<z;Te++)ne[Te]=arguments[Te+2];V.children=ne}return Y(B.type,T,V)},We.createContext=function(B){return B={$$typeof:f,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:u,_context:B},B},We.createElement=function(B,A,q){var V,T={},z=null;if(A!=null)for(V in A.key!==void 0&&(z=""+A.key),A)Z.call(A,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(T[V]=A[V]);var ne=arguments.length-2;if(ne===1)T.children=q;else if(1<ne){for(var Te=Array(ne),ge=0;ge<ne;ge++)Te[ge]=arguments[ge+2];T.children=Te}if(B&&B.defaultProps)for(V in ne=B.defaultProps,ne)T[V]===void 0&&(T[V]=ne[V]);return Y(B,z,T)},We.createRef=function(){return{current:null}},We.forwardRef=function(B){return{$$typeof:d,render:B}},We.isValidElement=K,We.lazy=function(B){return{$$typeof:g,_payload:{_status:-1,_result:B},_init:Ae}},We.memo=function(B,A){return{$$typeof:x,type:B,compare:A===void 0?null:A}},We.startTransition=function(B){var A=R.T,q={};R.T=q;try{var V=B(),T=R.S;T!==null&&T(q,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(H,ae)}catch(z){ae(z)}finally{A!==null&&q.types!==null&&(A.types=q.types),R.T=A}},We.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},We.use=function(B){return R.H.use(B)},We.useActionState=function(B,A,q){return R.H.useActionState(B,A,q)},We.useCallback=function(B,A){return R.H.useCallback(B,A)},We.useContext=function(B){return R.H.useContext(B)},We.useDebugValue=function(){},We.useDeferredValue=function(B,A){return R.H.useDeferredValue(B,A)},We.useEffect=function(B,A){return R.H.useEffect(B,A)},We.useEffectEvent=function(B){return R.H.useEffectEvent(B)},We.useId=function(){return R.H.useId()},We.useImperativeHandle=function(B,A,q){return R.H.useImperativeHandle(B,A,q)},We.useInsertionEffect=function(B,A){return R.H.useInsertionEffect(B,A)},We.useLayoutEffect=function(B,A){return R.H.useLayoutEffect(B,A)},We.useMemo=function(B,A){return R.H.useMemo(B,A)},We.useOptimistic=function(B,A){return R.H.useOptimistic(B,A)},We.useReducer=function(B,A,q){return R.H.useReducer(B,A,q)},We.useRef=function(B){return R.H.useRef(B)},We.useState=function(B){return R.H.useState(B)},We.useSyncExternalStore=function(B,A,q){return R.H.useSyncExternalStore(B,A,q)},We.useTransition=function(){return R.H.useTransition()},We.version="19.2.3",We}var op;function Od(){return op||(op=1,Lf.exports=vk()),Lf.exports}var D=Od();const zg=jd(D);var If={exports:{}},Si={},Bf={exports:{}},zf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var up;function bk(){return up||(up=1,(function(e){function n(J,se){var Ae=J.length;J.push(se);e:for(;0<Ae;){var ae=Ae-1>>>1,Ce=J[ae];if(0<i(Ce,se))J[ae]=se,J[Ae]=Ce,Ae=ae;else break e}}function a(J){return J.length===0?null:J[0]}function s(J){if(J.length===0)return null;var se=J[0],Ae=J.pop();if(Ae!==se){J[0]=Ae;e:for(var ae=0,Ce=J.length,B=Ce>>>1;ae<B;){var A=2*(ae+1)-1,q=J[A],V=A+1,T=J[V];if(0>i(q,Ae))V<Ce&&0>i(T,q)?(J[ae]=T,J[V]=Ae,ae=V):(J[ae]=q,J[A]=Ae,ae=A);else if(V<Ce&&0>i(T,Ae))J[ae]=T,J[V]=Ae,ae=V;else break e}}return se}function i(J,se){var Ae=J.sortIndex-se.sortIndex;return Ae!==0?Ae:J.id-se.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var f=Date,d=f.now();e.unstable_now=function(){return f.now()-d}}var m=[],x=[],g=1,v=null,b=3,k=!1,y=!1,w=!1,N=!1,_=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function L(J){for(var se=a(x);se!==null;){if(se.callback===null)s(x);else if(se.startTime<=J)s(x),se.sortIndex=se.expirationTime,n(m,se);else break;se=a(x)}}function G(J){if(w=!1,L(J),!y)if(a(m)!==null)y=!0,H||(H=!0,ee());else{var se=a(x);se!==null&&me(G,se.startTime-J)}}var H=!1,R=-1,Z=5,Y=-1;function Q(){return N?!0:!(e.unstable_now()-Y<Z)}function K(){if(N=!1,H){var J=e.unstable_now();Y=J;var se=!0;try{e:{y=!1,w&&(w=!1,O(R),R=-1),k=!0;var Ae=b;try{t:{for(L(J),v=a(m);v!==null&&!(v.expirationTime>J&&Q());){var ae=v.callback;if(typeof ae=="function"){v.callback=null,b=v.priorityLevel;var Ce=ae(v.expirationTime<=J);if(J=e.unstable_now(),typeof Ce=="function"){v.callback=Ce,L(J),se=!0;break t}v===a(m)&&s(m),L(J)}else s(m);v=a(m)}if(v!==null)se=!0;else{var B=a(x);B!==null&&me(G,B.startTime-J),se=!1}}break e}finally{v=null,b=Ae,k=!1}se=void 0}}finally{se?ee():H=!1}}}var ee;if(typeof E=="function")ee=function(){E(K)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Ne=Ee.port2;Ee.port1.onmessage=K,ee=function(){Ne.postMessage(null)}}else ee=function(){_(K,0)};function me(J,se){R=_(function(){J(e.unstable_now())},se)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(J){switch(b){case 1:case 2:case 3:var se=3;break;default:se=b}var Ae=b;b=se;try{return J()}finally{b=Ae}},e.unstable_requestPaint=function(){N=!0},e.unstable_runWithPriority=function(J,se){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var Ae=b;b=J;try{return se()}finally{b=Ae}},e.unstable_scheduleCallback=function(J,se,Ae){var ae=e.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?ae+Ae:ae):Ae=ae,J){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=Ae+Ce,J={id:g++,callback:se,priorityLevel:J,startTime:Ae,expirationTime:Ce,sortIndex:-1},Ae>ae?(J.sortIndex=Ae,n(x,J),a(m)===null&&J===a(x)&&(w?(O(R),R=-1):w=!0,me(G,Ae-ae))):(J.sortIndex=Ce,n(m,J),y||k||(y=!0,H||(H=!0,ee()))),J},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(J){var se=b;return function(){var Ae=b;b=se;try{return J.apply(this,arguments)}finally{b=Ae}}}})(zf)),zf}var fp;function yk(){return fp||(fp=1,Bf.exports=bk()),Bf.exports}var Uf={exports:{}},xa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dp;function kk(){if(dp)return xa;dp=1;var e=Od();function n(m){var x="https://react.dev/errors/"+m;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)x+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+m+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},i=Symbol.for("react.portal");function u(m,x,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:m,containerInfo:x,implementation:g}}var f=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(m,x){if(m==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return xa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,xa.createPortal=function(m,x){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(n(299));return u(m,x,null,g)},xa.flushSync=function(m){var x=f.T,g=s.p;try{if(f.T=null,s.p=2,m)return m()}finally{f.T=x,s.p=g,s.d.f()}},xa.preconnect=function(m,x){typeof m=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,s.d.C(m,x))},xa.prefetchDNS=function(m){typeof m=="string"&&s.d.D(m)},xa.preinit=function(m,x){if(typeof m=="string"&&x&&typeof x.as=="string"){var g=x.as,v=d(g,x.crossOrigin),b=typeof x.integrity=="string"?x.integrity:void 0,k=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;g==="style"?s.d.S(m,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:k}):g==="script"&&s.d.X(m,{crossOrigin:v,integrity:b,fetchPriority:k,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},xa.preinitModule=function(m,x){if(typeof m=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var g=d(x.as,x.crossOrigin);s.d.M(m,{crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&s.d.M(m)},xa.preload=function(m,x){if(typeof m=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var g=x.as,v=d(g,x.crossOrigin);s.d.L(m,g,{crossOrigin:v,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},xa.preloadModule=function(m,x){if(typeof m=="string")if(x){var g=d(x.as,x.crossOrigin);s.d.m(m,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else s.d.m(m)},xa.requestFormReset=function(m){s.d.r(m)},xa.unstable_batchedUpdates=function(m,x){return m(x)},xa.useFormState=function(m,x,g){return f.H.useFormState(m,x,g)},xa.useFormStatus=function(){return f.H.useHostTransitionStatus()},xa.version="19.2.3",xa}var hp;function Ug(){if(hp)return Uf.exports;hp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Uf.exports=kk(),Uf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xp;function wk(){if(xp)return Si;xp=1;var e=yk(),n=Od(),a=Ug();function s(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var r=t,l=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(l=r.return),t=r.return;while(t)}return r.tag===3?l:null}function f(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function d(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function m(t){if(u(t)!==t)throw Error(s(188))}function x(t){var r=t.alternate;if(!r){if(r=u(t),r===null)throw Error(s(188));return r!==t?null:t}for(var l=t,o=r;;){var h=l.return;if(h===null)break;var p=h.alternate;if(p===null){if(o=h.return,o!==null){l=o;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===l)return m(h),t;if(p===o)return m(h),r;p=p.sibling}throw Error(s(188))}if(l.return!==o.return)l=h,o=p;else{for(var S=!1,j=h.child;j;){if(j===l){S=!0,l=h,o=p;break}if(j===o){S=!0,o=h,l=p;break}j=j.sibling}if(!S){for(j=p.child;j;){if(j===l){S=!0,l=p,o=h;break}if(j===o){S=!0,o=p,l=h;break}j=j.sibling}if(!S)throw Error(s(189))}}if(l.alternate!==o)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?t:r}function g(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=g(t),r!==null)return r;t=t.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),E=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function ee(t){return t===null||typeof t!="object"?null:(t=K&&t[K]||t["@@iterator"],typeof t=="function"?t:null)}var Ee=Symbol.for("react.client.reference");function Ne(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Ee?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case w:return"Fragment";case _:return"Profiler";case N:return"StrictMode";case G:return"Suspense";case H:return"SuspenseList";case Y:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case y:return"Portal";case E:return t.displayName||"Context";case O:return(t._context.displayName||"Context")+".Consumer";case L:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case R:return r=t.displayName||null,r!==null?r:Ne(t.type)||"Memo";case Z:r=t._payload,t=t._init;try{return Ne(t(r))}catch{}}return null}var me=Array.isArray,J=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae={pending:!1,data:null,method:null,action:null},ae=[],Ce=-1;function B(t){return{current:t}}function A(t){0>Ce||(t.current=ae[Ce],ae[Ce]=null,Ce--)}function q(t,r){Ce++,ae[Ce]=t.current,t.current=r}var V=B(null),T=B(null),z=B(null),ne=B(null);function Te(t,r){switch(q(z,r),q(T,t),q(V,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?Cm(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=Cm(r),t=jm(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}A(V),q(V,t)}function ge(){A(V),A(T),A(z)}function ke(t){t.memoizedState!==null&&q(ne,t);var r=V.current,l=jm(r,t.type);r!==l&&(q(T,t),q(V,l))}function $e(t){T.current===t&&(A(V),A(T)),ne.current===t&&(A(ne),vi._currentValue=Ae)}var X,nt;function pe(t){if(X===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);X=r&&r[1]||"",nt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+X+t+nt}var we=!1;function be(t,r){if(!t||we)return"";we=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(r){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(he){var fe=he}Reflect.construct(t,[],_e)}else{try{_e.call()}catch(he){fe=he}t.call(_e.prototype)}}else{try{throw Error()}catch(he){fe=he}(_e=t())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(he){if(he&&fe&&typeof he.stack=="string")return[he.stack,fe.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=o.DetermineComponentFrameRoot(),S=p[0],j=p[1];if(S&&j){var W=S.split(`
`),ie=j.split(`
`);for(h=o=0;o<W.length&&!W[o].includes("DetermineComponentFrameRoot");)o++;for(;h<ie.length&&!ie[h].includes("DetermineComponentFrameRoot");)h++;if(o===W.length||h===ie.length)for(o=W.length-1,h=ie.length-1;1<=o&&0<=h&&W[o]!==ie[h];)h--;for(;1<=o&&0<=h;o--,h--)if(W[o]!==ie[h]){if(o!==1||h!==1)do if(o--,h--,0>h||W[o]!==ie[h]){var ve=`
`+W[o].replace(" at new "," at ");return t.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",t.displayName)),ve}while(1<=o&&0<=h);break}}}finally{we=!1,Error.prepareStackTrace=l}return(l=t?t.displayName||t.name:"")?pe(l):""}function xe(t,r){switch(t.tag){case 26:case 27:case 5:return pe(t.type);case 16:return pe("Lazy");case 13:return t.child!==r&&r!==null?pe("Suspense Fallback"):pe("Suspense");case 19:return pe("SuspenseList");case 0:case 15:return be(t.type,!1);case 11:return be(t.type.render,!1);case 1:return be(t.type,!0);case 31:return pe("Activity");default:return""}}function Le(t){try{var r="",l=null;do r+=xe(t,l),l=t,t=t.return;while(t);return r}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var De=Object.prototype.hasOwnProperty,Ye=e.unstable_scheduleCallback,qe=e.unstable_cancelCallback,ze=e.unstable_shouldYield,Pe=e.unstable_requestPaint,Ue=e.unstable_now,ha=e.unstable_getCurrentPriorityLevel,zt=e.unstable_ImmediatePriority,Wa=e.unstable_UserBlockingPriority,Gt=e.unstable_NormalPriority,Za=e.unstable_LowPriority,et=e.unstable_IdlePriority,Dt=e.log,Ca=e.unstable_setDisableYieldValue,Tt=null,Ut=null;function pr(t){if(typeof Dt=="function"&&Ca(t),Ut&&typeof Ut.setStrictMode=="function")try{Ut.setStrictMode(Tt,t)}catch{}}var wa=Math.clz32?Math.clz32:mc,Eo=Math.log,xc=Math.LN2;function mc(t){return t>>>=0,t===0?32:31-(Eo(t)/xc|0)|0}var Wn=256,Os=262144,Rs=4194304;function Ja(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Ds(t,r,l){var o=t.pendingLanes;if(o===0)return 0;var h=0,p=t.suspendedLanes,S=t.pingedLanes;t=t.warmLanes;var j=o&134217727;return j!==0?(o=j&~p,o!==0?h=Ja(o):(S&=j,S!==0?h=Ja(S):l||(l=j&~t,l!==0&&(h=Ja(l))))):(j=o&~p,j!==0?h=Ja(j):S!==0?h=Ja(S):l||(l=o&~t,l!==0&&(h=Ja(l)))),h===0?0:r!==0&&r!==h&&(r&p)===0&&(p=h&-h,l=r&-r,p>=l||p===32&&(l&4194048)!==0)?r:h}function Zn(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function No(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pc(){var t=Rs;return Rs<<=1,(Rs&62914560)===0&&(Rs=4194304),t}function Ol(t){for(var r=[],l=0;31>l;l++)r.push(t);return r}function Jn(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function To(t,r,l,o,h,p){var S=t.pendingLanes;t.pendingLanes=l,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=l,t.entangledLanes&=l,t.errorRecoveryDisabledLanes&=l,t.shellSuspendCounter=0;var j=t.entanglements,W=t.expirationTimes,ie=t.hiddenUpdates;for(l=S&~l;0<l;){var ve=31-wa(l),_e=1<<ve;j[ve]=0,W[ve]=-1;var fe=ie[ve];if(fe!==null)for(ie[ve]=null,ve=0;ve<fe.length;ve++){var he=fe[ve];he!==null&&(he.lane&=-536870913)}l&=~_e}o!==0&&gc(t,o,0),p!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=p&~(S&~r))}function gc(t,r,l){t.pendingLanes|=r,t.suspendedLanes&=~r;var o=31-wa(r);t.entangledLanes|=r,t.entanglements[o]=t.entanglements[o]|1073741824|l&261930}function Fs(t,r){var l=t.entangledLanes|=r;for(t=t.entanglements;l;){var o=31-wa(l),h=1<<o;h&r|t[o]&r&&(t[o]|=r),l&=~h}}function vc(t,r){var l=r&-r;return l=(l&42)!==0?1:Rl(l),(l&(t.suspendedLanes|r))!==0?0:l}function Rl(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Dl(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function C(){var t=se.p;return t!==0?t:(t=window.event,t===void 0?32:Qm(t.type))}function U(t,r){var l=se.p;try{return se.p=t,r()}finally{se.p=l}}var F=Math.random().toString(36).slice(2),M="__reactFiber$"+F,I="__reactProps$"+F,P="__reactContainer$"+F,ce="__reactEvents$"+F,ye="__reactListeners$"+F,oe="__reactHandles$"+F,ue="__reactResources$"+F,de="__reactMarker$"+F;function je(t){delete t[M],delete t[I],delete t[ce],delete t[ye],delete t[oe]}function Re(t){var r=t[M];if(r)return r;for(var l=t.parentNode;l;){if(r=l[P]||l[M]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(t=Im(t);t!==null;){if(l=t[M])return l;t=Im(t)}return r}t=l,l=t.parentNode}return null}function Ie(t){if(t=t[M]||t[P]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function Oe(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(s(33))}function Fe(t){var r=t[ue];return r||(r=t[ue]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function He(t){t[de]=!0}var St=new Set,Et={};function Ct(t,r){Qa(t,r),Qa(t+"Capture",r)}function Qa(t,r){for(Et[t]=r,t=0;t<r.length;t++)St.add(r[t])}var Qn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xn={},_r={};function Fl(t){return De.call(_r,t)?!0:De.call(xn,t)?!1:Qn.test(t)?_r[t]=!0:(xn[t]=!0,!1)}function ja(t,r,l){if(Fl(r))if(l===null)t.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var o=r.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+l)}}function bc(t,r,l){if(l===null)t.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+l)}}function Ur(t,r,l,o){if(o===null)t.removeAttribute(l);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(l);return}t.setAttributeNS(r,l,""+o)}}function er(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function kh(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ob(t,r,l){var o=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var h=o.get,p=o.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return h.call(this)},set:function(S){l=""+S,p.call(this,S)}}),Object.defineProperty(t,r,{enumerable:o.enumerable}),{getValue:function(){return l},setValue:function(S){l=""+S},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function _o(t){if(!t._valueTracker){var r=kh(t)?"checked":"value";t._valueTracker=ob(t,r,""+t[r])}}function wh(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var l=r.getValue(),o="";return t&&(o=kh(t)?t.checked?"true":"false":t.value),t=o,t!==l?(r.setValue(t),!0):!1}function yc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var ub=/[\n"\\]/g;function tr(t){return t.replace(ub,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ao(t,r,l,o,h,p,S,j){t.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.type=S:t.removeAttribute("type"),r!=null?S==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+er(r)):t.value!==""+er(r)&&(t.value=""+er(r)):S!=="submit"&&S!=="reset"||t.removeAttribute("value"),r!=null?Co(t,S,er(r)):l!=null?Co(t,S,er(l)):o!=null&&t.removeAttribute("value"),h==null&&p!=null&&(t.defaultChecked=!!p),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?t.name=""+er(j):t.removeAttribute("name")}function Sh(t,r,l,o,h,p,S,j){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),r!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||r!=null)){_o(t);return}l=l!=null?""+er(l):"",r=r!=null?""+er(r):l,j||r===t.value||(t.value=r),t.defaultValue=r}o=o??h,o=typeof o!="function"&&typeof o!="symbol"&&!!o,t.checked=j?t.checked:!!o,t.defaultChecked=!!o,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(t.name=S),_o(t)}function Co(t,r,l){r==="number"&&yc(t.ownerDocument)===t||t.defaultValue===""+l||(t.defaultValue=""+l)}function Ms(t,r,l,o){if(t=t.options,r){r={};for(var h=0;h<l.length;h++)r["$"+l[h]]=!0;for(l=0;l<t.length;l++)h=r.hasOwnProperty("$"+t[l].value),t[l].selected!==h&&(t[l].selected=h),h&&o&&(t[l].defaultSelected=!0)}else{for(l=""+er(l),r=null,h=0;h<t.length;h++){if(t[h].value===l){t[h].selected=!0,o&&(t[h].defaultSelected=!0);return}r!==null||t[h].disabled||(r=t[h])}r!==null&&(r.selected=!0)}}function Eh(t,r,l){if(r!=null&&(r=""+er(r),r!==t.value&&(t.value=r),l==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=l!=null?""+er(l):""}function Nh(t,r,l,o){if(r==null){if(o!=null){if(l!=null)throw Error(s(92));if(me(o)){if(1<o.length)throw Error(s(93));o=o[0]}l=o}l==null&&(l=""),r=l}l=er(r),t.defaultValue=l,o=t.textContent,o===l&&o!==""&&o!==null&&(t.value=o),_o(t)}function Ls(t,r){if(r){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=r;return}}t.textContent=r}var fb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Th(t,r,l){var o=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?o?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":o?t.setProperty(r,l):typeof l!="number"||l===0||fb.has(r)?r==="float"?t.cssFloat=l:t[r]=(""+l).trim():t[r]=l+"px"}function _h(t,r,l){if(r!=null&&typeof r!="object")throw Error(s(62));if(t=t.style,l!=null){for(var o in l)!l.hasOwnProperty(o)||r!=null&&r.hasOwnProperty(o)||(o.indexOf("--")===0?t.setProperty(o,""):o==="float"?t.cssFloat="":t[o]="");for(var h in r)o=r[h],r.hasOwnProperty(h)&&l[h]!==o&&Th(t,h,o)}else for(var p in r)r.hasOwnProperty(p)&&Th(t,p,r[p])}function jo(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var db=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function kc(t){return hb.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Pr(){}var Oo=null;function Ro(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Is=null,Bs=null;function Ah(t){var r=Ie(t);if(r&&(t=r.stateNode)){var l=t[I]||null;e:switch(t=r.stateNode,r.type){case"input":if(Ao(t,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+tr(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var o=l[r];if(o!==t&&o.form===t.form){var h=o[I]||null;if(!h)throw Error(s(90));Ao(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(r=0;r<l.length;r++)o=l[r],o.form===t.form&&wh(o)}break e;case"textarea":Eh(t,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Ms(t,!!l.multiple,r,!1)}}}var Do=!1;function Ch(t,r,l){if(Do)return t(r,l);Do=!0;try{var o=t(r);return o}finally{if(Do=!1,(Is!==null||Bs!==null)&&(c0(),Is&&(r=Is,t=Bs,Bs=Is=null,Ah(r),t)))for(r=0;r<t.length;r++)Ah(t[r])}}function Ml(t,r){var l=t.stateNode;if(l===null)return null;var o=l[I]||null;if(o===null)return null;l=o[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(t=t.type,o=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!o;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(s(231,r,typeof l));return l}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fo=!1;if(Hr)try{var Ll={};Object.defineProperty(Ll,"passive",{get:function(){Fo=!0}}),window.addEventListener("test",Ll,Ll),window.removeEventListener("test",Ll,Ll)}catch{Fo=!1}var mn=null,Mo=null,wc=null;function jh(){if(wc)return wc;var t,r=Mo,l=r.length,o,h="value"in mn?mn.value:mn.textContent,p=h.length;for(t=0;t<l&&r[t]===h[t];t++);var S=l-t;for(o=1;o<=S&&r[l-o]===h[p-o];o++);return wc=h.slice(t,1<o?1-o:void 0)}function Sc(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function Ec(){return!0}function Oh(){return!1}function Oa(t){function r(l,o,h,p,S){this._reactName=l,this._targetInst=h,this.type=o,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var j in t)t.hasOwnProperty(j)&&(l=t[j],this[j]=l?l(p):p[j]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Ec:Oh,this.isPropagationStopped=Oh,this}return v(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ec)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ec)},persist:function(){},isPersistent:Ec}),r}var es={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=Oa(es),Il=v({},es,{view:0,detail:0}),xb=Oa(Il),Lo,Io,Bl,Tc=v({},Il,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zo,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bl&&(Bl&&t.type==="mousemove"?(Lo=t.screenX-Bl.screenX,Io=t.screenY-Bl.screenY):Io=Lo=0,Bl=t),Lo)},movementY:function(t){return"movementY"in t?t.movementY:Io}}),Rh=Oa(Tc),mb=v({},Tc,{dataTransfer:0}),pb=Oa(mb),gb=v({},Il,{relatedTarget:0}),Bo=Oa(gb),vb=v({},es,{animationName:0,elapsedTime:0,pseudoElement:0}),bb=Oa(vb),yb=v({},es,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kb=Oa(yb),wb=v({},es,{data:0}),Dh=Oa(wb),Sb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Eb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tb(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=Nb[t])?!!r[t]:!1}function zo(){return Tb}var _b=v({},Il,{key:function(t){if(t.key){var r=Sb[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=Sc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Eb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zo,charCode:function(t){return t.type==="keypress"?Sc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ab=Oa(_b),Cb=v({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fh=Oa(Cb),jb=v({},Il,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zo}),Ob=Oa(jb),Rb=v({},es,{propertyName:0,elapsedTime:0,pseudoElement:0}),Db=Oa(Rb),Fb=v({},Tc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Mb=Oa(Fb),Lb=v({},es,{newState:0,oldState:0}),Ib=Oa(Lb),Bb=[9,13,27,32],Uo=Hr&&"CompositionEvent"in window,zl=null;Hr&&"documentMode"in document&&(zl=document.documentMode);var zb=Hr&&"TextEvent"in window&&!zl,Mh=Hr&&(!Uo||zl&&8<zl&&11>=zl),Lh=" ",Ih=!1;function Bh(t,r){switch(t){case"keyup":return Bb.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zs=!1;function Ub(t,r){switch(t){case"compositionend":return zh(r);case"keypress":return r.which!==32?null:(Ih=!0,Lh);case"textInput":return t=r.data,t===Lh&&Ih?null:t;default:return null}}function Pb(t,r){if(zs)return t==="compositionend"||!Uo&&Bh(t,r)?(t=jh(),wc=Mo=mn=null,zs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Mh&&r.locale!=="ko"?null:r.data;default:return null}}var Hb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uh(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!Hb[t.type]:r==="textarea"}function Ph(t,r,l,o){Is?Bs?Bs.push(o):Bs=[o]:Is=o,r=m0(r,"onChange"),0<r.length&&(l=new Nc("onChange","change",null,l,o),t.push({event:l,listeners:r}))}var Ul=null,Pl=null;function Vb(t){Sm(t,0)}function _c(t){var r=Oe(t);if(wh(r))return t}function Hh(t,r){if(t==="change")return r}var Vh=!1;if(Hr){var Po;if(Hr){var Ho="oninput"in document;if(!Ho){var Gh=document.createElement("div");Gh.setAttribute("oninput","return;"),Ho=typeof Gh.oninput=="function"}Po=Ho}else Po=!1;Vh=Po&&(!document.documentMode||9<document.documentMode)}function $h(){Ul&&(Ul.detachEvent("onpropertychange",Xh),Pl=Ul=null)}function Xh(t){if(t.propertyName==="value"&&_c(Pl)){var r=[];Ph(r,Pl,t,Ro(t)),Ch(Vb,r)}}function Gb(t,r,l){t==="focusin"?($h(),Ul=r,Pl=l,Ul.attachEvent("onpropertychange",Xh)):t==="focusout"&&$h()}function $b(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _c(Pl)}function Xb(t,r){if(t==="click")return _c(r)}function Yb(t,r){if(t==="input"||t==="change")return _c(r)}function qb(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var za=typeof Object.is=="function"?Object.is:qb;function Hl(t,r){if(za(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var l=Object.keys(t),o=Object.keys(r);if(l.length!==o.length)return!1;for(o=0;o<l.length;o++){var h=l[o];if(!De.call(r,h)||!za(t[h],r[h]))return!1}return!0}function Yh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qh(t,r){var l=Yh(t);t=0;for(var o;l;){if(l.nodeType===3){if(o=t+l.textContent.length,t<=r&&o>=r)return{node:l,offset:r-t};t=o}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Yh(l)}}function Kh(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?Kh(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function Wh(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=yc(t.document);r instanceof t.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)t=r.contentWindow;else break;r=yc(t.document)}return r}function Vo(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var Kb=Hr&&"documentMode"in document&&11>=document.documentMode,Us=null,Go=null,Vl=null,$o=!1;function Zh(t,r,l){var o=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;$o||Us==null||Us!==yc(o)||(o=Us,"selectionStart"in o&&Vo(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Vl&&Hl(Vl,o)||(Vl=o,o=m0(Go,"onSelect"),0<o.length&&(r=new Nc("onSelect","select",null,r,l),t.push({event:r,listeners:o}),r.target=Us)))}function ts(t,r){var l={};return l[t.toLowerCase()]=r.toLowerCase(),l["Webkit"+t]="webkit"+r,l["Moz"+t]="moz"+r,l}var Ps={animationend:ts("Animation","AnimationEnd"),animationiteration:ts("Animation","AnimationIteration"),animationstart:ts("Animation","AnimationStart"),transitionrun:ts("Transition","TransitionRun"),transitionstart:ts("Transition","TransitionStart"),transitioncancel:ts("Transition","TransitionCancel"),transitionend:ts("Transition","TransitionEnd")},Xo={},Jh={};Hr&&(Jh=document.createElement("div").style,"AnimationEvent"in window||(delete Ps.animationend.animation,delete Ps.animationiteration.animation,delete Ps.animationstart.animation),"TransitionEvent"in window||delete Ps.transitionend.transition);function as(t){if(Xo[t])return Xo[t];if(!Ps[t])return t;var r=Ps[t],l;for(l in r)if(r.hasOwnProperty(l)&&l in Jh)return Xo[t]=r[l];return t}var Qh=as("animationend"),ex=as("animationiteration"),tx=as("animationstart"),Wb=as("transitionrun"),Zb=as("transitionstart"),Jb=as("transitioncancel"),ax=as("transitionend"),rx=new Map,Yo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Yo.push("scrollEnd");function gr(t,r){rx.set(t,r),Ct(r,[t])}var Ac=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ar=[],Hs=0,qo=0;function Cc(){for(var t=Hs,r=qo=Hs=0;r<t;){var l=ar[r];ar[r++]=null;var o=ar[r];ar[r++]=null;var h=ar[r];ar[r++]=null;var p=ar[r];if(ar[r++]=null,o!==null&&h!==null){var S=o.pending;S===null?h.next=h:(h.next=S.next,S.next=h),o.pending=h}p!==0&&nx(l,h,p)}}function jc(t,r,l,o){ar[Hs++]=t,ar[Hs++]=r,ar[Hs++]=l,ar[Hs++]=o,qo|=o,t.lanes|=o,t=t.alternate,t!==null&&(t.lanes|=o)}function Ko(t,r,l,o){return jc(t,r,l,o),Oc(t)}function rs(t,r){return jc(t,null,null,r),Oc(t)}function nx(t,r,l){t.lanes|=l;var o=t.alternate;o!==null&&(o.lanes|=l);for(var h=!1,p=t.return;p!==null;)p.childLanes|=l,o=p.alternate,o!==null&&(o.childLanes|=l),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(h=!0)),t=p,p=p.return;return t.tag===3?(p=t.stateNode,h&&r!==null&&(h=31-wa(l),t=p.hiddenUpdates,o=t[h],o===null?t[h]=[r]:o.push(r),r.lane=l|536870912),p):null}function Oc(t){if(50<fi)throw fi=0,nf=null,Error(s(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var Vs={};function Qb(t,r,l,o){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ua(t,r,l,o){return new Qb(t,r,l,o)}function Wo(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Vr(t,r){var l=t.alternate;return l===null?(l=Ua(t.tag,r,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=r,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&65011712,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,r=t.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l.refCleanup=t.refCleanup,l}function sx(t,r){t.flags&=65011714;var l=t.alternate;return l===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=l.childLanes,t.lanes=l.lanes,t.child=l.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=l.memoizedProps,t.memoizedState=l.memoizedState,t.updateQueue=l.updateQueue,t.type=l.type,r=l.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function Rc(t,r,l,o,h,p){var S=0;if(o=t,typeof t=="function")Wo(t)&&(S=1);else if(typeof t=="string")S=nk(t,l,V.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Y:return t=Ua(31,l,r,h),t.elementType=Y,t.lanes=p,t;case w:return ns(l.children,h,p,r);case N:S=8,h|=24;break;case _:return t=Ua(12,l,r,h|2),t.elementType=_,t.lanes=p,t;case G:return t=Ua(13,l,r,h),t.elementType=G,t.lanes=p,t;case H:return t=Ua(19,l,r,h),t.elementType=H,t.lanes=p,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case E:S=10;break e;case O:S=9;break e;case L:S=11;break e;case R:S=14;break e;case Z:S=16,o=null;break e}S=29,l=Error(s(130,t===null?"null":typeof t,"")),o=null}return r=Ua(S,l,r,h),r.elementType=t,r.type=o,r.lanes=p,r}function ns(t,r,l,o){return t=Ua(7,t,o,r),t.lanes=l,t}function Zo(t,r,l){return t=Ua(6,t,null,r),t.lanes=l,t}function lx(t){var r=Ua(18,null,null,0);return r.stateNode=t,r}function Jo(t,r,l){return r=Ua(4,t.children!==null?t.children:[],t.key,r),r.lanes=l,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var ix=new WeakMap;function rr(t,r){if(typeof t=="object"&&t!==null){var l=ix.get(t);return l!==void 0?l:(r={value:t,source:r,stack:Le(r)},ix.set(t,r),r)}return{value:t,source:r,stack:Le(r)}}var Gs=[],$s=0,Dc=null,Gl=0,nr=[],sr=0,pn=null,Ar=1,Cr="";function Gr(t,r){Gs[$s++]=Gl,Gs[$s++]=Dc,Dc=t,Gl=r}function cx(t,r,l){nr[sr++]=Ar,nr[sr++]=Cr,nr[sr++]=pn,pn=t;var o=Ar;t=Cr;var h=32-wa(o)-1;o&=~(1<<h),l+=1;var p=32-wa(r)+h;if(30<p){var S=h-h%5;p=(o&(1<<S)-1).toString(32),o>>=S,h-=S,Ar=1<<32-wa(r)+h|l<<h|o,Cr=p+t}else Ar=1<<p|l<<h|o,Cr=t}function Qo(t){t.return!==null&&(Gr(t,1),cx(t,1,0))}function eu(t){for(;t===Dc;)Dc=Gs[--$s],Gs[$s]=null,Gl=Gs[--$s],Gs[$s]=null;for(;t===pn;)pn=nr[--sr],nr[sr]=null,Cr=nr[--sr],nr[sr]=null,Ar=nr[--sr],nr[sr]=null}function ox(t,r){nr[sr++]=Ar,nr[sr++]=Cr,nr[sr++]=pn,Ar=r.id,Cr=r.overflow,pn=t}var la=null,_t=null,ot=!1,gn=null,lr=!1,tu=Error(s(519));function vn(t){var r=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw $l(rr(r,t)),tu}function ux(t){var r=t.stateNode,l=t.type,o=t.memoizedProps;switch(r[M]=t,r[I]=o,l){case"dialog":lt("cancel",r),lt("close",r);break;case"iframe":case"object":case"embed":lt("load",r);break;case"video":case"audio":for(l=0;l<hi.length;l++)lt(hi[l],r);break;case"source":lt("error",r);break;case"img":case"image":case"link":lt("error",r),lt("load",r);break;case"details":lt("toggle",r);break;case"input":lt("invalid",r),Sh(r,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":lt("invalid",r);break;case"textarea":lt("invalid",r),Nh(r,o.value,o.defaultValue,o.children)}l=o.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||o.suppressHydrationWarning===!0||_m(r.textContent,l)?(o.popover!=null&&(lt("beforetoggle",r),lt("toggle",r)),o.onScroll!=null&&lt("scroll",r),o.onScrollEnd!=null&&lt("scrollend",r),o.onClick!=null&&(r.onclick=Pr),r=!0):r=!1,r||vn(t,!0)}function fx(t){for(la=t.return;la;)switch(la.tag){case 5:case 31:case 13:lr=!1;return;case 27:case 3:lr=!0;return;default:la=la.return}}function Xs(t){if(t!==la)return!1;if(!ot)return fx(t),ot=!0,!1;var r=t.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=t.type,l=!(l!=="form"&&l!=="button")||yf(t.type,t.memoizedProps)),l=!l),l&&_t&&vn(t),fx(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));_t=Lm(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));_t=Lm(t)}else r===27?(r=_t,Rn(t.type)?(t=Nf,Nf=null,_t=t):_t=r):_t=la?cr(t.stateNode.nextSibling):null;return!0}function ss(){_t=la=null,ot=!1}function au(){var t=gn;return t!==null&&(Ma===null?Ma=t:Ma.push.apply(Ma,t),gn=null),t}function $l(t){gn===null?gn=[t]:gn.push(t)}var ru=B(null),ls=null,$r=null;function bn(t,r,l){q(ru,r._currentValue),r._currentValue=l}function Xr(t){t._currentValue=ru.current,A(ru)}function nu(t,r,l){for(;t!==null;){var o=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,o!==null&&(o.childLanes|=r)):o!==null&&(o.childLanes&r)!==r&&(o.childLanes|=r),t===l)break;t=t.return}}function su(t,r,l,o){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var p=h.dependencies;if(p!==null){var S=h.child;p=p.firstContext;e:for(;p!==null;){var j=p;p=h;for(var W=0;W<r.length;W++)if(j.context===r[W]){p.lanes|=l,j=p.alternate,j!==null&&(j.lanes|=l),nu(p.return,l,t),o||(S=null);break e}p=j.next}}else if(h.tag===18){if(S=h.return,S===null)throw Error(s(341));S.lanes|=l,p=S.alternate,p!==null&&(p.lanes|=l),nu(S,l,t),S=null}else S=h.child;if(S!==null)S.return=h;else for(S=h;S!==null;){if(S===t){S=null;break}if(h=S.sibling,h!==null){h.return=S.return,S=h;break}S=S.return}h=S}}function Ys(t,r,l,o){t=null;for(var h=r,p=!1;h!==null;){if(!p){if((h.flags&524288)!==0)p=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var S=h.alternate;if(S===null)throw Error(s(387));if(S=S.memoizedProps,S!==null){var j=h.type;za(h.pendingProps.value,S.value)||(t!==null?t.push(j):t=[j])}}else if(h===ne.current){if(S=h.alternate,S===null)throw Error(s(387));S.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(vi):t=[vi])}h=h.return}t!==null&&su(r,t,l,o),r.flags|=262144}function Fc(t){for(t=t.firstContext;t!==null;){if(!za(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function is(t){ls=t,$r=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function ia(t){return dx(ls,t)}function Mc(t,r){return ls===null&&is(t),dx(t,r)}function dx(t,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},$r===null){if(t===null)throw Error(s(308));$r=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else $r=$r.next=r;return l}var ey=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(l,o){t.push(o)}};this.abort=function(){r.aborted=!0,t.forEach(function(l){return l()})}},ty=e.unstable_scheduleCallback,ay=e.unstable_NormalPriority,$t={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lu(){return{controller:new ey,data:new Map,refCount:0}}function Xl(t){t.refCount--,t.refCount===0&&ty(ay,function(){t.controller.abort()})}var Yl=null,iu=0,qs=0,Ks=null;function ry(t,r){if(Yl===null){var l=Yl=[];iu=0,qs=ff(),Ks={status:"pending",value:void 0,then:function(o){l.push(o)}}}return iu++,r.then(hx,hx),r}function hx(){if(--iu===0&&Yl!==null){Ks!==null&&(Ks.status="fulfilled");var t=Yl;Yl=null,qs=0,Ks=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function ny(t,r){var l=[],o={status:"pending",value:null,reason:null,then:function(h){l.push(h)}};return t.then(function(){o.status="fulfilled",o.value=r;for(var h=0;h<l.length;h++)(0,l[h])(r)},function(h){for(o.status="rejected",o.reason=h,h=0;h<l.length;h++)(0,l[h])(void 0)}),o}var xx=J.S;J.S=function(t,r){Z1=Ue(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&ry(t,r),xx!==null&&xx(t,r)};var cs=B(null);function cu(){var t=cs.current;return t!==null?t:wt.pooledCache}function Lc(t,r){r===null?q(cs,cs.current):q(cs,r.pool)}function mx(){var t=cu();return t===null?null:{parent:$t._currentValue,pool:t}}var Ws=Error(s(460)),ou=Error(s(474)),Ic=Error(s(542)),Bc={then:function(){}};function px(t){return t=t.status,t==="fulfilled"||t==="rejected"}function gx(t,r,l){switch(l=t[l],l===void 0?t.push(r):l!==r&&(r.then(Pr,Pr),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,bx(t),t;default:if(typeof r.status=="string")r.then(Pr,Pr);else{if(t=wt,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=r,t.status="pending",t.then(function(o){if(r.status==="pending"){var h=r;h.status="fulfilled",h.value=o}},function(o){if(r.status==="pending"){var h=r;h.status="rejected",h.reason=o}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,bx(t),t}throw us=r,Ws}}function os(t){try{var r=t._init;return r(t._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(us=l,Ws):l}}var us=null;function vx(){if(us===null)throw Error(s(459));var t=us;return us=null,t}function bx(t){if(t===Ws||t===Ic)throw Error(s(483))}var Zs=null,ql=0;function zc(t){var r=ql;return ql+=1,Zs===null&&(Zs=[]),gx(Zs,t,r)}function Kl(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function Uc(t,r){throw r.$$typeof===b?Error(s(525)):(t=Object.prototype.toString.call(r),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function yx(t){function r(re,te){if(t){var le=re.deletions;le===null?(re.deletions=[te],re.flags|=16):le.push(te)}}function l(re,te){if(!t)return null;for(;te!==null;)r(re,te),te=te.sibling;return null}function o(re){for(var te=new Map;re!==null;)re.key!==null?te.set(re.key,re):te.set(re.index,re),re=re.sibling;return te}function h(re,te){return re=Vr(re,te),re.index=0,re.sibling=null,re}function p(re,te,le){return re.index=le,t?(le=re.alternate,le!==null?(le=le.index,le<te?(re.flags|=67108866,te):le):(re.flags|=67108866,te)):(re.flags|=1048576,te)}function S(re){return t&&re.alternate===null&&(re.flags|=67108866),re}function j(re,te,le,Se){return te===null||te.tag!==6?(te=Zo(le,re.mode,Se),te.return=re,te):(te=h(te,le),te.return=re,te)}function W(re,te,le,Se){var Ge=le.type;return Ge===w?ve(re,te,le.props.children,Se,le.key):te!==null&&(te.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Z&&os(Ge)===te.type)?(te=h(te,le.props),Kl(te,le),te.return=re,te):(te=Rc(le.type,le.key,le.props,null,re.mode,Se),Kl(te,le),te.return=re,te)}function ie(re,te,le,Se){return te===null||te.tag!==4||te.stateNode.containerInfo!==le.containerInfo||te.stateNode.implementation!==le.implementation?(te=Jo(le,re.mode,Se),te.return=re,te):(te=h(te,le.children||[]),te.return=re,te)}function ve(re,te,le,Se,Ge){return te===null||te.tag!==7?(te=ns(le,re.mode,Se,Ge),te.return=re,te):(te=h(te,le),te.return=re,te)}function _e(re,te,le){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=Zo(""+te,re.mode,le),te.return=re,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case k:return le=Rc(te.type,te.key,te.props,null,re.mode,le),Kl(le,te),le.return=re,le;case y:return te=Jo(te,re.mode,le),te.return=re,te;case Z:return te=os(te),_e(re,te,le)}if(me(te)||ee(te))return te=ns(te,re.mode,le,null),te.return=re,te;if(typeof te.then=="function")return _e(re,zc(te),le);if(te.$$typeof===E)return _e(re,Mc(re,te),le);Uc(re,te)}return null}function fe(re,te,le,Se){var Ge=te!==null?te.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Ge!==null?null:j(re,te,""+le,Se);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case k:return le.key===Ge?W(re,te,le,Se):null;case y:return le.key===Ge?ie(re,te,le,Se):null;case Z:return le=os(le),fe(re,te,le,Se)}if(me(le)||ee(le))return Ge!==null?null:ve(re,te,le,Se,null);if(typeof le.then=="function")return fe(re,te,zc(le),Se);if(le.$$typeof===E)return fe(re,te,Mc(re,le),Se);Uc(re,le)}return null}function he(re,te,le,Se,Ge){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return re=re.get(le)||null,j(te,re,""+Se,Ge);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case k:return re=re.get(Se.key===null?le:Se.key)||null,W(te,re,Se,Ge);case y:return re=re.get(Se.key===null?le:Se.key)||null,ie(te,re,Se,Ge);case Z:return Se=os(Se),he(re,te,le,Se,Ge)}if(me(Se)||ee(Se))return re=re.get(le)||null,ve(te,re,Se,Ge,null);if(typeof Se.then=="function")return he(re,te,le,zc(Se),Ge);if(Se.$$typeof===E)return he(re,te,le,Mc(te,Se),Ge);Uc(te,Se)}return null}function Be(re,te,le,Se){for(var Ge=null,xt=null,Ve=te,tt=te=0,ct=null;Ve!==null&&tt<le.length;tt++){Ve.index>tt?(ct=Ve,Ve=null):ct=Ve.sibling;var mt=fe(re,Ve,le[tt],Se);if(mt===null){Ve===null&&(Ve=ct);break}t&&Ve&&mt.alternate===null&&r(re,Ve),te=p(mt,te,tt),xt===null?Ge=mt:xt.sibling=mt,xt=mt,Ve=ct}if(tt===le.length)return l(re,Ve),ot&&Gr(re,tt),Ge;if(Ve===null){for(;tt<le.length;tt++)Ve=_e(re,le[tt],Se),Ve!==null&&(te=p(Ve,te,tt),xt===null?Ge=Ve:xt.sibling=Ve,xt=Ve);return ot&&Gr(re,tt),Ge}for(Ve=o(Ve);tt<le.length;tt++)ct=he(Ve,re,tt,le[tt],Se),ct!==null&&(t&&ct.alternate!==null&&Ve.delete(ct.key===null?tt:ct.key),te=p(ct,te,tt),xt===null?Ge=ct:xt.sibling=ct,xt=ct);return t&&Ve.forEach(function(In){return r(re,In)}),ot&&Gr(re,tt),Ge}function Xe(re,te,le,Se){if(le==null)throw Error(s(151));for(var Ge=null,xt=null,Ve=te,tt=te=0,ct=null,mt=le.next();Ve!==null&&!mt.done;tt++,mt=le.next()){Ve.index>tt?(ct=Ve,Ve=null):ct=Ve.sibling;var In=fe(re,Ve,mt.value,Se);if(In===null){Ve===null&&(Ve=ct);break}t&&Ve&&In.alternate===null&&r(re,Ve),te=p(In,te,tt),xt===null?Ge=In:xt.sibling=In,xt=In,Ve=ct}if(mt.done)return l(re,Ve),ot&&Gr(re,tt),Ge;if(Ve===null){for(;!mt.done;tt++,mt=le.next())mt=_e(re,mt.value,Se),mt!==null&&(te=p(mt,te,tt),xt===null?Ge=mt:xt.sibling=mt,xt=mt);return ot&&Gr(re,tt),Ge}for(Ve=o(Ve);!mt.done;tt++,mt=le.next())mt=he(Ve,re,tt,mt.value,Se),mt!==null&&(t&&mt.alternate!==null&&Ve.delete(mt.key===null?tt:mt.key),te=p(mt,te,tt),xt===null?Ge=mt:xt.sibling=mt,xt=mt);return t&&Ve.forEach(function(mk){return r(re,mk)}),ot&&Gr(re,tt),Ge}function kt(re,te,le,Se){if(typeof le=="object"&&le!==null&&le.type===w&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case k:e:{for(var Ge=le.key;te!==null;){if(te.key===Ge){if(Ge=le.type,Ge===w){if(te.tag===7){l(re,te.sibling),Se=h(te,le.props.children),Se.return=re,re=Se;break e}}else if(te.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Z&&os(Ge)===te.type){l(re,te.sibling),Se=h(te,le.props),Kl(Se,le),Se.return=re,re=Se;break e}l(re,te);break}else r(re,te);te=te.sibling}le.type===w?(Se=ns(le.props.children,re.mode,Se,le.key),Se.return=re,re=Se):(Se=Rc(le.type,le.key,le.props,null,re.mode,Se),Kl(Se,le),Se.return=re,re=Se)}return S(re);case y:e:{for(Ge=le.key;te!==null;){if(te.key===Ge)if(te.tag===4&&te.stateNode.containerInfo===le.containerInfo&&te.stateNode.implementation===le.implementation){l(re,te.sibling),Se=h(te,le.children||[]),Se.return=re,re=Se;break e}else{l(re,te);break}else r(re,te);te=te.sibling}Se=Jo(le,re.mode,Se),Se.return=re,re=Se}return S(re);case Z:return le=os(le),kt(re,te,le,Se)}if(me(le))return Be(re,te,le,Se);if(ee(le)){if(Ge=ee(le),typeof Ge!="function")throw Error(s(150));return le=Ge.call(le),Xe(re,te,le,Se)}if(typeof le.then=="function")return kt(re,te,zc(le),Se);if(le.$$typeof===E)return kt(re,te,Mc(re,le),Se);Uc(re,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,te!==null&&te.tag===6?(l(re,te.sibling),Se=h(te,le),Se.return=re,re=Se):(l(re,te),Se=Zo(le,re.mode,Se),Se.return=re,re=Se),S(re)):l(re,te)}return function(re,te,le,Se){try{ql=0;var Ge=kt(re,te,le,Se);return Zs=null,Ge}catch(Ve){if(Ve===Ws||Ve===Ic)throw Ve;var xt=Ua(29,Ve,null,re.mode);return xt.lanes=Se,xt.return=re,xt}finally{}}}var fs=yx(!0),kx=yx(!1),yn=!1;function uu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fu(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function kn(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function wn(t,r,l){var o=t.updateQueue;if(o===null)return null;if(o=o.shared,(pt&2)!==0){var h=o.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),o.pending=r,r=Oc(t),nx(t,null,l),r}return jc(t,o,r,l),Oc(t)}function Wl(t,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var o=r.lanes;o&=t.pendingLanes,l|=o,r.lanes=l,Fs(t,l)}}function du(t,r){var l=t.updateQueue,o=t.alternate;if(o!==null&&(o=o.updateQueue,l===o)){var h=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var S={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?h=p=S:p=p.next=S,l=l.next}while(l!==null);p===null?h=p=r:p=p.next=r}else h=p=r;l={baseState:o.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:o.shared,callbacks:o.callbacks},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=r:t.next=r,l.lastBaseUpdate=r}var hu=!1;function Zl(){if(hu){var t=Ks;if(t!==null)throw t}}function Jl(t,r,l,o){hu=!1;var h=t.updateQueue;yn=!1;var p=h.firstBaseUpdate,S=h.lastBaseUpdate,j=h.shared.pending;if(j!==null){h.shared.pending=null;var W=j,ie=W.next;W.next=null,S===null?p=ie:S.next=ie,S=W;var ve=t.alternate;ve!==null&&(ve=ve.updateQueue,j=ve.lastBaseUpdate,j!==S&&(j===null?ve.firstBaseUpdate=ie:j.next=ie,ve.lastBaseUpdate=W))}if(p!==null){var _e=h.baseState;S=0,ve=ie=W=null,j=p;do{var fe=j.lane&-536870913,he=fe!==j.lane;if(he?(it&fe)===fe:(o&fe)===fe){fe!==0&&fe===qs&&(hu=!0),ve!==null&&(ve=ve.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Be=t,Xe=j;fe=r;var kt=l;switch(Xe.tag){case 1:if(Be=Xe.payload,typeof Be=="function"){_e=Be.call(kt,_e,fe);break e}_e=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Xe.payload,fe=typeof Be=="function"?Be.call(kt,_e,fe):Be,fe==null)break e;_e=v({},_e,fe);break e;case 2:yn=!0}}fe=j.callback,fe!==null&&(t.flags|=64,he&&(t.flags|=8192),he=h.callbacks,he===null?h.callbacks=[fe]:he.push(fe))}else he={lane:fe,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ve===null?(ie=ve=he,W=_e):ve=ve.next=he,S|=fe;if(j=j.next,j===null){if(j=h.shared.pending,j===null)break;he=j,j=he.next,he.next=null,h.lastBaseUpdate=he,h.shared.pending=null}}while(!0);ve===null&&(W=_e),h.baseState=W,h.firstBaseUpdate=ie,h.lastBaseUpdate=ve,p===null&&(h.shared.lanes=0),_n|=S,t.lanes=S,t.memoizedState=_e}}function wx(t,r){if(typeof t!="function")throw Error(s(191,t));t.call(r)}function Sx(t,r){var l=t.callbacks;if(l!==null)for(t.callbacks=null,t=0;t<l.length;t++)wx(l[t],r)}var Js=B(null),Pc=B(0);function Ex(t,r){t=tn,q(Pc,t),q(Js,r),tn=t|r.baseLanes}function xu(){q(Pc,tn),q(Js,Js.current)}function mu(){tn=Pc.current,A(Js),A(Pc)}var Pa=B(null),ir=null;function Sn(t){var r=t.alternate;q(Pt,Pt.current&1),q(Pa,t),ir===null&&(r===null||Js.current!==null||r.memoizedState!==null)&&(ir=t)}function pu(t){q(Pt,Pt.current),q(Pa,t),ir===null&&(ir=t)}function Nx(t){t.tag===22?(q(Pt,Pt.current),q(Pa,t),ir===null&&(ir=t)):En()}function En(){q(Pt,Pt.current),q(Pa,Pa.current)}function Ha(t){A(Pa),ir===t&&(ir=null),A(Pt)}var Pt=B(0);function Hc(t){for(var r=t;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Sf(l)||Ef(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Yr=0,Je=null,bt=null,Xt=null,Vc=!1,Qs=!1,ds=!1,Gc=0,Ql=0,el=null,sy=0;function Ft(){throw Error(s(321))}function gu(t,r){if(r===null)return!1;for(var l=0;l<r.length&&l<t.length;l++)if(!za(t[l],r[l]))return!1;return!0}function vu(t,r,l,o,h,p){return Yr=p,Je=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,J.H=t===null||t.memoizedState===null?c1:Du,ds=!1,p=l(o,h),ds=!1,Qs&&(p=_x(r,l,o,h)),Tx(t),p}function Tx(t){J.H=ai;var r=bt!==null&&bt.next!==null;if(Yr=0,Xt=bt=Je=null,Vc=!1,Ql=0,el=null,r)throw Error(s(300));t===null||Yt||(t=t.dependencies,t!==null&&Fc(t)&&(Yt=!0))}function _x(t,r,l,o){Je=t;var h=0;do{if(Qs&&(el=null),Ql=0,Qs=!1,25<=h)throw Error(s(301));if(h+=1,Xt=bt=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}J.H=o1,p=r(l,o)}while(Qs);return p}function ly(){var t=J.H,r=t.useState()[0];return r=typeof r.then=="function"?ei(r):r,t=t.useState()[0],(bt!==null?bt.memoizedState:null)!==t&&(Je.flags|=1024),r}function bu(){var t=Gc!==0;return Gc=0,t}function yu(t,r,l){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~l}function ku(t){if(Vc){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}Vc=!1}Yr=0,Xt=bt=Je=null,Qs=!1,Ql=Gc=0,el=null}function Sa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?Je.memoizedState=Xt=t:Xt=Xt.next=t,Xt}function Ht(){if(bt===null){var t=Je.alternate;t=t!==null?t.memoizedState:null}else t=bt.next;var r=Xt===null?Je.memoizedState:Xt.next;if(r!==null)Xt=r,bt=t;else{if(t===null)throw Je.alternate===null?Error(s(467)):Error(s(310));bt=t,t={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},Xt===null?Je.memoizedState=Xt=t:Xt=Xt.next=t}return Xt}function $c(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ei(t){var r=Ql;return Ql+=1,el===null&&(el=[]),t=gx(el,t,r),r=Je,(Xt===null?r.memoizedState:Xt.next)===null&&(r=r.alternate,J.H=r===null||r.memoizedState===null?c1:Du),t}function Xc(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return ei(t);if(t.$$typeof===E)return ia(t)}throw Error(s(438,String(t)))}function wu(t){var r=null,l=Je.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var o=Je.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(r={data:o.data.map(function(h){return h.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=$c(),Je.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(t),o=0;o<t;o++)l[o]=Q;return r.index++,l}function qr(t,r){return typeof r=="function"?r(t):r}function Yc(t){var r=Ht();return Su(r,bt,t)}function Su(t,r,l){var o=t.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=l;var h=t.baseQueue,p=o.pending;if(p!==null){if(h!==null){var S=h.next;h.next=p.next,p.next=S}r.baseQueue=h=p,o.pending=null}if(p=t.baseState,h===null)t.memoizedState=p;else{r=h.next;var j=S=null,W=null,ie=r,ve=!1;do{var _e=ie.lane&-536870913;if(_e!==ie.lane?(it&_e)===_e:(Yr&_e)===_e){var fe=ie.revertLane;if(fe===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),_e===qs&&(ve=!0);else if((Yr&fe)===fe){ie=ie.next,fe===qs&&(ve=!0);continue}else _e={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},W===null?(j=W=_e,S=p):W=W.next=_e,Je.lanes|=fe,_n|=fe;_e=ie.action,ds&&l(p,_e),p=ie.hasEagerState?ie.eagerState:l(p,_e)}else fe={lane:_e,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},W===null?(j=W=fe,S=p):W=W.next=fe,Je.lanes|=_e,_n|=_e;ie=ie.next}while(ie!==null&&ie!==r);if(W===null?S=p:W.next=j,!za(p,t.memoizedState)&&(Yt=!0,ve&&(l=Ks,l!==null)))throw l;t.memoizedState=p,t.baseState=S,t.baseQueue=W,o.lastRenderedState=p}return h===null&&(o.lanes=0),[t.memoizedState,o.dispatch]}function Eu(t){var r=Ht(),l=r.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=t;var o=l.dispatch,h=l.pending,p=r.memoizedState;if(h!==null){l.pending=null;var S=h=h.next;do p=t(p,S.action),S=S.next;while(S!==h);za(p,r.memoizedState)||(Yt=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,o]}function Ax(t,r,l){var o=Je,h=Ht(),p=ot;if(p){if(l===void 0)throw Error(s(407));l=l()}else l=r();var S=!za((bt||h).memoizedState,l);if(S&&(h.memoizedState=l,Yt=!0),h=h.queue,_u(Ox.bind(null,o,h,t),[t]),h.getSnapshot!==r||S||Xt!==null&&Xt.memoizedState.tag&1){if(o.flags|=2048,tl(9,{destroy:void 0},jx.bind(null,o,h,l,r),null),wt===null)throw Error(s(349));p||(Yr&127)!==0||Cx(o,r,l)}return l}function Cx(t,r,l){t.flags|=16384,t={getSnapshot:r,value:l},r=Je.updateQueue,r===null?(r=$c(),Je.updateQueue=r,r.stores=[t]):(l=r.stores,l===null?r.stores=[t]:l.push(t))}function jx(t,r,l,o){r.value=l,r.getSnapshot=o,Rx(r)&&Dx(t)}function Ox(t,r,l){return l(function(){Rx(r)&&Dx(t)})}function Rx(t){var r=t.getSnapshot;t=t.value;try{var l=r();return!za(t,l)}catch{return!0}}function Dx(t){var r=rs(t,2);r!==null&&La(r,t,2)}function Nu(t){var r=Sa();if(typeof t=="function"){var l=t;if(t=l(),ds){pr(!0);try{l()}finally{pr(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:t},r}function Fx(t,r,l,o){return t.baseState=l,Su(t,bt,typeof o=="function"?o:qr)}function iy(t,r,l,o,h){if(Wc(t))throw Error(s(485));if(t=r.action,t!==null){var p={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){p.listeners.push(S)}};J.T!==null?l(!0):p.isTransition=!1,o(p),l=r.pending,l===null?(p.next=r.pending=p,Mx(r,p)):(p.next=l.next,r.pending=l.next=p)}}function Mx(t,r){var l=r.action,o=r.payload,h=t.state;if(r.isTransition){var p=J.T,S={};J.T=S;try{var j=l(h,o),W=J.S;W!==null&&W(S,j),Lx(t,r,j)}catch(ie){Tu(t,r,ie)}finally{p!==null&&S.types!==null&&(p.types=S.types),J.T=p}}else try{p=l(h,o),Lx(t,r,p)}catch(ie){Tu(t,r,ie)}}function Lx(t,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(o){Ix(t,r,o)},function(o){return Tu(t,r,o)}):Ix(t,r,l)}function Ix(t,r,l){r.status="fulfilled",r.value=l,Bx(r),t.state=l,r=t.pending,r!==null&&(l=r.next,l===r?t.pending=null:(l=l.next,r.next=l,Mx(t,l)))}function Tu(t,r,l){var o=t.pending;if(t.pending=null,o!==null){o=o.next;do r.status="rejected",r.reason=l,Bx(r),r=r.next;while(r!==o)}t.action=null}function Bx(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function zx(t,r){return r}function Ux(t,r){if(ot){var l=wt.formState;if(l!==null){e:{var o=Je;if(ot){if(_t){t:{for(var h=_t,p=lr;h.nodeType!==8;){if(!p){h=null;break t}if(h=cr(h.nextSibling),h===null){h=null;break t}}p=h.data,h=p==="F!"||p==="F"?h:null}if(h){_t=cr(h.nextSibling),o=h.data==="F!";break e}}vn(o)}o=!1}o&&(r=l[0])}}return l=Sa(),l.memoizedState=l.baseState=r,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zx,lastRenderedState:r},l.queue=o,l=s1.bind(null,Je,o),o.dispatch=l,o=Nu(!1),p=Ru.bind(null,Je,!1,o.queue),o=Sa(),h={state:r,dispatch:null,action:t,pending:null},o.queue=h,l=iy.bind(null,Je,h,p,l),h.dispatch=l,o.memoizedState=t,[r,l,!1]}function Px(t){var r=Ht();return Hx(r,bt,t)}function Hx(t,r,l){if(r=Su(t,r,zx)[0],t=Yc(qr)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var o=ei(r)}catch(S){throw S===Ws?Ic:S}else o=r;r=Ht();var h=r.queue,p=h.dispatch;return l!==r.memoizedState&&(Je.flags|=2048,tl(9,{destroy:void 0},cy.bind(null,h,l),null)),[o,p,t]}function cy(t,r){t.action=r}function Vx(t){var r=Ht(),l=bt;if(l!==null)return Hx(r,l,t);Ht(),r=r.memoizedState,l=Ht();var o=l.queue.dispatch;return l.memoizedState=t,[r,o,!1]}function tl(t,r,l,o){return t={tag:t,create:l,deps:o,inst:r,next:null},r=Je.updateQueue,r===null&&(r=$c(),Je.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=t.next=t:(o=l.next,l.next=t,t.next=o,r.lastEffect=t),t}function Gx(){return Ht().memoizedState}function qc(t,r,l,o){var h=Sa();Je.flags|=t,h.memoizedState=tl(1|r,{destroy:void 0},l,o===void 0?null:o)}function Kc(t,r,l,o){var h=Ht();o=o===void 0?null:o;var p=h.memoizedState.inst;bt!==null&&o!==null&&gu(o,bt.memoizedState.deps)?h.memoizedState=tl(r,p,l,o):(Je.flags|=t,h.memoizedState=tl(1|r,p,l,o))}function $x(t,r){qc(8390656,8,t,r)}function _u(t,r){Kc(2048,8,t,r)}function oy(t){Je.flags|=4;var r=Je.updateQueue;if(r===null)r=$c(),Je.updateQueue=r,r.events=[t];else{var l=r.events;l===null?r.events=[t]:l.push(t)}}function Xx(t){var r=Ht().memoizedState;return oy({ref:r,nextImpl:t}),function(){if((pt&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}function Yx(t,r){return Kc(4,2,t,r)}function qx(t,r){return Kc(4,4,t,r)}function Kx(t,r){if(typeof r=="function"){t=t();var l=r(t);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function Wx(t,r,l){l=l!=null?l.concat([t]):null,Kc(4,4,Kx.bind(null,r,t),l)}function Au(){}function Zx(t,r){var l=Ht();r=r===void 0?null:r;var o=l.memoizedState;return r!==null&&gu(r,o[1])?o[0]:(l.memoizedState=[t,r],t)}function Jx(t,r){var l=Ht();r=r===void 0?null:r;var o=l.memoizedState;if(r!==null&&gu(r,o[1]))return o[0];if(o=t(),ds){pr(!0);try{t()}finally{pr(!1)}}return l.memoizedState=[o,r],o}function Cu(t,r,l){return l===void 0||(Yr&1073741824)!==0&&(it&261930)===0?t.memoizedState=r:(t.memoizedState=l,t=Q1(),Je.lanes|=t,_n|=t,l)}function Qx(t,r,l,o){return za(l,r)?l:Js.current!==null?(t=Cu(t,l,o),za(t,r)||(Yt=!0),t):(Yr&42)===0||(Yr&1073741824)!==0&&(it&261930)===0?(Yt=!0,t.memoizedState=l):(t=Q1(),Je.lanes|=t,_n|=t,r)}function e1(t,r,l,o,h){var p=se.p;se.p=p!==0&&8>p?p:8;var S=J.T,j={};J.T=j,Ru(t,!1,r,l);try{var W=h(),ie=J.S;if(ie!==null&&ie(j,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var ve=ny(W,o);ti(t,r,ve,$a(t))}else ti(t,r,o,$a(t))}catch(_e){ti(t,r,{then:function(){},status:"rejected",reason:_e},$a())}finally{se.p=p,S!==null&&j.types!==null&&(S.types=j.types),J.T=S}}function uy(){}function ju(t,r,l,o){if(t.tag!==5)throw Error(s(476));var h=t1(t).queue;e1(t,h,r,Ae,l===null?uy:function(){return a1(t),l(o)})}function t1(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:Ae,baseState:Ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:Ae},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:l},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function a1(t){var r=t1(t);r.next===null&&(r=t.alternate.memoizedState),ti(t,r.next.queue,{},$a())}function Ou(){return ia(vi)}function r1(){return Ht().memoizedState}function n1(){return Ht().memoizedState}function fy(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var l=$a();t=kn(l);var o=wn(r,t,l);o!==null&&(La(o,r,l),Wl(o,r,l)),r={cache:lu()},t.payload=r;return}r=r.return}}function dy(t,r,l){var o=$a();l={lane:o,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Wc(t)?l1(r,l):(l=Ko(t,r,l,o),l!==null&&(La(l,t,o),i1(l,r,o)))}function s1(t,r,l){var o=$a();ti(t,r,l,o)}function ti(t,r,l,o){var h={lane:o,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Wc(t))l1(r,h);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var S=r.lastRenderedState,j=p(S,l);if(h.hasEagerState=!0,h.eagerState=j,za(j,S))return jc(t,r,h,0),wt===null&&Cc(),!1}catch{}finally{}if(l=Ko(t,r,h,o),l!==null)return La(l,t,o),i1(l,r,o),!0}return!1}function Ru(t,r,l,o){if(o={lane:2,revertLane:ff(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Wc(t)){if(r)throw Error(s(479))}else r=Ko(t,l,o,2),r!==null&&La(r,t,2)}function Wc(t){var r=t.alternate;return t===Je||r!==null&&r===Je}function l1(t,r){Qs=Vc=!0;var l=t.pending;l===null?r.next=r:(r.next=l.next,l.next=r),t.pending=r}function i1(t,r,l){if((l&4194048)!==0){var o=r.lanes;o&=t.pendingLanes,l|=o,r.lanes=l,Fs(t,l)}}var ai={readContext:ia,use:Xc,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useLayoutEffect:Ft,useInsertionEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useSyncExternalStore:Ft,useId:Ft,useHostTransitionStatus:Ft,useFormState:Ft,useActionState:Ft,useOptimistic:Ft,useMemoCache:Ft,useCacheRefresh:Ft};ai.useEffectEvent=Ft;var c1={readContext:ia,use:Xc,useCallback:function(t,r){return Sa().memoizedState=[t,r===void 0?null:r],t},useContext:ia,useEffect:$x,useImperativeHandle:function(t,r,l){l=l!=null?l.concat([t]):null,qc(4194308,4,Kx.bind(null,r,t),l)},useLayoutEffect:function(t,r){return qc(4194308,4,t,r)},useInsertionEffect:function(t,r){qc(4,2,t,r)},useMemo:function(t,r){var l=Sa();r=r===void 0?null:r;var o=t();if(ds){pr(!0);try{t()}finally{pr(!1)}}return l.memoizedState=[o,r],o},useReducer:function(t,r,l){var o=Sa();if(l!==void 0){var h=l(r);if(ds){pr(!0);try{l(r)}finally{pr(!1)}}}else h=r;return o.memoizedState=o.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},o.queue=t,t=t.dispatch=dy.bind(null,Je,t),[o.memoizedState,t]},useRef:function(t){var r=Sa();return t={current:t},r.memoizedState=t},useState:function(t){t=Nu(t);var r=t.queue,l=s1.bind(null,Je,r);return r.dispatch=l,[t.memoizedState,l]},useDebugValue:Au,useDeferredValue:function(t,r){var l=Sa();return Cu(l,t,r)},useTransition:function(){var t=Nu(!1);return t=e1.bind(null,Je,t.queue,!0,!1),Sa().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,l){var o=Je,h=Sa();if(ot){if(l===void 0)throw Error(s(407));l=l()}else{if(l=r(),wt===null)throw Error(s(349));(it&127)!==0||Cx(o,r,l)}h.memoizedState=l;var p={value:l,getSnapshot:r};return h.queue=p,$x(Ox.bind(null,o,p,t),[t]),o.flags|=2048,tl(9,{destroy:void 0},jx.bind(null,o,p,l,r),null),l},useId:function(){var t=Sa(),r=wt.identifierPrefix;if(ot){var l=Cr,o=Ar;l=(o&~(1<<32-wa(o)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Gc++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=sy++,r="_"+r+"r_"+l.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:Ou,useFormState:Ux,useActionState:Ux,useOptimistic:function(t){var r=Sa();r.memoizedState=r.baseState=t;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Ru.bind(null,Je,!0,l),l.dispatch=r,[t,r]},useMemoCache:wu,useCacheRefresh:function(){return Sa().memoizedState=fy.bind(null,Je)},useEffectEvent:function(t){var r=Sa(),l={impl:t};return r.memoizedState=l,function(){if((pt&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Du={readContext:ia,use:Xc,useCallback:Zx,useContext:ia,useEffect:_u,useImperativeHandle:Wx,useInsertionEffect:Yx,useLayoutEffect:qx,useMemo:Jx,useReducer:Yc,useRef:Gx,useState:function(){return Yc(qr)},useDebugValue:Au,useDeferredValue:function(t,r){var l=Ht();return Qx(l,bt.memoizedState,t,r)},useTransition:function(){var t=Yc(qr)[0],r=Ht().memoizedState;return[typeof t=="boolean"?t:ei(t),r]},useSyncExternalStore:Ax,useId:r1,useHostTransitionStatus:Ou,useFormState:Px,useActionState:Px,useOptimistic:function(t,r){var l=Ht();return Fx(l,bt,t,r)},useMemoCache:wu,useCacheRefresh:n1};Du.useEffectEvent=Xx;var o1={readContext:ia,use:Xc,useCallback:Zx,useContext:ia,useEffect:_u,useImperativeHandle:Wx,useInsertionEffect:Yx,useLayoutEffect:qx,useMemo:Jx,useReducer:Eu,useRef:Gx,useState:function(){return Eu(qr)},useDebugValue:Au,useDeferredValue:function(t,r){var l=Ht();return bt===null?Cu(l,t,r):Qx(l,bt.memoizedState,t,r)},useTransition:function(){var t=Eu(qr)[0],r=Ht().memoizedState;return[typeof t=="boolean"?t:ei(t),r]},useSyncExternalStore:Ax,useId:r1,useHostTransitionStatus:Ou,useFormState:Vx,useActionState:Vx,useOptimistic:function(t,r){var l=Ht();return bt!==null?Fx(l,bt,t,r):(l.baseState=t,[t,l.queue.dispatch])},useMemoCache:wu,useCacheRefresh:n1};o1.useEffectEvent=Xx;function Fu(t,r,l,o){r=t.memoizedState,l=l(o,r),l=l==null?r:v({},r,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var Mu={enqueueSetState:function(t,r,l){t=t._reactInternals;var o=$a(),h=kn(o);h.payload=r,l!=null&&(h.callback=l),r=wn(t,h,o),r!==null&&(La(r,t,o),Wl(r,t,o))},enqueueReplaceState:function(t,r,l){t=t._reactInternals;var o=$a(),h=kn(o);h.tag=1,h.payload=r,l!=null&&(h.callback=l),r=wn(t,h,o),r!==null&&(La(r,t,o),Wl(r,t,o))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var l=$a(),o=kn(l);o.tag=2,r!=null&&(o.callback=r),r=wn(t,o,l),r!==null&&(La(r,t,l),Wl(r,t,l))}};function u1(t,r,l,o,h,p,S){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(o,p,S):r.prototype&&r.prototype.isPureReactComponent?!Hl(l,o)||!Hl(h,p):!0}function f1(t,r,l,o){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,o),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,o),r.state!==t&&Mu.enqueueReplaceState(r,r.state,null)}function hs(t,r){var l=r;if("ref"in r){l={};for(var o in r)o!=="ref"&&(l[o]=r[o])}if(t=t.defaultProps){l===r&&(l=v({},l));for(var h in t)l[h]===void 0&&(l[h]=t[h])}return l}function d1(t){Ac(t)}function h1(t){console.error(t)}function x1(t){Ac(t)}function Zc(t,r){try{var l=t.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(o){setTimeout(function(){throw o})}}function m1(t,r,l){try{var o=t.onCaughtError;o(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Lu(t,r,l){return l=kn(l),l.tag=3,l.payload={element:null},l.callback=function(){Zc(t,r)},l}function p1(t){return t=kn(t),t.tag=3,t}function g1(t,r,l,o){var h=l.type.getDerivedStateFromError;if(typeof h=="function"){var p=o.value;t.payload=function(){return h(p)},t.callback=function(){m1(r,l,o)}}var S=l.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(t.callback=function(){m1(r,l,o),typeof h!="function"&&(An===null?An=new Set([this]):An.add(this));var j=o.stack;this.componentDidCatch(o.value,{componentStack:j!==null?j:""})})}function hy(t,r,l,o,h){if(l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(r=l.alternate,r!==null&&Ys(r,l,h,!0),l=Pa.current,l!==null){switch(l.tag){case 31:case 13:return ir===null?o0():l.alternate===null&&Mt===0&&(Mt=3),l.flags&=-257,l.flags|=65536,l.lanes=h,o===Bc?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([o]):r.add(o),cf(t,o,h)),!1;case 22:return l.flags|=65536,o===Bc?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([o])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([o]):l.add(o)),cf(t,o,h)),!1}throw Error(s(435,l.tag))}return cf(t,o,h),o0(),!1}if(ot)return r=Pa.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=h,o!==tu&&(t=Error(s(422),{cause:o}),$l(rr(t,l)))):(o!==tu&&(r=Error(s(423),{cause:o}),$l(rr(r,l))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,o=rr(o,l),h=Lu(t.stateNode,o,h),du(t,h),Mt!==4&&(Mt=2)),!1;var p=Error(s(520),{cause:o});if(p=rr(p,l),ui===null?ui=[p]:ui.push(p),Mt!==4&&(Mt=2),r===null)return!0;o=rr(o,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,t=h&-h,l.lanes|=t,t=Lu(l.stateNode,o,t),du(l,t),!1;case 1:if(r=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(An===null||!An.has(p))))return l.flags|=65536,h&=-h,l.lanes|=h,h=p1(h),g1(h,t,l,o),du(l,h),!1}l=l.return}while(l!==null);return!1}var Iu=Error(s(461)),Yt=!1;function ca(t,r,l,o){r.child=t===null?kx(r,null,l,o):fs(r,t.child,l,o)}function v1(t,r,l,o,h){l=l.render;var p=r.ref;if("ref"in o){var S={};for(var j in o)j!=="ref"&&(S[j]=o[j])}else S=o;return is(r),o=vu(t,r,l,S,p,h),j=bu(),t!==null&&!Yt?(yu(t,r,h),Kr(t,r,h)):(ot&&j&&Qo(r),r.flags|=1,ca(t,r,o,h),r.child)}function b1(t,r,l,o,h){if(t===null){var p=l.type;return typeof p=="function"&&!Wo(p)&&p.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=p,y1(t,r,p,o,h)):(t=Rc(l.type,null,o,r,r.mode,h),t.ref=r.ref,t.return=r,r.child=t)}if(p=t.child,!$u(t,h)){var S=p.memoizedProps;if(l=l.compare,l=l!==null?l:Hl,l(S,o)&&t.ref===r.ref)return Kr(t,r,h)}return r.flags|=1,t=Vr(p,o),t.ref=r.ref,t.return=r,r.child=t}function y1(t,r,l,o,h){if(t!==null){var p=t.memoizedProps;if(Hl(p,o)&&t.ref===r.ref)if(Yt=!1,r.pendingProps=o=p,$u(t,h))(t.flags&131072)!==0&&(Yt=!0);else return r.lanes=t.lanes,Kr(t,r,h)}return Bu(t,r,l,o,h)}function k1(t,r,l,o){var h=o.children,p=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((r.flags&128)!==0){if(p=p!==null?p.baseLanes|l:l,t!==null){for(o=r.child=t.child,h=0;o!==null;)h=h|o.lanes|o.childLanes,o=o.sibling;o=h&~p}else o=0,r.child=null;return w1(t,r,p,l,o)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&Lc(r,p!==null?p.cachePool:null),p!==null?Ex(r,p):xu(),Nx(r);else return o=r.lanes=536870912,w1(t,r,p!==null?p.baseLanes|l:l,l,o)}else p!==null?(Lc(r,p.cachePool),Ex(r,p),En(),r.memoizedState=null):(t!==null&&Lc(r,null),xu(),En());return ca(t,r,h,l),r.child}function ri(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function w1(t,r,l,o,h){var p=cu();return p=p===null?null:{parent:$t._currentValue,pool:p},r.memoizedState={baseLanes:l,cachePool:p},t!==null&&Lc(r,null),xu(),Nx(r),t!==null&&Ys(t,r,o,!0),r.childLanes=h,null}function Jc(t,r){return r=e0({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function S1(t,r,l){return fs(r,t.child,null,l),t=Jc(r,r.pendingProps),t.flags|=2,Ha(r),r.memoizedState=null,t}function xy(t,r,l){var o=r.pendingProps,h=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(ot){if(o.mode==="hidden")return t=Jc(r,o),r.lanes=536870912,ri(null,t);if(pu(r),(t=_t)?(t=Mm(t,lr),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:pn!==null?{id:Ar,overflow:Cr}:null,retryLane:536870912,hydrationErrors:null},l=lx(t),l.return=r,r.child=l,la=r,_t=null)):t=null,t===null)throw vn(r);return r.lanes=536870912,null}return Jc(r,o)}var p=t.memoizedState;if(p!==null){var S=p.dehydrated;if(pu(r),h)if(r.flags&256)r.flags&=-257,r=S1(t,r,l);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(s(558));else if(Yt||Ys(t,r,l,!1),h=(l&t.childLanes)!==0,Yt||h){if(o=wt,o!==null&&(S=vc(o,l),S!==0&&S!==p.retryLane))throw p.retryLane=S,rs(t,S),La(o,t,S),Iu;o0(),r=S1(t,r,l)}else t=p.treeContext,_t=cr(S.nextSibling),la=r,ot=!0,gn=null,lr=!1,t!==null&&ox(r,t),r=Jc(r,o),r.flags|=4096;return r}return t=Vr(t.child,{mode:o.mode,children:o.children}),t.ref=r.ref,r.child=t,t.return=r,t}function Qc(t,r){var l=r.ref;if(l===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(t===null||t.ref!==l)&&(r.flags|=4194816)}}function Bu(t,r,l,o,h){return is(r),l=vu(t,r,l,o,void 0,h),o=bu(),t!==null&&!Yt?(yu(t,r,h),Kr(t,r,h)):(ot&&o&&Qo(r),r.flags|=1,ca(t,r,l,h),r.child)}function E1(t,r,l,o,h,p){return is(r),r.updateQueue=null,l=_x(r,o,l,h),Tx(t),o=bu(),t!==null&&!Yt?(yu(t,r,p),Kr(t,r,p)):(ot&&o&&Qo(r),r.flags|=1,ca(t,r,l,p),r.child)}function N1(t,r,l,o,h){if(is(r),r.stateNode===null){var p=Vs,S=l.contextType;typeof S=="object"&&S!==null&&(p=ia(S)),p=new l(o,p),r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Mu,r.stateNode=p,p._reactInternals=r,p=r.stateNode,p.props=o,p.state=r.memoizedState,p.refs={},uu(r),S=l.contextType,p.context=typeof S=="object"&&S!==null?ia(S):Vs,p.state=r.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(Fu(r,l,S,o),p.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(S=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),S!==p.state&&Mu.enqueueReplaceState(p,p.state,null),Jl(r,o,p,h),Zl(),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308),o=!0}else if(t===null){p=r.stateNode;var j=r.memoizedProps,W=hs(l,j);p.props=W;var ie=p.context,ve=l.contextType;S=Vs,typeof ve=="object"&&ve!==null&&(S=ia(ve));var _e=l.getDerivedStateFromProps;ve=typeof _e=="function"||typeof p.getSnapshotBeforeUpdate=="function",j=r.pendingProps!==j,ve||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(j||ie!==S)&&f1(r,p,o,S),yn=!1;var fe=r.memoizedState;p.state=fe,Jl(r,o,p,h),Zl(),ie=r.memoizedState,j||fe!==ie||yn?(typeof _e=="function"&&(Fu(r,l,_e,o),ie=r.memoizedState),(W=yn||u1(r,l,W,o,fe,ie,S))?(ve||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(r.flags|=4194308)):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=o,r.memoizedState=ie),p.props=o,p.state=ie,p.context=S,o=W):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),o=!1)}else{p=r.stateNode,fu(t,r),S=r.memoizedProps,ve=hs(l,S),p.props=ve,_e=r.pendingProps,fe=p.context,ie=l.contextType,W=Vs,typeof ie=="object"&&ie!==null&&(W=ia(ie)),j=l.getDerivedStateFromProps,(ie=typeof j=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==_e||fe!==W)&&f1(r,p,o,W),yn=!1,fe=r.memoizedState,p.state=fe,Jl(r,o,p,h),Zl();var he=r.memoizedState;S!==_e||fe!==he||yn||t!==null&&t.dependencies!==null&&Fc(t.dependencies)?(typeof j=="function"&&(Fu(r,l,j,o),he=r.memoizedState),(ve=yn||u1(r,l,ve,o,fe,he,W)||t!==null&&t.dependencies!==null&&Fc(t.dependencies))?(ie||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,he,W),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,he,W)),typeof p.componentDidUpdate=="function"&&(r.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof p.componentDidUpdate!="function"||S===t.memoizedProps&&fe===t.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&fe===t.memoizedState||(r.flags|=1024),r.memoizedProps=o,r.memoizedState=he),p.props=o,p.state=he,p.context=W,o=ve):(typeof p.componentDidUpdate!="function"||S===t.memoizedProps&&fe===t.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&fe===t.memoizedState||(r.flags|=1024),o=!1)}return p=o,Qc(t,r),o=(r.flags&128)!==0,p||o?(p=r.stateNode,l=o&&typeof l.getDerivedStateFromError!="function"?null:p.render(),r.flags|=1,t!==null&&o?(r.child=fs(r,t.child,null,h),r.child=fs(r,null,l,h)):ca(t,r,l,h),r.memoizedState=p.state,t=r.child):t=Kr(t,r,h),t}function T1(t,r,l,o){return ss(),r.flags|=256,ca(t,r,l,o),r.child}var zu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Uu(t){return{baseLanes:t,cachePool:mx()}}function Pu(t,r,l){return t=t!==null?t.childLanes&~l:0,r&&(t|=Ga),t}function _1(t,r,l){var o=r.pendingProps,h=!1,p=(r.flags&128)!==0,S;if((S=p)||(S=t!==null&&t.memoizedState===null?!1:(Pt.current&2)!==0),S&&(h=!0,r.flags&=-129),S=(r.flags&32)!==0,r.flags&=-33,t===null){if(ot){if(h?Sn(r):En(),(t=_t)?(t=Mm(t,lr),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:pn!==null?{id:Ar,overflow:Cr}:null,retryLane:536870912,hydrationErrors:null},l=lx(t),l.return=r,r.child=l,la=r,_t=null)):t=null,t===null)throw vn(r);return Ef(t)?r.lanes=32:r.lanes=536870912,null}var j=o.children;return o=o.fallback,h?(En(),h=r.mode,j=e0({mode:"hidden",children:j},h),o=ns(o,h,l,null),j.return=r,o.return=r,j.sibling=o,r.child=j,o=r.child,o.memoizedState=Uu(l),o.childLanes=Pu(t,S,l),r.memoizedState=zu,ri(null,o)):(Sn(r),Hu(r,j))}var W=t.memoizedState;if(W!==null&&(j=W.dehydrated,j!==null)){if(p)r.flags&256?(Sn(r),r.flags&=-257,r=Vu(t,r,l)):r.memoizedState!==null?(En(),r.child=t.child,r.flags|=128,r=null):(En(),j=o.fallback,h=r.mode,o=e0({mode:"visible",children:o.children},h),j=ns(j,h,l,null),j.flags|=2,o.return=r,j.return=r,o.sibling=j,r.child=o,fs(r,t.child,null,l),o=r.child,o.memoizedState=Uu(l),o.childLanes=Pu(t,S,l),r.memoizedState=zu,r=ri(null,o));else if(Sn(r),Ef(j)){if(S=j.nextSibling&&j.nextSibling.dataset,S)var ie=S.dgst;S=ie,o=Error(s(419)),o.stack="",o.digest=S,$l({value:o,source:null,stack:null}),r=Vu(t,r,l)}else if(Yt||Ys(t,r,l,!1),S=(l&t.childLanes)!==0,Yt||S){if(S=wt,S!==null&&(o=vc(S,l),o!==0&&o!==W.retryLane))throw W.retryLane=o,rs(t,o),La(S,t,o),Iu;Sf(j)||o0(),r=Vu(t,r,l)}else Sf(j)?(r.flags|=192,r.child=t.child,r=null):(t=W.treeContext,_t=cr(j.nextSibling),la=r,ot=!0,gn=null,lr=!1,t!==null&&ox(r,t),r=Hu(r,o.children),r.flags|=4096);return r}return h?(En(),j=o.fallback,h=r.mode,W=t.child,ie=W.sibling,o=Vr(W,{mode:"hidden",children:o.children}),o.subtreeFlags=W.subtreeFlags&65011712,ie!==null?j=Vr(ie,j):(j=ns(j,h,l,null),j.flags|=2),j.return=r,o.return=r,o.sibling=j,r.child=o,ri(null,o),o=r.child,j=t.child.memoizedState,j===null?j=Uu(l):(h=j.cachePool,h!==null?(W=$t._currentValue,h=h.parent!==W?{parent:W,pool:W}:h):h=mx(),j={baseLanes:j.baseLanes|l,cachePool:h}),o.memoizedState=j,o.childLanes=Pu(t,S,l),r.memoizedState=zu,ri(t.child,o)):(Sn(r),l=t.child,t=l.sibling,l=Vr(l,{mode:"visible",children:o.children}),l.return=r,l.sibling=null,t!==null&&(S=r.deletions,S===null?(r.deletions=[t],r.flags|=16):S.push(t)),r.child=l,r.memoizedState=null,l)}function Hu(t,r){return r=e0({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function e0(t,r){return t=Ua(22,t,null,r),t.lanes=0,t}function Vu(t,r,l){return fs(r,t.child,null,l),t=Hu(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function A1(t,r,l){t.lanes|=r;var o=t.alternate;o!==null&&(o.lanes|=r),nu(t.return,r,l)}function Gu(t,r,l,o,h,p){var S=t.memoizedState;S===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:o,tail:l,tailMode:h,treeForkCount:p}:(S.isBackwards=r,S.rendering=null,S.renderingStartTime=0,S.last=o,S.tail=l,S.tailMode=h,S.treeForkCount=p)}function C1(t,r,l){var o=r.pendingProps,h=o.revealOrder,p=o.tail;o=o.children;var S=Pt.current,j=(S&2)!==0;if(j?(S=S&1|2,r.flags|=128):S&=1,q(Pt,S),ca(t,r,o,l),o=ot?Gl:0,!j&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&A1(t,l,r);else if(t.tag===19)A1(t,l,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(l=r.child,h=null;l!==null;)t=l.alternate,t!==null&&Hc(t)===null&&(h=l),l=l.sibling;l=h,l===null?(h=r.child,r.child=null):(h=l.sibling,l.sibling=null),Gu(r,!1,h,l,p,o);break;case"backwards":case"unstable_legacy-backwards":for(l=null,h=r.child,r.child=null;h!==null;){if(t=h.alternate,t!==null&&Hc(t)===null){r.child=h;break}t=h.sibling,h.sibling=l,l=h,h=t}Gu(r,!0,l,null,p,o);break;case"together":Gu(r,!1,null,null,void 0,o);break;default:r.memoizedState=null}return r.child}function Kr(t,r,l){if(t!==null&&(r.dependencies=t.dependencies),_n|=r.lanes,(l&r.childLanes)===0)if(t!==null){if(Ys(t,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(s(153));if(r.child!==null){for(t=r.child,l=Vr(t,t.pendingProps),r.child=l,l.return=r;t.sibling!==null;)t=t.sibling,l=l.sibling=Vr(t,t.pendingProps),l.return=r;l.sibling=null}return r.child}function $u(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&Fc(t)))}function my(t,r,l){switch(r.tag){case 3:Te(r,r.stateNode.containerInfo),bn(r,$t,t.memoizedState.cache),ss();break;case 27:case 5:ke(r);break;case 4:Te(r,r.stateNode.containerInfo);break;case 10:bn(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,pu(r),null;break;case 13:var o=r.memoizedState;if(o!==null)return o.dehydrated!==null?(Sn(r),r.flags|=128,null):(l&r.child.childLanes)!==0?_1(t,r,l):(Sn(r),t=Kr(t,r,l),t!==null?t.sibling:null);Sn(r);break;case 19:var h=(t.flags&128)!==0;if(o=(l&r.childLanes)!==0,o||(Ys(t,r,l,!1),o=(l&r.childLanes)!==0),h){if(o)return C1(t,r,l);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),q(Pt,Pt.current),o)break;return null;case 22:return r.lanes=0,k1(t,r,l,r.pendingProps);case 24:bn(r,$t,t.memoizedState.cache)}return Kr(t,r,l)}function j1(t,r,l){if(t!==null)if(t.memoizedProps!==r.pendingProps)Yt=!0;else{if(!$u(t,l)&&(r.flags&128)===0)return Yt=!1,my(t,r,l);Yt=(t.flags&131072)!==0}else Yt=!1,ot&&(r.flags&1048576)!==0&&cx(r,Gl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var o=r.pendingProps;if(t=os(r.elementType),r.type=t,typeof t=="function")Wo(t)?(o=hs(t,o),r.tag=1,r=N1(null,r,t,o,l)):(r.tag=0,r=Bu(null,r,t,o,l));else{if(t!=null){var h=t.$$typeof;if(h===L){r.tag=11,r=v1(null,r,t,o,l);break e}else if(h===R){r.tag=14,r=b1(null,r,t,o,l);break e}}throw r=Ne(t)||t,Error(s(306,r,""))}}return r;case 0:return Bu(t,r,r.type,r.pendingProps,l);case 1:return o=r.type,h=hs(o,r.pendingProps),N1(t,r,o,h,l);case 3:e:{if(Te(r,r.stateNode.containerInfo),t===null)throw Error(s(387));o=r.pendingProps;var p=r.memoizedState;h=p.element,fu(t,r),Jl(r,o,null,l);var S=r.memoizedState;if(o=S.cache,bn(r,$t,o),o!==p.cache&&su(r,[$t],l,!0),Zl(),o=S.element,p.isDehydrated)if(p={element:o,isDehydrated:!1,cache:S.cache},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){r=T1(t,r,o,l);break e}else if(o!==h){h=rr(Error(s(424)),r),$l(h),r=T1(t,r,o,l);break e}else{switch(t=r.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(_t=cr(t.firstChild),la=r,ot=!0,gn=null,lr=!0,l=kx(r,null,o,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(ss(),o===h){r=Kr(t,r,l);break e}ca(t,r,o,l)}r=r.child}return r;case 26:return Qc(t,r),t===null?(l=Pm(r.type,null,r.pendingProps,null))?r.memoizedState=l:ot||(l=r.type,t=r.pendingProps,o=p0(z.current).createElement(l),o[M]=r,o[I]=t,oa(o,l,t),He(o),r.stateNode=o):r.memoizedState=Pm(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return ke(r),t===null&&ot&&(o=r.stateNode=Bm(r.type,r.pendingProps,z.current),la=r,lr=!0,h=_t,Rn(r.type)?(Nf=h,_t=cr(o.firstChild)):_t=h),ca(t,r,r.pendingProps.children,l),Qc(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&ot&&((h=o=_t)&&(o=$y(o,r.type,r.pendingProps,lr),o!==null?(r.stateNode=o,la=r,_t=cr(o.firstChild),lr=!1,h=!0):h=!1),h||vn(r)),ke(r),h=r.type,p=r.pendingProps,S=t!==null?t.memoizedProps:null,o=p.children,yf(h,p)?o=null:S!==null&&yf(h,S)&&(r.flags|=32),r.memoizedState!==null&&(h=vu(t,r,ly,null,null,l),vi._currentValue=h),Qc(t,r),ca(t,r,o,l),r.child;case 6:return t===null&&ot&&((t=l=_t)&&(l=Xy(l,r.pendingProps,lr),l!==null?(r.stateNode=l,la=r,_t=null,t=!0):t=!1),t||vn(r)),null;case 13:return _1(t,r,l);case 4:return Te(r,r.stateNode.containerInfo),o=r.pendingProps,t===null?r.child=fs(r,null,o,l):ca(t,r,o,l),r.child;case 11:return v1(t,r,r.type,r.pendingProps,l);case 7:return ca(t,r,r.pendingProps,l),r.child;case 8:return ca(t,r,r.pendingProps.children,l),r.child;case 12:return ca(t,r,r.pendingProps.children,l),r.child;case 10:return o=r.pendingProps,bn(r,r.type,o.value),ca(t,r,o.children,l),r.child;case 9:return h=r.type._context,o=r.pendingProps.children,is(r),h=ia(h),o=o(h),r.flags|=1,ca(t,r,o,l),r.child;case 14:return b1(t,r,r.type,r.pendingProps,l);case 15:return y1(t,r,r.type,r.pendingProps,l);case 19:return C1(t,r,l);case 31:return xy(t,r,l);case 22:return k1(t,r,l,r.pendingProps);case 24:return is(r),o=ia($t),t===null?(h=cu(),h===null&&(h=wt,p=lu(),h.pooledCache=p,p.refCount++,p!==null&&(h.pooledCacheLanes|=l),h=p),r.memoizedState={parent:o,cache:h},uu(r),bn(r,$t,h)):((t.lanes&l)!==0&&(fu(t,r),Jl(r,null,null,l),Zl()),h=t.memoizedState,p=r.memoizedState,h.parent!==o?(h={parent:o,cache:o},r.memoizedState=h,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=h),bn(r,$t,o)):(o=p.cache,bn(r,$t,o),o!==h.cache&&su(r,[$t],l,!0))),ca(t,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function Wr(t){t.flags|=4}function Xu(t,r,l,o,h){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(h&335544128)===h)if(t.stateNode.complete)t.flags|=8192;else if(rm())t.flags|=8192;else throw us=Bc,ou}else t.flags&=-16777217}function O1(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Xm(r))if(rm())t.flags|=8192;else throw us=Bc,ou}function t0(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?pc():536870912,t.lanes|=r,sl|=r)}function ni(t,r){if(!ot)switch(t.tailMode){case"hidden":r=t.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var o=null;l!==null;)l.alternate!==null&&(o=l),l=l.sibling;o===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:o.sibling=null}}function At(t){var r=t.alternate!==null&&t.alternate.child===t.child,l=0,o=0;if(r)for(var h=t.child;h!==null;)l|=h.lanes|h.childLanes,o|=h.subtreeFlags&65011712,o|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)l|=h.lanes|h.childLanes,o|=h.subtreeFlags,o|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=o,t.childLanes=l,r}function py(t,r,l){var o=r.pendingProps;switch(eu(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(r),null;case 1:return At(r),null;case 3:return l=r.stateNode,o=null,t!==null&&(o=t.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Xr($t),ge(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(Xs(r)?Wr(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,au())),At(r),null;case 26:var h=r.type,p=r.memoizedState;return t===null?(Wr(r),p!==null?(At(r),O1(r,p)):(At(r),Xu(r,h,null,o,l))):p?p!==t.memoizedState?(Wr(r),At(r),O1(r,p)):(At(r),r.flags&=-16777217):(t=t.memoizedProps,t!==o&&Wr(r),At(r),Xu(r,h,t,o,l)),null;case 27:if($e(r),l=z.current,h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==o&&Wr(r);else{if(!o){if(r.stateNode===null)throw Error(s(166));return At(r),null}t=V.current,Xs(r)?ux(r):(t=Bm(h,o,l),r.stateNode=t,Wr(r))}return At(r),null;case 5:if($e(r),h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==o&&Wr(r);else{if(!o){if(r.stateNode===null)throw Error(s(166));return At(r),null}if(p=V.current,Xs(r))ux(r);else{var S=p0(z.current);switch(p){case 1:p=S.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:p=S.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":p=S.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":p=S.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":p=S.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof o.is=="string"?S.createElement("select",{is:o.is}):S.createElement("select"),o.multiple?p.multiple=!0:o.size&&(p.size=o.size);break;default:p=typeof o.is=="string"?S.createElement(h,{is:o.is}):S.createElement(h)}}p[M]=r,p[I]=o;e:for(S=r.child;S!==null;){if(S.tag===5||S.tag===6)p.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===r)break e;for(;S.sibling===null;){if(S.return===null||S.return===r)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}r.stateNode=p;e:switch(oa(p,h,o),h){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Wr(r)}}return At(r),Xu(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,l),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==o&&Wr(r);else{if(typeof o!="string"&&r.stateNode===null)throw Error(s(166));if(t=z.current,Xs(r)){if(t=r.stateNode,l=r.memoizedProps,o=null,h=la,h!==null)switch(h.tag){case 27:case 5:o=h.memoizedProps}t[M]=r,t=!!(t.nodeValue===l||o!==null&&o.suppressHydrationWarning===!0||_m(t.nodeValue,l)),t||vn(r,!0)}else t=p0(t).createTextNode(o),t[M]=r,r.stateNode=t}return At(r),null;case 31:if(l=r.memoizedState,t===null||t.memoizedState!==null){if(o=Xs(r),l!==null){if(t===null){if(!o)throw Error(s(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(557));t[M]=r}else ss(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;At(r),t=!1}else l=au(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=l),t=!0;if(!t)return r.flags&256?(Ha(r),r):(Ha(r),null);if((r.flags&128)!==0)throw Error(s(558))}return At(r),null;case 13:if(o=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=Xs(r),o!==null&&o.dehydrated!==null){if(t===null){if(!h)throw Error(s(318));if(h=r.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[M]=r}else ss(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;At(r),h=!1}else h=au(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return r.flags&256?(Ha(r),r):(Ha(r),null)}return Ha(r),(r.flags&128)!==0?(r.lanes=l,r):(l=o!==null,t=t!==null&&t.memoizedState!==null,l&&(o=r.child,h=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(h=o.alternate.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==h&&(o.flags|=2048)),l!==t&&l&&(r.child.flags|=8192),t0(r,r.updateQueue),At(r),null);case 4:return ge(),t===null&&mf(r.stateNode.containerInfo),At(r),null;case 10:return Xr(r.type),At(r),null;case 19:if(A(Pt),o=r.memoizedState,o===null)return At(r),null;if(h=(r.flags&128)!==0,p=o.rendering,p===null)if(h)ni(o,!1);else{if(Mt!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(p=Hc(t),p!==null){for(r.flags|=128,ni(o,!1),t=p.updateQueue,r.updateQueue=t,t0(r,t),r.subtreeFlags=0,t=l,l=r.child;l!==null;)sx(l,t),l=l.sibling;return q(Pt,Pt.current&1|2),ot&&Gr(r,o.treeForkCount),r.child}t=t.sibling}o.tail!==null&&Ue()>l0&&(r.flags|=128,h=!0,ni(o,!1),r.lanes=4194304)}else{if(!h)if(t=Hc(p),t!==null){if(r.flags|=128,h=!0,t=t.updateQueue,r.updateQueue=t,t0(r,t),ni(o,!0),o.tail===null&&o.tailMode==="hidden"&&!p.alternate&&!ot)return At(r),null}else 2*Ue()-o.renderingStartTime>l0&&l!==536870912&&(r.flags|=128,h=!0,ni(o,!1),r.lanes=4194304);o.isBackwards?(p.sibling=r.child,r.child=p):(t=o.last,t!==null?t.sibling=p:r.child=p,o.last=p)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ue(),t.sibling=null,l=Pt.current,q(Pt,h?l&1|2:l&1),ot&&Gr(r,o.treeForkCount),t):(At(r),null);case 22:case 23:return Ha(r),mu(),o=r.memoizedState!==null,t!==null?t.memoizedState!==null!==o&&(r.flags|=8192):o&&(r.flags|=8192),o?(l&536870912)!==0&&(r.flags&128)===0&&(At(r),r.subtreeFlags&6&&(r.flags|=8192)):At(r),l=r.updateQueue,l!==null&&t0(r,l.retryQueue),l=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),o=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),o!==l&&(r.flags|=2048),t!==null&&A(cs),null;case 24:return l=null,t!==null&&(l=t.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),Xr($t),At(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function gy(t,r){switch(eu(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return Xr($t),ge(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return $e(r),null;case 31:if(r.memoizedState!==null){if(Ha(r),r.alternate===null)throw Error(s(340));ss()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(Ha(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(s(340));ss()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return A(Pt),null;case 4:return ge(),null;case 10:return Xr(r.type),null;case 22:case 23:return Ha(r),mu(),t!==null&&A(cs),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return Xr($t),null;case 25:return null;default:return null}}function R1(t,r){switch(eu(r),r.tag){case 3:Xr($t),ge();break;case 26:case 27:case 5:$e(r);break;case 4:ge();break;case 31:r.memoizedState!==null&&Ha(r);break;case 13:Ha(r);break;case 19:A(Pt);break;case 10:Xr(r.type);break;case 22:case 23:Ha(r),mu(),t!==null&&A(cs);break;case 24:Xr($t)}}function si(t,r){try{var l=r.updateQueue,o=l!==null?l.lastEffect:null;if(o!==null){var h=o.next;l=h;do{if((l.tag&t)===t){o=void 0;var p=l.create,S=l.inst;o=p(),S.destroy=o}l=l.next}while(l!==h)}}catch(j){vt(r,r.return,j)}}function Nn(t,r,l){try{var o=r.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var p=h.next;o=p;do{if((o.tag&t)===t){var S=o.inst,j=S.destroy;if(j!==void 0){S.destroy=void 0,h=r;var W=l,ie=j;try{ie()}catch(ve){vt(h,W,ve)}}}o=o.next}while(o!==p)}}catch(ve){vt(r,r.return,ve)}}function D1(t){var r=t.updateQueue;if(r!==null){var l=t.stateNode;try{Sx(r,l)}catch(o){vt(t,t.return,o)}}}function F1(t,r,l){l.props=hs(t.type,t.memoizedProps),l.state=t.memoizedState;try{l.componentWillUnmount()}catch(o){vt(t,r,o)}}function li(t,r){try{var l=t.ref;if(l!==null){switch(t.tag){case 26:case 27:case 5:var o=t.stateNode;break;case 30:o=t.stateNode;break;default:o=t.stateNode}typeof l=="function"?t.refCleanup=l(o):l.current=o}}catch(h){vt(t,r,h)}}function jr(t,r){var l=t.ref,o=t.refCleanup;if(l!==null)if(typeof o=="function")try{o()}catch(h){vt(t,r,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(h){vt(t,r,h)}else l.current=null}function M1(t){var r=t.type,l=t.memoizedProps,o=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&o.focus();break e;case"img":l.src?o.src=l.src:l.srcSet&&(o.srcset=l.srcSet)}}catch(h){vt(t,t.return,h)}}function Yu(t,r,l){try{var o=t.stateNode;zy(o,t.type,l,r),o[I]=r}catch(h){vt(t,t.return,h)}}function L1(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Rn(t.type)||t.tag===4}function qu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||L1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Rn(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ku(t,r,l){var o=t.tag;if(o===5||o===6)t=t.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(t,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(t),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Pr));else if(o!==4&&(o===27&&Rn(t.type)&&(l=t.stateNode,r=null),t=t.child,t!==null))for(Ku(t,r,l),t=t.sibling;t!==null;)Ku(t,r,l),t=t.sibling}function a0(t,r,l){var o=t.tag;if(o===5||o===6)t=t.stateNode,r?l.insertBefore(t,r):l.appendChild(t);else if(o!==4&&(o===27&&Rn(t.type)&&(l=t.stateNode),t=t.child,t!==null))for(a0(t,r,l),t=t.sibling;t!==null;)a0(t,r,l),t=t.sibling}function I1(t){var r=t.stateNode,l=t.memoizedProps;try{for(var o=t.type,h=r.attributes;h.length;)r.removeAttributeNode(h[0]);oa(r,o,l),r[M]=t,r[I]=l}catch(p){vt(t,t.return,p)}}var Zr=!1,qt=!1,Wu=!1,B1=typeof WeakSet=="function"?WeakSet:Set,ra=null;function vy(t,r){if(t=t.containerInfo,vf=S0,t=Wh(t),Vo(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var o=l.getSelection&&l.getSelection();if(o&&o.rangeCount!==0){l=o.anchorNode;var h=o.anchorOffset,p=o.focusNode;o=o.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var S=0,j=-1,W=-1,ie=0,ve=0,_e=t,fe=null;t:for(;;){for(var he;_e!==l||h!==0&&_e.nodeType!==3||(j=S+h),_e!==p||o!==0&&_e.nodeType!==3||(W=S+o),_e.nodeType===3&&(S+=_e.nodeValue.length),(he=_e.firstChild)!==null;)fe=_e,_e=he;for(;;){if(_e===t)break t;if(fe===l&&++ie===h&&(j=S),fe===p&&++ve===o&&(W=S),(he=_e.nextSibling)!==null)break;_e=fe,fe=_e.parentNode}_e=he}l=j===-1||W===-1?null:{start:j,end:W}}else l=null}l=l||{start:0,end:0}}else l=null;for(bf={focusedElem:t,selectionRange:l},S0=!1,ra=r;ra!==null;)if(r=ra,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,ra=t;else for(;ra!==null;){switch(r=ra,p=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(l=0;l<t.length;l++)h=t[l],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,l=r,h=p.memoizedProps,p=p.memoizedState,o=l.stateNode;try{var Be=hs(l.type,h);t=o.getSnapshotBeforeUpdate(Be,p),o.__reactInternalSnapshotBeforeUpdate=t}catch(Xe){vt(l,l.return,Xe)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,l=t.nodeType,l===9)wf(t);else if(l===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":wf(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=r.sibling,t!==null){t.return=r.return,ra=t;break}ra=r.return}}function z1(t,r,l){var o=l.flags;switch(l.tag){case 0:case 11:case 15:Qr(t,l),o&4&&si(5,l);break;case 1:if(Qr(t,l),o&4)if(t=l.stateNode,r===null)try{t.componentDidMount()}catch(S){vt(l,l.return,S)}else{var h=hs(l.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(h,r,t.__reactInternalSnapshotBeforeUpdate)}catch(S){vt(l,l.return,S)}}o&64&&D1(l),o&512&&li(l,l.return);break;case 3:if(Qr(t,l),o&64&&(t=l.updateQueue,t!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Sx(t,r)}catch(S){vt(l,l.return,S)}}break;case 27:r===null&&o&4&&I1(l);case 26:case 5:Qr(t,l),r===null&&o&4&&M1(l),o&512&&li(l,l.return);break;case 12:Qr(t,l);break;case 31:Qr(t,l),o&4&&H1(t,l);break;case 13:Qr(t,l),o&4&&V1(t,l),o&64&&(t=l.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(l=_y.bind(null,l),Yy(t,l))));break;case 22:if(o=l.memoizedState!==null||Zr,!o){r=r!==null&&r.memoizedState!==null||qt,h=Zr;var p=qt;Zr=o,(qt=r)&&!p?en(t,l,(l.subtreeFlags&8772)!==0):Qr(t,l),Zr=h,qt=p}break;case 30:break;default:Qr(t,l)}}function U1(t){var r=t.alternate;r!==null&&(t.alternate=null,U1(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&je(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var jt=null,Ra=!1;function Jr(t,r,l){for(l=l.child;l!==null;)P1(t,r,l),l=l.sibling}function P1(t,r,l){if(Ut&&typeof Ut.onCommitFiberUnmount=="function")try{Ut.onCommitFiberUnmount(Tt,l)}catch{}switch(l.tag){case 26:qt||jr(l,r),Jr(t,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:qt||jr(l,r);var o=jt,h=Ra;Rn(l.type)&&(jt=l.stateNode,Ra=!1),Jr(t,r,l),mi(l.stateNode),jt=o,Ra=h;break;case 5:qt||jr(l,r);case 6:if(o=jt,h=Ra,jt=null,Jr(t,r,l),jt=o,Ra=h,jt!==null)if(Ra)try{(jt.nodeType===9?jt.body:jt.nodeName==="HTML"?jt.ownerDocument.body:jt).removeChild(l.stateNode)}catch(p){vt(l,r,p)}else try{jt.removeChild(l.stateNode)}catch(p){vt(l,r,p)}break;case 18:jt!==null&&(Ra?(t=jt,Dm(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,l.stateNode),hl(t)):Dm(jt,l.stateNode));break;case 4:o=jt,h=Ra,jt=l.stateNode.containerInfo,Ra=!0,Jr(t,r,l),jt=o,Ra=h;break;case 0:case 11:case 14:case 15:Nn(2,l,r),qt||Nn(4,l,r),Jr(t,r,l);break;case 1:qt||(jr(l,r),o=l.stateNode,typeof o.componentWillUnmount=="function"&&F1(l,r,o)),Jr(t,r,l);break;case 21:Jr(t,r,l);break;case 22:qt=(o=qt)||l.memoizedState!==null,Jr(t,r,l),qt=o;break;default:Jr(t,r,l)}}function H1(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{hl(t)}catch(l){vt(r,r.return,l)}}}function V1(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{hl(t)}catch(l){vt(r,r.return,l)}}function by(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new B1),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new B1),r;default:throw Error(s(435,t.tag))}}function r0(t,r){var l=by(t);r.forEach(function(o){if(!l.has(o)){l.add(o);var h=Ay.bind(null,t,o);o.then(h,h)}})}function Da(t,r){var l=r.deletions;if(l!==null)for(var o=0;o<l.length;o++){var h=l[o],p=t,S=r,j=S;e:for(;j!==null;){switch(j.tag){case 27:if(Rn(j.type)){jt=j.stateNode,Ra=!1;break e}break;case 5:jt=j.stateNode,Ra=!1;break e;case 3:case 4:jt=j.stateNode.containerInfo,Ra=!0;break e}j=j.return}if(jt===null)throw Error(s(160));P1(p,S,h),jt=null,Ra=!1,p=h.alternate,p!==null&&(p.return=null),h.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)G1(r,t),r=r.sibling}var vr=null;function G1(t,r){var l=t.alternate,o=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Da(r,t),Fa(t),o&4&&(Nn(3,t,t.return),si(3,t),Nn(5,t,t.return));break;case 1:Da(r,t),Fa(t),o&512&&(qt||l===null||jr(l,l.return)),o&64&&Zr&&(t=t.updateQueue,t!==null&&(o=t.callbacks,o!==null&&(l=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=l===null?o:l.concat(o))));break;case 26:var h=vr;if(Da(r,t),Fa(t),o&512&&(qt||l===null||jr(l,l.return)),o&4){var p=l!==null?l.memoizedState:null;if(o=t.memoizedState,l===null)if(o===null)if(t.stateNode===null){e:{o=t.type,l=t.memoizedProps,h=h.ownerDocument||h;t:switch(o){case"title":p=h.getElementsByTagName("title")[0],(!p||p[de]||p[M]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=h.createElement(o),h.head.insertBefore(p,h.querySelector("head > title"))),oa(p,o,l),p[M]=t,He(p),o=p;break e;case"link":var S=Gm("link","href",h).get(o+(l.href||""));if(S){for(var j=0;j<S.length;j++)if(p=S[j],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){S.splice(j,1);break t}}p=h.createElement(o),oa(p,o,l),h.head.appendChild(p);break;case"meta":if(S=Gm("meta","content",h).get(o+(l.content||""))){for(j=0;j<S.length;j++)if(p=S[j],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){S.splice(j,1);break t}}p=h.createElement(o),oa(p,o,l),h.head.appendChild(p);break;default:throw Error(s(468,o))}p[M]=t,He(p),o=p}t.stateNode=o}else $m(h,t.type,t.stateNode);else t.stateNode=Vm(h,o,t.memoizedProps);else p!==o?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,o===null?$m(h,t.type,t.stateNode):Vm(h,o,t.memoizedProps)):o===null&&t.stateNode!==null&&Yu(t,t.memoizedProps,l.memoizedProps)}break;case 27:Da(r,t),Fa(t),o&512&&(qt||l===null||jr(l,l.return)),l!==null&&o&4&&Yu(t,t.memoizedProps,l.memoizedProps);break;case 5:if(Da(r,t),Fa(t),o&512&&(qt||l===null||jr(l,l.return)),t.flags&32){h=t.stateNode;try{Ls(h,"")}catch(Be){vt(t,t.return,Be)}}o&4&&t.stateNode!=null&&(h=t.memoizedProps,Yu(t,h,l!==null?l.memoizedProps:h)),o&1024&&(Wu=!0);break;case 6:if(Da(r,t),Fa(t),o&4){if(t.stateNode===null)throw Error(s(162));o=t.memoizedProps,l=t.stateNode;try{l.nodeValue=o}catch(Be){vt(t,t.return,Be)}}break;case 3:if(b0=null,h=vr,vr=g0(r.containerInfo),Da(r,t),vr=h,Fa(t),o&4&&l!==null&&l.memoizedState.isDehydrated)try{hl(r.containerInfo)}catch(Be){vt(t,t.return,Be)}Wu&&(Wu=!1,$1(t));break;case 4:o=vr,vr=g0(t.stateNode.containerInfo),Da(r,t),Fa(t),vr=o;break;case 12:Da(r,t),Fa(t);break;case 31:Da(r,t),Fa(t),o&4&&(o=t.updateQueue,o!==null&&(t.updateQueue=null,r0(t,o)));break;case 13:Da(r,t),Fa(t),t.child.flags&8192&&t.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(s0=Ue()),o&4&&(o=t.updateQueue,o!==null&&(t.updateQueue=null,r0(t,o)));break;case 22:h=t.memoizedState!==null;var W=l!==null&&l.memoizedState!==null,ie=Zr,ve=qt;if(Zr=ie||h,qt=ve||W,Da(r,t),qt=ve,Zr=ie,Fa(t),o&8192)e:for(r=t.stateNode,r._visibility=h?r._visibility&-2:r._visibility|1,h&&(l===null||W||Zr||qt||xs(t)),l=null,r=t;;){if(r.tag===5||r.tag===26){if(l===null){W=l=r;try{if(p=W.stateNode,h)S=p.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{j=W.stateNode;var _e=W.memoizedProps.style,fe=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;j.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(Be){vt(W,W.return,Be)}}}else if(r.tag===6){if(l===null){W=r;try{W.stateNode.nodeValue=h?"":W.memoizedProps}catch(Be){vt(W,W.return,Be)}}}else if(r.tag===18){if(l===null){W=r;try{var he=W.stateNode;h?Fm(he,!0):Fm(W.stateNode,!1)}catch(Be){vt(W,W.return,Be)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}o&4&&(o=t.updateQueue,o!==null&&(l=o.retryQueue,l!==null&&(o.retryQueue=null,r0(t,l))));break;case 19:Da(r,t),Fa(t),o&4&&(o=t.updateQueue,o!==null&&(t.updateQueue=null,r0(t,o)));break;case 30:break;case 21:break;default:Da(r,t),Fa(t)}}function Fa(t){var r=t.flags;if(r&2){try{for(var l,o=t.return;o!==null;){if(L1(o)){l=o;break}o=o.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var h=l.stateNode,p=qu(t);a0(t,p,h);break;case 5:var S=l.stateNode;l.flags&32&&(Ls(S,""),l.flags&=-33);var j=qu(t);a0(t,j,S);break;case 3:case 4:var W=l.stateNode.containerInfo,ie=qu(t);Ku(t,ie,W);break;default:throw Error(s(161))}}catch(ve){vt(t,t.return,ve)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function $1(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;$1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function Qr(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)z1(t,r.alternate,r),r=r.sibling}function xs(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Nn(4,r,r.return),xs(r);break;case 1:jr(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&F1(r,r.return,l),xs(r);break;case 27:mi(r.stateNode);case 26:case 5:jr(r,r.return),xs(r);break;case 22:r.memoizedState===null&&xs(r);break;case 30:xs(r);break;default:xs(r)}t=t.sibling}}function en(t,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var o=r.alternate,h=t,p=r,S=p.flags;switch(p.tag){case 0:case 11:case 15:en(h,p,l),si(4,p);break;case 1:if(en(h,p,l),o=p,h=o.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(ie){vt(o,o.return,ie)}if(o=p,h=o.updateQueue,h!==null){var j=o.stateNode;try{var W=h.shared.hiddenCallbacks;if(W!==null)for(h.shared.hiddenCallbacks=null,h=0;h<W.length;h++)wx(W[h],j)}catch(ie){vt(o,o.return,ie)}}l&&S&64&&D1(p),li(p,p.return);break;case 27:I1(p);case 26:case 5:en(h,p,l),l&&o===null&&S&4&&M1(p),li(p,p.return);break;case 12:en(h,p,l);break;case 31:en(h,p,l),l&&S&4&&H1(h,p);break;case 13:en(h,p,l),l&&S&4&&V1(h,p);break;case 22:p.memoizedState===null&&en(h,p,l),li(p,p.return);break;case 30:break;default:en(h,p,l)}r=r.sibling}}function Zu(t,r){var l=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==l&&(t!=null&&t.refCount++,l!=null&&Xl(l))}function Ju(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Xl(t))}function br(t,r,l,o){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)X1(t,r,l,o),r=r.sibling}function X1(t,r,l,o){var h=r.flags;switch(r.tag){case 0:case 11:case 15:br(t,r,l,o),h&2048&&si(9,r);break;case 1:br(t,r,l,o);break;case 3:br(t,r,l,o),h&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Xl(t)));break;case 12:if(h&2048){br(t,r,l,o),t=r.stateNode;try{var p=r.memoizedProps,S=p.id,j=p.onPostCommit;typeof j=="function"&&j(S,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(W){vt(r,r.return,W)}}else br(t,r,l,o);break;case 31:br(t,r,l,o);break;case 13:br(t,r,l,o);break;case 23:break;case 22:p=r.stateNode,S=r.alternate,r.memoizedState!==null?p._visibility&2?br(t,r,l,o):ii(t,r):p._visibility&2?br(t,r,l,o):(p._visibility|=2,al(t,r,l,o,(r.subtreeFlags&10256)!==0||!1)),h&2048&&Zu(S,r);break;case 24:br(t,r,l,o),h&2048&&Ju(r.alternate,r);break;default:br(t,r,l,o)}}function al(t,r,l,o,h){for(h=h&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var p=t,S=r,j=l,W=o,ie=S.flags;switch(S.tag){case 0:case 11:case 15:al(p,S,j,W,h),si(8,S);break;case 23:break;case 22:var ve=S.stateNode;S.memoizedState!==null?ve._visibility&2?al(p,S,j,W,h):ii(p,S):(ve._visibility|=2,al(p,S,j,W,h)),h&&ie&2048&&Zu(S.alternate,S);break;case 24:al(p,S,j,W,h),h&&ie&2048&&Ju(S.alternate,S);break;default:al(p,S,j,W,h)}r=r.sibling}}function ii(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=t,o=r,h=o.flags;switch(o.tag){case 22:ii(l,o),h&2048&&Zu(o.alternate,o);break;case 24:ii(l,o),h&2048&&Ju(o.alternate,o);break;default:ii(l,o)}r=r.sibling}}var ci=8192;function rl(t,r,l){if(t.subtreeFlags&ci)for(t=t.child;t!==null;)Y1(t,r,l),t=t.sibling}function Y1(t,r,l){switch(t.tag){case 26:rl(t,r,l),t.flags&ci&&t.memoizedState!==null&&sk(l,vr,t.memoizedState,t.memoizedProps);break;case 5:rl(t,r,l);break;case 3:case 4:var o=vr;vr=g0(t.stateNode.containerInfo),rl(t,r,l),vr=o;break;case 22:t.memoizedState===null&&(o=t.alternate,o!==null&&o.memoizedState!==null?(o=ci,ci=16777216,rl(t,r,l),ci=o):rl(t,r,l));break;default:rl(t,r,l)}}function q1(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function oi(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var o=r[l];ra=o,W1(o,t)}q1(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)K1(t),t=t.sibling}function K1(t){switch(t.tag){case 0:case 11:case 15:oi(t),t.flags&2048&&Nn(9,t,t.return);break;case 3:oi(t);break;case 12:oi(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,n0(t)):oi(t);break;default:oi(t)}}function n0(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var o=r[l];ra=o,W1(o,t)}q1(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Nn(8,r,r.return),n0(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,n0(r));break;default:n0(r)}t=t.sibling}}function W1(t,r){for(;ra!==null;){var l=ra;switch(l.tag){case 0:case 11:case 15:Nn(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var o=l.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Xl(l.memoizedState.cache)}if(o=l.child,o!==null)o.return=l,ra=o;else e:for(l=t;ra!==null;){o=ra;var h=o.sibling,p=o.return;if(U1(o),o===l){ra=null;break e}if(h!==null){h.return=p,ra=h;break e}ra=p}}}var yy={getCacheForType:function(t){var r=ia($t),l=r.data.get(t);return l===void 0&&(l=t(),r.data.set(t,l)),l},cacheSignal:function(){return ia($t).controller.signal}},ky=typeof WeakMap=="function"?WeakMap:Map,pt=0,wt=null,st=null,it=0,gt=0,Va=null,Tn=!1,nl=!1,Qu=!1,tn=0,Mt=0,_n=0,ms=0,ef=0,Ga=0,sl=0,ui=null,Ma=null,tf=!1,s0=0,Z1=0,l0=1/0,i0=null,An=null,Qt=0,Cn=null,ll=null,an=0,af=0,rf=null,J1=null,fi=0,nf=null;function $a(){return(pt&2)!==0&&it!==0?it&-it:J.T!==null?ff():C()}function Q1(){if(Ga===0)if((it&536870912)===0||ot){var t=Os;Os<<=1,(Os&3932160)===0&&(Os=262144),Ga=t}else Ga=536870912;return t=Pa.current,t!==null&&(t.flags|=32),Ga}function La(t,r,l){(t===wt&&(gt===2||gt===9)||t.cancelPendingCommit!==null)&&(il(t,0),jn(t,it,Ga,!1)),Jn(t,l),((pt&2)===0||t!==wt)&&(t===wt&&((pt&2)===0&&(ms|=l),Mt===4&&jn(t,it,Ga,!1)),Or(t))}function em(t,r,l){if((pt&6)!==0)throw Error(s(327));var o=!l&&(r&127)===0&&(r&t.expiredLanes)===0||Zn(t,r),h=o?Ey(t,r):lf(t,r,!0),p=o;do{if(h===0){nl&&!o&&jn(t,r,0,!1);break}else{if(l=t.current.alternate,p&&!wy(l)){h=lf(t,r,!1),p=!1;continue}if(h===2){if(p=r,t.errorRecoveryDisabledLanes&p)var S=0;else S=t.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){r=S;e:{var j=t;h=ui;var W=j.current.memoizedState.isDehydrated;if(W&&(il(j,S).flags|=256),S=lf(j,S,!1),S!==2){if(Qu&&!W){j.errorRecoveryDisabledLanes|=p,ms|=p,h=4;break e}p=Ma,Ma=h,p!==null&&(Ma===null?Ma=p:Ma.push.apply(Ma,p))}h=S}if(p=!1,h!==2)continue}}if(h===1){il(t,0),jn(t,r,0,!0);break}e:{switch(o=t,p=h,p){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:jn(o,r,Ga,!Tn);break e;case 2:Ma=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(h=s0+300-Ue(),10<h)){if(jn(o,r,Ga,!Tn),Ds(o,0,!0)!==0)break e;an=r,o.timeoutHandle=Om(tm.bind(null,o,l,Ma,i0,tf,r,Ga,ms,sl,Tn,p,"Throttled",-0,0),h);break e}tm(o,l,Ma,i0,tf,r,Ga,ms,sl,Tn,p,null,-0,0)}}break}while(!0);Or(t)}function tm(t,r,l,o,h,p,S,j,W,ie,ve,_e,fe,he){if(t.timeoutHandle=-1,_e=r.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pr},Y1(r,p,_e);var Be=(p&62914560)===p?s0-Ue():(p&4194048)===p?Z1-Ue():0;if(Be=lk(_e,Be),Be!==null){an=p,t.cancelPendingCommit=Be(om.bind(null,t,r,p,l,o,h,S,j,W,ve,_e,null,fe,he)),jn(t,p,S,!ie);return}}om(t,r,p,l,o,h,S,j,W)}function wy(t){for(var r=t;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var o=0;o<l.length;o++){var h=l[o],p=h.getSnapshot;h=h.value;try{if(!za(p(),h))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function jn(t,r,l,o){r&=~ef,r&=~ms,t.suspendedLanes|=r,t.pingedLanes&=~r,o&&(t.warmLanes|=r),o=t.expirationTimes;for(var h=r;0<h;){var p=31-wa(h),S=1<<p;o[p]=-1,h&=~S}l!==0&&gc(t,l,r)}function c0(){return(pt&6)===0?(di(0),!1):!0}function sf(){if(st!==null){if(gt===0)var t=st.return;else t=st,$r=ls=null,ku(t),Zs=null,ql=0,t=st;for(;t!==null;)R1(t.alternate,t),t=t.return;st=null}}function il(t,r){var l=t.timeoutHandle;l!==-1&&(t.timeoutHandle=-1,Hy(l)),l=t.cancelPendingCommit,l!==null&&(t.cancelPendingCommit=null,l()),an=0,sf(),wt=t,st=l=Vr(t.current,null),it=r,gt=0,Va=null,Tn=!1,nl=Zn(t,r),Qu=!1,sl=Ga=ef=ms=_n=Mt=0,Ma=ui=null,tf=!1,(r&8)!==0&&(r|=r&32);var o=t.entangledLanes;if(o!==0)for(t=t.entanglements,o&=r;0<o;){var h=31-wa(o),p=1<<h;r|=t[h],o&=~p}return tn=r,Cc(),l}function am(t,r){Je=null,J.H=ai,r===Ws||r===Ic?(r=vx(),gt=3):r===ou?(r=vx(),gt=4):gt=r===Iu?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Va=r,st===null&&(Mt=1,Zc(t,rr(r,t.current)))}function rm(){var t=Pa.current;return t===null?!0:(it&4194048)===it?ir===null:(it&62914560)===it||(it&536870912)!==0?t===ir:!1}function nm(){var t=J.H;return J.H=ai,t===null?ai:t}function sm(){var t=J.A;return J.A=yy,t}function o0(){Mt=4,Tn||(it&4194048)!==it&&Pa.current!==null||(nl=!0),(_n&134217727)===0&&(ms&134217727)===0||wt===null||jn(wt,it,Ga,!1)}function lf(t,r,l){var o=pt;pt|=2;var h=nm(),p=sm();(wt!==t||it!==r)&&(i0=null,il(t,r)),r=!1;var S=Mt;e:do try{if(gt!==0&&st!==null){var j=st,W=Va;switch(gt){case 8:sf(),S=6;break e;case 3:case 2:case 9:case 6:Pa.current===null&&(r=!0);var ie=gt;if(gt=0,Va=null,cl(t,j,W,ie),l&&nl){S=0;break e}break;default:ie=gt,gt=0,Va=null,cl(t,j,W,ie)}}Sy(),S=Mt;break}catch(ve){am(t,ve)}while(!0);return r&&t.shellSuspendCounter++,$r=ls=null,pt=o,J.H=h,J.A=p,st===null&&(wt=null,it=0,Cc()),S}function Sy(){for(;st!==null;)lm(st)}function Ey(t,r){var l=pt;pt|=2;var o=nm(),h=sm();wt!==t||it!==r?(i0=null,l0=Ue()+500,il(t,r)):nl=Zn(t,r);e:do try{if(gt!==0&&st!==null){r=st;var p=Va;t:switch(gt){case 1:gt=0,Va=null,cl(t,r,p,1);break;case 2:case 9:if(px(p)){gt=0,Va=null,im(r);break}r=function(){gt!==2&&gt!==9||wt!==t||(gt=7),Or(t)},p.then(r,r);break e;case 3:gt=7;break e;case 4:gt=5;break e;case 7:px(p)?(gt=0,Va=null,im(r)):(gt=0,Va=null,cl(t,r,p,7));break;case 5:var S=null;switch(st.tag){case 26:S=st.memoizedState;case 5:case 27:var j=st;if(S?Xm(S):j.stateNode.complete){gt=0,Va=null;var W=j.sibling;if(W!==null)st=W;else{var ie=j.return;ie!==null?(st=ie,u0(ie)):st=null}break t}}gt=0,Va=null,cl(t,r,p,5);break;case 6:gt=0,Va=null,cl(t,r,p,6);break;case 8:sf(),Mt=6;break e;default:throw Error(s(462))}}Ny();break}catch(ve){am(t,ve)}while(!0);return $r=ls=null,J.H=o,J.A=h,pt=l,st!==null?0:(wt=null,it=0,Cc(),Mt)}function Ny(){for(;st!==null&&!ze();)lm(st)}function lm(t){var r=j1(t.alternate,t,tn);t.memoizedProps=t.pendingProps,r===null?u0(t):st=r}function im(t){var r=t,l=r.alternate;switch(r.tag){case 15:case 0:r=E1(l,r,r.pendingProps,r.type,void 0,it);break;case 11:r=E1(l,r,r.pendingProps,r.type.render,r.ref,it);break;case 5:ku(r);default:R1(l,r),r=st=sx(r,tn),r=j1(l,r,tn)}t.memoizedProps=t.pendingProps,r===null?u0(t):st=r}function cl(t,r,l,o){$r=ls=null,ku(r),Zs=null,ql=0;var h=r.return;try{if(hy(t,h,r,l,it)){Mt=1,Zc(t,rr(l,t.current)),st=null;return}}catch(p){if(h!==null)throw st=h,p;Mt=1,Zc(t,rr(l,t.current)),st=null;return}r.flags&32768?(ot||o===1?t=!0:nl||(it&536870912)!==0?t=!1:(Tn=t=!0,(o===2||o===9||o===3||o===6)&&(o=Pa.current,o!==null&&o.tag===13&&(o.flags|=16384))),cm(r,t)):u0(r)}function u0(t){var r=t;do{if((r.flags&32768)!==0){cm(r,Tn);return}t=r.return;var l=py(r.alternate,r,tn);if(l!==null){st=l;return}if(r=r.sibling,r!==null){st=r;return}st=r=t}while(r!==null);Mt===0&&(Mt=5)}function cm(t,r){do{var l=gy(t.alternate,t);if(l!==null){l.flags&=32767,st=l;return}if(l=t.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(t=t.sibling,t!==null)){st=t;return}st=t=l}while(t!==null);Mt=6,st=null}function om(t,r,l,o,h,p,S,j,W){t.cancelPendingCommit=null;do f0();while(Qt!==0);if((pt&6)!==0)throw Error(s(327));if(r!==null){if(r===t.current)throw Error(s(177));if(p=r.lanes|r.childLanes,p|=qo,To(t,l,p,S,j,W),t===wt&&(st=wt=null,it=0),ll=r,Cn=t,an=l,af=p,rf=h,J1=o,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Cy(Gt,function(){return xm(),null})):(t.callbackNode=null,t.callbackPriority=0),o=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||o){o=J.T,J.T=null,h=se.p,se.p=2,S=pt,pt|=4;try{vy(t,r,l)}finally{pt=S,se.p=h,J.T=o}}Qt=1,um(),fm(),dm()}}function um(){if(Qt===1){Qt=0;var t=Cn,r=ll,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=J.T,J.T=null;var o=se.p;se.p=2;var h=pt;pt|=4;try{G1(r,t);var p=bf,S=Wh(t.containerInfo),j=p.focusedElem,W=p.selectionRange;if(S!==j&&j&&j.ownerDocument&&Kh(j.ownerDocument.documentElement,j)){if(W!==null&&Vo(j)){var ie=W.start,ve=W.end;if(ve===void 0&&(ve=ie),"selectionStart"in j)j.selectionStart=ie,j.selectionEnd=Math.min(ve,j.value.length);else{var _e=j.ownerDocument||document,fe=_e&&_e.defaultView||window;if(fe.getSelection){var he=fe.getSelection(),Be=j.textContent.length,Xe=Math.min(W.start,Be),kt=W.end===void 0?Xe:Math.min(W.end,Be);!he.extend&&Xe>kt&&(S=kt,kt=Xe,Xe=S);var re=qh(j,Xe),te=qh(j,kt);if(re&&te&&(he.rangeCount!==1||he.anchorNode!==re.node||he.anchorOffset!==re.offset||he.focusNode!==te.node||he.focusOffset!==te.offset)){var le=_e.createRange();le.setStart(re.node,re.offset),he.removeAllRanges(),Xe>kt?(he.addRange(le),he.extend(te.node,te.offset)):(le.setEnd(te.node,te.offset),he.addRange(le))}}}}for(_e=[],he=j;he=he.parentNode;)he.nodeType===1&&_e.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<_e.length;j++){var Se=_e[j];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}S0=!!vf,bf=vf=null}finally{pt=h,se.p=o,J.T=l}}t.current=r,Qt=2}}function fm(){if(Qt===2){Qt=0;var t=Cn,r=ll,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=J.T,J.T=null;var o=se.p;se.p=2;var h=pt;pt|=4;try{z1(t,r.alternate,r)}finally{pt=h,se.p=o,J.T=l}}Qt=3}}function dm(){if(Qt===4||Qt===3){Qt=0,Pe();var t=Cn,r=ll,l=an,o=J1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Qt=5:(Qt=0,ll=Cn=null,hm(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(An=null),Dl(l),r=r.stateNode,Ut&&typeof Ut.onCommitFiberRoot=="function")try{Ut.onCommitFiberRoot(Tt,r,void 0,(r.current.flags&128)===128)}catch{}if(o!==null){r=J.T,h=se.p,se.p=2,J.T=null;try{for(var p=t.onRecoverableError,S=0;S<o.length;S++){var j=o[S];p(j.value,{componentStack:j.stack})}}finally{J.T=r,se.p=h}}(an&3)!==0&&f0(),Or(t),h=t.pendingLanes,(l&261930)!==0&&(h&42)!==0?t===nf?fi++:(fi=0,nf=t):fi=0,di(0)}}function hm(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,Xl(r)))}function f0(){return um(),fm(),dm(),xm()}function xm(){if(Qt!==5)return!1;var t=Cn,r=af;af=0;var l=Dl(an),o=J.T,h=se.p;try{se.p=32>l?32:l,J.T=null,l=rf,rf=null;var p=Cn,S=an;if(Qt=0,ll=Cn=null,an=0,(pt&6)!==0)throw Error(s(331));var j=pt;if(pt|=4,K1(p.current),X1(p,p.current,S,l),pt=j,di(0,!1),Ut&&typeof Ut.onPostCommitFiberRoot=="function")try{Ut.onPostCommitFiberRoot(Tt,p)}catch{}return!0}finally{se.p=h,J.T=o,hm(t,r)}}function mm(t,r,l){r=rr(l,r),r=Lu(t.stateNode,r,2),t=wn(t,r,2),t!==null&&(Jn(t,2),Or(t))}function vt(t,r,l){if(t.tag===3)mm(t,t,l);else for(;r!==null;){if(r.tag===3){mm(r,t,l);break}else if(r.tag===1){var o=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(An===null||!An.has(o))){t=rr(l,t),l=p1(2),o=wn(r,l,2),o!==null&&(g1(l,o,r,t),Jn(o,2),Or(o));break}}r=r.return}}function cf(t,r,l){var o=t.pingCache;if(o===null){o=t.pingCache=new ky;var h=new Set;o.set(r,h)}else h=o.get(r),h===void 0&&(h=new Set,o.set(r,h));h.has(l)||(Qu=!0,h.add(l),t=Ty.bind(null,t,r,l),r.then(t,t))}function Ty(t,r,l){var o=t.pingCache;o!==null&&o.delete(r),t.pingedLanes|=t.suspendedLanes&l,t.warmLanes&=~l,wt===t&&(it&l)===l&&(Mt===4||Mt===3&&(it&62914560)===it&&300>Ue()-s0?(pt&2)===0&&il(t,0):ef|=l,sl===it&&(sl=0)),Or(t)}function pm(t,r){r===0&&(r=pc()),t=rs(t,r),t!==null&&(Jn(t,r),Or(t))}function _y(t){var r=t.memoizedState,l=0;r!==null&&(l=r.retryLane),pm(t,l)}function Ay(t,r){var l=0;switch(t.tag){case 31:case 13:var o=t.stateNode,h=t.memoizedState;h!==null&&(l=h.retryLane);break;case 19:o=t.stateNode;break;case 22:o=t.stateNode._retryCache;break;default:throw Error(s(314))}o!==null&&o.delete(r),pm(t,l)}function Cy(t,r){return Ye(t,r)}var d0=null,ol=null,of=!1,h0=!1,uf=!1,On=0;function Or(t){t!==ol&&t.next===null&&(ol===null?d0=ol=t:ol=ol.next=t),h0=!0,of||(of=!0,Oy())}function di(t,r){if(!uf&&h0){uf=!0;do for(var l=!1,o=d0;o!==null;){if(t!==0){var h=o.pendingLanes;if(h===0)var p=0;else{var S=o.suspendedLanes,j=o.pingedLanes;p=(1<<31-wa(42|t)+1)-1,p&=h&~(S&~j),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,ym(o,p))}else p=it,p=Ds(o,o===wt?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(p&3)===0||Zn(o,p)||(l=!0,ym(o,p));o=o.next}while(l);uf=!1}}function jy(){gm()}function gm(){h0=of=!1;var t=0;On!==0&&Py()&&(t=On);for(var r=Ue(),l=null,o=d0;o!==null;){var h=o.next,p=vm(o,r);p===0?(o.next=null,l===null?d0=h:l.next=h,h===null&&(ol=l)):(l=o,(t!==0||(p&3)!==0)&&(h0=!0)),o=h}Qt!==0&&Qt!==5||di(t),On!==0&&(On=0)}function vm(t,r){for(var l=t.suspendedLanes,o=t.pingedLanes,h=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var S=31-wa(p),j=1<<S,W=h[S];W===-1?((j&l)===0||(j&o)!==0)&&(h[S]=No(j,r)):W<=r&&(t.expiredLanes|=j),p&=~j}if(r=wt,l=it,l=Ds(t,t===r?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),o=t.callbackNode,l===0||t===r&&(gt===2||gt===9)||t.cancelPendingCommit!==null)return o!==null&&o!==null&&qe(o),t.callbackNode=null,t.callbackPriority=0;if((l&3)===0||Zn(t,l)){if(r=l&-l,r===t.callbackPriority)return r;switch(o!==null&&qe(o),Dl(l)){case 2:case 8:l=Wa;break;case 32:l=Gt;break;case 268435456:l=et;break;default:l=Gt}return o=bm.bind(null,t),l=Ye(l,o),t.callbackPriority=r,t.callbackNode=l,r}return o!==null&&o!==null&&qe(o),t.callbackPriority=2,t.callbackNode=null,2}function bm(t,r){if(Qt!==0&&Qt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var l=t.callbackNode;if(f0()&&t.callbackNode!==l)return null;var o=it;return o=Ds(t,t===wt?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),o===0?null:(em(t,o,r),vm(t,Ue()),t.callbackNode!=null&&t.callbackNode===l?bm.bind(null,t):null)}function ym(t,r){if(f0())return null;em(t,r,!0)}function Oy(){Vy(function(){(pt&6)!==0?Ye(zt,jy):gm()})}function ff(){if(On===0){var t=qs;t===0&&(t=Wn,Wn<<=1,(Wn&261888)===0&&(Wn=256)),On=t}return On}function km(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:kc(""+t)}function wm(t,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,t.id&&l.setAttribute("form",t.id),r.parentNode.insertBefore(l,r),t=new FormData(t),l.parentNode.removeChild(l),t}function Ry(t,r,l,o,h){if(r==="submit"&&l&&l.stateNode===h){var p=km((h[I]||null).action),S=o.submitter;S&&(r=(r=S[I]||null)?km(r.formAction):S.getAttribute("formAction"),r!==null&&(p=r,S=null));var j=new Nc("action","action",null,o,h);t.push({event:j,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(On!==0){var W=S?wm(h,S):new FormData(h);ju(l,{pending:!0,data:W,method:h.method,action:p},null,W)}}else typeof p=="function"&&(j.preventDefault(),W=S?wm(h,S):new FormData(h),ju(l,{pending:!0,data:W,method:h.method,action:p},p,W))},currentTarget:h}]})}}for(var df=0;df<Yo.length;df++){var hf=Yo[df],Dy=hf.toLowerCase(),Fy=hf[0].toUpperCase()+hf.slice(1);gr(Dy,"on"+Fy)}gr(Qh,"onAnimationEnd"),gr(ex,"onAnimationIteration"),gr(tx,"onAnimationStart"),gr("dblclick","onDoubleClick"),gr("focusin","onFocus"),gr("focusout","onBlur"),gr(Wb,"onTransitionRun"),gr(Zb,"onTransitionStart"),gr(Jb,"onTransitionCancel"),gr(ax,"onTransitionEnd"),Qa("onMouseEnter",["mouseout","mouseover"]),Qa("onMouseLeave",["mouseout","mouseover"]),Qa("onPointerEnter",["pointerout","pointerover"]),Qa("onPointerLeave",["pointerout","pointerover"]),Ct("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ct("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ct("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ct("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ct("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ct("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),My=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hi));function Sm(t,r){r=(r&4)!==0;for(var l=0;l<t.length;l++){var o=t[l],h=o.event;o=o.listeners;e:{var p=void 0;if(r)for(var S=o.length-1;0<=S;S--){var j=o[S],W=j.instance,ie=j.currentTarget;if(j=j.listener,W!==p&&h.isPropagationStopped())break e;p=j,h.currentTarget=ie;try{p(h)}catch(ve){Ac(ve)}h.currentTarget=null,p=W}else for(S=0;S<o.length;S++){if(j=o[S],W=j.instance,ie=j.currentTarget,j=j.listener,W!==p&&h.isPropagationStopped())break e;p=j,h.currentTarget=ie;try{p(h)}catch(ve){Ac(ve)}h.currentTarget=null,p=W}}}}function lt(t,r){var l=r[ce];l===void 0&&(l=r[ce]=new Set);var o=t+"__bubble";l.has(o)||(Em(r,t,2,!1),l.add(o))}function xf(t,r,l){var o=0;r&&(o|=4),Em(l,t,o,r)}var x0="_reactListening"+Math.random().toString(36).slice(2);function mf(t){if(!t[x0]){t[x0]=!0,St.forEach(function(l){l!=="selectionchange"&&(My.has(l)||xf(l,!1,t),xf(l,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[x0]||(r[x0]=!0,xf("selectionchange",!1,r))}}function Em(t,r,l,o){switch(Qm(r)){case 2:var h=ok;break;case 8:h=uk;break;default:h=jf}l=h.bind(null,r,l,t),h=void 0,!Fo||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),o?h!==void 0?t.addEventListener(r,l,{capture:!0,passive:h}):t.addEventListener(r,l,!0):h!==void 0?t.addEventListener(r,l,{passive:h}):t.addEventListener(r,l,!1)}function pf(t,r,l,o,h){var p=o;if((r&1)===0&&(r&2)===0&&o!==null)e:for(;;){if(o===null)return;var S=o.tag;if(S===3||S===4){var j=o.stateNode.containerInfo;if(j===h)break;if(S===4)for(S=o.return;S!==null;){var W=S.tag;if((W===3||W===4)&&S.stateNode.containerInfo===h)return;S=S.return}for(;j!==null;){if(S=Re(j),S===null)return;if(W=S.tag,W===5||W===6||W===26||W===27){o=p=S;continue e}j=j.parentNode}}o=o.return}Ch(function(){var ie=p,ve=Ro(l),_e=[];e:{var fe=rx.get(t);if(fe!==void 0){var he=Nc,Be=t;switch(t){case"keypress":if(Sc(l)===0)break e;case"keydown":case"keyup":he=Ab;break;case"focusin":Be="focus",he=Bo;break;case"focusout":Be="blur",he=Bo;break;case"beforeblur":case"afterblur":he=Bo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=pb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=Ob;break;case Qh:case ex:case tx:he=bb;break;case ax:he=Db;break;case"scroll":case"scrollend":he=xb;break;case"wheel":he=Mb;break;case"copy":case"cut":case"paste":he=kb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=Fh;break;case"toggle":case"beforetoggle":he=Ib}var Xe=(r&4)!==0,kt=!Xe&&(t==="scroll"||t==="scrollend"),re=Xe?fe!==null?fe+"Capture":null:fe;Xe=[];for(var te=ie,le;te!==null;){var Se=te;if(le=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||le===null||re===null||(Se=Ml(te,re),Se!=null&&Xe.push(xi(te,Se,le))),kt)break;te=te.return}0<Xe.length&&(fe=new he(fe,Be,null,l,ve),_e.push({event:fe,listeners:Xe}))}}if((r&7)===0){e:{if(fe=t==="mouseover"||t==="pointerover",he=t==="mouseout"||t==="pointerout",fe&&l!==Oo&&(Be=l.relatedTarget||l.fromElement)&&(Re(Be)||Be[P]))break e;if((he||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,he?(Be=l.relatedTarget||l.toElement,he=ie,Be=Be?Re(Be):null,Be!==null&&(kt=u(Be),Xe=Be.tag,Be!==kt||Xe!==5&&Xe!==27&&Xe!==6)&&(Be=null)):(he=null,Be=ie),he!==Be)){if(Xe=Rh,Se="onMouseLeave",re="onMouseEnter",te="mouse",(t==="pointerout"||t==="pointerover")&&(Xe=Fh,Se="onPointerLeave",re="onPointerEnter",te="pointer"),kt=he==null?fe:Oe(he),le=Be==null?fe:Oe(Be),fe=new Xe(Se,te+"leave",he,l,ve),fe.target=kt,fe.relatedTarget=le,Se=null,Re(ve)===ie&&(Xe=new Xe(re,te+"enter",Be,l,ve),Xe.target=le,Xe.relatedTarget=kt,Se=Xe),kt=Se,he&&Be)t:{for(Xe=Ly,re=he,te=Be,le=0,Se=re;Se;Se=Xe(Se))le++;Se=0;for(var Ge=te;Ge;Ge=Xe(Ge))Se++;for(;0<le-Se;)re=Xe(re),le--;for(;0<Se-le;)te=Xe(te),Se--;for(;le--;){if(re===te||te!==null&&re===te.alternate){Xe=re;break t}re=Xe(re),te=Xe(te)}Xe=null}else Xe=null;he!==null&&Nm(_e,fe,he,Xe,!1),Be!==null&&kt!==null&&Nm(_e,kt,Be,Xe,!0)}}e:{if(fe=ie?Oe(ie):window,he=fe.nodeName&&fe.nodeName.toLowerCase(),he==="select"||he==="input"&&fe.type==="file")var xt=Hh;else if(Uh(fe))if(Vh)xt=Yb;else{xt=$b;var Ve=Gb}else he=fe.nodeName,!he||he.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ie&&jo(ie.elementType)&&(xt=Hh):xt=Xb;if(xt&&(xt=xt(t,ie))){Ph(_e,xt,l,ve);break e}Ve&&Ve(t,fe,ie),t==="focusout"&&ie&&fe.type==="number"&&ie.memoizedProps.value!=null&&Co(fe,"number",fe.value)}switch(Ve=ie?Oe(ie):window,t){case"focusin":(Uh(Ve)||Ve.contentEditable==="true")&&(Us=Ve,Go=ie,Vl=null);break;case"focusout":Vl=Go=Us=null;break;case"mousedown":$o=!0;break;case"contextmenu":case"mouseup":case"dragend":$o=!1,Zh(_e,l,ve);break;case"selectionchange":if(Kb)break;case"keydown":case"keyup":Zh(_e,l,ve)}var tt;if(Uo)e:{switch(t){case"compositionstart":var ct="onCompositionStart";break e;case"compositionend":ct="onCompositionEnd";break e;case"compositionupdate":ct="onCompositionUpdate";break e}ct=void 0}else zs?Bh(t,l)&&(ct="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(ct="onCompositionStart");ct&&(Mh&&l.locale!=="ko"&&(zs||ct!=="onCompositionStart"?ct==="onCompositionEnd"&&zs&&(tt=jh()):(mn=ve,Mo="value"in mn?mn.value:mn.textContent,zs=!0)),Ve=m0(ie,ct),0<Ve.length&&(ct=new Dh(ct,t,null,l,ve),_e.push({event:ct,listeners:Ve}),tt?ct.data=tt:(tt=zh(l),tt!==null&&(ct.data=tt)))),(tt=zb?Ub(t,l):Pb(t,l))&&(ct=m0(ie,"onBeforeInput"),0<ct.length&&(Ve=new Dh("onBeforeInput","beforeinput",null,l,ve),_e.push({event:Ve,listeners:ct}),Ve.data=tt)),Ry(_e,t,ie,l,ve)}Sm(_e,r)})}function xi(t,r,l){return{instance:t,listener:r,currentTarget:l}}function m0(t,r){for(var l=r+"Capture",o=[];t!==null;){var h=t,p=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||p===null||(h=Ml(t,l),h!=null&&o.unshift(xi(t,h,p)),h=Ml(t,r),h!=null&&o.push(xi(t,h,p))),t.tag===3)return o;t=t.return}return[]}function Ly(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Nm(t,r,l,o,h){for(var p=r._reactName,S=[];l!==null&&l!==o;){var j=l,W=j.alternate,ie=j.stateNode;if(j=j.tag,W!==null&&W===o)break;j!==5&&j!==26&&j!==27||ie===null||(W=ie,h?(ie=Ml(l,p),ie!=null&&S.unshift(xi(l,ie,W))):h||(ie=Ml(l,p),ie!=null&&S.push(xi(l,ie,W)))),l=l.return}S.length!==0&&t.push({event:r,listeners:S})}var Iy=/\r\n?/g,By=/\u0000|\uFFFD/g;function Tm(t){return(typeof t=="string"?t:""+t).replace(Iy,`
`).replace(By,"")}function _m(t,r){return r=Tm(r),Tm(t)===r}function yt(t,r,l,o,h,p){switch(l){case"children":typeof o=="string"?r==="body"||r==="textarea"&&o===""||Ls(t,o):(typeof o=="number"||typeof o=="bigint")&&r!=="body"&&Ls(t,""+o);break;case"className":bc(t,"class",o);break;case"tabIndex":bc(t,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":bc(t,l,o);break;case"style":_h(t,o,p);break;case"data":if(r!=="object"){bc(t,"data",o);break}case"src":case"href":if(o===""&&(r!=="a"||l!=="href")){t.removeAttribute(l);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){t.removeAttribute(l);break}o=kc(""+o),t.setAttribute(l,o);break;case"action":case"formAction":if(typeof o=="function"){t.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(r!=="input"&&yt(t,r,"name",h.name,h,null),yt(t,r,"formEncType",h.formEncType,h,null),yt(t,r,"formMethod",h.formMethod,h,null),yt(t,r,"formTarget",h.formTarget,h,null)):(yt(t,r,"encType",h.encType,h,null),yt(t,r,"method",h.method,h,null),yt(t,r,"target",h.target,h,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){t.removeAttribute(l);break}o=kc(""+o),t.setAttribute(l,o);break;case"onClick":o!=null&&(t.onclick=Pr);break;case"onScroll":o!=null&&lt("scroll",t);break;case"onScrollEnd":o!=null&&lt("scrollend",t);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(l=o.__html,l!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=l}}break;case"multiple":t.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":t.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){t.removeAttribute("xlink:href");break}l=kc(""+o),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?t.setAttribute(l,""+o):t.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?t.setAttribute(l,""):t.removeAttribute(l);break;case"capture":case"download":o===!0?t.setAttribute(l,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?t.setAttribute(l,o):t.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?t.setAttribute(l,o):t.removeAttribute(l);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?t.removeAttribute(l):t.setAttribute(l,o);break;case"popover":lt("beforetoggle",t),lt("toggle",t),ja(t,"popover",o);break;case"xlinkActuate":Ur(t,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Ur(t,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Ur(t,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Ur(t,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Ur(t,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Ur(t,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Ur(t,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Ur(t,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Ur(t,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":ja(t,"is",o);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=db.get(l)||l,ja(t,l,o))}}function gf(t,r,l,o,h,p){switch(l){case"style":_h(t,o,p);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(l=o.__html,l!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=l}}break;case"children":typeof o=="string"?Ls(t,o):(typeof o=="number"||typeof o=="bigint")&&Ls(t,""+o);break;case"onScroll":o!=null&&lt("scroll",t);break;case"onScrollEnd":o!=null&&lt("scrollend",t);break;case"onClick":o!=null&&(t.onclick=Pr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Et.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(h=l.endsWith("Capture"),r=l.slice(2,h?l.length-7:void 0),p=t[I]||null,p=p!=null?p[l]:null,typeof p=="function"&&t.removeEventListener(r,p,h),typeof o=="function")){typeof p!="function"&&p!==null&&(l in t?t[l]=null:t.hasAttribute(l)&&t.removeAttribute(l)),t.addEventListener(r,o,h);break e}l in t?t[l]=o:o===!0?t.setAttribute(l,""):ja(t,l,o)}}}function oa(t,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lt("error",t),lt("load",t);var o=!1,h=!1,p;for(p in l)if(l.hasOwnProperty(p)){var S=l[p];if(S!=null)switch(p){case"src":o=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:yt(t,r,p,S,l,null)}}h&&yt(t,r,"srcSet",l.srcSet,l,null),o&&yt(t,r,"src",l.src,l,null);return;case"input":lt("invalid",t);var j=p=S=h=null,W=null,ie=null;for(o in l)if(l.hasOwnProperty(o)){var ve=l[o];if(ve!=null)switch(o){case"name":h=ve;break;case"type":S=ve;break;case"checked":W=ve;break;case"defaultChecked":ie=ve;break;case"value":p=ve;break;case"defaultValue":j=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(s(137,r));break;default:yt(t,r,o,ve,l,null)}}Sh(t,p,j,W,ie,S,h,!1);return;case"select":lt("invalid",t),o=S=p=null;for(h in l)if(l.hasOwnProperty(h)&&(j=l[h],j!=null))switch(h){case"value":p=j;break;case"defaultValue":S=j;break;case"multiple":o=j;default:yt(t,r,h,j,l,null)}r=p,l=S,t.multiple=!!o,r!=null?Ms(t,!!o,r,!1):l!=null&&Ms(t,!!o,l,!0);return;case"textarea":lt("invalid",t),p=h=o=null;for(S in l)if(l.hasOwnProperty(S)&&(j=l[S],j!=null))switch(S){case"value":o=j;break;case"defaultValue":h=j;break;case"children":p=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:yt(t,r,S,j,l,null)}Nh(t,o,h,p);return;case"option":for(W in l)if(l.hasOwnProperty(W)&&(o=l[W],o!=null))switch(W){case"selected":t.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:yt(t,r,W,o,l,null)}return;case"dialog":lt("beforetoggle",t),lt("toggle",t),lt("cancel",t),lt("close",t);break;case"iframe":case"object":lt("load",t);break;case"video":case"audio":for(o=0;o<hi.length;o++)lt(hi[o],t);break;case"image":lt("error",t),lt("load",t);break;case"details":lt("toggle",t);break;case"embed":case"source":case"link":lt("error",t),lt("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in l)if(l.hasOwnProperty(ie)&&(o=l[ie],o!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:yt(t,r,ie,o,l,null)}return;default:if(jo(r)){for(ve in l)l.hasOwnProperty(ve)&&(o=l[ve],o!==void 0&&gf(t,r,ve,o,l,void 0));return}}for(j in l)l.hasOwnProperty(j)&&(o=l[j],o!=null&&yt(t,r,j,o,l,null))}function zy(t,r,l,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,p=null,S=null,j=null,W=null,ie=null,ve=null;for(he in l){var _e=l[he];if(l.hasOwnProperty(he)&&_e!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":W=_e;default:o.hasOwnProperty(he)||yt(t,r,he,null,o,_e)}}for(var fe in o){var he=o[fe];if(_e=l[fe],o.hasOwnProperty(fe)&&(he!=null||_e!=null))switch(fe){case"type":p=he;break;case"name":h=he;break;case"checked":ie=he;break;case"defaultChecked":ve=he;break;case"value":S=he;break;case"defaultValue":j=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(s(137,r));break;default:he!==_e&&yt(t,r,fe,he,o,_e)}}Ao(t,S,j,W,ie,ve,p,h);return;case"select":he=S=j=fe=null;for(p in l)if(W=l[p],l.hasOwnProperty(p)&&W!=null)switch(p){case"value":break;case"multiple":he=W;default:o.hasOwnProperty(p)||yt(t,r,p,null,o,W)}for(h in o)if(p=o[h],W=l[h],o.hasOwnProperty(h)&&(p!=null||W!=null))switch(h){case"value":fe=p;break;case"defaultValue":j=p;break;case"multiple":S=p;default:p!==W&&yt(t,r,h,p,o,W)}r=j,l=S,o=he,fe!=null?Ms(t,!!l,fe,!1):!!o!=!!l&&(r!=null?Ms(t,!!l,r,!0):Ms(t,!!l,l?[]:"",!1));return;case"textarea":he=fe=null;for(j in l)if(h=l[j],l.hasOwnProperty(j)&&h!=null&&!o.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:yt(t,r,j,null,o,h)}for(S in o)if(h=o[S],p=l[S],o.hasOwnProperty(S)&&(h!=null||p!=null))switch(S){case"value":fe=h;break;case"defaultValue":he=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==p&&yt(t,r,S,h,o,p)}Eh(t,fe,he);return;case"option":for(var Be in l)if(fe=l[Be],l.hasOwnProperty(Be)&&fe!=null&&!o.hasOwnProperty(Be))switch(Be){case"selected":t.selected=!1;break;default:yt(t,r,Be,null,o,fe)}for(W in o)if(fe=o[W],he=l[W],o.hasOwnProperty(W)&&fe!==he&&(fe!=null||he!=null))switch(W){case"selected":t.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:yt(t,r,W,fe,o,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in l)fe=l[Xe],l.hasOwnProperty(Xe)&&fe!=null&&!o.hasOwnProperty(Xe)&&yt(t,r,Xe,null,o,fe);for(ie in o)if(fe=o[ie],he=l[ie],o.hasOwnProperty(ie)&&fe!==he&&(fe!=null||he!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(s(137,r));break;default:yt(t,r,ie,fe,o,he)}return;default:if(jo(r)){for(var kt in l)fe=l[kt],l.hasOwnProperty(kt)&&fe!==void 0&&!o.hasOwnProperty(kt)&&gf(t,r,kt,void 0,o,fe);for(ve in o)fe=o[ve],he=l[ve],!o.hasOwnProperty(ve)||fe===he||fe===void 0&&he===void 0||gf(t,r,ve,fe,o,he);return}}for(var re in l)fe=l[re],l.hasOwnProperty(re)&&fe!=null&&!o.hasOwnProperty(re)&&yt(t,r,re,null,o,fe);for(_e in o)fe=o[_e],he=l[_e],!o.hasOwnProperty(_e)||fe===he||fe==null&&he==null||yt(t,r,_e,fe,o,he)}function Am(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Uy(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,l=performance.getEntriesByType("resource"),o=0;o<l.length;o++){var h=l[o],p=h.transferSize,S=h.initiatorType,j=h.duration;if(p&&j&&Am(S)){for(S=0,j=h.responseEnd,o+=1;o<l.length;o++){var W=l[o],ie=W.startTime;if(ie>j)break;var ve=W.transferSize,_e=W.initiatorType;ve&&Am(_e)&&(W=W.responseEnd,S+=ve*(W<j?1:(j-ie)/(W-ie)))}if(--o,r+=8*(p+S)/(h.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var vf=null,bf=null;function p0(t){return t.nodeType===9?t:t.ownerDocument}function Cm(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jm(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function yf(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var kf=null;function Py(){var t=window.event;return t&&t.type==="popstate"?t===kf?!1:(kf=t,!0):(kf=null,!1)}var Om=typeof setTimeout=="function"?setTimeout:void 0,Hy=typeof clearTimeout=="function"?clearTimeout:void 0,Rm=typeof Promise=="function"?Promise:void 0,Vy=typeof queueMicrotask=="function"?queueMicrotask:typeof Rm<"u"?function(t){return Rm.resolve(null).then(t).catch(Gy)}:Om;function Gy(t){setTimeout(function(){throw t})}function Rn(t){return t==="head"}function Dm(t,r){var l=r,o=0;do{var h=l.nextSibling;if(t.removeChild(l),h&&h.nodeType===8)if(l=h.data,l==="/$"||l==="/&"){if(o===0){t.removeChild(h),hl(r);return}o--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")o++;else if(l==="html")mi(t.ownerDocument.documentElement);else if(l==="head"){l=t.ownerDocument.head,mi(l);for(var p=l.firstChild;p;){var S=p.nextSibling,j=p.nodeName;p[de]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&p.rel.toLowerCase()==="stylesheet"||l.removeChild(p),p=S}}else l==="body"&&mi(t.ownerDocument.body);l=h}while(l);hl(r)}function Fm(t,r){var l=t;t=0;do{var o=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),o&&o.nodeType===8)if(l=o.data,l==="/$"){if(t===0)break;t--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||t++;l=o}while(l)}function wf(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":wf(l),je(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}t.removeChild(l)}}function $y(t,r,l,o){for(;t.nodeType===1;){var h=l;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!o&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(o){if(!t[de])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var p=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=cr(t.nextSibling),t===null)break}return null}function Xy(t,r,l){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!l||(t=cr(t.nextSibling),t===null))return null;return t}function Mm(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=cr(t.nextSibling),t===null))return null;return t}function Sf(t){return t.data==="$?"||t.data==="$~"}function Ef(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function Yy(t,r){var l=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||l.readyState!=="loading")r();else{var o=function(){r(),l.removeEventListener("DOMContentLoaded",o)};l.addEventListener("DOMContentLoaded",o),t._reactRetry=o}}function cr(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var Nf=null;function Lm(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"||l==="/&"){if(r===0)return cr(t.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}t=t.nextSibling}return null}function Im(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return t;r--}else l!=="/$"&&l!=="/&"||r++}t=t.previousSibling}return null}function Bm(t,r,l){switch(r=p0(l),t){case"html":if(t=r.documentElement,!t)throw Error(s(452));return t;case"head":if(t=r.head,!t)throw Error(s(453));return t;case"body":if(t=r.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}function mi(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);je(t)}var or=new Map,zm=new Set;function g0(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var rn=se.d;se.d={f:qy,r:Ky,D:Wy,C:Zy,L:Jy,m:Qy,X:tk,S:ek,M:ak};function qy(){var t=rn.f(),r=c0();return t||r}function Ky(t){var r=Ie(t);r!==null&&r.tag===5&&r.type==="form"?a1(r):rn.r(t)}var ul=typeof document>"u"?null:document;function Um(t,r,l){var o=ul;if(o&&typeof r=="string"&&r){var h=tr(r);h='link[rel="'+t+'"][href="'+h+'"]',typeof l=="string"&&(h+='[crossorigin="'+l+'"]'),zm.has(h)||(zm.add(h),t={rel:t,crossOrigin:l,href:r},o.querySelector(h)===null&&(r=o.createElement("link"),oa(r,"link",t),He(r),o.head.appendChild(r)))}}function Wy(t){rn.D(t),Um("dns-prefetch",t,null)}function Zy(t,r){rn.C(t,r),Um("preconnect",t,r)}function Jy(t,r,l){rn.L(t,r,l);var o=ul;if(o&&t&&r){var h='link[rel="preload"][as="'+tr(r)+'"]';r==="image"&&l&&l.imageSrcSet?(h+='[imagesrcset="'+tr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(h+='[imagesizes="'+tr(l.imageSizes)+'"]')):h+='[href="'+tr(t)+'"]';var p=h;switch(r){case"style":p=fl(t);break;case"script":p=dl(t)}or.has(p)||(t=v({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:t,as:r},l),or.set(p,t),o.querySelector(h)!==null||r==="style"&&o.querySelector(pi(p))||r==="script"&&o.querySelector(gi(p))||(r=o.createElement("link"),oa(r,"link",t),He(r),o.head.appendChild(r)))}}function Qy(t,r){rn.m(t,r);var l=ul;if(l&&t){var o=r&&typeof r.as=="string"?r.as:"script",h='link[rel="modulepreload"][as="'+tr(o)+'"][href="'+tr(t)+'"]',p=h;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=dl(t)}if(!or.has(p)&&(t=v({rel:"modulepreload",href:t},r),or.set(p,t),l.querySelector(h)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(gi(p)))return}o=l.createElement("link"),oa(o,"link",t),He(o),l.head.appendChild(o)}}}function ek(t,r,l){rn.S(t,r,l);var o=ul;if(o&&t){var h=Fe(o).hoistableStyles,p=fl(t);r=r||"default";var S=h.get(p);if(!S){var j={loading:0,preload:null};if(S=o.querySelector(pi(p)))j.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":r},l),(l=or.get(p))&&Tf(t,l);var W=S=o.createElement("link");He(W),oa(W,"link",t),W._p=new Promise(function(ie,ve){W.onload=ie,W.onerror=ve}),W.addEventListener("load",function(){j.loading|=1}),W.addEventListener("error",function(){j.loading|=2}),j.loading|=4,v0(S,r,o)}S={type:"stylesheet",instance:S,count:1,state:j},h.set(p,S)}}}function tk(t,r){rn.X(t,r);var l=ul;if(l&&t){var o=Fe(l).hoistableScripts,h=dl(t),p=o.get(h);p||(p=l.querySelector(gi(h)),p||(t=v({src:t,async:!0},r),(r=or.get(h))&&_f(t,r),p=l.createElement("script"),He(p),oa(p,"link",t),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(h,p))}}function ak(t,r){rn.M(t,r);var l=ul;if(l&&t){var o=Fe(l).hoistableScripts,h=dl(t),p=o.get(h);p||(p=l.querySelector(gi(h)),p||(t=v({src:t,async:!0,type:"module"},r),(r=or.get(h))&&_f(t,r),p=l.createElement("script"),He(p),oa(p,"link",t),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(h,p))}}function Pm(t,r,l,o){var h=(h=z.current)?g0(h):null;if(!h)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=fl(l.href),l=Fe(h).hoistableStyles,o=l.get(r),o||(o={type:"style",instance:null,count:0,state:null},l.set(r,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){t=fl(l.href);var p=Fe(h).hoistableStyles,S=p.get(t);if(S||(h=h.ownerDocument||h,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,S),(p=h.querySelector(pi(t)))&&!p._p&&(S.instance=p,S.state.loading=5),or.has(t)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},or.set(t,l),p||rk(h,t,l,S.state))),r&&o===null)throw Error(s(528,""));return S}if(r&&o!==null)throw Error(s(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=dl(l),l=Fe(h).hoistableScripts,o=l.get(r),o||(o={type:"script",instance:null,count:0,state:null},l.set(r,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function fl(t){return'href="'+tr(t)+'"'}function pi(t){return'link[rel="stylesheet"]['+t+"]"}function Hm(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function rk(t,r,l,o){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?o.loading=1:(r=t.createElement("link"),o.preload=r,r.addEventListener("load",function(){return o.loading|=1}),r.addEventListener("error",function(){return o.loading|=2}),oa(r,"link",l),He(r),t.head.appendChild(r))}function dl(t){return'[src="'+tr(t)+'"]'}function gi(t){return"script[async]"+t}function Vm(t,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var o=t.querySelector('style[data-href~="'+tr(l.href)+'"]');if(o)return r.instance=o,He(o),o;var h=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return o=(t.ownerDocument||t).createElement("style"),He(o),oa(o,"style",h),v0(o,l.precedence,t),r.instance=o;case"stylesheet":h=fl(l.href);var p=t.querySelector(pi(h));if(p)return r.state.loading|=4,r.instance=p,He(p),p;o=Hm(l),(h=or.get(h))&&Tf(o,h),p=(t.ownerDocument||t).createElement("link"),He(p);var S=p;return S._p=new Promise(function(j,W){S.onload=j,S.onerror=W}),oa(p,"link",o),r.state.loading|=4,v0(p,l.precedence,t),r.instance=p;case"script":return p=dl(l.src),(h=t.querySelector(gi(p)))?(r.instance=h,He(h),h):(o=l,(h=or.get(p))&&(o=v({},l),_f(o,h)),t=t.ownerDocument||t,h=t.createElement("script"),He(h),oa(h,"link",o),t.head.appendChild(h),r.instance=h);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(o=r.instance,r.state.loading|=4,v0(o,l.precedence,t));return r.instance}function v0(t,r,l){for(var o=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=o.length?o[o.length-1]:null,p=h,S=0;S<o.length;S++){var j=o[S];if(j.dataset.precedence===r)p=j;else if(p!==h)break}p?p.parentNode.insertBefore(t,p.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(t,r.firstChild))}function Tf(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function _f(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var b0=null;function Gm(t,r,l){if(b0===null){var o=new Map,h=b0=new Map;h.set(l,o)}else h=b0,o=h.get(l),o||(o=new Map,h.set(l,o));if(o.has(t))return o;for(o.set(t,null),l=l.getElementsByTagName(t),h=0;h<l.length;h++){var p=l[h];if(!(p[de]||p[M]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var S=p.getAttribute(r)||"";S=t+S;var j=o.get(S);j?j.push(p):o.set(S,[p])}}return o}function $m(t,r,l){t=t.ownerDocument||t,t.head.insertBefore(l,r==="title"?t.querySelector("head > title"):null)}function nk(t,r,l){if(l===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return t=r.disabled,typeof r.precedence=="string"&&t==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Xm(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function sk(t,r,l,o){if(l.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var h=fl(o.href),p=r.querySelector(pi(h));if(p){r=p._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=y0.bind(t),r.then(t,t)),l.state.loading|=4,l.instance=p,He(p);return}p=r.ownerDocument||r,o=Hm(o),(h=or.get(h))&&Tf(o,h),p=p.createElement("link"),He(p);var S=p;S._p=new Promise(function(j,W){S.onload=j,S.onerror=W}),oa(p,"link",o),l.instance=p}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(t.count++,l=y0.bind(t),r.addEventListener("load",l),r.addEventListener("error",l))}}var Af=0;function lk(t,r){return t.stylesheets&&t.count===0&&w0(t,t.stylesheets),0<t.count||0<t.imgCount?function(l){var o=setTimeout(function(){if(t.stylesheets&&w0(t,t.stylesheets),t.unsuspend){var p=t.unsuspend;t.unsuspend=null,p()}},6e4+r);0<t.imgBytes&&Af===0&&(Af=62500*Uy());var h=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&w0(t,t.stylesheets),t.unsuspend)){var p=t.unsuspend;t.unsuspend=null,p()}},(t.imgBytes>Af?50:800)+r);return t.unsuspend=l,function(){t.unsuspend=null,clearTimeout(o),clearTimeout(h)}}:null}function y0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)w0(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var k0=null;function w0(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,k0=new Map,r.forEach(ik,t),k0=null,y0.call(t))}function ik(t,r){if(!(r.state.loading&4)){var l=k0.get(t);if(l)var o=l.get(null);else{l=new Map,k0.set(t,l);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<h.length;p++){var S=h[p];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(l.set(S.dataset.precedence,S),o=S)}o&&l.set(null,o)}h=r.instance,S=h.getAttribute("data-precedence"),p=l.get(S)||o,p===o&&l.set(null,h),l.set(S,h),this.count++,o=y0.bind(this),h.addEventListener("load",o),h.addEventListener("error",o),p?p.parentNode.insertBefore(h,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),r.state.loading|=4}}var vi={$$typeof:E,Provider:null,Consumer:null,_currentValue:Ae,_currentValue2:Ae,_threadCount:0};function ck(t,r,l,o,h,p,S,j,W){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ol(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ol(0),this.hiddenUpdates=Ol(null),this.identifierPrefix=o,this.onUncaughtError=h,this.onCaughtError=p,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Ym(t,r,l,o,h,p,S,j,W,ie,ve,_e){return t=new ck(t,r,l,S,W,ie,ve,_e,j),r=1,p===!0&&(r|=24),p=Ua(3,null,null,r),t.current=p,p.stateNode=t,r=lu(),r.refCount++,t.pooledCache=r,r.refCount++,p.memoizedState={element:o,isDehydrated:l,cache:r},uu(p),t}function qm(t){return t?(t=Vs,t):Vs}function Km(t,r,l,o,h,p){h=qm(h),o.context===null?o.context=h:o.pendingContext=h,o=kn(r),o.payload={element:l},p=p===void 0?null:p,p!==null&&(o.callback=p),l=wn(t,o,r),l!==null&&(La(l,t,r),Wl(l,t,r))}function Wm(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<r?l:r}}function Cf(t,r){Wm(t,r),(t=t.alternate)&&Wm(t,r)}function Zm(t){if(t.tag===13||t.tag===31){var r=rs(t,67108864);r!==null&&La(r,t,67108864),Cf(t,67108864)}}function Jm(t){if(t.tag===13||t.tag===31){var r=$a();r=Rl(r);var l=rs(t,r);l!==null&&La(l,t,r),Cf(t,r)}}var S0=!0;function ok(t,r,l,o){var h=J.T;J.T=null;var p=se.p;try{se.p=2,jf(t,r,l,o)}finally{se.p=p,J.T=h}}function uk(t,r,l,o){var h=J.T;J.T=null;var p=se.p;try{se.p=8,jf(t,r,l,o)}finally{se.p=p,J.T=h}}function jf(t,r,l,o){if(S0){var h=Of(o);if(h===null)pf(t,r,o,E0,l),ep(t,o);else if(dk(h,t,r,l,o))o.stopPropagation();else if(ep(t,o),r&4&&-1<fk.indexOf(t)){for(;h!==null;){var p=Ie(h);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var S=Ja(p.pendingLanes);if(S!==0){var j=p;for(j.pendingLanes|=2,j.entangledLanes|=2;S;){var W=1<<31-wa(S);j.entanglements[1]|=W,S&=~W}Or(p),(pt&6)===0&&(l0=Ue()+500,di(0))}}break;case 31:case 13:j=rs(p,2),j!==null&&La(j,p,2),c0(),Cf(p,2)}if(p=Of(o),p===null&&pf(t,r,o,E0,l),p===h)break;h=p}h!==null&&o.stopPropagation()}else pf(t,r,o,null,l)}}function Of(t){return t=Ro(t),Rf(t)}var E0=null;function Rf(t){if(E0=null,t=Re(t),t!==null){var r=u(t);if(r===null)t=null;else{var l=r.tag;if(l===13){if(t=f(r),t!==null)return t;t=null}else if(l===31){if(t=d(r),t!==null)return t;t=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return E0=t,null}function Qm(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ha()){case zt:return 2;case Wa:return 8;case Gt:case Za:return 32;case et:return 268435456;default:return 32}default:return 32}}var Df=!1,Dn=null,Fn=null,Mn=null,bi=new Map,yi=new Map,Ln=[],fk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ep(t,r){switch(t){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":Fn=null;break;case"mouseover":case"mouseout":Mn=null;break;case"pointerover":case"pointerout":bi.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":yi.delete(r.pointerId)}}function ki(t,r,l,o,h,p){return t===null||t.nativeEvent!==p?(t={blockedOn:r,domEventName:l,eventSystemFlags:o,nativeEvent:p,targetContainers:[h]},r!==null&&(r=Ie(r),r!==null&&Zm(r)),t):(t.eventSystemFlags|=o,r=t.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),t)}function dk(t,r,l,o,h){switch(r){case"focusin":return Dn=ki(Dn,t,r,l,o,h),!0;case"dragenter":return Fn=ki(Fn,t,r,l,o,h),!0;case"mouseover":return Mn=ki(Mn,t,r,l,o,h),!0;case"pointerover":var p=h.pointerId;return bi.set(p,ki(bi.get(p)||null,t,r,l,o,h)),!0;case"gotpointercapture":return p=h.pointerId,yi.set(p,ki(yi.get(p)||null,t,r,l,o,h)),!0}return!1}function tp(t){var r=Re(t.target);if(r!==null){var l=u(r);if(l!==null){if(r=l.tag,r===13){if(r=f(l),r!==null){t.blockedOn=r,U(t.priority,function(){Jm(l)});return}}else if(r===31){if(r=d(l),r!==null){t.blockedOn=r,U(t.priority,function(){Jm(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function N0(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var l=Of(t.nativeEvent);if(l===null){l=t.nativeEvent;var o=new l.constructor(l.type,l);Oo=o,l.target.dispatchEvent(o),Oo=null}else return r=Ie(l),r!==null&&Zm(r),t.blockedOn=l,!1;r.shift()}return!0}function ap(t,r,l){N0(t)&&l.delete(r)}function hk(){Df=!1,Dn!==null&&N0(Dn)&&(Dn=null),Fn!==null&&N0(Fn)&&(Fn=null),Mn!==null&&N0(Mn)&&(Mn=null),bi.forEach(ap),yi.forEach(ap)}function T0(t,r){t.blockedOn===r&&(t.blockedOn=null,Df||(Df=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,hk)))}var _0=null;function rp(t){_0!==t&&(_0=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){_0===t&&(_0=null);for(var r=0;r<t.length;r+=3){var l=t[r],o=t[r+1],h=t[r+2];if(typeof o!="function"){if(Rf(o||l)===null)continue;break}var p=Ie(l);p!==null&&(t.splice(r,3),r-=3,ju(p,{pending:!0,data:h,method:l.method,action:o},o,h))}}))}function hl(t){function r(W){return T0(W,t)}Dn!==null&&T0(Dn,t),Fn!==null&&T0(Fn,t),Mn!==null&&T0(Mn,t),bi.forEach(r),yi.forEach(r);for(var l=0;l<Ln.length;l++){var o=Ln[l];o.blockedOn===t&&(o.blockedOn=null)}for(;0<Ln.length&&(l=Ln[0],l.blockedOn===null);)tp(l),l.blockedOn===null&&Ln.shift();if(l=(t.ownerDocument||t).$$reactFormReplay,l!=null)for(o=0;o<l.length;o+=3){var h=l[o],p=l[o+1],S=h[I]||null;if(typeof p=="function")S||rp(l);else if(S){var j=null;if(p&&p.hasAttribute("formAction")){if(h=p,S=p[I]||null)j=S.formAction;else if(Rf(h)!==null)continue}else j=S.action;typeof j=="function"?l[o+1]=j:(l.splice(o,3),o-=3),rp(l)}}}function np(){function t(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(S){return h=S})},focusReset:"manual",scroll:"manual"})}function r(){h!==null&&(h(),h=null),o||setTimeout(l,20)}function l(){if(!o&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,h=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){o=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),h!==null&&(h(),h=null)}}}function Ff(t){this._internalRoot=t}A0.prototype.render=Ff.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(s(409));var l=r.current,o=$a();Km(l,o,t,r,null,null)},A0.prototype.unmount=Ff.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;Km(t.current,2,null,t,null,null),c0(),r[P]=null}};function A0(t){this._internalRoot=t}A0.prototype.unstable_scheduleHydration=function(t){if(t){var r=C();t={blockedOn:null,target:t,priority:r};for(var l=0;l<Ln.length&&r!==0&&r<Ln[l].priority;l++);Ln.splice(l,0,t),l===0&&tp(t)}};var sp=n.version;if(sp!=="19.2.3")throw Error(s(527,sp,"19.2.3"));se.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=x(r),t=t!==null?g(t):null,t=t===null?null:t.stateNode,t};var xk={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var C0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!C0.isDisabled&&C0.supportsFiber)try{Tt=C0.inject(xk),Ut=C0}catch{}}return Si.createRoot=function(t,r){if(!i(t))throw Error(s(299));var l=!1,o="",h=d1,p=h1,S=x1;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(p=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError)),r=Ym(t,1,!1,null,null,l,o,null,h,p,S,np),t[P]=r.current,mf(t),new Ff(r)},Si.hydrateRoot=function(t,r,l){if(!i(t))throw Error(s(299));var o=!1,h="",p=d1,S=h1,j=x1,W=null;return l!=null&&(l.unstable_strictMode===!0&&(o=!0),l.identifierPrefix!==void 0&&(h=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(j=l.onRecoverableError),l.formState!==void 0&&(W=l.formState)),r=Ym(t,1,!0,r,l??null,o,h,W,p,S,j,np),r.context=qm(null),l=r.current,o=$a(),o=Rl(o),h=kn(o),h.callback=null,wn(l,h,o),l=o,r.current.lanes=l,Jn(r,l),Or(r),t[P]=r.current,mf(t),new A0(r)},Si.version="19.2.3",Si}var mp;function Sk(){if(mp)return If.exports;mp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),If.exports=wk(),If.exports}var Ek=Sk();const Nk=jd(Ek);/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var pp="popstate";function Tk(e={}){function n(s,i){let{pathname:u,search:f,hash:d}=s.location;return ld("",{pathname:u,search:f,hash:d},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function a(s,i){return typeof i=="string"?i:Vi(i)}return Ak(n,a,null,e)}function Rt(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function hr(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function _k(){return Math.random().toString(36).substring(2,10)}function gp(e,n){return{usr:e.state,key:e.key,idx:n}}function ld(e,n,a=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Nl(n):n,state:a,key:n&&n.key||s||_k()}}function Vi({pathname:e="/",search:n="",hash:a=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(e+=a.charAt(0)==="#"?a:"#"+a),e}function Nl(e){let n={};if(e){let a=e.indexOf("#");a>=0&&(n.hash=e.substring(a),e=e.substring(0,a));let s=e.indexOf("?");s>=0&&(n.search=e.substring(s),e=e.substring(0,s)),e&&(n.pathname=e)}return n}function Ak(e,n,a,s={}){let{window:i=document.defaultView,v5Compat:u=!1}=s,f=i.history,d="POP",m=null,x=g();x==null&&(x=0,f.replaceState({...f.state,idx:x},""));function g(){return(f.state||{idx:null}).idx}function v(){d="POP";let N=g(),_=N==null?null:N-x;x=N,m&&m({action:d,location:w.location,delta:_})}function b(N,_){d="PUSH";let O=ld(w.location,N,_);x=g()+1;let E=gp(O,x),L=w.createHref(O);try{f.pushState(E,"",L)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;i.location.assign(L)}u&&m&&m({action:d,location:w.location,delta:1})}function k(N,_){d="REPLACE";let O=ld(w.location,N,_);x=g();let E=gp(O,x),L=w.createHref(O);f.replaceState(E,"",L),u&&m&&m({action:d,location:w.location,delta:0})}function y(N){return Ck(N)}let w={get action(){return d},get location(){return e(i,f)},listen(N){if(m)throw new Error("A history only accepts one active listener");return i.addEventListener(pp,v),m=N,()=>{i.removeEventListener(pp,v),m=null}},createHref(N){return n(i,N)},createURL:y,encodeLocation(N){let _=y(N);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:b,replace:k,go(N){return f.go(N)}};return w}function Ck(e,n=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Rt(a,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:Vi(e);return s=s.replace(/ $/,"%20"),!n&&s.startsWith("//")&&(s=a+s),new URL(s,a)}function Pg(e,n,a="/"){return jk(e,n,a,!1)}function jk(e,n,a,s){let i=typeof n=="string"?Nl(n):n,u=un(i.pathname||"/",a);if(u==null)return null;let f=Hg(e);Ok(f);let d=null;for(let m=0;d==null&&m<f.length;++m){let x=Hk(u);d=Uk(f[m],x,s)}return d}function Hg(e,n=[],a=[],s="",i=!1){let u=(f,d,m=i,x)=>{let g={relativePath:x===void 0?f.path||"":x,caseSensitive:f.caseSensitive===!0,childrenIndex:d,route:f};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(s)&&m)return;Rt(g.relativePath.startsWith(s),`Absolute route path "${g.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(s.length)}let v=ln([s,g.relativePath]),b=a.concat(g);f.children&&f.children.length>0&&(Rt(f.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),Hg(f.children,n,b,v,m)),!(f.path==null&&!f.index)&&n.push({path:v,score:Bk(v,f.index),routesMeta:b})};return e.forEach((f,d)=>{var m;if(f.path===""||!((m=f.path)!=null&&m.includes("?")))u(f,d);else for(let x of Vg(f.path))u(f,d,!0,x)}),n}function Vg(e){let n=e.split("/");if(n.length===0)return[];let[a,...s]=n,i=a.endsWith("?"),u=a.replace(/\?$/,"");if(s.length===0)return i?[u,""]:[u];let f=Vg(s.join("/")),d=[];return d.push(...f.map(m=>m===""?u:[u,m].join("/"))),i&&d.push(...f),d.map(m=>e.startsWith("/")&&m===""?"/":m)}function Ok(e){e.sort((n,a)=>n.score!==a.score?a.score-n.score:zk(n.routesMeta.map(s=>s.childrenIndex),a.routesMeta.map(s=>s.childrenIndex)))}var Rk=/^:[\w-]+$/,Dk=3,Fk=2,Mk=1,Lk=10,Ik=-2,vp=e=>e==="*";function Bk(e,n){let a=e.split("/"),s=a.length;return a.some(vp)&&(s+=Ik),n&&(s+=Fk),a.filter(i=>!vp(i)).reduce((i,u)=>i+(Rk.test(u)?Dk:u===""?Mk:Lk),s)}function zk(e,n){return e.length===n.length&&e.slice(0,-1).every((s,i)=>s===n[i])?e[e.length-1]-n[n.length-1]:0}function Uk(e,n,a=!1){let{routesMeta:s}=e,i={},u="/",f=[];for(let d=0;d<s.length;++d){let m=s[d],x=d===s.length-1,g=u==="/"?n:n.slice(u.length)||"/",v=Z0({path:m.relativePath,caseSensitive:m.caseSensitive,end:x},g),b=m.route;if(!v&&x&&a&&!s[s.length-1].route.index&&(v=Z0({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},g)),!v)return null;Object.assign(i,v.params),f.push({params:i,pathname:ln([u,v.pathname]),pathnameBase:Xk(ln([u,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(u=ln([u,v.pathnameBase]))}return f}function Z0(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,s]=Pk(e.path,e.caseSensitive,e.end),i=n.match(a);if(!i)return null;let u=i[0],f=u.replace(/(.)\/+$/,"$1"),d=i.slice(1);return{params:s.reduce((x,{paramName:g,isOptional:v},b)=>{if(g==="*"){let y=d[b]||"";f=u.slice(0,u.length-y.length).replace(/(.)\/+$/,"$1")}const k=d[b];return v&&!k?x[g]=void 0:x[g]=(k||"").replace(/%2F/g,"/"),x},{}),pathname:u,pathnameBase:f,pattern:e}}function Pk(e,n=!1,a=!0){hr(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,d,m)=>(s.push({paramName:d,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,n?void 0:"i"),s]}function Hk(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return hr(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function un(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,s=e.charAt(a);return s&&s!=="/"?null:e.slice(a)||"/"}var Gg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vk=e=>Gg.test(e);function Gk(e,n="/"){let{pathname:a,search:s="",hash:i=""}=typeof e=="string"?Nl(e):e,u;if(a)if(Vk(a))u=a;else{if(a.includes("//")){let f=a;a=a.replace(/\/\/+/g,"/"),hr(!1,`Pathnames cannot have embedded double slashes - normalizing ${f} -> ${a}`)}a.startsWith("/")?u=bp(a.substring(1),"/"):u=bp(a,n)}else u=n;return{pathname:u,search:Yk(s),hash:qk(i)}}function bp(e,n){let a=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?a.length>1&&a.pop():i!=="."&&a.push(i)}),a.length>1?a.join("/"):"/"}function Pf(e,n,a,s){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function $k(e){return e.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function Rd(e){let n=$k(e);return n.map((a,s)=>s===n.length-1?a.pathname:a.pathnameBase)}function Dd(e,n,a,s=!1){let i;typeof e=="string"?i=Nl(e):(i={...e},Rt(!i.pathname||!i.pathname.includes("?"),Pf("?","pathname","search",i)),Rt(!i.pathname||!i.pathname.includes("#"),Pf("#","pathname","hash",i)),Rt(!i.search||!i.search.includes("#"),Pf("#","search","hash",i)));let u=e===""||i.pathname==="",f=u?"/":i.pathname,d;if(f==null)d=a;else{let v=n.length-1;if(!s&&f.startsWith("..")){let b=f.split("/");for(;b[0]==="..";)b.shift(),v-=1;i.pathname=b.join("/")}d=v>=0?n[v]:"/"}let m=Gk(i,d),x=f&&f!=="/"&&f.endsWith("/"),g=(u||f===".")&&a.endsWith("/");return!m.pathname.endsWith("/")&&(x||g)&&(m.pathname+="/"),m}var ln=e=>e.join("/").replace(/\/\/+/g,"/"),Xk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Yk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,qk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Kk=class{constructor(e,n,a,s=!1){this.status=e,this.statusText=n||"",this.internal=s,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function Wk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function Zk(e){return e.map(n=>n.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var $g=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Xg(e,n){let a=e;if(typeof a!="string"||!Gg.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let s=a,i=!1;if($g)try{let u=new URL(window.location.href),f=a.startsWith("//")?new URL(u.protocol+a):new URL(a),d=un(f.pathname,n);f.origin===u.origin&&d!=null?a=d+f.search+f.hash:i=!0}catch{hr(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:i,to:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Yg=["POST","PUT","PATCH","DELETE"];new Set(Yg);var Jk=["GET",...Yg];new Set(Jk);var Tl=D.createContext(null);Tl.displayName="DataRouter";var po=D.createContext(null);po.displayName="DataRouterState";var Qk=D.createContext(!1),qg=D.createContext({isTransitioning:!1});qg.displayName="ViewTransition";var e4=D.createContext(new Map);e4.displayName="Fetchers";var t4=D.createContext(null);t4.displayName="Await";var Ka=D.createContext(null);Ka.displayName="Navigation";var nc=D.createContext(null);nc.displayName="Location";var Ir=D.createContext({outlet:null,matches:[],isDataRoute:!1});Ir.displayName="Route";var Fd=D.createContext(null);Fd.displayName="RouteError";var Kg="REACT_ROUTER_ERROR",a4="REDIRECT",r4="ROUTE_ERROR_RESPONSE";function n4(e){if(e.startsWith(`${Kg}:${a4}:{`))try{let n=JSON.parse(e.slice(28));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.location=="string"&&typeof n.reloadDocument=="boolean"&&typeof n.replace=="boolean")return n}catch{}}function s4(e){if(e.startsWith(`${Kg}:${r4}:{`))try{let n=JSON.parse(e.slice(40));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string")return new Kk(n.status,n.statusText,n.data)}catch{}}function l4(e,{relative:n}={}){Rt(_l(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:s}=D.useContext(Ka),{hash:i,pathname:u,search:f}=lc(e,{relative:n}),d=u;return a!=="/"&&(d=u==="/"?a:ln([a,u])),s.createHref({pathname:d,search:f,hash:i})}function _l(){return D.useContext(nc)!=null}function dn(){return Rt(_l(),"useLocation() may be used only in the context of a <Router> component."),D.useContext(nc).location}var Wg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Zg(e){D.useContext(Ka).static||D.useLayoutEffect(e)}function sc(){let{isDataRoute:e}=D.useContext(Ir);return e?b4():i4()}function i4(){Rt(_l(),"useNavigate() may be used only in the context of a <Router> component.");let e=D.useContext(Tl),{basename:n,navigator:a}=D.useContext(Ka),{matches:s}=D.useContext(Ir),{pathname:i}=dn(),u=JSON.stringify(Rd(s)),f=D.useRef(!1);return Zg(()=>{f.current=!0}),D.useCallback((m,x={})=>{if(hr(f.current,Wg),!f.current)return;if(typeof m=="number"){a.go(m);return}let g=Dd(m,JSON.parse(u),i,x.relative==="path");e==null&&n!=="/"&&(g.pathname=g.pathname==="/"?n:ln([n,g.pathname])),(x.replace?a.replace:a.push)(g,x.state,x)},[n,a,u,i,e])}D.createContext(null);function lc(e,{relative:n}={}){let{matches:a}=D.useContext(Ir),{pathname:s}=dn(),i=JSON.stringify(Rd(a));return D.useMemo(()=>Dd(e,JSON.parse(i),s,n==="path"),[e,i,s,n])}function c4(e,n){return Jg(e,n)}function Jg(e,n,a,s,i){var O;Rt(_l(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=D.useContext(Ka),{matches:f}=D.useContext(Ir),d=f[f.length-1],m=d?d.params:{},x=d?d.pathname:"/",g=d?d.pathnameBase:"/",v=d&&d.route;{let E=v&&v.path||"";ev(x,!v||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let b=dn(),k;if(n){let E=typeof n=="string"?Nl(n):n;Rt(g==="/"||((O=E.pathname)==null?void 0:O.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${E.pathname}" was given in the \`location\` prop.`),k=E}else k=b;let y=k.pathname||"/",w=y;if(g!=="/"){let E=g.replace(/^\//,"").split("/");w="/"+y.replace(/^\//,"").split("/").slice(E.length).join("/")}let N=Pg(e,{pathname:w});hr(v||N!=null,`No routes matched location "${k.pathname}${k.search}${k.hash}" `),hr(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${k.pathname}${k.search}${k.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=h4(N&&N.map(E=>Object.assign({},E,{params:Object.assign({},m,E.params),pathname:ln([g,u.encodeLocation?u.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?g:ln([g,u.encodeLocation?u.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),f,a,s,i);return n&&_?D.createElement(nc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...k},navigationType:"POP"}},_):_}function o4(){let e=v4(),n=Wk(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},u={padding:"2px 4px",backgroundColor:s},f=null;return console.error("Error handled by React Router default ErrorBoundary:",e),f=D.createElement(D.Fragment,null,D.createElement("p",null," Hey developer "),D.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",D.createElement("code",{style:u},"ErrorBoundary")," or"," ",D.createElement("code",{style:u},"errorElement")," prop on your route.")),D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},n),a?D.createElement("pre",{style:i},a):null,f)}var u4=D.createElement(o4,null),Qg=class extends D.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){this.props.onError?this.props.onError(e,n):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const a=s4(e.digest);a&&(e=a)}let n=e!==void 0?D.createElement(Ir.Provider,{value:this.props.routeContext},D.createElement(Fd.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?D.createElement(f4,{error:e},n):n}};Qg.contextType=Qk;var Hf=new WeakMap;function f4({children:e,error:n}){let{basename:a}=D.useContext(Ka);if(typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){let s=n4(n.digest);if(s){let i=Hf.get(n);if(i)throw i;let u=Xg(s.location,a);if($g&&!Hf.get(n))if(u.isExternal||s.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const f=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:s.replace}));throw Hf.set(n,f),f}return D.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return e}function d4({routeContext:e,match:n,children:a}){let s=D.useContext(Tl);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),D.createElement(Ir.Provider,{value:e},a)}function h4(e,n=[],a=null,s=null,i=null){if(e==null){if(!a)return null;if(a.errors)e=a.matches;else if(n.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let u=e,f=a==null?void 0:a.errors;if(f!=null){let g=u.findIndex(v=>v.route.id&&(f==null?void 0:f[v.route.id])!==void 0);Rt(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(f).join(",")}`),u=u.slice(0,Math.min(u.length,g+1))}let d=!1,m=-1;if(a)for(let g=0;g<u.length;g++){let v=u[g];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(m=g),v.route.id){let{loaderData:b,errors:k}=a,y=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!k||k[v.route.id]===void 0);if(v.route.lazy||y){d=!0,m>=0?u=u.slice(0,m+1):u=[u[0]];break}}}let x=a&&s?(g,v)=>{var b,k;s(g,{location:a.location,params:((k=(b=a.matches)==null?void 0:b[0])==null?void 0:k.params)??{},unstable_pattern:Zk(a.matches),errorInfo:v})}:void 0;return u.reduceRight((g,v,b)=>{let k,y=!1,w=null,N=null;a&&(k=f&&v.route.id?f[v.route.id]:void 0,w=v.route.errorElement||u4,d&&(m<0&&b===0?(ev("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,N=null):m===b&&(y=!0,N=v.route.hydrateFallbackElement||null)));let _=n.concat(u.slice(0,b+1)),O=()=>{let E;return k?E=w:y?E=N:v.route.Component?E=D.createElement(v.route.Component,null):v.route.element?E=v.route.element:E=g,D.createElement(d4,{match:v,routeContext:{outlet:g,matches:_,isDataRoute:a!=null},children:E})};return a&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?D.createElement(Qg,{location:a.location,revalidation:a.revalidation,component:w,error:k,children:O(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:x}):O()},null)}function Md(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function x4(e){let n=D.useContext(Tl);return Rt(n,Md(e)),n}function m4(e){let n=D.useContext(po);return Rt(n,Md(e)),n}function p4(e){let n=D.useContext(Ir);return Rt(n,Md(e)),n}function Ld(e){let n=p4(e),a=n.matches[n.matches.length-1];return Rt(a.route.id,`${e} can only be used on routes that contain a unique "id"`),a.route.id}function g4(){return Ld("useRouteId")}function v4(){var s;let e=D.useContext(Fd),n=m4("useRouteError"),a=Ld("useRouteError");return e!==void 0?e:(s=n.errors)==null?void 0:s[a]}function b4(){let{router:e}=x4("useNavigate"),n=Ld("useNavigate"),a=D.useRef(!1);return Zg(()=>{a.current=!0}),D.useCallback(async(i,u={})=>{hr(a.current,Wg),a.current&&(typeof i=="number"?await e.navigate(i):await e.navigate(i,{fromRouteId:n,...u}))},[e,n])}var yp={};function ev(e,n,a){!n&&!yp[e]&&(yp[e]=!0,hr(!1,a))}D.memo(y4);function y4({routes:e,future:n,state:a,onError:s}){return Jg(e,void 0,a,s,n)}function id({to:e,replace:n,state:a,relative:s}){Rt(_l(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=D.useContext(Ka);hr(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=D.useContext(Ir),{pathname:f}=dn(),d=sc(),m=Dd(e,Rd(u),f,s==="path"),x=JSON.stringify(m);return D.useEffect(()=>{d(JSON.parse(x),{replace:n,state:a,relative:s})},[d,x,s,n,a]),null}function G0(e){Rt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function k4({basename:e="/",children:n=null,location:a,navigationType:s="POP",navigator:i,static:u=!1,unstable_useTransitions:f}){Rt(!_l(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=e.replace(/^\/*/,"/"),m=D.useMemo(()=>({basename:d,navigator:i,static:u,unstable_useTransitions:f,future:{}}),[d,i,u,f]);typeof a=="string"&&(a=Nl(a));let{pathname:x="/",search:g="",hash:v="",state:b=null,key:k="default"}=a,y=D.useMemo(()=>{let w=un(x,d);return w==null?null:{location:{pathname:w,search:g,hash:v,state:b,key:k},navigationType:s}},[d,x,g,v,b,k,s]);return hr(y!=null,`<Router basename="${d}"> is not able to match the URL "${x}${g}${v}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:D.createElement(Ka.Provider,{value:m},D.createElement(nc.Provider,{children:n,value:y}))}function w4({children:e,location:n}){return c4(cd(e),n)}function cd(e,n=[]){let a=[];return D.Children.forEach(e,(s,i)=>{if(!D.isValidElement(s))return;let u=[...n,i];if(s.type===D.Fragment){a.push.apply(a,cd(s.props.children,u));return}Rt(s.type===G0,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Rt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let f={id:s.props.id||u.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(f.children=cd(s.props.children,u)),a.push(f)}),a}var $0="get",X0="application/x-www-form-urlencoded";function go(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function S4(e){return go(e)&&e.tagName.toLowerCase()==="button"}function E4(e){return go(e)&&e.tagName.toLowerCase()==="form"}function N4(e){return go(e)&&e.tagName.toLowerCase()==="input"}function T4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function _4(e,n){return e.button===0&&(!n||n==="_self")&&!T4(e)}var j0=null;function A4(){if(j0===null)try{new FormData(document.createElement("form"),0),j0=!1}catch{j0=!0}return j0}var C4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vf(e){return e!=null&&!C4.has(e)?(hr(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${X0}"`),null):e}function j4(e,n){let a,s,i,u,f;if(E4(e)){let d=e.getAttribute("action");s=d?un(d,n):null,a=e.getAttribute("method")||$0,i=Vf(e.getAttribute("enctype"))||X0,u=new FormData(e)}else if(S4(e)||N4(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=e.getAttribute("formaction")||d.getAttribute("action");if(s=m?un(m,n):null,a=e.getAttribute("formmethod")||d.getAttribute("method")||$0,i=Vf(e.getAttribute("formenctype"))||Vf(d.getAttribute("enctype"))||X0,u=new FormData(d,e),!A4()){let{name:x,type:g,value:v}=e;if(g==="image"){let b=x?`${x}.`:"";u.append(`${b}x`,"0"),u.append(`${b}y`,"0")}else x&&u.append(x,v)}}else{if(go(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=$0,s=null,i=X0,f=e}return u&&i==="text/plain"&&(f=u,u=void 0),{action:s,method:a.toLowerCase(),encType:i,formData:u,body:f}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Id(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function O4(e,n,a){let s=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return s.pathname==="/"?s.pathname=`_root.${a}`:n&&un(s.pathname,n)==="/"?s.pathname=`${n.replace(/\/$/,"")}/_root.${a}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${a}`,s}async function R4(e,n){if(e.id in n)return n[e.id];try{let a=await import(e.module);return n[e.id]=a,a}catch(a){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function D4(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function F4(e,n,a){let s=await Promise.all(e.map(async i=>{let u=n.routes[i.route.id];if(u){let f=await R4(u,a);return f.links?f.links():[]}return[]}));return B4(s.flat(1).filter(D4).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function kp(e,n,a,s,i,u){let f=(m,x)=>a[x]?m.route.id!==a[x].route.id:!0,d=(m,x)=>{var g;return a[x].pathname!==m.pathname||((g=a[x].route.path)==null?void 0:g.endsWith("*"))&&a[x].params["*"]!==m.params["*"]};return u==="assets"?n.filter((m,x)=>f(m,x)||d(m,x)):u==="data"?n.filter((m,x)=>{var v;let g=s.routes[m.route.id];if(!g||!g.hasLoader)return!1;if(f(m,x)||d(m,x))return!0;if(m.route.shouldRevalidate){let b=m.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((v=a[0])==null?void 0:v.params)||{},nextUrl:new URL(e,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function M4(e,n,{includeHydrateFallback:a}={}){return L4(e.map(s=>{let i=n.routes[s.route.id];if(!i)return[];let u=[i.module];return i.clientActionModule&&(u=u.concat(i.clientActionModule)),i.clientLoaderModule&&(u=u.concat(i.clientLoaderModule)),a&&i.hydrateFallbackModule&&(u=u.concat(i.hydrateFallbackModule)),i.imports&&(u=u.concat(i.imports)),u}).flat(1))}function L4(e){return[...new Set(e)]}function I4(e){let n={},a=Object.keys(e).sort();for(let s of a)n[s]=e[s];return n}function B4(e,n){let a=new Set;return new Set(n),e.reduce((s,i)=>{let u=JSON.stringify(I4(i));return a.has(u)||(a.add(u),s.push({key:u,link:i})),s},[])}function tv(){let e=D.useContext(Tl);return Id(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function z4(){let e=D.useContext(po);return Id(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Bd=D.createContext(void 0);Bd.displayName="FrameworkContext";function av(){let e=D.useContext(Bd);return Id(e,"You must render this element inside a <HydratedRouter> element"),e}function U4(e,n){let a=D.useContext(Bd),[s,i]=D.useState(!1),[u,f]=D.useState(!1),{onFocus:d,onBlur:m,onMouseEnter:x,onMouseLeave:g,onTouchStart:v}=n,b=D.useRef(null);D.useEffect(()=>{if(e==="render"&&f(!0),e==="viewport"){let w=_=>{_.forEach(O=>{f(O.isIntersecting)})},N=new IntersectionObserver(w,{threshold:.5});return b.current&&N.observe(b.current),()=>{N.disconnect()}}},[e]),D.useEffect(()=>{if(s){let w=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(w)}}},[s]);let k=()=>{i(!0)},y=()=>{i(!1),f(!1)};return a?e!=="intent"?[u,b,{}]:[u,b,{onFocus:Ei(d,k),onBlur:Ei(m,y),onMouseEnter:Ei(x,k),onMouseLeave:Ei(g,y),onTouchStart:Ei(v,k)}]:[!1,b,{}]}function Ei(e,n){return a=>{e&&e(a),a.defaultPrevented||n(a)}}function P4({page:e,...n}){let{router:a}=tv(),s=D.useMemo(()=>Pg(a.routes,e,a.basename),[a.routes,e,a.basename]);return s?D.createElement(V4,{page:e,matches:s,...n}):null}function H4(e){let{manifest:n,routeModules:a}=av(),[s,i]=D.useState([]);return D.useEffect(()=>{let u=!1;return F4(e,n,a).then(f=>{u||i(f)}),()=>{u=!0}},[e,n,a]),s}function V4({page:e,matches:n,...a}){let s=dn(),{manifest:i,routeModules:u}=av(),{basename:f}=tv(),{loaderData:d,matches:m}=z4(),x=D.useMemo(()=>kp(e,n,m,i,s,"data"),[e,n,m,i,s]),g=D.useMemo(()=>kp(e,n,m,i,s,"assets"),[e,n,m,i,s]),v=D.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let y=new Set,w=!1;if(n.forEach(_=>{var E;let O=i.routes[_.route.id];!O||!O.hasLoader||(!x.some(L=>L.route.id===_.route.id)&&_.route.id in d&&((E=u[_.route.id])!=null&&E.shouldRevalidate)||O.hasClientLoader?w=!0:y.add(_.route.id))}),y.size===0)return[];let N=O4(e,f,"data");return w&&y.size>0&&N.searchParams.set("_routes",n.filter(_=>y.has(_.route.id)).map(_=>_.route.id).join(",")),[N.pathname+N.search]},[f,d,s,i,x,n,e,u]),b=D.useMemo(()=>M4(g,i),[g,i]),k=H4(g);return D.createElement(D.Fragment,null,v.map(y=>D.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...a})),b.map(y=>D.createElement("link",{key:y,rel:"modulepreload",href:y,...a})),k.map(({key:y,link:w})=>D.createElement("link",{key:y,nonce:a.nonce,...w})))}function G4(...e){return n=>{e.forEach(a=>{typeof a=="function"?a(n):a!=null&&(a.current=n)})}}var $4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{$4&&(window.__reactRouterVersion="7.11.0")}catch{}function X4({basename:e,children:n,unstable_useTransitions:a,window:s}){let i=D.useRef();i.current==null&&(i.current=Tk({window:s,v5Compat:!0}));let u=i.current,[f,d]=D.useState({action:u.action,location:u.location}),m=D.useCallback(x=>{a===!1?d(x):D.startTransition(()=>d(x))},[a]);return D.useLayoutEffect(()=>u.listen(m),[u,m]),D.createElement(k4,{basename:e,children:n,location:f.location,navigationType:f.action,navigator:u,unstable_useTransitions:a})}var rv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nv=D.forwardRef(function({onClick:n,discover:a="render",prefetch:s="none",relative:i,reloadDocument:u,replace:f,state:d,target:m,to:x,preventScrollReset:g,viewTransition:v,unstable_defaultShouldRevalidate:b,...k},y){let{basename:w,unstable_useTransitions:N}=D.useContext(Ka),_=typeof x=="string"&&rv.test(x),O=Xg(x,w);x=O.to;let E=l4(x,{relative:i}),[L,G,H]=U4(s,k),R=W4(x,{replace:f,state:d,target:m,preventScrollReset:g,relative:i,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:N});function Z(Q){n&&n(Q),Q.defaultPrevented||R(Q)}let Y=D.createElement("a",{...k,...H,href:O.absoluteURL||E,onClick:O.isExternal||u?n:Z,ref:G4(y,G),target:m,"data-discover":!_&&a==="render"?"true":void 0});return L&&!_?D.createElement(D.Fragment,null,Y,D.createElement(P4,{page:E})):Y});nv.displayName="Link";var Y4=D.forwardRef(function({"aria-current":n="page",caseSensitive:a=!1,className:s="",end:i=!1,style:u,to:f,viewTransition:d,children:m,...x},g){let v=lc(f,{relative:x.relative}),b=dn(),k=D.useContext(po),{navigator:y,basename:w}=D.useContext(Ka),N=k!=null&&tw(v)&&d===!0,_=y.encodeLocation?y.encodeLocation(v).pathname:v.pathname,O=b.pathname,E=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;a||(O=O.toLowerCase(),E=E?E.toLowerCase():null,_=_.toLowerCase()),E&&w&&(E=un(E,w)||E);const L=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let G=O===_||!i&&O.startsWith(_)&&O.charAt(L)==="/",H=E!=null&&(E===_||!i&&E.startsWith(_)&&E.charAt(_.length)==="/"),R={isActive:G,isPending:H,isTransitioning:N},Z=G?n:void 0,Y;typeof s=="function"?Y=s(R):Y=[s,G?"active":null,H?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let Q=typeof u=="function"?u(R):u;return D.createElement(nv,{...x,"aria-current":Z,className:Y,ref:g,style:Q,to:f,viewTransition:d},typeof m=="function"?m(R):m)});Y4.displayName="NavLink";var q4=D.forwardRef(({discover:e="render",fetcherKey:n,navigate:a,reloadDocument:s,replace:i,state:u,method:f=$0,action:d,onSubmit:m,relative:x,preventScrollReset:g,viewTransition:v,unstable_defaultShouldRevalidate:b,...k},y)=>{let{unstable_useTransitions:w}=D.useContext(Ka),N=Q4(),_=ew(d,{relative:x}),O=f.toLowerCase()==="get"?"get":"post",E=typeof d=="string"&&rv.test(d),L=G=>{if(m&&m(G),G.defaultPrevented)return;G.preventDefault();let H=G.nativeEvent.submitter,R=(H==null?void 0:H.getAttribute("formmethod"))||f,Z=()=>N(H||G.currentTarget,{fetcherKey:n,method:R,navigate:a,replace:i,state:u,relative:x,preventScrollReset:g,viewTransition:v,unstable_defaultShouldRevalidate:b});w&&a!==!1?D.startTransition(()=>Z()):Z()};return D.createElement("form",{ref:y,method:O,action:_,onSubmit:s?m:L,...k,"data-discover":!E&&e==="render"?"true":void 0})});q4.displayName="Form";function K4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sv(e){let n=D.useContext(Tl);return Rt(n,K4(e)),n}function W4(e,{target:n,replace:a,state:s,preventScrollReset:i,relative:u,viewTransition:f,unstable_defaultShouldRevalidate:d,unstable_useTransitions:m}={}){let x=sc(),g=dn(),v=lc(e,{relative:u});return D.useCallback(b=>{if(_4(b,n)){b.preventDefault();let k=a!==void 0?a:Vi(g)===Vi(v),y=()=>x(e,{replace:k,state:s,preventScrollReset:i,relative:u,viewTransition:f,unstable_defaultShouldRevalidate:d});m?D.startTransition(()=>y()):y()}},[g,x,v,a,s,n,e,i,u,f,d,m])}var Z4=0,J4=()=>`__${String(++Z4)}__`;function Q4(){let{router:e}=sv("useSubmit"),{basename:n}=D.useContext(Ka),a=g4(),s=e.fetch,i=e.navigate;return D.useCallback(async(u,f={})=>{let{action:d,method:m,encType:x,formData:g,body:v}=j4(u,n);if(f.navigate===!1){let b=f.fetcherKey||J4();await s(b,a,f.action||d,{unstable_defaultShouldRevalidate:f.unstable_defaultShouldRevalidate,preventScrollReset:f.preventScrollReset,formData:g,body:v,formMethod:f.method||m,formEncType:f.encType||x,flushSync:f.flushSync})}else await i(f.action||d,{unstable_defaultShouldRevalidate:f.unstable_defaultShouldRevalidate,preventScrollReset:f.preventScrollReset,formData:g,body:v,formMethod:f.method||m,formEncType:f.encType||x,replace:f.replace,state:f.state,fromRouteId:a,flushSync:f.flushSync,viewTransition:f.viewTransition})},[s,i,n,a])}function ew(e,{relative:n}={}){let{basename:a}=D.useContext(Ka),s=D.useContext(Ir);Rt(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),u={...lc(e||".",{relative:n})},f=dn();if(e==null){u.search=f.search;let d=new URLSearchParams(u.search),m=d.getAll("index");if(m.some(g=>g==="")){d.delete("index"),m.filter(v=>v).forEach(v=>d.append("index",v));let g=d.toString();u.search=g?`?${g}`:""}}return(!e||e===".")&&i.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(u.pathname=u.pathname==="/"?a:ln([a,u.pathname])),Vi(u)}function tw(e,{relative:n}={}){let a=D.useContext(qg);Rt(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=sv("useViewTransitionState"),i=lc(e,{relative:n});if(!a.isTransitioning)return!1;let u=un(a.currentLocation.pathname,s)||a.currentLocation.pathname,f=un(a.nextLocation.pathname,s)||a.nextLocation.pathname;return Z0(i.pathname,f)!=null||Z0(i.pathname,u)!=null}var aw=Ug();const rw=jd(aw),Gf={},rt=(Gf==null?void 0:Gf.VITE_API_URL)!==void 0?void 0:"",qn=()=>localStorage.getItem("token"),nw=e=>{localStorage.setItem("token",e)},J0=()=>{localStorage.removeItem("token"),sessionStorage.clear()},vo=e=>{try{const a=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(a).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch(n){return console.error("Error decoding token:",n),null}},Q0=()=>{const e=qn();if(!e)return null;const n=vo(e);return n?n.exp&&n.exp*1e3<Date.now()?(J0(),null):{id:n.userId,username:n.username,role:n.role,storeId:n.storeId,store_id:n.storeId,storeName:n.storeName||"Store",organizationId:n.organizationId}:null},sw=()=>{const e=qn();if(!e)return;const n=vo(e);if(!(n!=null&&n.exp))return;const a=new Date(n.exp*1e3),s=new Date,i=a.getTime()-s.getTime(),u=Math.floor(i/(1e3*60*60*24));u>0&&u<=7&&(console.warn(` TOKEN EXPIRATION WARNING: Your session will expire in ${u} day(s)`),console.warn(`   Expiration date: ${a.toLocaleString("es-MX")}`),sessionStorage.getItem("tokenExpirationWarningShown")||setTimeout(()=>{alert(` Aviso: Tu sesin expirar en ${u} da(s).

Fecha de expiracin: ${a.toLocaleDateString("es-MX")}

Por favor, guarda tu trabajo y vuelve a iniciar sesin pronto.`),sessionStorage.setItem("tokenExpirationWarningShown","true")},2e3))},wp=()=>{const e=qn();if(!e)return console.log(" Token Validation: No token found"),!1;const n=vo(e);if(!n)return console.error(" Token Validation: Failed to decode token (corrupted)"),!1;if(n.exp&&n.exp*1e3<Date.now()+3e4){const i=new Date(n.exp*1e3),u=new Date;return console.error(" Token Validation: Token expired"),console.error(`   Expired at: ${i.toLocaleString("es-MX")}`),console.error(`   Current time: ${u.toLocaleString("es-MX")}`),!1}const a=n.exp*1e3-Date.now(),s=Math.floor(a/(1e3*60*60*24));return console.log(` Token Validation:  Valid (${s} days remaining)`),!0},lw=()=>{if(window.location.pathname==="/login"){console.warn(" Session invalid, but user is already on login page. Clearing token silently."),J0(),localStorage.removeItem("cashSession");return}console.error(" SESSION EXPIRED - Cleaning up and redirecting to login");const n=qn();let a="";if(n)try{const s=vo(n);if(s!=null&&s.exp){const i=new Date(s.exp*1e3),f=Math.floor((new Date().getTime()-i.getTime())/(1e3*60*60*24));f>0?a=`

Tu sesin expir hace ${f} da(s).`:a=`

Tu sesin ha expirado.`}}catch(s){console.warn("Could not decode token for expiration info:",s)}J0(),localStorage.removeItem("cashSession"),alert(` Tu sesin ha expirado${a}

Por favor, inicia sesin nuevamente para continuar.`),window.location.href="/login"},iw=async e=>{if(!e.ok){const n=await e.text();throw new Error(n||`HTTP Error ${e.status}`)}return e},cw=async e=>{if(e.status===401)throw console.error(" 401 Unauthorized - Session expired or invalid credentials"),lw(),new Error("SESIN_EXPIRADA");if(!e.ok){const n=await e.text();throw new Error(n||`HTTP Error ${e.status}`)}return e},lv=(e,n)=>{if(e.name==="TypeError"&&e.message.includes("Failed to fetch")){console.error(" Network Error (CORS/Server Down):",e),rt.startsWith("https");let a;throw a=` Error de Conexin:
No se pudo conectar al servidor.

Posibles causas:
 El servidor est en mantenimiento
 Problema de conexin a internet
 Verifica que el backend est corriendo`,alert(a),new Error("NETWORK_ERROR")}throw e},$f=async(e,n={})=>{try{const a=await fetch(e,{...n,headers:{"Content-Type":"application/json",...n.headers}});return iw(a)}catch(a){return lv(a)}},It=async(e,n={})=>{const a=qn();if(!a)throw console.error(" No authentication token available"),new Error("No authentication token available");try{const s=await fetch(e,{...n,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,...n.headers}});return cw(s)}catch(s){return lv(s)}},nn=()=>{const e=qn();return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},zd={register:async e=>(await $f(`${rt}/api/auth/register`,{method:"POST",body:JSON.stringify(e)})).json(),login:async(e,n)=>(await $f(`${rt}/api/auth/login`,{method:"POST",body:JSON.stringify({usuario:e,password:n})})).json(),requestPasswordReset:async(e,n)=>(await $f(`${rt}/api/auth/request-password-reset`,{method:"POST",body:JSON.stringify({email:e,phone:n})})).json(),updateProfile:async e=>(await It(`${rt}/api/me/profile`,{method:"PUT",body:JSON.stringify(e)})).json(),adminUpdateStore:async(e,n)=>(await It(`${rt}/api/admin/update-store`,{method:"POST",body:JSON.stringify({targetStoreId:e,...n})})).json()},zn={getAll:async e=>{let a=[],s=1,i=1;try{let u=`${rt}/api/productos`;const f=[`page=${s}`,"limit=50"];e!=null&&e.storeId&&f.push(`storeId=${e.storeId}`);const d=`${u}?${f.join("&")}`,x=await(await It(d,{})).json();if(x.data&&Array.isArray(x.data)){for(a=[...x.data],i=x.totalPages||1,s++;s<=i;){const g=`${u}?${f.map(k=>k.startsWith("page=")?`page=${s}`:k).join("&")}`,b=await(await It(g,{})).json();b.data&&(a=[...a,...b.data]),s++}return a}else if(Array.isArray(x))return x;return[]}catch(u){throw console.error("Error fetching products chunked:",u),u}},create:async e=>(await It(`${rt}/api/productos`,{method:"POST",body:JSON.stringify(e)})).json(),update:async(e,n)=>(await It(`${rt}/api/productos/${e}`,{method:"PUT",body:JSON.stringify(n)})).json(),delete:async e=>(await It(`${rt}/api/productos/${e}`,{method:"DELETE"})).json(),bulkImport:async e=>(await It(`${rt}/api/products/bulk`,{method:"POST",body:JSON.stringify(e)})).json()},iv={getMovements:async e=>{let n=`${rt}/api/inventory/movements`;if(e){const s=[];e.storeId&&s.push(`storeId=${e.storeId}`),e.productId&&s.push(`productId=${e.productId}`),e.type&&s.push(`type=${e.type}`),e.page&&s.push(`page=${e.page}`),e.limit&&s.push(`limit=${e.limit}`),s.length>0&&(n+=`?${s.join("&")}`)}return(await It(n)).json()},createMovement:async e=>(await It(`${rt}/api/inventory/movements`,{method:"POST",body:JSON.stringify(e)})).json()},Y0={getAll:async()=>(await It(`${rt}/api/stores`,{})).json(),create:async e=>(await It(`${rt}/api/stores/new`,{method:"POST",body:JSON.stringify(e)})).json(),delete:async(e,n)=>(await It(`${rt}/api/stores/${e}`,{method:"DELETE",body:JSON.stringify({password:n})})).json()},gs={getAll:async e=>{let n=`${rt}/api/ventas`;return e!=null&&e.storeId&&(n+=`?storeId=${e.storeId}`),(await(await It(n,{})).json()).map(i=>({...i,date:i.createdAt||i.date}))},getById:async e=>{const a=await(await It(`${rt}/api/ventas/${e}`,{})).json();return{...a,date:a.createdAt||a.date}},cancel:async e=>(await It(`${rt}/api/ventas/${e}/cancel`,{method:"PUT"})).json(),create:async e=>(await It(`${rt}/api/ventas`,{method:"POST",body:JSON.stringify(e)})).json(),sync:async e=>(await It(`${rt}/api/ventas/sync`,{method:"POST",body:JSON.stringify({sales:e})})).json()},ow={getSummary:async(e,n)=>{let a=`${rt}/api/dashboard/summary?period=${e}`;return n&&(a+=`&storeId=${n}`),(await It(a,{})).json()}},uw={getAll:async()=>(await It(`${rt}/api/tickets`,{})).json(),create:async e=>(await It(`${rt}/api/tickets`,{method:"POST",body:JSON.stringify(e)})).json(),update:async(e,n)=>(await It(`${rt}/api/tickets/${e}`,{method:"PUT",body:JSON.stringify(n)})).json()},od=(e,n)=>n.some(a=>e instanceof a);let Sp,Ep;function fw(){return Sp||(Sp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dw(){return Ep||(Ep=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ud=new WeakMap,Xf=new WeakMap,bo=new WeakMap;function hw(e){const n=new Promise((a,s)=>{const i=()=>{e.removeEventListener("success",u),e.removeEventListener("error",f)},u=()=>{a(bs(e.result)),i()},f=()=>{s(e.error),i()};e.addEventListener("success",u),e.addEventListener("error",f)});return bo.set(n,e),n}function xw(e){if(ud.has(e))return;const n=new Promise((a,s)=>{const i=()=>{e.removeEventListener("complete",u),e.removeEventListener("error",f),e.removeEventListener("abort",f)},u=()=>{a(),i()},f=()=>{s(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",u),e.addEventListener("error",f),e.addEventListener("abort",f)});ud.set(e,n)}let fd={get(e,n,a){if(e instanceof IDBTransaction){if(n==="done")return ud.get(e);if(n==="store")return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return bs(e[n])},set(e,n,a){return e[n]=a,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function cv(e){fd=e(fd)}function mw(e){return dw().includes(e)?function(...n){return e.apply(dd(this),n),bs(this.request)}:function(...n){return bs(e.apply(dd(this),n))}}function pw(e){return typeof e=="function"?mw(e):(e instanceof IDBTransaction&&xw(e),od(e,fw())?new Proxy(e,fd):e)}function bs(e){if(e instanceof IDBRequest)return hw(e);if(Xf.has(e))return Xf.get(e);const n=pw(e);return n!==e&&(Xf.set(e,n),bo.set(n,e)),n}const dd=e=>bo.get(e);function gw(e,n,{blocked:a,upgrade:s,blocking:i,terminated:u}={}){const f=indexedDB.open(e,n),d=bs(f);return s&&f.addEventListener("upgradeneeded",m=>{s(bs(f.result),m.oldVersion,m.newVersion,bs(f.transaction),m)}),a&&f.addEventListener("blocked",m=>a(m.oldVersion,m.newVersion,m)),d.then(m=>{u&&m.addEventListener("close",()=>u()),i&&m.addEventListener("versionchange",x=>i(x.oldVersion,x.newVersion,x))}).catch(()=>{}),d}const vw=["get","getKey","getAll","getAllKeys","count"],bw=["put","add","delete","clear"],Yf=new Map;function Np(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(Yf.get(n))return Yf.get(n);const a=n.replace(/FromIndex$/,""),s=n!==a,i=bw.includes(a);if(!(a in(s?IDBIndex:IDBObjectStore).prototype)||!(i||vw.includes(a)))return;const u=async function(f,...d){const m=this.transaction(f,i?"readwrite":"readonly");let x=m.store;return s&&(x=x.index(d.shift())),(await Promise.all([x[a](...d),i&&m.done]))[0]};return Yf.set(n,u),u}cv(e=>({...e,get:(n,a,s)=>Np(n,a)||e.get(n,a,s),has:(n,a)=>!!Np(n,a)||e.has(n,a)}));const yw=["continue","continuePrimaryKey","advance"],Tp={},hd=new WeakMap,ov=new WeakMap,kw={get(e,n){if(!yw.includes(n))return e[n];let a=Tp[n];return a||(a=Tp[n]=function(...s){hd.set(this,ov.get(this)[n](...s))}),a}};async function*ww(...e){let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...e)),!n)return;n=n;const a=new Proxy(n,kw);for(ov.set(a,n),bo.set(a,dd(n));n;)yield a,n=await(hd.get(a)||n.continue()),hd.delete(a)}function _p(e,n){return n===Symbol.asyncIterator&&od(e,[IDBIndex,IDBObjectStore,IDBCursor])||n==="iterate"&&od(e,[IDBIndex,IDBObjectStore])}cv(e=>({...e,get(n,a,s){return _p(n,a)?ww:e.get(n,a,s)},has(n,a){return _p(n,a)||e.has(n,a)}}));let O0=null;const Ud=async()=>O0||(O0=await gw("teikon-pos",1,{upgrade(e){e.createObjectStore("pendingSales",{keyPath:"tempId"}).createIndex("by-date","createdAt")}}),O0),Sw=async e=>{await(await Ud()).add("pendingSales",e)},Ew=async()=>await(await Ud()).getAll("pendingSales"),Nw=async()=>{await(await Ud()).clear("pendingSales")};function qf(e,n){return!e||Object.keys(e).length===0?null:e.id?{id:e.id,startTime:e.start_time||e.startTime||new Date().toISOString(),startBalance:parseFloat(e.initial_amount||e.initialAmount||0),expectedBalance:parseFloat(e.expected_amount||e.expectedAmount||e.initial_amount||e.initialAmount||0),cashSales:parseFloat(e.cash_sales||e.cashSales||0),refunds:0,status:"OPEN",ownerId:n||e.opened_by||e.ownerId}:(console.warn(" Invalid shift data received:",e),null)}function R0(e){return{...e,name:e.nombre||e.name||"Sin Nombre",category:e.categoria||e.category||"General",image:e.imagen||e.image,costPrice:Number(e.costPrice||0),salePrice:Number(e.salePrice||0),isActive:e.activo!==void 0?e.activo:e.isActive!==void 0?e.isActive:!0}}function Ap(e,n){return{sku:e.sku,nombre:e.name,categoria:e.category||"",costPrice:e.costPrice,salePrice:e.salePrice,stock:e.stock||0,minStock:e.minStock||0,taxRate:e.taxRate||0,imagen:e.image,activo:e.isActive!==void 0?e.isActive:!0,storeId:n}}function Tw(e,n="operation"){if(!e||e.trim()==="")throw new Error(`Store ID is required for ${n}. Please select a store.`);return!0}function _w(e){if(e!=null&&e.storeId)return e.storeId;try{const n=localStorage.getItem("selectedStore");if(n){const a=JSON.parse(n),s=typeof a=="object"?a.id||a.storeId:a;if(s)return console.log(" Recovered storeId from localStorage:",s),s}}catch(n){console.warn(" Failed to parse selectedStore from localStorage:",n)}return console.warn(" No storeId found in any source"),null}const uv=D.createContext(void 0),Aw=({children:e})=>{const n=(pe,we,be=!1)=>{try{return localStorage.setItem(pe,we),!0}catch(xe){if(xe.name==="QuotaExceededError"||xe.code===22)if(console.error(` Storage quota exceeded while saving '${pe}'`),be){console.warn("   Clearing non-critical cache to save critical data...");try{return localStorage.removeItem("cachedProducts"),localStorage.removeItem("cachedSales"),localStorage.setItem(pe,we),console.log(` Critical data '${pe}' saved after clearing cache`),!0}catch{return console.error(` Failed to save '${pe}' even after clearing cache`),!1}}else return console.warn(`   Skipping non-critical data '${pe}' due to quota`),!1;else return console.error(` Unexpected error saving '${pe}':`,xe),!1}},[a,s]=D.useState(()=>Q0()),[i,u]=D.useState([]),[f,d]=D.useState([]),[m,x]=D.useState([]),[g,v]=D.useState({monthlyFixedCosts:1e4}),[b,k]=D.useState(navigator.onLine),[y,w]=D.useState(!1),[N,_]=D.useState(!0),[O,E]=D.useState(!1),[L,G]=D.useState(!1),[H,R]=D.useState(null),Z=m.find(pe=>pe.status==="OPEN")||null,Y=!!Z;D.useEffect(()=>{const pe=()=>k(navigator.onLine);return window.addEventListener("online",pe),window.addEventListener("offline",pe),()=>{window.removeEventListener("online",pe),window.removeEventListener("offline",pe)}},[]);const Q=D.useRef(!1),K=D.useRef(null),ee=D.useRef(!1),Ee=pe=>{try{const we=new Date(pe.startTime),be=new Date;return we.toDateString()===be.toDateString()}catch(we){return console.warn(" Failed to parse session date:",we),!1}};D.useEffect(()=>{const pe=a==null?void 0:a.id,we=a==null?void 0:a.role;let be=a==null?void 0:a.storeId;if(!be){const Le=localStorage.getItem("selectedStore");if(Le)try{const De=JSON.parse(Le);be=typeof De=="object"?De.id||De.storeId:De}catch{be=Le}}if(!a){console.log(" No user logged in, skipping session recovery"),_(!1);return}if(Q.current){console.log(" Session check already in progress, skipping...");return}if(be&&be===K.current&&Z){console.log(" Session already loaded for this store, skipping check"),_(!1);return}if(!b){_(!1);return}if(!be&&we!=="SUPER_ADMIN"){console.warn(" No storeId available for session recovery"),_(!1);return}if(we==="SUPER_ADMIN"){console.log(" SUPER_ADMIN detected - Skipping active shift requirement"),_(!1);return}(async()=>{Q.current=!0,_(!0);try{console.log(` Recovering active shift for store: ${be}`);const Le=new AbortController,De=setTimeout(()=>Le.abort(),1e4),Ye=await fetch(`${rt}/api/shifts/current?storeId=${be}`,{headers:nn(),signal:Le.signal});if(clearTimeout(De),Ye.ok){const qe=Ye.headers.get("content-type");if(!qe||!qe.includes("application/json")){console.warn(" Server returned non-JSON response"),x([]),localStorage.removeItem("cashSession"),_(!1);return}const ze=await Ye.json();if(console.log(" Session Found:",ze),!ze||Object.keys(ze).length===0){console.log(" No active session (Data is null/empty)"),x([]),localStorage.removeItem("cashSession"),K.current=be||null,_(!1);return}const Pe=qf(ze,pe);if(!Pe){console.warn(" Mapper returned null (Invalid Data)"),x([]),localStorage.removeItem("cashSession"),_(!1);return}if(!Ee(Pe)){console.log(" Backend session is from previous day, clearing..."),localStorage.removeItem("cashSession"),x([]),K.current=be||null,_(!1);return}console.log(" Active session restored:",Pe.id),x([Pe]),localStorage.setItem("cashSession",JSON.stringify(Pe)),K.current=be||null,_(!1)}else if(Ye.status===204||Ye.status===404)console.log(" No active session found (User must open shift)"),x([]),localStorage.removeItem("cashSession"),K.current=be||null,_(!1);else{console.error(` Session check failed with status: ${Ye.status}`);const qe=Ye.headers.get("content-type");if(qe!=null&&qe.includes("application/json"))try{const ze=await Ye.json();console.error("   Error details:",ze)}catch{console.warn("   Could not parse error response")}x([]),localStorage.removeItem("cashSession"),K.current=be||null,_(!1)}}catch(Le){console.error(" Error in checkSession:",Le);const De=Le.name==="AbortError"||Le instanceof TypeError&&Le.message.includes("fetch")||!navigator.onLine,Ye=Le instanceof SyntaxError;if(Le.name==="AbortError"?(console.error("   Type: Session recovery timeout (10s exceeded)"),console.warn("   Backend may be slow or unreachable")):Le instanceof TypeError&&Le.message.includes("fetch")?(console.error("   Type: Network error - Cannot reach backend"),console.warn("   Check if server is running and accessible")):Ye?(console.error("   Type: JSON parse error - Backend returned invalid data"),console.warn("   Backend may have returned HTML instead of JSON")):console.error("   Type: Unexpected error"),De){console.log(" Network error detected - Attempting localStorage fallback...");try{const qe=localStorage.getItem("cashSession");if(qe){const ze=JSON.parse(qe);if(Ee(ze)){console.log(" Loaded session from localStorage fallback (today):",ze.id),x([ze]),K.current=be||null,_(!1);return}else console.log(" Cached session is from previous day, clearing..."),localStorage.removeItem("cashSession")}}catch(qe){console.warn(" Could not load cached session:",qe)}}else console.warn(" Non-network error detected - Clearing stale localStorage data"),localStorage.removeItem("cashSession");x([]),_(!1)}finally{_(!1),Q.current=!1}})()},[a==null?void 0:a.id,a==null?void 0:a.storeId,a==null?void 0:a.role,b]);const Ne=D.useCallback(async()=>{if(!(!a||!b)){w(!0),R(null);try{const pe=await Ew();if(pe.length>0){console.log(`Syncing ${pe.length} offline sales...`);try{await gs.sync(pe),await Nw(),console.log(" Offline sales synced successfully")}catch(De){De.message&&De.message.includes("NO_OPEN_SHIFT")?(console.warn(" Cannot sync offline sales: No open shift."),alert("Caja Cerrada: Abre un turno para sincronizar las ventas pendientes.")):console.warn(" Failed to sync offline sales, will retry later:",De)}}const we=async(De,Ye=1e4)=>{const qe=new Promise((ze,Pe)=>setTimeout(()=>Pe(new Error("REQUEST_TIMEOUT")),Ye));return Promise.race([De,qe])},[be,xe]=await Promise.all([we(zn.getAll()),we(gs.getAll())]),Le=Array.isArray(be)?be.map(R0):[];u(Le),d(xe),w(!1);try{const De=Le.map(Ue=>({id:Ue.id,name:Ue.name,category:Ue.category,sku:Ue.sku,costPrice:Ue.costPrice,salePrice:Ue.salePrice,stock:Ue.stock,isActive:Ue.isActive})),Ye=xe.slice(-30),qe=JSON.stringify(De).length,ze=JSON.stringify(Ye).length,Pe=qe+ze;console.log(` Caching data: ${(Pe/1024).toFixed(2)} KB`),Pe>1e6&&console.warn(" Cache size exceeds 1MB, consider reducing data"),localStorage.setItem("cachedProducts",JSON.stringify(De)),localStorage.setItem("cachedSales",JSON.stringify(Ye)),console.log(" Data cached successfully for offline use")}catch(De){if(De.name==="QuotaExceededError"||De.code===22){console.error(" Storage quota exceeded!"),console.warn("   Clearing old cache and retrying with minimal data...");try{["cachedProducts","cachedSales","pendingSales"].forEach(Pe=>{try{localStorage.removeItem(Pe),console.log(`   Removed: ${Pe}`)}catch{console.warn(`   Failed to remove ${Pe}`)}});const qe=Le.slice(0,10).map(Pe=>({id:Pe.id,name:Pe.name,sku:Pe.sku,salePrice:Pe.salePrice,stock:Pe.stock})),ze=xe.slice(-5);localStorage.setItem("cachedProducts",JSON.stringify(qe)),localStorage.setItem("cachedSales",JSON.stringify(ze)),console.log(" Minimal cache saved successfully")}catch(Ye){console.error(" Failed to save even minimal cache:",Ye),console.warn("   App will work online-only until cache is cleared manually")}}else console.warn(" Failed to cache data (non-quota error):",De)}console.log(" Data synced successfully from SaaS server")}catch(pe){if(console.error(" Data Sync Error:",pe),pe.message==="SESIN_EXPIRADA"){Ae(),w(!1);return}if(pe.message==="NETWORK_ERROR"||pe.message==="REQUEST_TIMEOUT"||pe.name==="TypeError"){console.warn(" Servidor SaaS no disponible - Activando Modo Offline"),R("Modo Offline: No se pudo conectar al servidor. Los datos se sincronizarn cuando vuelva la conexin."),k(!1);try{const we=localStorage.getItem("cachedProducts"),be=localStorage.getItem("cachedSales");we&&(u(JSON.parse(we)),console.log(" Loaded products from cache")),be&&(d(JSON.parse(be)),console.log(" Loaded sales from cache"))}catch(we){console.error("Failed to load cached data:",we)}w(!1),setTimeout(()=>{console.log(" Retrying connection to SaaS server..."),k(navigator.onLine),navigator.onLine&&Ne()},3e4);return}R("Error al sincronizar datos. La app funcionar con datos locales."),w(!1)}}},[a,b]),me=D.useCallback(async()=>{if(!(!a||!b)){if(L){console.log(" Background sync skipped: Transaction in progress");return}try{console.log(" Background sync: Refreshing product data...");const pe=await zn.getAll(),we=Array.isArray(pe)?pe.map(R0):[];u(we);try{const be=we.map(xe=>({id:xe.id,name:xe.name,category:xe.category,sku:xe.sku,costPrice:xe.costPrice,salePrice:xe.salePrice,stock:xe.stock,isActive:xe.isActive}));n("cachedProducts",JSON.stringify(be),!1),console.log(" Background sync: Products updated and cached")}catch(be){console.warn(" Background sync: Failed to process data:",be)}}catch(pe){console.warn(" Background sync failed (will retry):",pe)}}},[a,b,L]);D.useEffect(()=>{Ne()},[Ne]),D.useEffect(()=>{if(!a||!b)return;const pe=setInterval(()=>{me()},3e5);return console.log(" Background sync enabled (every 5 min)"),()=>{clearInterval(pe),console.log(" Background sync disabled")}},[a,b,me]);const J=pe=>{if(a){const we={...a,...pe};s(we)}},se=pe=>{nw(pe);const we=Q0();s(we)},Ae=()=>{localStorage.removeItem("token"),localStorage.removeItem("currentUser"),localStorage.removeItem("cashSession"),localStorage.removeItem("activeSession"),localStorage.removeItem("selectedStore"),s(null),u([]),d([]),x([]),console.log(" Logout: All data cleared")},ae=()=>{if((a==null?void 0:a.role)==="SUPER_ADMIN")return Ae(),!0;const pe=m.find(we=>we.status==="OPEN");return pe?(console.warn(" safeLogout: Blocked  active cash shift found:",pe.id),!1):(Ae(),!0)},Ce=async pe=>{if(!a)throw console.error(" Cannot open session: No user logged in"),new Error("Usuario no autenticado");if(ee.current){console.warn(" Session opening already in progress, ignoring duplicate request");return}try{ee.current=!0,E(!0),console.log(" Opening cash shift via API..."),console.log("   Store ID:",a.storeId),console.log("   Initial amount:",pe);const we=new AbortController,be=setTimeout(()=>we.abort(),15e3),xe=await fetch(`${rt}/api/shifts/start`,{method:"POST",headers:nn(),body:JSON.stringify({storeId:a.storeId,initialAmount:pe,openedBy:a.username}),signal:we.signal});if(clearTimeout(be),!xe.ok){const qe=xe.headers.get("content-type");let ze={};if(qe!=null&&qe.includes("application/json"))try{ze=await xe.json()}catch{throw console.error(" Failed to parse error response as JSON"),new Error(`Error del servidor (HTTP ${xe.status})`)}else throw console.error(" Server returned non-JSON error response"),new Error(`Error del servidor: Respuesta invlida (HTTP ${xe.status})`);if(console.error(" Server error:",ze),xe.status===409||ze.error&&ze.error.includes("Ya existe un turno")){console.log(" Shift already exists, attempting to recover...");try{const Pe=await fetch(`${rt}/api/shifts/current?storeId=${a.storeId}`,{headers:nn()});if(Pe.ok){const Ue=Pe.headers.get("content-type");if(!(Ue!=null&&Ue.includes("application/json"))){const Wa=await Pe.text();throw console.error(" Backend returned HTML instead of JSON"),console.error("   Response preview:",Wa.substring(0,200)),console.error("   Content-Type:",Ue),new Error("El servidor confirm que existe un turno abierto, pero no pudo proporcionar los detalles. Por favor, contacta al administrador para cerrar el turno anterior desde la base de datos.")}const ha=await Pe.json(),zt=qf(ha,a.id);if(!zt)throw console.error(" mapShiftToSession returned null for existing shift"),new Error("Los datos del turno existente estn corruptos.");x([zt]),localStorage.setItem("cashSession",JSON.stringify(zt)),console.log(" Recovered existing shift:",zt.id),console.log("   You can continue working with the existing shift");return}else throw console.error(" Failed to fetch existing shift, status:",Pe.status),new Error("No se pudo recuperar el turno existente del servidor.")}catch(Pe){throw console.error(" Failed to recover existing shift:",Pe),Pe.message.includes("servidor")||Pe.message.includes("administrador")?Pe:new Error("Ya existe un turno abierto pero no se pudo recuperar. Verifica tu conexin o contacta al administrador.")}}throw new Error(ze.error||ze.message||"Error al abrir turno de caja")}const Le=xe.headers.get("content-type");if(!(Le!=null&&Le.includes("application/json")))throw new Error("Backend returned non-JSON response");const De=await xe.json();console.log(" Backend shift response:",De);const Ye=qf(De,a.id);if(!Ye)throw console.error(" mapShiftToSession returned null for new shift"),new Error("Los datos del turno recibidos del servidor estn corruptos.");console.log(" Mapped session object:",Ye),x(qe=>[...qe,Ye]);try{localStorage.setItem("cashSession",JSON.stringify(Ye))}catch(qe){console.warn(" Failed to save session to localStorage:",qe)}console.log(" Cash shift opened successfully:",Ye.id),console.log("   Session saved to state and localStorage")}catch(we){throw we.name==="AbortError"?(console.error(" Session opening timeout (15s exceeded)"),new Error("La operacin tard demasiado. Verifica tu conexin e intenta nuevamente.")):we instanceof TypeError&&we.message.includes("fetch")?(console.error(" Network error opening session:",we),new Error("No se pudo conectar al servidor. Verifica tu conexin a internet.")):(console.error(" Error opening cash shift:",we),we)}finally{ee.current=!1,E(!1)}},B=async pe=>{if(!Z){console.error(" Cannot close session: No active session");return}if(!a)throw console.error(" Cannot close session: No user logged in"),new Error("Usuario no autenticado");try{console.log(" Closing cash shift via API...");const we=Z.startBalance+Z.cashSales-Z.refunds,be=await fetch(`${rt}/api/shifts/end`,{method:"POST",headers:nn(),body:JSON.stringify({storeId:a.storeId,finalAmount:pe,expectedAmount:we,notes:""})});if(!be.ok){const Le=await be.json();throw new Error(Le.error||"Error al cerrar turno de caja")}const xe=await be.json();console.log(" Cash shift closed successfully:",xe.id),console.log(`   Expected: $${we}, Real: $${pe}, Difference: $${xe.difference} `),x(Le=>Le.map(De=>De.id===Z.id?{...De,status:"CLOSED",endTime:xe.endTime,expectedBalance:we,endBalanceReal:pe}:De)),localStorage.removeItem("cashSession"),console.log(" Cash session cleared from localStorage")}catch(we){throw console.error(" Error closing cash shift:",we),we}},A=()=>i.reduce((pe,we)=>{const be=Number(we.costPrice)||0,xe=Number(we.stock)||0;return pe+be*xe},0),q=async(pe,we)=>{if(!a)return{totalRevenueAdded:0,totalProfitAdded:0,success:!1};G(!0);try{let be=0,xe=0;const Le=pe.map(ze=>{const Pe=ze.sellingPrice*ze.quantity;let Ue=0;return!ze.unitCost||ze.unitCost<=0?Ue=Pe:Ue=(ze.sellingPrice-ze.unitCost)*ze.quantity,be+=Pe,xe+=Ue,{productId:ze.productId||"unknown",productName:ze.name,quantity:ze.quantity,unitPrice:ze.sellingPrice,unitCost:ze.unitCost||0,discount:0,subtotal:Pe}}),De={storeId:a.storeId||"unknown",vendedor:a.username,subtotal:be,totalDiscount:0,taxTotal:0,total:be,totalCost:be-xe,netProfit:xe,paymentMethod:we,status:"ACTIVE",items:Le,syncedAt:b?new Date:null};let Ye;if(b){const ze=await gs.create(De);Ye=ze,d(Pe=>[...Pe,ze]),u(Pe=>{const Ue=[...Pe];return Le.forEach(ha=>{const zt=Ue.findIndex(Wa=>Wa.id===ha.productId);zt!==-1&&(Ue[zt]={...Ue[zt],stock:Ue[zt].stock-ha.quantity})}),Ue})}else{const ze={...De,tempId:crypto.randomUUID(),createdAt:new Date().toISOString()};await Sw(ze),console.log("Sale saved offline");const Pe={id:ze.tempId||"temp",sellerId:De.vendedor,date:new Date().toISOString(),ownerId:a.id,...De};Ye=Pe,d(Ue=>[...Ue,Pe])}if(we==="CASH"&&Z){const ze=m.map(Ue=>Ue.id===Z.id?{...Ue,cashSales:Math.round((Ue.cashSales+be)*100)/100}:Ue);x(ze);const Pe=ze.find(Ue=>Ue.id===Z.id);if(Pe)try{localStorage.setItem("cashSession",JSON.stringify(Pe))}catch(Ue){console.warn(" Failed to save session to localStorage:",Ue)}}const qe={totalRevenueAdded:be,totalProfitAdded:xe,success:!0,sale:Ye};return b&&(console.log(" Sale completed - Triggering immediate sync"),me().catch(ze=>console.warn(" Post-sale sync failed:",ze))),qe}catch(be){return console.error("Sale processing error:",be),{totalRevenueAdded:0,totalProfitAdded:0,success:!1}}finally{G(!1)}},V=async(pe,we)=>{if(a)try{if(b){const be=we||_w(a);Tw(be,"crear producto");const xe=Ap(pe,be);console.log(" Payload:",JSON.stringify(xe,null,2)),console.log(" User:",a.username,"Role:",a.role),console.log(" StoreId:",xe.storeId);const Le=await zn.create(xe);console.log(" Product created:",Le),u(De=>[...De,R0(Le)])}else console.warn("Cannot add products while offline"),alert("No se pueden agregar productos sin conexin a internet.")}catch(be){console.error("Error creating product:",be),alert(`Error al crear producto: ${be.message||"Error desconocido"}`)}},T=async pe=>{try{if(b){const we=Ap(pe);await zn.update(pe.id,we),u(be=>be.map(xe=>xe.id===pe.id?pe:xe))}}catch(we){console.error(we)}},z=async pe=>{try{b?(await zn.delete(pe),u(we=>we.filter(be=>be.id!==pe))):alert("No se puede eliminar productos en modo offline")}catch(we){console.error("Error deleting product:",we),alert("Error al eliminar producto")}},ne=async pe=>{try{if(b){const we=await gs.cancel(pe);console.log(" Venta cancelada:",we),d(be=>be.map(xe=>xe.id===pe?{...xe,status:"CANCELLED"}:xe)),await Ne(),alert(" Venta cancelada exitosamente. El inventario ha sido restaurado.")}else alert(" No se pueden cancelar ventas en modo offline. Conctate a internet e intenta nuevamente.")}catch(we){throw console.error("Error al cancelar venta:",we),alert(` Error al cancelar venta: ${we.message||"Error desconocido"}`),we}},Te=pe=>v(pe),ge=async(pe,we)=>{if(b)try{return await ow.getSummary(pe,we)}catch(ze){console.error("Failed to fetch dashboard stats, falling back to local calc",ze)}const be=new Date,xe=be.toISOString().split("T")[0],Le=be.toISOString().slice(0,7);let De=f;we&&(De=f.filter(ze=>ze.storeId===we));const Ye=De.filter(ze=>{if(ze.status!=="ACTIVE")return!1;const Pe=ze.date.split("T")[0];return pe==="day"?Pe===xe:pe==="month"?Pe.startsWith(Le):!0}),qe=Ye.reduce((ze,Pe)=>ze+Pe.total,0);return{salesToday:qe,salesCount:Ye.length,ordersCount:Ye.length,totalRevenue:qe,grossProfit:qe*.3,netProfit:qe*.2,investment:0,dailyTarget:0,dailyOperationalCost:0}},ke=async pe=>{if(!pe||pe.trim()==="")return console.warn("searchProductBySKU: Empty SKU provided"),null;const we=pe.trim().toUpperCase();try{if(b){console.log(` Searching product by SKU: ${we}`);const be=await fetch(`${rt}/api/products/search-sku/${encodeURIComponent(we)}`,{headers:nn()});if(be.status===404)return console.log(` Product not found: ${we}`),null;if(!be.ok)throw new Error("Error al buscar producto");const xe=await be.json();return console.log(` Product found: ${xe.name}`),xe}else{console.log(` Offline search for SKU: ${we}`);const be=i.find(xe=>{var Le;return((Le=xe.sku)==null?void 0:Le.trim().toUpperCase())===we&&xe.isActive!==!1});return be?(console.log(` Product found in cache: ${be.name}`),be):(console.log(` Product not found in cache: ${we}`),null)}}catch(be){console.error("Error searching product by SKU:",be);const xe=i.find(Le=>{var De;return((De=Le.sku)==null?void 0:De.trim().toUpperCase())===we&&Le.isActive!==!1});return xe?(console.log(` Product found in local fallback: ${xe.name}`),xe):null}},$e=async()=>{try{const pe=await zn.getAll(),we=Array.isArray(pe)?pe.map(R0):[];u(we),console.log(" Products refreshed")}catch(pe){throw console.error(" Failed to refresh products:",pe),pe}},X=async pe=>{try{console.log(" Datos Crudos (Fila 1):",pe[0]);const we=Le=>{const De={};return Object.keys(Le).forEach(Ye=>{const qe=Ye.trim().toLowerCase().replace(/^[\uFEFF]/,"");De[qe]=Le[Ye]}),De},be=pe.map(Le=>{const De=we(Le);return{sku:De.sku||De.clave||"",name:De.nombre||De.name||De.producto||"",salePrice:parseFloat(De.precio||De.price||De.venta||0),costPrice:parseFloat(De.costo||De.cost||De.compra||0),stock:parseInt(De.existencia||De.stock||De.cantidad||0),category:De.categoria||De.category||"General",minStock:5,image:null}}).filter(Le=>Le.sku&&Le.sku!=="");if(console.log(` Detectados ${be.length} productos vlidos.`),be.length===0)throw new Error("El archivo no tiene columnas reconocibles (SKU, Nombre, Precio)");if(!(await fetch(`${rt}/api/products/bulk`,{method:"POST",headers:nn(),body:JSON.stringify(be)})).ok)throw new Error("Error al guardar en base de datos");return await $e(),{success:!0,imported:be.length}}catch(we){throw console.error(" Error Importacin:",we),we}},nt=zg.useMemo(()=>({products:i,sales:f,allSessions:m,settings:g,currentUser:a,currentUserRole:a==null?void 0:a.role,currentSession:Z,isCashRegisterOpen:Y,isOnline:b,isLoading:y,isRecoveringSession:N,isOpeningSession:O,isTransactionInProgress:L,error:H,login:se,logout:Ae,safeLogout:ae,updateCurrentUser:J,openSession:Ce,closeSession:B,addProduct:V,updateProduct:T,deleteProduct:z,processSaleAndContributeToGoal:q,cancelSale:ne,updateSettings:Te,getDashboardStats:ge,calculateTotalInventoryValue:A,syncData:Ne,searchProductBySKU:ke,setTransactionInProgress:G,importProducts:X,refreshProducts:$e}),[i,f,m,g,a,Z,Y,b,y,N,O,H,se,Ae,ae,J,Ce,B,V,T,z,q,ne,Te,ge,A,Ne,ke]);return c.jsx(uv.Provider,{value:nt,children:e})},Jt=()=>{const e=D.useContext(uv);if(!e)throw new Error("useStore must be used within StoreProvider");return e},fv=D.createContext(void 0),Cw=({children:e})=>{const[n,a]=D.useState(()=>localStorage.getItem("teikon_theme")||"light");D.useEffect(()=>{const u=window.document.documentElement;n==="dark"?u.classList.add("dark"):u.classList.remove("dark"),localStorage.setItem("teikon_theme",n)},[n]);const s=()=>{a(u=>u==="dark"?"light":"dark")},i=n==="dark";return c.jsx(fv.Provider,{value:{theme:n,toggleTheme:s,isDarkMode:i,toggleDarkMode:s},children:e})},dv=()=>{const e=D.useContext(fv);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ow=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,a,s)=>s?s.toUpperCase():a.toLowerCase()),Cp=e=>{const n=Ow(e);return n.charAt(0).toUpperCase()+n.slice(1)},hv=(...e)=>e.filter((n,a,s)=>!!n&&n.trim()!==""&&s.indexOf(n)===a).join(" ").trim(),Rw=e=>{for(const n in e)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Dw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=D.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:i="",children:u,iconNode:f,...d},m)=>D.createElement("svg",{ref:m,...Dw,width:n,height:n,stroke:e,strokeWidth:s?Number(a)*24/Number(n):a,className:hv("lucide",i),...!u&&!Rw(d)&&{"aria-hidden":"true"},...d},[...f.map(([x,g])=>D.createElement(x,g)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=(e,n)=>{const a=D.forwardRef(({className:s,...i},u)=>D.createElement(Fw,{ref:u,iconNode:n,className:hv(`lucide-${jw(Cp(e))}`,`lucide-${e}`,s),...i}));return a.displayName=Cp(e),a};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Lw=Me("activity",Mw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Bw=Me("archive",Iw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],xd=Me("arrow-down-right",zw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Pw=Me("arrow-right-left",Uw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],md=Me("arrow-up-right",Hw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],eo=Me("banknote",Vw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Pd=Me("calculator",Gw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],xv=Me("calendar",$w);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Yw=Me("chart-column",Xw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],Kw=Me("chart-no-axes-column",qw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Zw=Me("chart-pie",Ww);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Qw=Me("chevron-down",Jw);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Kf=Me("chevron-left",eS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],aS=Me("chevron-right",tS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Gi=Me("circle-alert",rS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],q0=Me("circle-check-big",nS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],mv=Me("circle-check",sS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],iS=Me("circle-question-mark",lS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],oS=Me("clock",cS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],fS=Me("credit-card",uS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],$i=Me("dollar-sign",dS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],xS=Me("download",hS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],pS=Me("eye-off",mS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],K0=Me("eye",gS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],pd=Me("file-spreadsheet",vS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],pv=Me("file-text",bS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],kS=Me("folder-open",yS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],SS=Me("funnel",wS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],NS=Me("headphones",ES);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Ri=Me("history",TS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],AS=Me("house",_S);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]],jS=Me("image-off",CS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],W0=Me("image",OS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],DS=Me("info",RS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],MS=Me("layout-dashboard",FS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],gv=Me("life-buoy",LS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],to=Me("loader-circle",IS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Xi=Me("lock",BS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Hd=Me("log-out",zS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],PS=Me("menu",US);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],VS=Me("message-square",HS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=[["path",{d:"M5 12h14",key:"1ays0h"}]],$S=Me("minus",GS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],vv=Me("moon",XS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]],qS=Me("package-plus",YS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]],WS=Me("package-minus",KS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],vl=Me("package",ZS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],jp=Me("pen",JS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],eE=Me("percent",QS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],aE=Me("phone",tE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ao=Me("plus",rE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],bv=Me("power",nE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],lE=Me("printer",sE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],cE=Me("refresh-cw",iE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oE=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],uE=Me("rocket",oE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fE=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],dE=Me("save",fE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ic=Me("search",hE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xE=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Op=Me("send",xE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mE=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],yv=Me("settings",mE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pE=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Vd=Me("shield-alert",pE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gE=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ro=Me("shield-check",gE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],bE=Me("shopping-bag",vE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],Di=Me("shopping-cart",yE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Rp=Me("square-pen",kE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],Yi=Me("store",wE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],gd=Me("sun",SE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Gd=Me("target",EE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],TE=Me("terminal",NE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],AE=Me("ticket",_E);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],qi=Me("trash-2",CE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Vn=Me("trending-up",jE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ba=Me("triangle-alert",OE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],kv=Me("upload",RE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Fr=Me("user",DE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ME=Me("wifi-off",FE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],IE=Me("wifi",LE);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Nr=Me("x",BE),$d=({isOpen:e,onClose:n})=>{const[a,s]=D.useState({requesterName:"",storeName:"",description:""}),[i,u]=D.useState(!1),[f,d]=D.useState(!1);if(!e)return null;const m=x=>{x.preventDefault(),u(!0);const g={id:Date.now(),date:new Date().toLocaleDateString(),status:"pending",...a},v=localStorage.getItem("teikon_tickets"),b=v?JSON.parse(v):[],k=[g,...b];localStorage.setItem("teikon_tickets",JSON.stringify(k)),setTimeout(()=>{u(!1),d(!0),s({requesterName:"",storeName:"",description:""}),setTimeout(()=>{d(!1),n()},2e3)},800)};return c.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[c.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:n}),c.jsx("div",{className:"relative w-full max-w-lg bg-white dark:bg-slate-900 rounded-[2.5rem] shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden animate-in zoom-in duration-300",children:c.jsxs("div",{className:"p-8",children:[c.jsxs("div",{className:"flex justify-between items-start mb-8 border-b border-slate-100 dark:border-slate-800 pb-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-indigo-600 rounded-xl text-white",children:c.jsx(gv,{size:20})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.3em] text-slate-900 dark:text-white",children:"Teikon Support Center"}),c.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mt-0.5",children:"Asistencia Tcnica Directa"})]})]}),c.jsx("button",{onClick:n,"aria-label":"Cerrar modal",title:"Cerrar",className:"text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors",children:c.jsx(Nr,{size:20})})]}),f?c.jsxs("div",{className:"py-12 flex flex-col items-center text-center space-y-4 animate-in fade-in zoom-in",children:[c.jsx("div",{className:"h-16 w-16 bg-emerald-500/10 rounded-full flex items-center justify-center text-emerald-500 border border-emerald-500/20",children:c.jsx(Op,{size:32})}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-lg font-black text-slate-900 dark:text-white uppercase tracking-tight",children:"Ticket Enviado!"}),c.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-widest mt-1",children:"Nuestro equipo revisar el reporte pronto."})]})]}):c.jsxs("form",{onSubmit:m,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Solicitante"}),c.jsxs("div",{className:"relative group",children:[c.jsx(Fr,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500",size:16}),c.jsx("input",{required:!0,placeholder:"Nombre Completo",className:"w-full pl-11 pr-4 py-3 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl text-xs font-bold text-slate-900 dark:text-white outline-none focus:border-indigo-500 transition-all",value:a.requesterName,onChange:x=>s({...a,requesterName:x.target.value})})]})]}),c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Tienda / Nodo"}),c.jsxs("div",{className:"relative group",children:[c.jsx(Yi,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500",size:16}),c.jsx("input",{required:!0,placeholder:"Sucursal",className:"w-full pl-11 pr-4 py-3 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl text-xs font-bold text-slate-900 dark:text-white outline-none focus:border-indigo-500 transition-all",value:a.storeName,onChange:x=>s({...a,storeName:x.target.value})})]})]})]}),c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Descripcin del Problema"}),c.jsxs("div",{className:"relative group",children:[c.jsx(VS,{className:"absolute left-4 top-4 text-slate-400 group-focus-within:text-indigo-500",size:16}),c.jsx("textarea",{required:!0,placeholder:"Describe detalladamente el error o consulta...",rows:4,className:"w-full pl-11 pr-4 py-4 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl text-xs font-bold text-slate-900 dark:text-white outline-none focus:border-indigo-500 transition-all resize-none",value:a.description,onChange:x=>s({...a,description:x.target.value})})]})]}),c.jsx("button",{type:"submit",disabled:i,className:"w-full bg-slate-900 dark:bg-indigo-600 hover:bg-slate-800 dark:hover:bg-indigo-500 text-white py-4 rounded-xl text-[10px] font-black uppercase tracking-[0.3em] shadow-xl transition-all active:scale-[0.98] flex items-center justify-center gap-2",children:i?"Procesando...":c.jsxs(c.Fragment,{children:[c.jsx(Op,{size:14})," Enviar Reporte"]})})]})]})})]})},at=({children:e,variant:n="primary",size:a="md",loading:s=!1,icon:i,fullWidth:u=!1,className:f="",disabled:d,...m})=>{const x="inline-flex items-center justify-center rounded-xl font-bold transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2",g={primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-900/20 focus:ring-blue-500 border border-transparent",secondary:"bg-slate-800 hover:bg-slate-700 text-slate-200 border border-slate-700 hover:border-slate-600",danger:"bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20",ghost:"bg-transparent hover:bg-slate-800 text-slate-400 hover:text-white",sales:"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg shadow-emerald-500/20 focus:ring-emerald-500",finance:"bg-amber-600 hover:bg-amber-700 text-white shadow-lg shadow-amber-500/20 focus:ring-amber-500"},v={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2.5 text-sm",lg:"px-6 py-3.5 text-base"};return c.jsxs("button",{className:`
                ${x}
                ${g[n]}
                ${v[a]}
                ${u?"w-full":""}
                ${f}
            `,disabled:d||s,...m,children:[s&&c.jsx(to,{className:"w-4 h-4 mr-2 animate-spin"}),!s&&i&&c.jsx(i,{className:"w-4 h-4 mr-2"}),e]})},Mr=({isOpen:e,onClose:n,title:a,children:s})=>(D.useEffect(()=>{const i=u=>{u.key==="Escape"&&n()};return e&&(document.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",i),document.body.style.overflow="unset"}},[e,n]),e?c.jsx("div",{className:"fixed inset-0 z-[100] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-slate-900/60 dark:bg-brand-bg/80 backdrop-blur-sm transition-opacity","aria-hidden":"true",onClick:n}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),c.jsxs("div",{className:"relative inline-block align-bottom bg-white/95 dark:bg-brand-panel/95 backdrop-blur-md border border-slate-200 dark:border-brand-border text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full cut-corner p-6",children:[c.jsxs("div",{className:"flex justify-between items-start mb-8 border-b border-slate-100 dark:border-brand-border pb-4",children:[c.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.3em] text-slate-900 dark:text-brand-text",id:"modal-title",children:a}),c.jsx("button",{type:"button",className:"text-brand-muted hover:text-slate-900 dark:hover:text-brand-text transition-colors",onClick:n,"aria-label":"Cerrar modal",title:"Cerrar",children:c.jsx(Nr,{className:"h-5 w-5","aria-hidden":"true"})})]}),c.jsx("div",{className:"text-slate-900 dark:text-brand-text",children:s})]})]})}):null),Xd=({size:e=80,className:n=""})=>c.jsx("div",{className:`flex items-center justify-center transition-all duration-500 filter drop-shadow-[0_0_12px_rgba(0,198,255,0.25)] dark:drop-shadow-[0_0_30px_rgba(0,198,255,0.4)] brightness-110 ${n}`,style:{width:e,height:e},role:"img","aria-label":"Teikon Brand Logo",children:c.jsxs("svg",{viewBox:"0 0 400 400",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"100%",height:"100%"},children:[c.jsxs("defs",{children:[c.jsxs("linearGradient",{id:"gradLeftFinal",x1:"0%",y1:"100%",x2:"100%",y2:"0%",children:[c.jsx("stop",{offset:"0%",stopColor:"#005ea8"}),c.jsx("stop",{offset:"100%",stopColor:"#00c6ff"})]}),c.jsxs("linearGradient",{id:"gradRightFinal",x1:"0%",y1:"100%",x2:"100%",y2:"0%",children:[c.jsx("stop",{offset:"0%",stopColor:"#007e9e"}),c.jsx("stop",{offset:"100%",stopColor:"#89d62d"})]}),c.jsxs("linearGradient",{id:"gradTopFinal",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[c.jsx("stop",{offset:"0%",stopColor:"#00c6ff"}),c.jsx("stop",{offset:"100%",stopColor:"#89d62d"})]})]}),c.jsxs("g",{transform:"translate(40, 50)",children:[c.jsx("path",{d:"M160 10 L275 60 L160 105 L45 60 Z",fill:"url(#gradTopFinal)"}),c.jsx("path",{d:"M40 70 L153 115 L153 260 L40 215 Z",fill:"url(#gradLeftFinal)"}),c.jsx("path",{d:"M167 115 L280 70 L280 215 L167 260 Z",fill:"url(#gradRightFinal)"}),c.jsx("path",{d:"M160 10 L160 105",stroke:"white",strokeWidth:"2",strokeOpacity:"0.6"}),c.jsx("path",{d:"M45 60 L275 60",stroke:"white",strokeWidth:"2",strokeOpacity:"0.4"}),c.jsx("path",{d:"M96.5 92.5 L96.5 237.5",stroke:"white",strokeWidth:"2",strokeOpacity:"0.5"}),c.jsx("path",{d:"M40 142.5 L153 187.5",stroke:"white",strokeWidth:"2",strokeOpacity:"0.3"}),c.jsx("path",{d:"M 90 180 Q 130 200 150 225 L 160 235 L 290 90 L 260 75 L 155 190 L 120 160 Z",fill:"white"})]}),c.jsxs("g",{transform:"translate(250, 10)",children:[c.jsx("rect",{x:"22",y:"0",width:"18",height:"18",fill:"#00c6ff"}),c.jsx("rect",{x:"44",y:"22",width:"18",height:"18",fill:"#4caf50"}),c.jsx("rect",{x:"22",y:"44",width:"18",height:"18",fill:"#005ea8"}),c.jsx("rect",{x:"0",y:"22",width:"18",height:"18",fill:"#008ba3"})]})]})}),zE=({height:e=32,className:n=""})=>c.jsxs("svg",{height:e,viewBox:"0 0 320 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`drop-shadow-[0_0_10px_rgba(0,187,212,0.4)] transition-colors duration-500 ${n}`,children:[c.jsx("path",{d:"M5 5 H55 V18 H35 V55 H25 V18 H5 V5Z",className:"fill-current"}),c.jsx("path",{d:"M70 5 H110 V15 H70 V5Z",className:"fill-current"}),c.jsx("path",{d:"M70 25 H110 V35 H70 V25Z",className:"fill-current"}),c.jsx("path",{d:"M70 45 H110 V55 H70 V45Z",className:"fill-current"}),c.jsx("path",{d:"M125 5 H137 V55 H125 V5Z",className:"fill-current"}),c.jsx("path",{d:"M150 5 H162 V28 L182 5 H198 L170 32 L200 55 H184 L162 38 V55 H150 V5Z",className:"fill-current"}),c.jsx("path",{d:"M225 5 H250 L262 17 V43 L250 55 H225 L213 43 V17 L225 5ZM226 15 V45 H249 V15 H226Z",className:"fill-current",fillRule:"evenodd"}),c.jsx("path",{d:"M275 5 H287 L305 35 V5 H317 V55 H305 L287 25 V55 H275 V5Z",className:"fill-current"})]}),wv=({isOpen:e,onClose:n})=>{const[a,s]=D.useState("");D.useEffect(()=>{if(e){const u=localStorage.getItem("dailySalesGoal")||"10000";s(u)}},[e]);const i=()=>{const u=parseFloat(a);if(isNaN(u)||u<=0){alert("Por favor ingresa un valor vlido mayor a 0");return}localStorage.setItem("dailySalesGoal",u.toString()),alert(` Meta actualizada a $${u.toLocaleString()}`),n(),window.dispatchEvent(new Event("salesGoalUpdated"))};return c.jsx(Mr,{isOpen:e,onClose:n,title:"MODIFICAR META DE VENTA",children:c.jsxs("div",{className:"space-y-6 p-2",children:[c.jsx("div",{className:"flex items-center justify-center p-6 bg-purple-500/5 rounded-2xl border-2 border-purple-500/10",children:c.jsx(Gd,{className:"text-purple-600",size:48})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Meta Diaria (MXN)"}),c.jsx("input",{type:"number",className:"w-full py-4 text-3xl font-black bg-slate-50 dark:bg-slate-950 border-4 border-slate-100 dark:border-slate-800 rounded-2xl outline-none focus:border-purple-500 text-center",value:a,onChange:u=>s(u.target.value),placeholder:"10000",autoFocus:!0}),c.jsx("p",{className:"text-xs text-slate-500 text-center font-bold",children:"Esta meta se usa para calcular el progreso diario de ventas"})]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx(at,{variant:"secondary",fullWidth:!0,onClick:n,children:"CANCELAR"}),c.jsx(at,{variant:"primary",fullWidth:!0,onClick:i,children:"GUARDAR META"})]})]})})},UE=({isOpen:e,onClose:n,title:a,children:s,maxWidth:i="sm:max-w-lg"})=>(D.useEffect(()=>{const u=f=>{f.key==="Escape"&&n()};return e&&(document.addEventListener("keydown",u),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",u),document.body.style.overflow="unset"}},[e,n]),e?c.jsx("div",{className:"fixed inset-0 z-[100] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 bg-slate-900/60 dark:bg-brand-bg/80 backdrop-blur-sm transition-opacity","aria-hidden":"true",onClick:n}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),c.jsxs("div",{className:`relative inline-block align-bottom bg-white dark:bg-brand-panel border border-slate-200 dark:border-brand-border text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle ${i} sm:w-full cut-corner p-6`,children:[c.jsxs("div",{className:"flex justify-between items-start mb-8 border-b border-slate-100 dark:border-brand-border pb-4",children:[c.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.3em] text-slate-900 dark:text-brand-text",id:"modal-title",children:a}),c.jsx("button",{type:"button",className:"text-brand-muted hover:text-slate-900 dark:hover:text-brand-text transition-colors",onClick:n,children:c.jsx(Nr,{className:"h-5 w-5","aria-hidden":"true"})})]}),c.jsx("div",{className:"text-slate-900 dark:text-brand-text",children:s})]})]})}):null),Gn=({children:e,variant:n="primary",fullWidth:a=!1,className:s="",icon:i,...u})=>{const f="inline-flex items-center justify-center gap-2 min-h-[44px] px-5 py-3 text-[11px] font-black uppercase tracking-[0.2em] transition-all duration-150 ease-in-out active:scale-95 disabled:opacity-40 rounded-xl border-2 shadow-sm whitespace-nowrap overflow-hidden select-none",d={primary:"bg-brand-text text-brand-bg border-brand-text hover:bg-brand-text/90 shadow-brand-text/10",secondary:"bg-transparent text-brand-text border-brand-text/20 hover:border-brand-text/50",ghost:"bg-transparent text-brand-muted border-transparent hover:text-brand-text hover:bg-white/5",sales:"bg-brand-emerald text-white border-brand-emerald hover:bg-emerald-400 shadow-emerald-500/20",finance:"bg-brand-blue text-white border-brand-blue hover:bg-blue-400 shadow-blue-500/20",danger:"bg-red-500 text-white border-red-500 hover:bg-red-600 shadow-red-500/20"},m=a?"w-full":"";return c.jsxs("button",{className:`${f} ${d[n]} ${m} ${s}`,...u,children:[i&&c.jsx(i,{size:18}),e]})},Yd=({isOpen:e,onClose:n,onShiftClosed:a})=>{const[s,i]=D.useState(!1),[u,f]=D.useState(null),[d,m]=D.useState(""),[x,g]=D.useState(""),[v,b]=D.useState(null),k=Q=>{const K=Number(Q);return isNaN(K)?0:K},y=Q=>`$${k(Q).toFixed(2)}`;D.useEffect(()=>{e&&(w(),m(""),g(""),b(null))},[e]);const w=async()=>{i(!0),b(null);try{const Q=await fetch(`${rt}/api/shifts/current`,{headers:nn()});if(!Q.ok){if(Q.status===404)b("No hay un turno activo para cerrar.");else throw new Error("Error al obtener datos del turno");f(null);return}const K=await Q.json();f(K)}catch(Q){console.error(Q),b("Error de conexin con el servidor")}finally{i(!1)}},N=async()=>{if(!u)return;const Q=k(d);i(!0);try{const K=await fetch(`${rt}/api/shifts/end`,{method:"POST",headers:nn(),body:JSON.stringify({shiftId:u.id,montoReal:Q,notas:x})});if(!K.ok){const ee=await K.json();throw new Error(ee.message||"Error al cerrar el turno")}alert(" Turno cerrado exitosamente"),localStorage.removeItem("currentShiftId"),a?a():n(),window.location.reload()}catch(K){b(K.message)}finally{i(!1)}},_=k(u==null?void 0:u.montoInicial),O=k(u==null?void 0:u.ventasEfectivo),E=k((u==null?void 0:u.ventasTarjeta)||0),L=k((u==null?void 0:u.ventasTransferencia)||0),G=k(u==null?void 0:u.gastos),H=k(u==null?void 0:u.montoEsperado),Z=k(d)-H,Y=Z<0;return c.jsx(UE,{isOpen:e,onClose:n,title:"CERRAR TURNO (CORTE DE CAJA)",children:c.jsxs("div",{className:"space-y-6",children:[v&&c.jsxs("div",{className:"p-3 bg-red-100 text-red-700 rounded-lg text-sm flex items-center gap-2",children:[c.jsx(Gi,{size:16}),v]}),s&&!u?c.jsx("div",{className:"py-8 text-center text-slate-500",children:"Cargando informacin del turno..."}):u?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("div",{className:"text-xs text-slate-500 font-bold uppercase tracking-wider mb-1",children:"Fondo Inicial"}),c.jsx("div",{className:"text-lg font-mono font-bold text-slate-700 dark:text-slate-300",children:y(_)})]}),c.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-xl border border-green-200 dark:border-green-800",children:[c.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 font-bold uppercase tracking-wider mb-1",children:"Efectivo"}),c.jsxs("div",{className:"text-lg font-mono font-bold text-green-700 dark:text-green-400",children:["+ ",y(O)]})]}),c.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800",children:[c.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider mb-1",children:"Tarjetas"}),c.jsx("div",{className:"text-lg font-mono font-bold text-blue-700 dark:text-blue-400",children:y(E)})]}),c.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-xl border border-purple-200 dark:border-purple-800",children:[c.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-bold uppercase tracking-wider mb-1",children:"Transferencias"}),c.jsx("div",{className:"text-lg font-mono font-bold text-purple-700 dark:text-purple-400",children:y(L)})]}),c.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-xl border border-red-200 dark:border-red-800",children:[c.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 font-bold uppercase tracking-wider mb-1",children:"Gastos"}),c.jsxs("div",{className:"text-lg font-mono font-bold text-red-700 dark:text-red-400",children:["- ",y(G)]})]}),c.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800",children:[c.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase tracking-wider mb-1",children:"Esperado en Caja"}),c.jsx("div",{className:"text-xl font-mono font-black text-blue-700 dark:text-blue-400",children:y(H)})]})]}),c.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2",children:"Dinero Real en Caja (Contado)"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx($i,{className:"text-slate-400",size:18})}),c.jsx("input",{type:"number",value:d,onChange:Q=>m(Q.target.value),className:"block w-full pl-10 pr-3 py-3 border-2 border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-slate-900 font-mono text-lg font-bold",placeholder:"0.00",autoFocus:!0})]})]}),d!==""&&c.jsxs("div",{className:`p-3 rounded-lg flex justify-between items-center ${Y?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:[c.jsxs("span",{className:"text-xs font-bold uppercase flex items-center gap-2",children:[c.jsx(Pd,{size:14})," Diferencia"]}),c.jsxs("span",{className:"font-mono font-bold",children:[Z>0?"+":"",y(Z)]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2",children:"Notas / Observaciones"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute top-3 left-3 pointer-events-none",children:c.jsx(pv,{className:"text-slate-400",size:18})}),c.jsx("textarea",{value:x,onChange:Q=>g(Q.target.value),className:"block w-full pl-10 pr-3 py-2 border-2 border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-slate-900 min-h-[80px]",placeholder:"Justificacin de diferencias..."})]})]})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx(Gn,{variant:"secondary",fullWidth:!0,onClick:n,disabled:s,children:"CANCELAR"}),c.jsx(Gn,{variant:"primary",fullWidth:!0,onClick:N,disabled:s||d==="",className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:s?"CERRANDO...":"CONFIRMAR CIERRE"})]})]}):c.jsx("div",{className:"text-center py-4",children:c.jsx(Gn,{variant:"secondary",onClick:n,children:"Cerrar"})})]})})},Sv=({onStoreDeleted:e})=>{const[n,a]=D.useState(!1),[s,i]=D.useState(""),[u,f]=D.useState(!1),[d,m]=D.useState(""),x=async()=>{if(!s){m("Debes ingresar tu contrasea");return}f(!0),m("");try{const g=localStorage.getItem("currentStoreId");if(!g){m("No se pudo identificar la tienda");return}await Y0.delete(g,s),alert(" Tienda eliminada correctamente"),a(!1),e()}catch(g){m(g.message||"Error al eliminar la tienda")}finally{f(!1)}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-red-50 dark:bg-red-950/20 border-2 border-red-200 dark:border-red-900/50 rounded-3xl p-6",children:[c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"p-3 bg-red-500 rounded-xl",children:c.jsx(Ba,{className:"text-white",size:24})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-black text-red-600 dark:text-red-400 uppercase tracking-tight",children:"Zona de Peligro"}),c.jsx("p",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 mt-1",children:"Esta accin eliminar permanentemente tu tienda, productos, ventas e historial completo."}),c.jsx("p",{className:"text-xs font-bold text-red-500 mt-2",children:" Esta accin NO se puede deshacer"})]})]}),c.jsx("div",{className:"mt-6 flex justify-end",children:c.jsxs(Gn,{variant:"secondary",onClick:()=>a(!0),className:"bg-red-500 hover:bg-red-600 text-white border-none shadow-lg shadow-red-500/20",children:[c.jsx(qi,{size:16,className:"mr-2"}),"ELIMINAR TIENDA"]})})]}),n&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-md p-8 shadow-2xl scale-100 animate-in zoom-in-95 duration-200 border-2 border-red-500",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-500/10 rounded-xl text-red-500",children:c.jsx(Ba,{size:28})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white",children:"Confirmar Eliminacin"}),c.jsx("p",{className:"text-xs font-bold text-red-500 mt-0.5",children:"Accin Irreversible"})]})]}),c.jsx("button",{onClick:()=>{a(!1),i(""),m("")},className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-400 transition-colors","aria-label":"Cerrar modal",children:c.jsx(Nr,{size:20})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-950/20 rounded-xl border border-red-200 dark:border-red-900/50",children:[c.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Esta accin eliminar permanentemente:"}),c.jsxs("ul",{className:"mt-2 space-y-1 text-xs font-bold text-slate-600 dark:text-slate-400",children:[c.jsx("li",{children:" Todos los productos del inventario"}),c.jsx("li",{children:" Historial completo de ventas"}),c.jsx("li",{children:" Configuraciones y preferencias"}),c.jsx("li",{children:" Usuarios asociados a la tienda"})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Ingresa tu contrasea para confirmar"}),c.jsxs("div",{className:"relative",children:[c.jsx(Xi,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:16}),c.jsx("input",{type:"password",className:"w-full pl-12 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-xl text-sm font-bold focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition-all",value:s,onChange:g=>{i(g.target.value),m("")},placeholder:"",autoFocus:!0})]})]}),d&&c.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-xs font-bold rounded-xl flex items-center gap-2",children:[c.jsx(Ba,{size:16}),d]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx(Gn,{type:"button",variant:"secondary",fullWidth:!0,onClick:()=>{a(!1),i(""),m("")},className:"h-12",children:"CANCELAR"}),c.jsx(Gn,{type:"button",variant:"primary",fullWidth:!0,onClick:x,disabled:!s||u,className:"h-12 bg-red-500 hover:bg-red-600 text-white shadow-lg shadow-red-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"ELIMINANDO...":"CONFIRMAR ELIMINACIN"})]})]})]})})]})},PE=({onClose:e})=>{const{updateCurrentUser:n,currentUser:a}=Jt(),[s,i]=D.useState((a==null?void 0:a.fullName)||""),[u,f]=D.useState(""),[d,m]=D.useState(""),[x,g]=D.useState(!1),[v,b]=D.useState(""),[k,y]=D.useState(""),w=async _=>{if(_.preventDefault(),y(""),b(""),u&&u!==d){y("Las contraseas no coinciden");return}g(!0);try{await zd.updateProfile({storeName:s,newPassword:u||void 0}),n({fullName:s}),alert(" Perfil actualizado correctamente"),f(""),m(""),setTimeout(()=>{e()},1500)}catch(O){console.error(O);let E="Error al actualizar perfil";try{const L=JSON.parse(O.message);L.error&&(E=L.error)}catch{O.message&&!O.message.includes("{")&&(E=O.message)}y(E)}finally{g(!1)}},N=()=>{window.location.href="/login"};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-md p-8 shadow-2xl scale-100 animate-in zoom-in-95 duration-200 border border-slate-100 dark:border-slate-800",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-2xl font-black text-slate-900 dark:text-white",children:"Mi Perfil"}),c.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:"Gestin de Cuenta y Seguridad"})]}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-400 transition-colors","aria-label":"Cerrar configuracin",children:c.jsx(Nr,{size:20})})]}),c.jsxs("form",{onSubmit:w,className:"space-y-5",children:[c.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl flex items-center gap-3 border border-slate-100 dark:border-slate-800",children:[c.jsx("div",{className:"p-2 bg-slate-200 dark:bg-slate-700 rounded-lg text-slate-500",children:c.jsx(Fr,{size:18})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400",children:"Usuario / ID"}),c.jsx("p",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:(a==null?void 0:a.username)||(a==null?void 0:a.id)})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Nombre de la Tienda"}),c.jsxs("div",{className:"relative",children:[c.jsx(Yi,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:16}),c.jsx("input",{type:"text",className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all",value:s,onChange:_=>i(_.target.value),placeholder:"Nombre comercial"})]})]}),c.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-800 my-2 pt-2",children:[c.jsx("p",{className:"text-xs font-bold text-brand-blue mb-4",children:"Cambiar Contrasea (Opcional)"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx(Xi,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:16}),c.jsx("input",{type:"password",className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all",value:u,onChange:_=>f(_.target.value),placeholder:"Nueva Contrasea"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(Xi,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:16}),c.jsx("input",{type:"password",className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all",value:d,onChange:_=>m(_.target.value),placeholder:"Confirmar Nueva Contrasea"})]})]})]}),k&&c.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-xs font-bold rounded-xl flex items-center gap-2",children:[c.jsx(Ba,{size:16}),k]}),v&&c.jsxs("div",{className:"p-3 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 text-xs font-bold rounded-xl flex items-center gap-2",children:[c.jsx(q0,{size:16}),v]}),c.jsxs("div",{className:"pt-2 flex gap-3",children:[c.jsx(at,{type:"button",variant:"secondary",fullWidth:!0,onClick:e,className:"h-12",children:"CANCELAR"}),c.jsx(at,{type:"submit",variant:"primary",fullWidth:!0,className:"h-12 shadow-lg shadow-brand-blue/20 bg-brand-blue text-white hover:bg-blue-600",disabled:x,children:x?"GUARDANDO...":"GUARDAR CAMBIOS"})]})]}),(a==null?void 0:a.role)==="SUPER_ADMIN"&&c.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200 dark:border-slate-800",children:c.jsx(Sv,{onStoreDeleted:N})})]})})};function HE(){const[e,n]=D.useState(navigator.onLine),[a,s]=D.useState(!1);return D.useEffect(()=>{const i=()=>{n(!0),s(!0),setTimeout(()=>s(!1),3e3)},u=()=>{n(!1),s(!0)};return window.addEventListener("online",i),window.addEventListener("offline",u),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",u)}},[]),c.jsxs("div",{className:"fixed top-4 right-4 z-50 flex items-center gap-2",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${e?"bg-green-500":"bg-red-500"} animate-pulse`}),a&&c.jsx("div",{className:`
            px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 text-sm font-medium
            ${e?"bg-green-500 text-white":"bg-red-500 text-white"}
            animate-in slide-in-from-right duration-300
          `,children:e?c.jsxs(c.Fragment,{children:[c.jsx(IE,{size:16}),c.jsx("span",{children:"Conectado"})]}):c.jsxs(c.Fragment,{children:[c.jsx(ME,{size:16}),c.jsx("span",{children:"Sin conexin - Modo offline"})]})})]})}const VE=({isOpen:e,onClose:n,onGoToCloseShift:a})=>{const{currentSession:s}=Jt();if(!e)return null;const i=f=>{if(!f)return"";try{return new Date(f).toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"})}catch{return""}},u=f=>`$${(f??0).toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",role:"dialog","aria-modal":"true","aria-labelledby":"open-shift-warning-title",children:c.jsxs("div",{className:"relative w-full max-w-md bg-white dark:bg-slate-900 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-700 overflow-hidden animate-in zoom-in-95 duration-200",children:[c.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 px-5 py-4 flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-white/20 rounded-xl",children:c.jsx(Ba,{className:"text-white",size:22})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h2",{id:"open-shift-warning-title",className:"text-sm font-black text-white uppercase tracking-widest",children:"Turno de Caja Abierto"}),c.jsx("p",{className:"text-[10px] text-white/80 font-bold mt-0.5",children:"Debes realizar el corte antes de cerrar sesin"})]}),c.jsx("button",{onClick:n,className:"p-1.5 rounded-lg hover:bg-white/20 text-white transition-colors","aria-label":"Cancelar",children:c.jsx(Nr,{size:18})})]}),c.jsxs("div",{className:"p-5 space-y-4",children:[c.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300 leading-relaxed",children:["No puedes cerrar sesin mientras hay un"," ",c.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:"turno de caja activo"}),". Realiza el corte de caja para conciliar el efectivo y garantizar la integridad contable."]}),s&&c.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-xl p-4 space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(eo,{size:15,className:"text-amber-600 dark:text-amber-400"}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-amber-700 dark:text-amber-400",children:"Turno Activo"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400 block font-bold uppercase tracking-wider text-[9px]",children:"Hora de Apertura"}),c.jsx("span",{className:"font-mono font-bold text-slate-900 dark:text-white",children:i(s.startTime)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400 block font-bold uppercase tracking-wider text-[9px]",children:"Fondo Inicial"}),c.jsx("span",{className:"font-mono font-bold text-slate-900 dark:text-white",children:u(s.startBalance)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400 block font-bold uppercase tracking-wider text-[9px]",children:"Ventas Efectivo"}),c.jsx("span",{className:"font-mono font-bold text-emerald-700 dark:text-emerald-400",children:u(s.cashSales)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400 block font-bold uppercase tracking-wider text-[9px]",children:"Estado"}),c.jsxs("span",{className:"inline-flex items-center gap-1 font-bold text-amber-700 dark:text-amber-400",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse inline-block"}),"ABIERTO"]})]})]})]}),c.jsx("p",{className:"text-[10px] text-slate-400 dark:text-slate-500 font-bold uppercase tracking-wider text-center",children:" Cerrar sin corte puede causar descuadre contable"})]}),c.jsxs("div",{className:"px-5 pb-5 flex gap-3",children:[c.jsx("button",{onClick:n,className:"flex-1 py-2.5 px-4 rounded-xl border-2 border-slate-200 dark:border-slate-700 text-xs font-bold text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:"CANCELAR"}),c.jsxs("button",{onClick:a,className:"flex-1 py-2.5 px-4 rounded-xl bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white text-xs font-black uppercase tracking-wider transition-all shadow-lg shadow-amber-500/30 flex items-center justify-center gap-2",children:[c.jsx(eo,{size:14}),"HACER CORTE"]})]})]})})},Ni=({label:e})=>c.jsx("div",{className:"px-4 pt-5 pb-1",children:c.jsx("span",{className:"text-[9px] font-black tracking-[0.25em] text-slate-500 uppercase select-none",children:e})}),Ti=({id:e,label:n,icon:a,activeTab:s,onClick:i,iconColor:u})=>{const f=s===e;return c.jsxs("button",{onClick:i,className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-xs font-bold transition-all duration-200 ${f?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[c.jsx("div",{className:`p-1.5 rounded-lg transition-colors ${f?"bg-white/20":"bg-slate-800"}`,children:c.jsx(a,{size:15,className:f?"":u??"text-slate-400"})}),c.jsx("span",{children:n})]})},GE=({onOpenGoalModal:e,onOpenCashClose:n,onToggleTheme:a,isDarkMode:s,onLogout:i,onOpenProfile:u})=>{const[f,d]=D.useState(!1),m=(x,g,v,b=!1)=>c.jsxs("button",{onClick:()=>{v(),d(!1)},className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-xs font-bold transition-all duration-200 ${b?"text-red-400 hover:bg-red-500/10 hover:text-red-300":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[x,g]});return c.jsxs("div",{children:[c.jsxs("button",{onClick:()=>d(!f),className:`w-full flex items-center justify-between px-4 py-2.5 rounded-xl text-xs font-bold transition-all duration-200 ${f?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`p-1.5 rounded-lg transition-colors ${f?"bg-white/20":"bg-slate-800"}`,children:c.jsx(yv,{size:15,className:f?"animate-spin-slow":""})}),c.jsx("span",{children:"Configuracin"})]}),c.jsx(Qw,{size:14,className:`transition-transform duration-300 ${f?"rotate-180":""}`})]}),c.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${f?"max-h-96 opacity-100 mt-1":"max-h-0 opacity-0"}`,children:c.jsxs("div",{className:"pl-3 flex flex-col gap-0.5 border-l border-slate-700 ml-6",children:[m(c.jsx(Fr,{size:14,className:"text-blue-400 shrink-0"}),"Mi Perfil",u),m(c.jsx(Gd,{size:14,className:"text-emerald-400 shrink-0"}),"Ajustar Meta",e),m(c.jsx(eo,{size:14,className:"text-amber-400 shrink-0"}),"Corte de Caja",n),m(s?c.jsx(gd,{size:14,className:"text-yellow-400 shrink-0"}):c.jsx(vv,{size:14,className:"text-indigo-400 shrink-0"}),`Tema ${s?"Claro":"Oscuro"}`,a),c.jsx("div",{className:"h-px bg-slate-800 my-1 mx-2"}),m(c.jsx(Hd,{size:14,className:"shrink-0"}),"Cerrar Sesin",i,!0)]})})]})},$E=({activeTab:e,onTabChange:n,onOpenGoalModal:a,onOpenCashClose:s,onOpenSupport:i,onOpenProfile:u})=>{const{logout:f,safeLogout:d,currentUser:m}=Jt(),{theme:x,toggleTheme:g}=dv(),[v,b]=D.useState(!1),[k,y]=D.useState(!1),w=()=>{d()?window.location.href="/login":b(!0)},N=()=>{b(!1),y(!0)},_=()=>{y(!1),f(),window.location.href="/login"};return c.jsxs("div",{className:"h-screen w-64 bg-[#0f172a] flex flex-col border-r border-gray-800 overflow-y-auto overflow-x-hidden transition-all duration-300 custom-scrollbar",children:[c.jsx("div",{className:"h-20 flex items-center px-8 border-b border-gray-800 shrink-0",children:c.jsx("h1",{className:"text-2xl font-bold text-white tracking-wider",children:"TEIKON"})}),c.jsx(Ni,{label:"Principal"}),c.jsxs("nav",{className:"flex flex-col gap-1 px-4",children:[c.jsx(Ti,{id:"dashboard",label:"Inicio",icon:AS,activeTab:e,onClick:()=>n("dashboard"),iconColor:"text-blue-400"}),c.jsx(Ti,{id:"pos",label:"Ventas",icon:Di,activeTab:e,onClick:()=>n("pos"),iconColor:"text-emerald-400"})]}),c.jsx(Ni,{label:"Clientes"}),c.jsxs("nav",{className:"flex flex-col gap-1 px-4",children:[c.jsx(Ti,{id:"products",label:"Inventario",icon:vl,activeTab:e,onClick:()=>n("products"),iconColor:"text-violet-400"}),c.jsx(Ti,{id:"history",label:"Historial",icon:Ri,activeTab:e,onClick:()=>n("history"),iconColor:"text-orange-400"})]}),c.jsx(Ni,{label:"Reportes"}),c.jsx("nav",{className:"flex flex-col gap-1 px-4",children:c.jsx(Ti,{id:"reports",label:"Estadsticas",icon:Kw,activeTab:e,onClick:()=>n("dashboard"),iconColor:"text-sky-400"})}),c.jsx(Ni,{label:"Soporte"}),c.jsx("nav",{className:"flex flex-col gap-1 px-4",children:c.jsxs("button",{onClick:i,className:"w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-xs font-bold text-slate-400 hover:bg-white/5 hover:text-white transition-all duration-200",children:[c.jsx("div",{className:"p-1.5 rounded-lg bg-slate-800",children:c.jsx(NS,{size:15,className:"text-rose-400"})}),c.jsx("span",{children:"Abrir Ticket"})]})}),c.jsx(Ni,{label:"Configuracin"}),c.jsx("div",{className:"px-4 pb-6",children:c.jsx(GE,{onOpenGoalModal:a,onOpenCashClose:s,onToggleTheme:g,isDarkMode:x==="dark",onLogout:w,onOpenProfile:u})}),c.jsx(VE,{isOpen:v,onClose:()=>b(!1),onGoToCloseShift:N}),c.jsx(Yd,{isOpen:k,onClose:()=>y(!1),onShiftClosed:_})]})},XE=({children:e,activeTab:n,onTabChange:a})=>{const{currentUser:s,getDashboardStats:i,settings:u,sales:f,logout:d}=Jt(),[m,x]=D.useState(!1),[g,v]=D.useState(!1),[b,k]=D.useState(!1),[y,w]=D.useState(!1),[N,_]=D.useState(!1),[O,E]=D.useState({salesToday:0,totalProfit:0});D.useEffect(()=>{const Y=(s==null?void 0:s.storeName)||"TeikonPOS",Q=R();document.title=`${Y} - ${Q}`},[s,n]),D.useEffect(()=>{(async()=>{try{const Q=await i("day");E(Q||{salesToday:0,totalProfit:0})}catch(Q){console.error("Error fetching layout stats",Q)}})()},[i,f,u]);const L=(u.monthlyFixedCosts||0)/30,G=O.salesToday||0,H=L>0?Math.min(Math.max(G/L*100,0),100):0,R=()=>{switch(n){case"dashboard":return"Resumen de Hoy";case"pos":return"Terminal de Ventas";case"history":return"Historial de Operaciones";case"products":return"Gestin de Stock";case"settings":return"Parmetros de Sistema";default:return"Teikon OS"}},Z=Y=>{a(Y),x(!1)};return c.jsxs("div",{className:"flex h-[100dvh] bg-brand-bg text-brand-text overflow-hidden transition-colors duration-500",children:[c.jsx(HE,{}),c.jsx("div",{className:"md:hidden bg-brand-panel border-b border-brand-border px-4 py-3 flex justify-between items-center shrink-0 z-[60] shadow-sm fixed top-0 left-0 right-0 h-14",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:()=>x(!0),className:"p-2 -ml-2 text-brand-text hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors","aria-label":"Open menu",children:c.jsx(PS,{size:24})}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("h1",{className:"text-lg font-black text-slate-900 dark:text-white leading-none",children:(s==null?void 0:s.storeName)||"TeikonPOS"}),c.jsx("span",{className:"text-[10px] font-bold text-brand-muted",children:(s==null?void 0:s.fullName)||(s==null?void 0:s.username)})]})]})}),m&&c.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 md:hidden animate-fade-in",onClick:()=>x(!1),"aria-label":"Close menu"}),c.jsx("div",{className:`
          fixed md:relative
          top-0 left-0 h-full
          z-[60] md:z-auto
          transition-all duration-300
          ${m?"translate-x-0 opacity-100":"-translate-x-full opacity-0 md:translate-x-0 md:opacity-100"}
        `,style:{transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)"},children:c.jsx($E,{activeTab:n,onTabChange:Z,onOpenGoalModal:()=>k(!0),onOpenCashClose:()=>w(!0),onOpenSupport:()=>v(!0),onOpenProfile:()=>_(!0)})}),c.jsxs("div",{className:"flex-1 flex flex-col min-w-0 relative w-full h-full bg-brand-bg mt-14 md:mt-0",children:[c.jsxs("header",{className:"h-14 md:h-20 bg-brand-panel border-b border-brand-border flex items-center justify-between px-4 md:px-8 shrink-0 z-40 sticky top-0",children:[c.jsxs("div",{className:"flex flex-col min-w-0",children:[c.jsx("h2",{className:"text-sm md:text-xl font-black text-slate-900 dark:text-white uppercase tracking-tighter truncate",children:R()}),c.jsxs("div",{className:"flex items-center gap-3 mt-0.5",children:[c.jsx("span",{className:"text-base md:text-2xl font-black text-blue-600 dark:text-blue-400 truncate",children:(s==null?void 0:s.storeName)||"SISTEMA"}),c.jsxs("span",{className:"hidden md:inline text-xs font-bold text-brand-muted",children:[" Hola, ",(s==null?void 0:s.fullName)||(s==null?void 0:s.username)]})]})]}),c.jsxs("div",{className:"flex flex-col items-end gap-1.5 max-w-[150px] md:max-w-[300px] w-full hidden sm:flex",children:[c.jsxs("div",{className:"flex justify-between w-full text-[8px] font-black uppercase tracking-widest text-brand-muted",children:[c.jsx("span",{children:"Meta Diaria"}),c.jsxs("span",{className:"text-slate-900 dark:text-white",children:["$",G.toFixed(0)," / $",L.toFixed(0)]})]}),c.jsx("div",{className:"h-2 w-full bg-slate-100 dark:bg-slate-900 rounded-full relative overflow-hidden shadow-inner border border-black/5 dark:border-white/5",children:c.jsx("div",{className:"h-full bg-brand-purple transition-all duration-1000 ease-out shadow-[0_0_10px_rgba(139,92,246,0.4)]",style:{width:`${H}%`}})})]})]}),c.jsx("main",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 md:p-8 custom-scrollbar scroll-smooth",children:c.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 md:space-y-10 min-h-full pb-20",children:[e,c.jsx("footer",{className:"pt-8 pb-4 border-t border-brand-border text-[9px] font-black text-brand-muted uppercase tracking-[0.5em] text-center opacity-30 select-none",children:"TEIKON OS // CORE INTELLIGENCE v2.9.2"})]})})]}),c.jsx($d,{isOpen:g,onClose:()=>v(!1)}),c.jsx(wv,{isOpen:b,onClose:()=>k(!1)}),c.jsx(Yd,{isOpen:y,onClose:()=>w(!1),onShiftClosed:()=>{w(!1),d(),window.location.href="/login"}}),N&&c.jsx(PE,{onClose:()=>_(!1)})]})},Ev=({storeId:e})=>{const{getDashboardStats:n,products:a,isOnline:s,sales:i,settings:u}=Jt(),[f,d]=D.useState(null),[m,x]=D.useState(!0),[g,v]=D.useState(!1),[b,k]=D.useState(null),y=async(Y=!0)=>{Y&&x(!0);try{const Q=await n("day",e);d(Q),k(new Date)}catch(Q){console.error("Dashboard fetch error",Q)}finally{x(!1),v(!1)}},w=()=>{v(!0),y(!1)};D.useEffect(()=>{y()},[n,e,i,u]);const N=(f==null?void 0:f.costoOperativo)||0,_=(f==null?void 0:f.utilidadNeta)||0,O=(f==null?void 0:f.utilidadBruta)||0;f!=null&&f.ventaTotal;const E=(f==null?void 0:f.porcentajeEquilibrio)||0,L=_>0,G=O>=N,H=(a||[]).filter(Y=>Y.isActive&&Y.stock>0&&Y.stock<=Y.minStock),R=(a||[]).filter(Y=>Y.isActive).length,Z=(i||[]).length;return m&&!f?c.jsxs("div",{className:"animate-pulse space-y-6",children:[c.jsx("div",{className:"h-72 bg-gradient-to-br from-purple-100 to-blue-100 dark:from-purple-900/20 dark:to-blue-900/20 rounded-3xl"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx("div",{className:"h-36 bg-slate-200 dark:bg-slate-800 rounded-2xl"}),c.jsx("div",{className:"h-36 bg-slate-200 dark:bg-slate-800 rounded-2xl"}),c.jsx("div",{className:"h-36 bg-slate-200 dark:bg-slate-800 rounded-2xl"}),c.jsx("div",{className:"h-36 bg-slate-200 dark:bg-slate-800 rounded-2xl"})]})]}):c.jsxs("div",{className:"space-y-6 pb-8",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-black text-slate-900 dark:text-white tracking-tight",children:"Dashboard"}),b&&c.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1 font-medium",children:["ltima actualizacin: ",b.toLocaleTimeString()]})]}),c.jsxs("button",{onClick:w,disabled:g,className:`flex items-center gap-2 px-5 py-2.5 rounded-xl font-bold text-sm transition-all shadow-lg ${g?"bg-slate-200 dark:bg-slate-700 text-slate-400 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-blue-600 text-white hover:from-purple-700 hover:to-blue-700 active:scale-95 shadow-purple-500/30"}`,children:[c.jsx(cE,{size:16,className:g?"animate-spin":""}),g?"Actualizando...":"Actualizar"]})]}),c.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-purple-600 via-blue-600 to-cyan-500 p-8 shadow-2xl shadow-purple-500/30",children:[c.jsxs("div",{className:"absolute inset-0 opacity-10",children:[c.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-white rounded-full blur-3xl animate-pulse"}),c.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-white rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}})]}),c.jsxs("div",{className:"relative z-10 space-y-6",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-white/20 backdrop-blur-sm rounded-lg",children:c.jsx(Vn,{className:"text-white",size:24})}),c.jsx("h4",{className:"text-sm font-black text-white/90 uppercase tracking-[0.2em]",children:"Utilidad del Da"}),!s&&c.jsx("span",{className:"px-2 py-1 bg-orange-500 text-white text-xs font-bold rounded-full",children:"Offline"})]}),c.jsxs("div",{className:"flex items-baseline gap-3",children:[c.jsxs("span",{className:"text-6xl md:text-7xl font-black text-white tracking-tighter drop-shadow-lg",children:["$",(O||0).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})]}),c.jsx("span",{className:"text-lg font-bold text-white/80",children:"MXN"})]})]}),c.jsx("div",{className:"flex flex-col items-end gap-2",children:c.jsxs("span",{className:`px-5 py-2 rounded-full text-xs font-black uppercase tracking-widest flex items-center gap-2 shadow-lg ${G?"bg-emerald-500 text-white":"bg-red-500 text-white"}`,children:[G?c.jsx(mv,{size:16}):c.jsx(Ba,{size:16}),G?"Cubriendo Gastos":"Bajo Equilibrio"]})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"p-5 bg-white/10 backdrop-blur-md rounded-2xl border border-white/20",children:[c.jsx("p",{className:"text-xs font-black text-white/80 uppercase tracking-widest mb-2",children:"Costo Operativo Diario"}),c.jsxs("p",{className:"text-3xl font-black text-white",children:["$",N.toFixed(2)]})]}),c.jsxs("div",{className:`p-5 rounded-2xl border backdrop-blur-md ${L?"bg-emerald-500/20 border-emerald-400/30":"bg-red-500/20 border-red-400/30"}`,children:[c.jsx("p",{className:`text-xs font-black uppercase tracking-widest mb-2 ${L?"text-emerald-100":"text-red-100"}`,children:"Utilidad Neta"}),c.jsxs("p",{className:`text-3xl font-black ${L?"text-emerald-50":"text-red-50"}`,children:["$",_.toLocaleString()]})]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-6 text-white shadow-lg shadow-emerald-500/30 hover:scale-105 transition-transform",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx(bE,{size:28,className:"opacity-90"}),c.jsx("span",{className:"text-4xl font-black",children:Z})]}),c.jsx("p",{className:"text-sm font-bold uppercase tracking-wide opacity-90",children:"Ventas Hoy"})]}),c.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white shadow-lg shadow-blue-500/30 hover:scale-105 transition-transform",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx(vl,{size:28,className:"opacity-90"}),c.jsx("span",{className:"text-4xl font-black",children:R})]}),c.jsx("p",{className:"text-sm font-bold uppercase tracking-wide opacity-90",children:"Productos Activos"})]}),c.jsxs("div",{className:`rounded-2xl p-6 text-white shadow-lg hover:scale-105 transition-transform ${H.length>0?"bg-gradient-to-br from-orange-500 to-red-600 shadow-orange-500/30":"bg-gradient-to-br from-slate-600 to-slate-700 shadow-slate-500/30"}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx(Ba,{size:28,className:"opacity-90"}),c.jsx("span",{className:"text-4xl font-black",children:H.length})]}),c.jsx("p",{className:"text-sm font-bold uppercase tracking-wide opacity-90",children:"Stock Bajo"})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg border border-slate-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{children:[c.jsxs("h4",{className:"text-sm font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest flex items-center gap-2",children:[c.jsx(Yw,{size:18}),"Cobertura de Gastos"]}),c.jsxs("div",{className:"flex items-baseline gap-2 mt-2",children:[c.jsxs("span",{className:"text-3xl font-black text-slate-900 dark:text-white",children:["$",O.toLocaleString("es-MX",{minimumFractionDigits:2})]}),c.jsxs("span",{className:"text-sm font-bold text-slate-500 dark:text-slate-400",children:["/ $",N.toLocaleString("es-MX",{minimumFractionDigits:2})]})]})]}),c.jsx("div",{className:"text-right",children:c.jsxs("span",{className:`text-4xl font-black ${G?"text-emerald-500":"text-red-500"}`,children:[Math.min(E,100).toFixed(0),"%"]})})]}),c.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-4 overflow-hidden shadow-inner",children:c.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out shadow-lg ${G?"bg-gradient-to-r from-emerald-500 to-teal-500":"bg-gradient-to-r from-red-500 to-orange-500"}`,style:{width:`${Math.min(E,100)}%`}})})]}),H.length>0&&c.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-950/30 dark:to-red-950/30 border-2 border-orange-300 dark:border-orange-600/50 p-6 rounded-2xl flex items-center gap-5 shadow-lg",children:[c.jsx("div",{className:"p-4 bg-gradient-to-br from-orange-500 to-red-600 rounded-2xl shadow-lg shadow-orange-500/30",children:c.jsx(Vd,{className:"text-white h-7 w-7"})}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-black text-orange-700 dark:text-orange-400 uppercase tracking-widest",children:"Alerta de Suministros"}),c.jsxs("p",{className:"text-base font-bold text-slate-700 dark:text-slate-300 mt-1",children:[H.length," producto",H.length>1?"s":""," requiere",H.length>1?"n":""," reposicin inmediata"]})]})]})]})},YE="58mm",vd='"Courier New", Courier, monospace',qE="12px",wl=32,D0="-".repeat(wl),xl=e=>{const a=String(e||"").substring(0,wl),s=Math.max(0,Math.floor((wl-a.length)/2));return" ".repeat(s)+a},F0=(e,n)=>{const a=String(e||""),i=String(n||"").substring(0,wl/2),u=wl-i.length;return a.substring(0,Math.max(0,u-1)).padEnd(u," ")+i},_i=e=>{const n=Number(e);return isNaN(n)?"0.00":n.toFixed(2)},Dp=({items:e,total:n,storeInfo:a,date:s,folio:i,sellerName:u,paymentMethod:f,amountPaid:d,change:m,footerMessage:x,isPrint:g=!1})=>{const v=(b,k)=>c.jsx("div",{style:{whiteSpace:"pre",overflow:"hidden",width:"100%"},children:b},k);return c.jsxs("div",{className:"thermal-ticket-content",style:{width:g?"100%":YE,fontFamily:vd,fontSize:qE,lineHeight:"1.2",color:"black",background:"white",padding:g?0:"0 2mm",margin:0,boxSizing:"border-box",textAlign:"left"},children:[v(xl(a.name)),a.address&&v(xl(a.address)),a.phone&&v(xl(`Tel: ${a.phone}`)),v(D0),v(`Fecha: ${s?new Date(s).toLocaleString("es-MX"):new Date().toLocaleString("es-MX")}`),i&&v(`Folio: ${String(i).toUpperCase()}`),u&&v(`Le atendi: ${u}`),v(D0),!Array.isArray(e)||e.length===0?v(xl("-- Sin productos --")):e.map((b,k)=>{if(!b)return null;const y=Number(b.quantity)||Number(b.qty)||Number(b.cantidad)||Number(b.units)||1,w=Number(b.unitPrice)||Number(b.price)||Number(b.salePrice)||Number(b.sellingPrice)||Number(b.precio)||0,N=y*w,_=String(b.productName||b.name||b.nombre||"Producto"),O=`${y} x $${_i(w)}`,E=`$${_i(N)}`,L=F0(O,E);return c.jsxs("div",{children:[v(_.substring(0,wl)),v(L)]},k)}),v(D0),v(F0("TOTAL:",`$${_i(n)}`)),d>0&&c.jsxs(c.Fragment,{children:[v(F0("Efectivo:",`$${_i(d)}`)),v(F0("Cambio:",`$${_i(m)}`))]}),f&&v(`Pago: ${f==="CASH"?"EFECTIVO":f}`),v(D0),c.jsxs("div",{style:{paddingTop:"8px"},children:[v(xl(x)),v(xl("** Gracias por su preferencia **"))]})]})},Nv=({saleId:e,items:n,total:a,amountPaid:s=0,change:i=0,date:u,storeInfo:f,footerMessage:d="Gracias por su compra!",folio:m,paymentMethod:x,sellerId:g,onClose:v,shouldAutoPrint:b=!1,hideControls:k=!1})=>{var se,Ae;const[y,w]=D.useState(null),[N,_]=D.useState(!1),[O,E]=D.useState(null),[L,G]=D.useState(null);D.useEffect(()=>{const ae=document.getElementById("print-ticket");G(ae)},[]),D.useEffect(()=>{e&&(!n||!a||!u)&&(async()=>{_(!0),E(null);try{const B=await gs.getById(e);w(B)}catch(B){E(B.message||"Error al cargar venta")}finally{_(!1)}})()},[e,n,a,u]);const H=n||(y==null?void 0:y.items)||[],R=a??(y==null?void 0:y.total)??0,Z=u||(y==null?void 0:y.date)||new Date().toISOString(),Y=m||((se=y==null?void 0:y.id)==null?void 0:se.slice(0,8))||"N/A",Q=x||(y==null?void 0:y.paymentMethod);let K=g||(y==null?void 0:y.vendedor)||(y==null?void 0:y.sellerId)||"SISTEMA";typeof K=="object"&&K!==null&&(K=K.username||K.name||"SISTEMA");const Ee=(ae=>{const Ce=String(ae||"");if(Ce.includes("("))return Ce.split("(")[0].trim();if(Ce.includes("@")){const B=Ce.split("@")[0];return B.charAt(0).toUpperCase()+B.slice(1)}return Ce})(K),Ne=f||{name:((Ae=y==null?void 0:y.store)==null?void 0:Ae.nombre)||"TEIKON POS",address:"Sistema de Punto de Venta",phone:"N/A"},me=D.useRef(!1);D.useEffect(()=>{b&&!N&&!O&&!me.current&&H.length>0&&(me.current=!0,setTimeout(()=>window.print(),500))},[b,N,O,H.length]);const J={items:H,total:R,storeInfo:Ne,date:Z,folio:Y,sellerName:Ee,paymentMethod:Q,amountPaid:s,change:i,footerMessage:d};return N?c.jsx("div",{style:{fontFamily:vd,padding:"20px"},children:"Cargando ticket..."}):O?c.jsxs("div",{style:{fontFamily:vd,padding:"20px",color:"red"},children:["Error: ",O]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"ticket-preview-container print:hidden",style:{background:"#fff",border:"1px solid #eee",padding:"10px",display:"inline-block"},children:c.jsx(Dp,{...J,isPrint:!1})}),L&&rw.createPortal(c.jsxs(c.Fragment,{children:[c.jsx("style",{children:`
              @media print {
                body { margin: 0; padding: 0; }
                .print-wrapper { width: 100%; display: block; }
                .ticket { width: 58mm; margin: 0 auto; padding: 0; font-family: monospace; font-size: 12px; }
                .thermal-ticket-content { width: 100% !important; }
              }
            `}),c.jsx("div",{className:"print-wrapper",children:c.jsx("div",{className:"ticket",children:c.jsx(Dp,{...J,isPrint:!0})})})]}),L),v&&!k&&c.jsxs("div",{className:"no-print",style:{textAlign:"center",marginTop:"10px",display:"flex",gap:"10px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>window.print(),style:{background:"black",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontFamily:"sans-serif"},children:"IMPRIMIR"}),c.jsx("button",{onClick:v,style:{background:"#ef4444",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontFamily:"sans-serif"},children:"CERRAR"})]})]})},KE=({searchTerm:e,setSearchTerm:n,searchInputRef:a,onKeyDown:s,onCloseShift:i})=>{const{sales:u,settings:f}=Jt(),d=new Date,m=d.getFullYear(),x=d.getMonth(),g=d.getDate(),v=new Date(m,x+1,0).getDate(),b=g/v*100,k=u.filter(O=>{const E=new Date(O.date);return O.status==="ACTIVE"&&E.getMonth()===x&&E.getFullYear()===m}).reduce((O,E)=>O+(E.netProfit||0),0),y=f.monthlyFixedCosts||3e4,w=y>0?Math.min(k/y*100,100):0,N=w>=b,_=N?"bg-gradient-to-r from-emerald-500 to-emerald-400 shadow-[0_0_10px_rgba(16,185,129,0.4)]":"bg-gradient-to-r from-orange-500 to-red-500 shadow-[0_0_10px_rgba(239,68,68,0.4)]";return c.jsxs("div",{className:"bg-white dark:bg-slate-900 border-b-2 border-brand-emerald/20 px-4 py-3 flex items-center justify-between gap-4 shrink-0 shadow-sm",children:[c.jsx("div",{className:"flex-1 max-w-xs",children:c.jsxs("div",{className:"relative",children:[c.jsx(ic,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),c.jsx("input",{ref:a,className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 dark:bg-slate-950 border-2 border-slate-200 dark:border-slate-800 rounded-xl focus:border-brand-emerald outline-none transition-all text-sm font-bold text-slate-900 dark:text-white placeholder:text-slate-400",placeholder:"Buscar producto...",value:e,onChange:O=>n(O.target.value),onKeyDown:s})]})}),c.jsxs("div",{className:"hidden md:flex flex-col items-center gap-1.5 min-w-[320px]",children:[c.jsxs("div",{className:"flex justify-between w-full text-[9px] font-black uppercase tracking-widest text-slate-500",children:[c.jsx("span",{children:"Salud Financiera"}),c.jsxs("span",{className:N?"text-emerald-600 dark:text-emerald-400":"text-orange-600 dark:text-orange-400",children:["$",k.toLocaleString()," / $",y.toLocaleString()]})]}),c.jsxs("div",{className:"h-3.5 w-full bg-slate-100 dark:bg-slate-800 rounded-full relative overflow-visible border border-slate-200 dark:border-slate-700",children:[c.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out relative z-10 ${_}`,style:{width:`${w}%`},title:`Progreso Financiero: ${w.toFixed(1)}%`}),c.jsx("div",{className:"absolute top-[-4px] bottom-[-4px] w-1 bg-slate-900/40 dark:bg-white/40 z-20 backdrop-blur-sm rounded-full pointer-events-none transition-all duration-500",style:{left:`${b}%`},title:`Da ${g} de ${v} (${b.toFixed(1)}% del mes)`,children:c.jsxs("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 text-[8px] font-bold text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-800 px-1.5 py-0.5 rounded shadow-sm opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap",children:["Da ",g]})})]}),c.jsxs("div",{className:"w-full flex justify-between items-center px-1",children:[c.jsx("span",{className:"text-[8px] font-bold text-slate-400",children:"Inicio Mes"}),c.jsx("span",{className:`text-[8px] font-bold ${N?"text-emerald-500":"text-orange-500"}`,children:N?" SUPERVIT (EN CAMINO)":" DFICIT (ATRASADO)"}),c.jsx("span",{className:"text-[8px] font-bold text-slate-400",children:"Fin Mes"})]})]}),c.jsx("div",{children:c.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 rounded-full border border-red-200 dark:border-red-800 text-xs font-black uppercase tracking-widest hover:bg-red-100 dark:hover:bg-red-900/40 transition-colors",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),"Cerrar Turno"]})})]})},WE=({isOpen:e,onClose:n})=>{const a=sc(),{getDashboardStats:s}=Jt(),[i,u]=D.useState({totalRevenue:0,totalProfit:0,totalSales:0,profitMargin:0}),[f,d]=D.useState(!1);D.useEffect(()=>{e&&m()},[e]);const m=async()=>{d(!0);try{const g=localStorage.getItem("cashRegisterOpenedAt");if(!g){console.error("No shift start time found"),u({totalRevenue:0,totalProfit:0,totalSales:0,profitMargin:0});return}const v=await fetch(`${rt}/api/sales/cash-close?shiftStartTime=${g}`,{headers:nn()});if(!v.ok)throw new Error("Failed to fetch shift stats");const b=await v.json();u(b)}catch(g){console.error("Error fetching shift stats",g),u({totalRevenue:0,totalProfit:0,totalSales:0,profitMargin:0})}finally{d(!1)}},x=()=>{confirm(`Confirmar cierre de turno?

Ventas: $${(i.totalRevenue||0).toLocaleString()}
Ganancia: $${(i.totalProfit||0).toLocaleString()}

Esta accin cerrar tu sesin.`)&&(localStorage.removeItem("cashRegisterOpenedAt"),localStorage.removeItem("cashRegisterSession"),localStorage.removeItem("cart"),sessionStorage.clear(),J0(),alert(" Turno cerrado exitosamente. Sesin finalizada."),a("/login"))};return c.jsx(Mr,{isOpen:e,onClose:n,title:"CORTE DE CAJA",children:c.jsx("div",{className:"space-y-6 p-2",children:f?c.jsx("div",{className:"text-center py-10",children:c.jsx("p",{className:"text-sm font-bold text-slate-500",children:"Cargando resumen..."})}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"p-4 bg-emerald-500/5 rounded-2xl border-2 border-emerald-500/10",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx($i,{className:"text-emerald-600",size:20}),c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-500",children:"Ingresos"})]}),c.jsxs("p",{className:"text-2xl font-black text-emerald-600",children:["$",(i.totalRevenue||0).toLocaleString()]})]}),c.jsxs("div",{className:"p-4 bg-purple-500/5 rounded-2xl border-2 border-purple-500/10",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Vn,{className:"text-purple-600",size:20}),c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-500",children:"Ganancia"})]}),c.jsxs("p",{className:"text-2xl font-black text-purple-600",children:["$",(i.totalProfit||0).toLocaleString()]})]}),c.jsxs("div",{className:"p-4 bg-blue-500/5 rounded-2xl border-2 border-blue-500/10",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Di,{className:"text-blue-600",size:20}),c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-500",children:"Transacciones"})]}),c.jsx("p",{className:"text-2xl font-black text-blue-600",children:i.totalSales||0})]}),c.jsxs("div",{className:"p-4 bg-amber-500/5 rounded-2xl border-2 border-amber-500/10",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(eE,{className:"text-amber-600",size:20}),c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-500",children:"Margen"})]}),c.jsxs("p",{className:"text-2xl font-black text-amber-600",children:[(i.profitMargin||0).toFixed(1),"%"]})]})]}),c.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800",children:c.jsxs("p",{className:"text-xs font-bold text-slate-600 dark:text-slate-400 text-center",children:[" Resumen del da: ",new Date().toLocaleDateString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx(at,{variant:"secondary",fullWidth:!0,onClick:n,children:"CANCELAR"}),c.jsx(at,{variant:"primary",fullWidth:!0,onClick:x,className:"bg-emerald-600 hover:bg-emerald-700",children:"CERRAR TURNO"})]})]})})})},ZE=()=>{const{products:e,processSaleAndContributeToGoal:n,currentUser:a,syncData:s,currentSession:i}=Jt(),[u,f]=D.useState(""),[d,m]=D.useState([]),[x,g]=D.useState(!1),[v,b]=D.useState(!1),[k,y]=D.useState(!1),[w,N]=D.useState(""),[_,O]=D.useState(null),[E,L]=D.useState(null),[G,H]=D.useState(!1),[R,Z]=D.useState(!1),[Y,Q]=D.useState(!1),[K,ee]=D.useState(!1),[Ee,Ne]=D.useState(!1),[me,J]=D.useState("CASH"),se=D.useRef(null);D.useEffect(()=>{const z=()=>{var ne;!x&&!G&&window.innerWidth>768&&((ne=se.current)==null||ne.focus())};return z(),window.addEventListener("focus",z),()=>window.removeEventListener("focus",z)},[x,G]),D.useEffect(()=>{if(d.length>0){Z(!0);const z=setTimeout(()=>Z(!1),300);return()=>clearTimeout(z)}},[d.length]),D.useEffect(()=>{const z=ne=>{ne.ctrlKey&&ne.key==="Enter"&&(ne.preventDefault(),d.length>0&&g(!0))};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[d]);const Ae=z=>{if(z.ctrlKey&&z.key==="Enter"){z.preventDefault(),d.length>0&&g(!0);return}if(z.key==="Enter"){z.preventDefault();const ne=u.trim();if(!ne)return;const Te=e.find(ge=>ge.sku===ne||ge.sku.toLowerCase()===ne.toLowerCase());Te?(Ce(Te),f("")):(alert("Producto no encontrado"),f(""))}},ae=e.filter(z=>z.isActive&&(z.name.toLowerCase().includes(u.toLowerCase())||z.sku.toUpperCase().includes(u.toUpperCase().trim()))),Ce=z=>{var ne;m(Te=>Te.find(ke=>ke.productId===z.id)?Te.map(ke=>ke.productId===z.id?{...ke,quantity:ke.quantity+1,subtotal:(ke.quantity+1)*ke.sellingPrice}:ke):(O(z.id),setTimeout(()=>O(null),1e3),[...Te,{productId:z.id,name:z.name,quantity:1,sellingPrice:Number(z.salePrice),unitCost:Number(z.costPrice),image:z.image,subtotal:Number(z.salePrice)}])),window.innerWidth>768&&((ne=se.current)==null||ne.focus())},B=(z,ne)=>{m(Te=>Te.map(ge=>{if(ge.productId===z){const ke=Math.max(0,ge.quantity+ne);return{...ge,quantity:ke,subtotal:ke*ge.sellingPrice}}return ge}).filter(ge=>ge.quantity>0))},q=d.reduce((z,ne)=>z+ne.sellingPrice*ne.quantity,0),V=(parseFloat(w)||0)-q;D.useEffect(()=>{x&&N(me!=="CASH"?q.toString():"")},[me,x,q]);const T=async()=>{var X;const z=parseFloat(w)||0,ne=Number(q)||0,Te=z-ne;if(isNaN(ne)||isNaN(Te)||ne<0){alert(" Error Crtico: Hay un clculo invlido en la venta (NaN). Por favor revisa los precios de los productos."),console.error("Calculo invlido:",{total:q,pay:z,safeChange:Te});return}if(me==="CASH"&&Te<0)return;const ge=d.map(nt=>({productId:nt.productId,name:nt.name,sellingPrice:Number(nt.sellingPrice)||0,unitCost:Number(nt.unitCost)||0,quantity:Number(nt.quantity)||1})),ke=[...d],$e=await n(ge,me);if($e.success){const nt=$e.sale;if(nt)L({...nt,revenue:$e.totalRevenueAdded,profit:$e.totalProfitAdded,folio:((X=nt.id)==null?void 0:X.slice(0,8))||"N/A"});else{console.warn(" No sale object returned, using local snapshot fallback");const pe=crypto.randomUUID().slice(0,8);L({revenue:$e.totalRevenueAdded,profit:$e.totalProfitAdded,items:ke,folio:pe})}m([]),g(!1),N(""),J("CASH"),H(!0)}};return c.jsxs("div",{className:"flex flex-col gap-6 h-[calc(100vh-80px)] md:h-[calc(100vh-140px)] overflow-hidden",children:[c.jsx(KE,{searchTerm:u,setSearchTerm:f,searchInputRef:se,onKeyDown:Ae,onCloseShift:()=>y(!0)}),c.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 flex-1 min-h-0",children:[c.jsx("div",{className:"flex-1 flex flex-col lg:w-2/3 card-premium overflow-hidden border-t-4 border-t-brand-emerald bg-white dark:bg-slate-900 shadow-xl min-h-0 pb-0 relative",children:c.jsx("div",{className:"absolute inset-0 overflow-y-auto p-4 grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2 sm:gap-3 md:gap-4 content-start pb-[100px] lg:pb-4 custom-scrollbar",children:ae.map((z,ne)=>c.jsxs("div",{onClick:()=>Ce(z),className:`group relative p-1.5 sm:p-2 md:p-2.5 bg-white dark:bg-slate-800 border-2 rounded-2xl cursor-pointer transition-all duration-200 ease-out hover:scale-105 hover:shadow-xl min-h-[140px] sm:min-h-[160px] ${_===z.id?"border-brand-emerald ring-4 ring-brand-emerald/10":"border-slate-100 dark:border-slate-700 hover:border-brand-emerald/40"}`,children:[c.jsxs("div",{className:"relative aspect-square w-full bg-slate-50 dark:bg-slate-900 rounded-xl mb-1.5 sm:mb-2 md:mb-3 flex items-center justify-center overflow-hidden border border-slate-100 dark:border-slate-700",children:[z.image?c.jsx("img",{src:z.image,className:"h-full w-full object-cover group-hover:scale-110 transition-transform duration-500",alt:z.name}):c.jsx(jS,{className:"text-slate-200 dark:text-slate-700",size:32}),c.jsxs("div",{className:`absolute top-2 right-2 px-2 py-1.5 sm:px-2.5 rounded-lg font-bold uppercase tracking-tight shadow-md ${z.stock===0?"text-red-500 bg-red-50 ring-2 ring-red-500 text-xl sm:text-2xl animate-pulse":z.stock<=z.minStock?"bg-red-500 text-white text-sm sm:text-base md:text-xl animate-pulse":"bg-black/50 dark:bg-white/20 text-white text-sm sm:text-base md:text-xl backdrop-blur-sm"}`,children:[z.stock," U."]})]}),c.jsxs("div",{className:"px-1 space-y-1",children:[c.jsx("h4",{className:"text-[9px] sm:text-[10px] md:text-[11px] font-black text-slate-900 dark:text-white line-clamp-2 min-h-[1.75rem] sm:min-h-[2rem] leading-tight uppercase tracking-tight",children:z.name}),c.jsxs("div",{className:"flex justify-between items-center pt-1",children:[c.jsxs("p",{className:"text-sm sm:text-base md:text-lg font-black text-brand-emerald tracking-tighter",children:["$",(z.salePrice||0).toLocaleString()]}),c.jsx("div",{className:"hidden md:block p-1.5 bg-brand-emerald/10 text-brand-emerald rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx(ao,{size:14})})]})]})]},z.id))})}),c.jsxs("div",{className:"hidden lg:flex lg:w-1/3 flex-col card-premium overflow-hidden border-t-4 border-t-brand-emerald shadow-2xl bg-white dark:bg-slate-900",children:[c.jsxs("div",{className:"px-4 py-3 border-b border-brand-border flex justify-between items-center bg-slate-50 dark:bg-slate-950 shrink-0",children:[c.jsxs("div",{className:`flex items-center gap-2 transition-transform duration-300 ${R?"scale-125 text-brand-emerald":"scale-100"}`,children:[c.jsx(Di,{size:16,className:R?"animate-bounce":"text-brand-emerald"}),c.jsx("h3",{className:"text-[10px] font-black uppercase tracking-widest",children:"Detalle"})]}),c.jsxs("span",{className:`bg-brand-emerald/10 text-brand-emerald px-3 py-1 rounded-full text-[9px] font-black transition-all ${R?"scale-110 rotate-3":"scale-100"}`,children:[d.length," TEMS"]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2 custom-scrollbar",children:[d.map(z=>c.jsxs("div",{className:"p-3 rounded-[1.2rem] border-2 border-slate-50 dark:border-slate-800 bg-white dark:bg-black/20 animate-fade-in-up",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("p",{className:"text-[10px] font-black uppercase truncate max-w-[150px]",children:z.name}),c.jsx("button",{onClick:()=>m(ne=>ne.filter(Te=>Te.productId!==z.productId)),className:"min-w-[44px] min-h-[44px] flex items-center justify-center text-slate-300 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-950/20 rounded-lg active:scale-90 transition-all","aria-label":"Eliminar item",children:c.jsx(qi,{size:18})})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>B(z.productId,-1),className:"min-w-[44px] min-h-[44px] flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-lg active:scale-90 transition-transform","aria-label":"Disminuir cantidad",children:c.jsx($S,{size:16})}),c.jsx("span",{className:"text-sm font-black w-8 text-center",children:z.quantity}),c.jsx("button",{onClick:()=>B(z.productId,1),className:"min-w-[44px] min-h-[44px] flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-lg active:scale-90 transition-transform","aria-label":"Aumentar cantidad",children:c.jsx(ao,{size:16})})]}),c.jsxs("span",{className:"text-[8px] font-bold text-slate-400 uppercase mt-1",children:["u. $",(z.sellingPrice||0).toLocaleString()]})]}),c.jsxs("p",{className:"text-lg font-black text-brand-emerald",children:["$",(z.subtotal||0).toLocaleString()]})]})]},z.productId)),d.length===0&&c.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center py-10 opacity-20",children:[c.jsx(Di,{size:40,className:"mb-2"}),c.jsx("p",{className:"text-[9px] font-black uppercase tracking-[0.3em]",children:"Carrito Vaco"})]})]}),c.jsxs("div",{className:"p-4 border-t border-brand-border bg-slate-50 dark:bg-slate-950 mt-auto shrink-0",children:[c.jsxs("div",{className:`flex flex-col md:flex-row justify-between items-center mb-3 gap-2 transition-all duration-300 ${R?"animate-pop":""}`,children:[c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest whitespace-nowrap",children:"Total Final"}),c.jsx("p",{className:"text-xl md:text-3xl font-black text-brand-emerald tracking-tighter whitespace-nowrap overflow-hidden text-ellipsis",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(q||0)})]}),c.jsx(at,{fullWidth:!0,variant:"sales",disabled:d.length===0||!i,onClick:()=>g(!0),className:"h-[48px] text-sm font-black",children:i?"CONFIRMAR VENTA":" CAJA CERRADA"})]})]})]}),c.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-slate-900 border-t-4 border-t-brand-emerald shadow-2xl",children:c.jsxs("div",{className:"p-4 space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Di,{size:20,className:`text-brand-emerald ${R?"animate-bounce":""}`}),c.jsxs("span",{className:"text-sm font-black text-slate-900 dark:text-white",children:[d.length," ",d.length===1?"item":"items"]})]}),c.jsx("p",{className:"text-2xl md:text-3xl font-black text-brand-emerald tracking-tighter",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(q||0)})]}),c.jsx(at,{fullWidth:!0,variant:"sales",disabled:d.length===0||!i,onClick:()=>g(!0),className:"h-[52px] text-sm font-black shadow-lg",children:i?"CONFIRMAR VENTA":" CAJA CERRADA"})]})}),c.jsx(Mr,{isOpen:x,onClose:()=>g(!1),title:"FINALIZAR OPERACIN",children:c.jsxs("div",{className:"space-y-6 p-1",children:[c.jsxs("div",{className:"text-center p-6 bg-emerald-500/5 rounded-[2rem] border-2 border-brand-emerald/10",children:[c.jsx("p",{className:"text-[10px] font-black text-brand-muted uppercase tracking-[0.5em] mb-2",children:"Total"}),c.jsxs("p",{className:"text-4xl md:text-6xl font-black text-brand-emerald tracking-tighter",children:["$",(q||0).toLocaleString()]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("button",{onClick:()=>J("CASH"),className:`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all min-h-[44px] ${me==="CASH"?"border-brand-emerald bg-emerald-50 text-brand-emerald":"border-slate-100 bg-white text-slate-400"}`,children:[c.jsx(eo,{size:24,className:"mb-1"}),c.jsx("span",{className:"text-[10px] font-black uppercase",children:"Efectivo"})]}),c.jsxs("button",{onClick:()=>J("CARD"),className:`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all min-h-[44px] ${me==="CARD"?"border-blue-500 bg-blue-50 text-blue-600":"border-slate-100 bg-white text-slate-400"}`,children:[c.jsx(fS,{size:24,className:"mb-1"}),c.jsx("span",{className:"text-[10px] font-black uppercase",children:"Tarjeta"})]}),c.jsxs("button",{onClick:()=>J("TRANSFER"),className:`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all min-h-[44px] ${me==="TRANSFER"?"border-purple-500 bg-purple-50 text-purple-600":"border-slate-100 bg-white text-slate-400"}`,children:[c.jsx(Pw,{size:24,className:"mb-1"}),c.jsx("span",{className:"text-[10px] font-black uppercase",children:"Transfer"})]})]}),c.jsxs("div",{className:"space-y-2 px-2",children:[c.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest",children:me==="CASH"?"Efectivo Recibido":"Monto Referencia"}),c.jsx("input",{type:"number",className:"w-full py-5 text-4xl font-black bg-slate-50 dark:bg-slate-950 border-4 border-slate-100 dark:border-slate-800 rounded-[2rem] outline-none focus:border-brand-emerald text-center",value:w,onChange:z=>N(z.target.value),placeholder:"0",autoFocus:!0,readOnly:me!=="CASH"})]}),me==="CASH"&&c.jsxs("div",{className:`p-4 rounded-[1.5rem] border-2 flex justify-between items-center ${V>=0?"bg-emerald-500/5 border-emerald-500/20":"bg-red-500/5 border-red-500/20"}`,children:[c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:V>=0?"Cambio":"Faltante"}),c.jsxs("span",{className:"text-2xl font-black",children:["$",Math.abs(V).toLocaleString()]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-2",children:[c.jsx(at,{variant:"secondary",fullWidth:!0,onClick:()=>g(!1),className:"h-[48px]",children:"MODIFICAR"}),c.jsx(at,{variant:"sales",fullWidth:!0,disabled:me==="CASH"&&V<0,onClick:T,className:"h-[48px]",children:"FINALIZAR VENTA"})]})]})}),c.jsx(Mr,{isOpen:G&&E!==null,onClose:()=>{H(!1),L(null)},title:" VENTA COMPLETADA",children:E&&c.jsxs("div",{className:"space-y-4",children:[c.jsx(Nv,{saleId:E.id,items:E.items,total:E.total||E.revenue,paymentMethod:E.paymentMethod||"CASH",sellerId:E.sellerId||(a==null?void 0:a.username)||"SISTEMA",folio:E.folio,date:E.date||new Date().toISOString(),storeInfo:{name:(a==null?void 0:a.storeName)||"TEIKON OS TERMINAL",address:"NODO OPERATIVO ACTIVO",phone:(a==null?void 0:a.phone)||"N/A"},onClose:()=>{},hideControls:!0}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx(at,{variant:"secondary",fullWidth:!0,onClick:()=>{H(!1),L(null)},className:"h-[48px]",children:"CERRAR"}),c.jsx(at,{variant:"primary",fullWidth:!0,onClick:()=>window.print(),className:"h-[48px]",children:"IMPRIMIR"})]})]})}),c.jsx(wv,{isOpen:Y,onClose:()=>Q(!1)}),c.jsx(WE,{isOpen:K,onClose:()=>ee(!1)}),c.jsx($d,{isOpen:Ee,onClose:()=>Ne(!1)}),c.jsx(Yd,{isOpen:k,onClose:()=>y(!1),onShiftClosed:()=>window.location.reload()})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Tv=1252,JE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],qd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Kd=function(e){JE.indexOf(e)!=-1&&(Tv=qd[0]=e)};function QE(){Kd(1252)}var Sr=function(e){Kd(e)};function _v(){Sr(1200),QE()}function Fp(e){for(var n=[],a=0,s=e.length;a<s;++a)n[a]=e.charCodeAt(a);return n}function eN(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return n.join("")}function Av(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return n.join("")}var Ai=function(e){var n=e.charCodeAt(0),a=e.charCodeAt(1);return n==255&&a==254?eN(e.slice(2)):n==254&&a==255?Av(e.slice(2)):n==65279?e.slice(1):e},M0=function(n){return String.fromCharCode(n)},Mp=function(n){return String.fromCharCode(n)},Ki,Pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Lp(e){for(var n="",a=0,s=0,i=0,u=0,f=0,d=0,m=0,x=0;x<e.length;)a=e.charCodeAt(x++),u=a>>2,s=e.charCodeAt(x++),f=(a&3)<<4|s>>4,i=e.charCodeAt(x++),d=(s&15)<<2|i>>6,m=i&63,isNaN(s)?d=m=64:isNaN(i)&&(m=64),n+=Pn.charAt(u)+Pn.charAt(f)+Pn.charAt(d)+Pn.charAt(m);return n}function qa(e){var n="",a=0,s=0,i=0,u=0,f=0,d=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)u=Pn.indexOf(e.charAt(x++)),f=Pn.indexOf(e.charAt(x++)),a=u<<2|f>>4,n+=String.fromCharCode(a),d=Pn.indexOf(e.charAt(x++)),s=(f&15)<<4|d>>2,d!==64&&(n+=String.fromCharCode(s)),m=Pn.indexOf(e.charAt(x++)),i=(d&3)<<6|m,m!==64&&(n+=String.fromCharCode(i));return n}var ut=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ns=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Xn(e){return ut?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ip(e){return ut?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wr=function(n){return ut?Ns(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function Ts(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var n=[],a=0;a<e.length;++a)n[a]=String.fromCharCode(e[a]);return n.join("")}function Wd(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Wd(new Uint8Array(e));for(var n=new Array(e.length),a=0;a<e.length;++a)n[a]=e[a];return n}var Un=ut?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:Ns(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<e.length;++n)a+=e[n].length;var s=new Uint8Array(a),i=0;for(n=0,a=0;n<e.length;a+=i,++n)if(i=e[n].length,e[n]instanceof Uint8Array)s.set(e[n],a);else{if(typeof e[n]=="string")throw"wtf";s.set(new Uint8Array(e[n]),a)}return s}return[].concat.apply([],e.map(function(u){return Array.isArray(u)?u:[].slice.call(u)}))};function tN(e){for(var n=[],a=0,s=e.length+250,i=Xn(e.length+255),u=0;u<e.length;++u){var f=e.charCodeAt(u);if(f<128)i[a++]=f;else if(f<2048)i[a++]=192|f>>6&31,i[a++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var d=e.charCodeAt(++u)&1023;i[a++]=240|f>>8&7,i[a++]=128|f>>2&63,i[a++]=128|d>>6&15|(f&3)<<4,i[a++]=128|d&63}else i[a++]=224|f>>12&15,i[a++]=128|f>>6&63,i[a++]=128|f&63;a>s&&(n.push(i.slice(0,a)),a=0,i=Xn(65535),s=65530)}return n.push(i.slice(0,a)),Un(n)}var _a=/\u0000/g,Ci=/[\u0001-\u0006]/g;function bl(e){for(var n="",a=e.length-1;a>=0;)n+=e.charAt(a--);return n}function Er(e,n){var a=""+e;return a.length>=n?a:Lt("0",n-a.length)+a}function Zd(e,n){var a=""+e;return a.length>=n?a:Lt(" ",n-a.length)+a}function no(e,n){var a=""+e;return a.length>=n?a:a+Lt(" ",n-a.length)}function aN(e,n){var a=""+Math.round(e);return a.length>=n?a:Lt("0",n-a.length)+a}function rN(e,n){var a=""+e;return a.length>=n?a:Lt("0",n-a.length)+a}var Bp=Math.pow(2,32);function ml(e,n){if(e>Bp||e<-Bp)return aN(e,n);var a=Math.round(e);return rN(a,n)}function so(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var zp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Wf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function nN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Up={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},sN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function lo(e,n,a){for(var s=e<0?-1:1,i=e*s,u=0,f=1,d=0,m=1,x=0,g=0,v=Math.floor(i);x<n&&(v=Math.floor(i),d=v*f+u,g=v*x+m,!(i-v<5e-8));)i=1/(i-v),u=f,f=d,m=x,x=g;if(g>n&&(x>n?(g=m,d=u):(g=x,d=f)),!a)return[0,s*d,g];var b=Math.floor(s*d/g);return[b,s*d-b*g,g]}function vs(e,n,a){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),u=0,f=[],d={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),n&&n.date1904&&(s+=1462),d.u>.9999&&(d.u=0,++i==86400&&(d.T=i=0,++s,++d.D)),s===60)f=a?[1317,10,29]:[1900,2,29],u=3;else if(s===0)f=a?[1317,8,29]:[1900,1,0],u=6;else{s>60&&--s;var m=new Date(1900,0,1);m.setDate(m.getDate()+s-1),f=[m.getFullYear(),m.getMonth()+1,m.getDate()],u=m.getDay(),s<60&&(u=(u+6)%7),a&&(u=fN(m,f))}return d.y=f[0],d.m=f[1],d.d=f[2],d.S=i%60,i=Math.floor(i/60),d.M=i%60,i=Math.floor(i/60),d.H=i,d.q=u,d}var Cv=new Date(1899,11,31,0,0,0),lN=Cv.getTime(),iN=new Date(1900,2,1,0,0,0);function jv(e,n){var a=e.getTime();return n?a-=1461*24*60*60*1e3:e>=iN&&(a+=1440*60*1e3),(a-(lN+(e.getTimezoneOffset()-Cv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Jd(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function cN(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function oN(e){var n=e<0?12:11,a=Jd(e.toFixed(12));return a.length<=n||(a=e.toPrecision(10),a.length<=n)?a:e.toExponential(5)}function uN(e){var n=Jd(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function Wi(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return n>=-4&&n<=-1?a=e.toPrecision(10+n):Math.abs(n)<=9?a=oN(e):n===10?a=e.toFixed(10).substr(0,12):a=uN(e),Jd(cN(a.toUpperCase()))}function ws(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Wi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return xr(14,jv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function fN(e,n){n[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function dN(e,n,a,s){var i="",u=0,f=0,d=a.y,m,x=0;switch(e){case 98:d=a.y+543;case 121:switch(n.length){case 1:case 2:m=d%100,x=2;break;default:m=d%1e4,x=4;break}break;case 109:switch(n.length){case 1:case 2:m=a.m,x=n.length;break;case 3:return Wf[a.m-1][1];case 5:return Wf[a.m-1][0];default:return Wf[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:m=a.d,x=n.length;break;case 3:return zp[a.q][0];default:return zp[a.q][1]}break;case 104:switch(n.length){case 1:case 2:m=1+(a.H+11)%12,x=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:m=a.H,x=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:m=a.M,x=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?Er(a.S,n.length):(s>=2?f=s===3?1e3:100:f=s===1?10:1,u=Math.round(f*(a.S+a.u)),u>=60*f&&(u=0),n==="s"?u===0?"0":""+u/f:(i=Er(u,2+s),n==="ss"?i.substr(0,2):"."+i.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":m=a.D*24+a.H;break;case"[m]":case"[mm]":m=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":m=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}x=n.length===3?1:2;break;case 101:m=d,x=1;break}var g=x>0?Er(m,x):"";return g}function Hn(e){var n=3;if(e.length<=n)return e;for(var a=e.length%n,s=e.substr(0,a);a!=e.length;a+=n)s+=(s.length>0?",":"")+e.substr(a,n);return s}var Ov=/%/g;function hN(e,n,a){var s=n.replace(Ov,""),i=n.length-s.length;return cn(e,s,a*Math.pow(10,2*i))+Lt("%",i)}function xN(e,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return cn(e,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function Rv(e,n){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Rv(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var u=Math.floor(Math.log(n)*Math.LOG10E)%i;if(u<0&&(u+=i),a=(n/Math.pow(10,u)).toPrecision(s+1+(i+u)%i),a.indexOf("e")===-1){var f=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(f-a.length+u):a+="E+"+(f-u);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,i)+"."+a.substr(2+i),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,x,g){return m+x+g.substr(0,(i+u)%i)+"."+g.substr(u)+"E"})}else a=n.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Dv=/# (\?+)( ?)\/( ?)(\d+)/;function mN(e,n,a){var s=parseInt(e[4],10),i=Math.round(n*s),u=Math.floor(i/s),f=i-u*s,d=s;return a+(u===0?"":""+u)+" "+(f===0?Lt(" ",e[1].length+1+e[4].length):Zd(f,e[1].length)+e[2]+"/"+e[3]+Er(d,e[4].length))}function pN(e,n,a){return a+(n===0?"":""+n)+Lt(" ",e[1].length+2+e[4].length)}var Fv=/^#*0*\.([0#]+)/,Mv=/\).*[0#]/,Lv=/\(###\) ###\\?-####/;function Ea(e){for(var n="",a,s=0;s!=e.length;++s)switch(a=e.charCodeAt(s)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function Pp(e,n){var a=Math.pow(10,n);return""+Math.round(e*a)/a}function Hp(e,n){var a=e-Math.floor(e),s=Math.pow(10,n);return n<(""+Math.round(a*s)).length?0:Math.round(a*s)}function gN(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function vN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function fr(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Mv)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?fr("n",s,a):"("+fr("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return xN(e,n,a);if(n.indexOf("%")!==-1)return hN(e,n,a);if(n.indexOf("E")!==-1)return Rv(n,a);if(n.charCodeAt(0)===36)return"$"+fr(e,n.substr(n.charAt(1)==" "?2:1),a);var i,u,f,d,m=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+ml(m,n.length);if(n.match(/^[#?]+$/))return i=ml(a,0),i==="0"&&(i=""),i.length>n.length?i:Ea(n.substr(0,n.length-i.length))+i;if(u=n.match(Dv))return mN(u,m,x);if(n.match(/^#+0+$/))return x+ml(m,n.length-n.indexOf("0"));if(u=n.match(Fv))return i=Pp(a,u[1].length).replace(/^([^\.]+)$/,"$1."+Ea(u[1])).replace(/\.$/,"."+Ea(u[1])).replace(/\.(\d*)$/,function(y,w){return"."+w+Lt("0",Ea(u[1]).length-w.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),u=n.match(/^(0*)\.(#*)$/))return x+Pp(m,u[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=n.match(/^#{1,3},##0(\.?)$/))return x+Hn(ml(m,0));if(u=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+fr(e,n,-a):Hn(""+(Math.floor(a)+gN(a,u[1].length)))+"."+Er(Hp(a,u[1].length),u[1].length);if(u=n.match(/^#,#*,#0/))return fr(e,n.replace(/^#,#*,/,""),a);if(u=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bl(fr(e,n.replace(/[\\-]/g,""),a)),f=0,bl(bl(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return f<i.length?i.charAt(f++):y==="0"?"0":""}));if(n.match(Lv))return i=fr(e,"##########",a),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(u=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(u[4].length,7),d=lo(m,Math.pow(10,f)-1,!1),i=""+x,g=cn("n",u[1],d[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+u[2]+"/"+u[3],g=no(d[2],f),g.length<u[4].length&&(g=Ea(u[4].substr(u[4].length-g.length))+g),i+=g,i;if(u=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(u[1].length,u[4].length),7),d=lo(m,Math.pow(10,f)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Zd(d[1],f)+u[2]+"/"+u[3]+no(d[2],f):Lt(" ",2*f+1+u[2].length+u[3].length));if(u=n.match(/^[#0?]+$/))return i=ml(a,0),n.length<=i.length?i:Ea(n.substr(0,n.length-i.length))+i;if(u=n.match(/^([#0?]+)\.([#0]+)$/)){i=""+a.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),f=i.indexOf(".");var v=n.indexOf(".")-f,b=n.length-i.length-v;return Ea(n.substr(0,v)+i+n.substr(n.length-b))}if(u=n.match(/^00,000\.([#0]*0)$/))return f=Hp(a,u[1].length),a<0?"-"+fr(e,n,-a):Hn(vN(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Er(0,3-y.length):"")+y})+"."+Er(f,u[1].length);switch(n){case"###,##0.00":return fr(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var k=Hn(ml(m,0));return k!=="0"?x+k:"";case"###,###.00":return fr(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return fr(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function bN(e,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return cn(e,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function yN(e,n,a){var s=n.replace(Ov,""),i=n.length-s.length;return cn(e,s,a*Math.pow(10,2*i))+Lt("%",i)}function Iv(e,n){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Iv(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var u=Math.floor(Math.log(n)*Math.LOG10E)%i;if(u<0&&(u+=i),a=(n/Math.pow(10,u)).toPrecision(s+1+(i+u)%i),!a.match(/[Ee]/)){var f=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(f-a.length+u):a+="E+"+(f-u),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,x,g){return m+x+g.substr(0,(i+u)%i)+"."+g.substr(u)+"E"})}else a=n.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Dr(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Mv)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Dr("n",s,a):"("+Dr("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return bN(e,n,a);if(n.indexOf("%")!==-1)return yN(e,n,a);if(n.indexOf("E")!==-1)return Iv(n,a);if(n.charCodeAt(0)===36)return"$"+Dr(e,n.substr(n.charAt(1)==" "?2:1),a);var i,u,f,d,m=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+Er(m,n.length);if(n.match(/^[#?]+$/))return i=""+a,a===0&&(i=""),i.length>n.length?i:Ea(n.substr(0,n.length-i.length))+i;if(u=n.match(Dv))return pN(u,m,x);if(n.match(/^#+0+$/))return x+Er(m,n.length-n.indexOf("0"));if(u=n.match(Fv))return i=(""+a).replace(/^([^\.]+)$/,"$1."+Ea(u[1])).replace(/\.$/,"."+Ea(u[1])),i=i.replace(/\.(\d*)$/,function(y,w){return"."+w+Lt("0",Ea(u[1]).length-w.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),u=n.match(/^(0*)\.(#*)$/))return x+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=n.match(/^#{1,3},##0(\.?)$/))return x+Hn(""+m);if(u=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Dr(e,n,-a):Hn(""+a)+"."+Lt("0",u[1].length);if(u=n.match(/^#,#*,#0/))return Dr(e,n.replace(/^#,#*,/,""),a);if(u=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bl(Dr(e,n.replace(/[\\-]/g,""),a)),f=0,bl(bl(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return f<i.length?i.charAt(f++):y==="0"?"0":""}));if(n.match(Lv))return i=Dr(e,"##########",a),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(u=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(u[4].length,7),d=lo(m,Math.pow(10,f)-1,!1),i=""+x,g=cn("n",u[1],d[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+u[2]+"/"+u[3],g=no(d[2],f),g.length<u[4].length&&(g=Ea(u[4].substr(u[4].length-g.length))+g),i+=g,i;if(u=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(u[1].length,u[4].length),7),d=lo(m,Math.pow(10,f)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Zd(d[1],f)+u[2]+"/"+u[3]+no(d[2],f):Lt(" ",2*f+1+u[2].length+u[3].length));if(u=n.match(/^[#0?]+$/))return i=""+a,n.length<=i.length?i:Ea(n.substr(0,n.length-i.length))+i;if(u=n.match(/^([#0]+)\.([#0]+)$/)){i=""+a.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),f=i.indexOf(".");var v=n.indexOf(".")-f,b=n.length-i.length-v;return Ea(n.substr(0,v)+i+n.substr(n.length-b))}if(u=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Dr(e,n,-a):Hn(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Er(0,3-y.length):"")+y})+"."+Er(0,u[1].length);switch(n){case"###,###":case"##,###":case"#,###":var k=Hn(""+m);return k!=="0"?x+k:"";default:if(n.match(/\.[0#?]*$/))return Dr(e,n.slice(0,n.lastIndexOf(".")),a)+Ea(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function cn(e,n,a){return(a|0)===a?Dr(e,n,a):fr(e,n,a)}function kN(e){for(var n=[],a=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:a=!a;break;case 95:case 42:case 92:++s;break;case 59:n[n.length]=e.substr(i,s-i),i=s+1}if(n[n.length]=e.substr(i),a===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var Bv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Al(e){for(var n=0,a="",s="";n<e.length;)switch(a=e.charAt(n)){case"G":so(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(s=a;e.charAt(n++)!=="]"&&n<e.length;)s+=e.charAt(n);if(s.match(Bv))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++n))>-1||a=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===a;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function wN(e,n,a,s){for(var i=[],u="",f=0,d="",m="t",x,g,v,b="H";f<e.length;)switch(d=e.charAt(f)){case"G":if(!so(e,f))throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"G",v:"General"},f+=7;break;case'"':for(u="";(v=e.charCodeAt(++f))!==34&&f<e.length;)u+=String.fromCharCode(v);i[i.length]={t:"t",v:u},++f;break;case"\\":var k=e.charAt(++f),y=k==="("||k===")"?k:"t";i[i.length]={t:y,v:k},++f;break;case"_":i[i.length]={t:"t",v:" "},f+=2;break;case"@":i[i.length]={t:"T",v:n},++f;break;case"B":case"b":if(e.charAt(f+1)==="1"||e.charAt(f+1)==="2"){if(x==null&&(x=vs(n,a,e.charAt(f+1)==="2"),x==null))return"";i[i.length]={t:"X",v:e.substr(f,2)},m=d,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||x==null&&(x=vs(n,a),x==null))return"";for(u=d;++f<e.length&&e.charAt(f).toLowerCase()===d;)u+=d;d==="m"&&m.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=b),i[i.length]={t:d,v:u},m=d;break;case"A":case"a":case"":var w={t:d,v:d};if(x==null&&(x=vs(n,a)),e.substr(f,3).toUpperCase()==="A/P"?(x!=null&&(w.v=x.H>=12?"P":"A"),w.t="T",b="h",f+=3):e.substr(f,5).toUpperCase()==="AM/PM"?(x!=null&&(w.v=x.H>=12?"PM":"AM"),w.t="T",f+=5,b="h"):e.substr(f,5).toUpperCase()==="/"?(x!=null&&(w.v=x.H>=12?"":""),w.t="T",f+=5,b="h"):(w.t="t",++f),x==null&&w.t==="T")return"";i[i.length]=w,m=d;break;case"[":for(u=d;e.charAt(f++)!=="]"&&f<e.length;)u+=e.charAt(f);if(u.slice(-1)!=="]")throw'unterminated "[" block: |'+u+"|";if(u.match(Bv)){if(x==null&&(x=vs(n,a),x==null))return"";i[i.length]={t:"Z",v:u.toLowerCase()},m=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",Al(e)||(i[i.length]={t:"t",v:u}));break;case".":if(x!=null){for(u=d;++f<e.length&&(d=e.charAt(f))==="0";)u+=d;i[i.length]={t:"s",v:u};break}case"0":case"#":for(u=d;++f<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(f))>-1;)u+=d;i[i.length]={t:"n",v:u};break;case"?":for(u=d;e.charAt(++f)===d;)u+=d;i[i.length]={t:d,v:u},m=d;break;case"*":++f,(e.charAt(f)==" "||e.charAt(f)=="*")&&++f;break;case"(":case")":i[i.length]={t:s===1?"t":d,v:d},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=d;f<e.length&&"0123456789".indexOf(e.charAt(++f))>-1;)u+=e.charAt(f);i[i.length]={t:"D",v:u};break;case" ":i[i.length]={t:d,v:d},++f;break;case"$":i[i.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"t",v:d},++f;break}var N=0,_=0,O;for(f=i.length-1,m="t";f>=0;--f)switch(i[f].t){case"h":case"H":i[f].t=b,m="h",N<1&&(N=1);break;case"s":(O=i[f].v.match(/\.0+$/))&&(_=Math.max(_,O[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":m=i[f].t;break;case"m":m==="s"&&(i[f].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&i[f].v.match(/[Hh]/)&&(N=1),N<2&&i[f].v.match(/[Mm]/)&&(N=2),N<3&&i[f].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var E="",L;for(f=0;f<i.length;++f)switch(i[f].t){case"t":case"T":case" ":case"D":break;case"X":i[f].v="",i[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[f].v=dN(i[f].t.charCodeAt(0),i[f].v,x,_),i[f].t="t";break;case"n":case"?":for(L=f+1;i[L]!=null&&((d=i[L].t)==="?"||d==="D"||(d===" "||d==="t")&&i[L+1]!=null&&(i[L+1].t==="?"||i[L+1].t==="t"&&i[L+1].v==="/")||i[f].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(i[L].v==="/"||i[L].v===" "&&i[L+1]!=null&&i[L+1].t=="?"));)i[f].v+=i[L].v,i[L]={v:"",t:";"},++L;E+=i[f].v,f=L-1;break;case"G":i[f].t="t",i[f].v=ws(n,a);break}var G="",H,R;if(E.length>0){E.charCodeAt(0)==40?(H=n<0&&E.charCodeAt(0)===45?-n:n,R=cn("n",E,H)):(H=n<0&&s>1?-n:n,R=cn("n",E,H),H<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),L=R.length-1;var Z=i.length;for(f=0;f<i.length;++f)if(i[f]!=null&&i[f].t!="t"&&i[f].v.indexOf(".")>-1){Z=f;break}var Y=i.length;if(Z===i.length&&R.indexOf("E")===-1){for(f=i.length-1;f>=0;--f)i[f]==null||"n?".indexOf(i[f].t)===-1||(L>=i[f].v.length-1?(L-=i[f].v.length,i[f].v=R.substr(L+1,i[f].v.length)):L<0?i[f].v="":(i[f].v=R.substr(0,L+1),L=-1),i[f].t="t",Y=f);L>=0&&Y<i.length&&(i[Y].v=R.substr(0,L+1)+i[Y].v)}else if(Z!==i.length&&R.indexOf("E")===-1){for(L=R.indexOf(".")-1,f=Z;f>=0;--f)if(!(i[f]==null||"n?".indexOf(i[f].t)===-1)){for(g=i[f].v.indexOf(".")>-1&&f===Z?i[f].v.indexOf(".")-1:i[f].v.length-1,G=i[f].v.substr(g+1);g>=0;--g)L>=0&&(i[f].v.charAt(g)==="0"||i[f].v.charAt(g)==="#")&&(G=R.charAt(L--)+G);i[f].v=G,i[f].t="t",Y=f}for(L>=0&&Y<i.length&&(i[Y].v=R.substr(0,L+1)+i[Y].v),L=R.indexOf(".")+1,f=Z;f<i.length;++f)if(!(i[f]==null||"n?(".indexOf(i[f].t)===-1&&f!==Z)){for(g=i[f].v.indexOf(".")>-1&&f===Z?i[f].v.indexOf(".")+1:0,G=i[f].v.substr(0,g);g<i[f].v.length;++g)L<R.length&&(G+=R.charAt(L++));i[f].v=G,i[f].t="t",Y=f}}}for(f=0;f<i.length;++f)i[f]!=null&&"n?".indexOf(i[f].t)>-1&&(H=s>1&&n<0&&f>0&&i[f-1].v==="-"?-n:n,i[f].v=cn(i[f].t,i[f].v,H),i[f].t="t");var Q="";for(f=0;f!==i.length;++f)i[f]!=null&&(Q+=i[f].v);return Q}var Vp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gp(e,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function SN(e,n){var a=kN(e),s=a.length,i=a[s-1].indexOf("@");if(s<4&&i>-1&&--s,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||i>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=i>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=i>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=i>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var u=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[s,u];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var f=a[0].match(Vp),d=a[1].match(Vp);return Gp(n,f)?[s,a[0]]:Gp(n,d)?[s,a[1]]:[s,a[f!=null&&d!=null?2:1]]}return[s,u]}function xr(e,n,a){a==null&&(a={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?s=a.dateNF:s=e;break;case"number":e==14&&a.dateNF?s=a.dateNF:s=(a.table!=null?a.table:Qe)[e],s==null&&(s=a.table&&a.table[Up[e]]||Qe[Up[e]]),s==null&&(s=sN[e]||"General");break}if(so(s,0))return ws(n,a);n instanceof Date&&(n=jv(n,a.date1904));var i=SN(s,n);if(so(i[1]))return ws(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return wN(i[1],n,a,i[0])}function ys(e,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(Qe[a]==null){n<0&&(n=a);continue}if(Qe[a]==e){n=a;break}}n<0&&(n=391)}return Qe[n]=e,n}function zv(){Qe=nN()}var EN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Uv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NN(e){var n=typeof e=="number"?Qe[e]:e;return n=n.replace(Uv,"(\\d+)"),new RegExp("^"+n+"$")}function TN(e,n,a){var s=-1,i=-1,u=-1,f=-1,d=-1,m=-1;(n.match(Uv)||[]).forEach(function(v,b){var k=parseInt(a[b+1],10);switch(v.toLowerCase().charAt(0)){case"y":s=k;break;case"d":u=k;break;case"h":f=k;break;case"s":m=k;break;case"m":f>=0?d=k:i=k;break}}),m>=0&&d==-1&&i>=0&&(d=i,i=-1);var x=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(u>=1?u:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var g=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return f==-1&&d==-1&&m==-1?x:s==-1&&i==-1&&u==-1?g:x+"T"+g}var _N=(function(){var e={};e.version="1.2.0";function n(){for(var R=0,Z=new Array(256),Y=0;Y!=256;++Y)R=Y,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,Z[Y]=R;return typeof Int32Array<"u"?new Int32Array(Z):Z}var a=n();function s(R){var Z=0,Y=0,Q=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)K[Q]=R[Q];for(Q=0;Q!=256;++Q)for(Y=R[Q],Z=256+Q;Z<4096;Z+=256)Y=K[Z]=Y>>>8^R[Y&255];var ee=[];for(Q=1;Q!=16;++Q)ee[Q-1]=typeof Int32Array<"u"?K.subarray(Q*256,Q*256+256):K.slice(Q*256,Q*256+256);return ee}var i=s(a),u=i[0],f=i[1],d=i[2],m=i[3],x=i[4],g=i[5],v=i[6],b=i[7],k=i[8],y=i[9],w=i[10],N=i[11],_=i[12],O=i[13],E=i[14];function L(R,Z){for(var Y=Z^-1,Q=0,K=R.length;Q<K;)Y=Y>>>8^a[(Y^R.charCodeAt(Q++))&255];return~Y}function G(R,Z){for(var Y=Z^-1,Q=R.length-15,K=0;K<Q;)Y=E[R[K++]^Y&255]^O[R[K++]^Y>>8&255]^_[R[K++]^Y>>16&255]^N[R[K++]^Y>>>24]^w[R[K++]]^y[R[K++]]^k[R[K++]]^b[R[K++]]^v[R[K++]]^g[R[K++]]^x[R[K++]]^m[R[K++]]^d[R[K++]]^f[R[K++]]^u[R[K++]]^a[R[K++]];for(Q+=15;K<Q;)Y=Y>>>8^a[(Y^R[K++])&255];return~Y}function H(R,Z){for(var Y=Z^-1,Q=0,K=R.length,ee=0,Ee=0;Q<K;)ee=R.charCodeAt(Q++),ee<128?Y=Y>>>8^a[(Y^ee)&255]:ee<2048?(Y=Y>>>8^a[(Y^(192|ee>>6&31))&255],Y=Y>>>8^a[(Y^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,Ee=R.charCodeAt(Q++)&1023,Y=Y>>>8^a[(Y^(240|ee>>8&7))&255],Y=Y>>>8^a[(Y^(128|ee>>2&63))&255],Y=Y>>>8^a[(Y^(128|Ee>>6&15|(ee&3)<<4))&255],Y=Y>>>8^a[(Y^(128|Ee&63))&255]):(Y=Y>>>8^a[(Y^(224|ee>>12&15))&255],Y=Y>>>8^a[(Y^(128|ee>>6&63))&255],Y=Y>>>8^a[(Y^(128|ee&63))&255]);return~Y}return e.table=a,e.bstr=L,e.buf=G,e.str=H,e})(),ft=(function(){var n={};n.version="1.2.1";function a(C,U){for(var F=C.split("/"),M=U.split("/"),I=0,P=0,ce=Math.min(F.length,M.length);I<ce;++I){if(P=F[I].length-M[I].length)return P;if(F[I]!=M[I])return F[I]<M[I]?-1:1}return F.length-M.length}function s(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:s(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(0,U+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(U+1)}function u(C,U){typeof U=="string"&&(U=new Date(U));var F=U.getHours();F=F<<6|U.getMinutes(),F=F<<5|U.getSeconds()>>>1,C.write_shift(2,F);var M=U.getFullYear()-1980;M=M<<4|U.getMonth()+1,M=M<<5|U.getDate(),C.write_shift(2,M)}function f(C){var U=C.read_shift(2)&65535,F=C.read_shift(2)&65535,M=new Date,I=F&31;F>>>=5;var P=F&15;F>>>=4,M.setMilliseconds(0),M.setFullYear(F+1980),M.setMonth(P-1),M.setDate(I);var ce=U&31;U>>>=5;var ye=U&63;return U>>>=6,M.setHours(U),M.setMinutes(ye),M.setSeconds(ce<<1),M}function d(C){ua(C,0);for(var U={},F=0;C.l<=C.length-4;){var M=C.read_shift(2),I=C.read_shift(2),P=C.l+I,ce={};switch(M){case 21589:F=C.read_shift(1),F&1&&(ce.mtime=C.read_shift(4)),I>5&&(F&2&&(ce.atime=C.read_shift(4)),F&4&&(ce.ctime=C.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}C.l=P,U[M]=ce}return U}var m;function x(){return m||(m={})}function g(C,U){if(C[0]==80&&C[1]==75)return Wn(C,U);if((C[0]|32)==109&&(C[1]|32)==105)return Jn(C,U);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var F=3,M=512,I=0,P=0,ce=0,ye=0,oe=0,ue=[],de=C.slice(0,512);ua(de,0);var je=v(de);switch(F=je[0],F){case 3:M=512;break;case 4:M=4096;break;case 0:if(je[1]==0)return Wn(C,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}M!==512&&(de=C.slice(0,M),ua(de,28));var Re=C.slice(0,M);b(de,F);var Ie=de.read_shift(4,"i");if(F===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);de.l+=4,ce=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ye=de.read_shift(4,"i"),I=de.read_shift(4,"i"),oe=de.read_shift(4,"i"),P=de.read_shift(4,"i");for(var Oe=-1,Fe=0;Fe<109&&(Oe=de.read_shift(4,"i"),!(Oe<0));++Fe)ue[Fe]=Oe;var He=k(C,M);N(oe,P,He,M,ue);var St=O(He,ce,ue,M);St[ce].name="!Directory",I>0&&ye!==Ee&&(St[ye].name="!MiniFAT"),St[ue[0]].name="!FAT",St.fat_addrs=ue,St.ssz=M;var Et={},Ct=[],Qa=[],Qn=[];E(ce,St,He,Ct,I,Et,Qa,ye),y(Qa,Qn,Ct),Ct.shift();var xn={FileIndex:Qa,FullPaths:Qn};return U&&U.raw&&(xn.raw={header:Re,sectors:He}),xn}function v(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Ne,"Header Signature: "),C.l+=16;var U=C.read_shift(2,"u");return[C.read_shift(2,"u"),U]}function b(C,U){var F=9;switch(C.l+=2,F=C.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function k(C,U){for(var F=Math.ceil(C.length/U)-1,M=[],I=1;I<F;++I)M[I-1]=C.slice(I*U,(I+1)*U);return M[F-1]=C.slice(F*U),M}function y(C,U,F){for(var M=0,I=0,P=0,ce=0,ye=0,oe=F.length,ue=[],de=[];M<oe;++M)ue[M]=de[M]=M,U[M]=F[M];for(;ye<de.length;++ye)M=de[ye],I=C[M].L,P=C[M].R,ce=C[M].C,ue[M]===M&&(I!==-1&&ue[I]!==I&&(ue[M]=ue[I]),P!==-1&&ue[P]!==P&&(ue[M]=ue[P])),ce!==-1&&(ue[ce]=M),I!==-1&&M!=ue[M]&&(ue[I]=ue[M],de.lastIndexOf(I)<ye&&de.push(I)),P!==-1&&M!=ue[M]&&(ue[P]=ue[M],de.lastIndexOf(P)<ye&&de.push(P));for(M=1;M<oe;++M)ue[M]===M&&(P!==-1&&ue[P]!==P?ue[M]=ue[P]:I!==-1&&ue[I]!==I&&(ue[M]=ue[I]));for(M=1;M<oe;++M)if(C[M].type!==0){if(ye=M,ye!=ue[ye])do ye=ue[ye],U[M]=U[ye]+"/"+U[M];while(ye!==0&&ue[ye]!==-1&&ye!=ue[ye]);ue[M]=-1}for(U[0]+="/",M=1;M<oe;++M)C[M].type!==2&&(U[M]+="/")}function w(C,U,F){for(var M=C.start,I=C.size,P=[],ce=M;F&&I>0&&ce>=0;)P.push(U.slice(ce*ee,ce*ee+ee)),I-=ee,ce=ps(F,ce*4);return P.length===0?ea(0):Un(P).slice(0,C.size)}function N(C,U,F,M,I){var P=Ee;if(C===Ee){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ce=F[C],ye=(M>>>2)-1;if(!ce)return;for(var oe=0;oe<ye&&(P=ps(ce,oe*4))!==Ee;++oe)I.push(P);N(ps(ce,M-4),U-1,F,M,I)}}function _(C,U,F,M,I){var P=[],ce=[];I||(I=[]);var ye=M-1,oe=0,ue=0;for(oe=U;oe>=0;){I[oe]=!0,P[P.length]=oe,ce.push(C[oe]);var de=F[Math.floor(oe*4/M)];if(ue=oe*4&ye,M<4+ue)throw new Error("FAT boundary crossed: "+oe+" 4 "+M);if(!C[de])break;oe=ps(C[de],ue)}return{nodes:P,data:eg([ce])}}function O(C,U,F,M){var I=C.length,P=[],ce=[],ye=[],oe=[],ue=M-1,de=0,je=0,Re=0,Ie=0;for(de=0;de<I;++de)if(ye=[],Re=de+U,Re>=I&&(Re-=I),!ce[Re]){oe=[];var Oe=[];for(je=Re;je>=0;){Oe[je]=!0,ce[je]=!0,ye[ye.length]=je,oe.push(C[je]);var Fe=F[Math.floor(je*4/M)];if(Ie=je*4&ue,M<4+Ie)throw new Error("FAT boundary crossed: "+je+" 4 "+M);if(!C[Fe]||(je=ps(C[Fe],Ie),Oe[je]))break}P[Re]={nodes:ye,data:eg([oe])}}return P}function E(C,U,F,M,I,P,ce,ye){for(var oe=0,ue=M.length?2:0,de=U[C].data,je=0,Re=0,Ie;je<de.length;je+=128){var Oe=de.slice(je,je+128);ua(Oe,64),Re=Oe.read_shift(2),Ie=rh(Oe,0,Re-ue),M.push(Ie);var Fe={name:Ie,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},He=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);He!==0&&(Fe.ct=L(Oe,Oe.l-8));var St=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);St!==0&&(Fe.mt=L(Oe,Oe.l-8)),Fe.start=Oe.read_shift(4,"i"),Fe.size=Oe.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=Ee,Fe.name=""),Fe.type===5?(oe=Fe.start,I>0&&oe!==Ee&&(U[oe].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",U[Fe.start]===void 0&&(U[Fe.start]=_(F,Fe.start,U.fat_addrs,U.ssz)),U[Fe.start].name=Fe.name,Fe.content=U[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:oe!==Ee&&Fe.start!==Ee&&U[oe]&&(Fe.content=w(Fe,U[oe].data,(U[ye]||{}).data))),Fe.content&&ua(Fe.content,0),P[Ie]=Fe,ce.push(Fe)}}function L(C,U){return new Date((Xa(C,U+4)/1e7*Math.pow(2,32)+Xa(C,U)/1e7-11644473600)*1e3)}function G(C,U){return x(),g(m.readFileSync(C),U)}function H(C,U){var F=U&&U.type;switch(F||ut&&Buffer.isBuffer(C)&&(F="buffer"),F||"base64"){case"file":return G(C,U);case"base64":return g(wr(qa(C)),U);case"binary":return g(wr(C),U)}return g(C,U)}function R(C,U){var F=U||{},M=F.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=M+"/",C.FileIndex[0]={name:M,type:5}),F.CLSID&&(C.FileIndex[0].clsid=F.CLSID),Z(C)}function Z(C){var U="Sh33tJ5";if(!ft.find(C,"/"+U)){var F=ea(4);F[0]=55,F[1]=F[3]=50,F[2]=54,C.FileIndex.push({name:U,type:2,content:F,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+U),Y(C)}}function Y(C,U){R(C);for(var F=!1,M=!1,I=C.FullPaths.length-1;I>=0;--I){var P=C.FileIndex[I];switch(P.type){case 0:M?F=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(P.R*P.L*P.C)&&(F=!0),P.R>-1&&P.L>-1&&P.R==P.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!U)){var ce=new Date(1987,1,19),ye=0,oe=Object.create?Object.create(null):{},ue=[];for(I=0;I<C.FullPaths.length;++I)oe[C.FullPaths[I]]=!0,C.FileIndex[I].type!==0&&ue.push([C.FullPaths[I],C.FileIndex[I]]);for(I=0;I<ue.length;++I){var de=s(ue[I][0]);M=oe[de],M||(ue.push([de,{name:i(de).replace("/",""),type:1,clsid:J,ct:ce,mt:ce,content:null}]),oe[de]=!0)}for(ue.sort(function(Ie,Oe){return a(Ie[0],Oe[0])}),C.FullPaths=[],C.FileIndex=[],I=0;I<ue.length;++I)C.FullPaths[I]=ue[I][0],C.FileIndex[I]=ue[I][1];for(I=0;I<ue.length;++I){var je=C.FileIndex[I],Re=C.FullPaths[I];if(je.name=i(Re).replace("/",""),je.L=je.R=je.C=-(je.color=1),je.size=je.content?je.content.length:0,je.start=0,je.clsid=je.clsid||J,I===0)je.C=ue.length>1?1:-1,je.size=0,je.type=5;else if(Re.slice(-1)=="/"){for(ye=I+1;ye<ue.length&&s(C.FullPaths[ye])!=Re;++ye);for(je.C=ye>=ue.length?-1:ye,ye=I+1;ye<ue.length&&s(C.FullPaths[ye])!=s(Re);++ye);je.R=ye>=ue.length?-1:ye,je.type=1}else s(C.FullPaths[I+1]||"")==s(Re)&&(je.R=I+1),je.type=2}}}function Q(C,U){var F=U||{};if(F.fileType=="mad")return To(C,F);switch(Y(C),F.fileType){case"zip":return Rs(C,F)}var M=(function(Ie){for(var Oe=0,Fe=0,He=0;He<Ie.FileIndex.length;++He){var St=Ie.FileIndex[He];if(St.content){var Et=St.content.length;Et>0&&(Et<4096?Oe+=Et+63>>6:Fe+=Et+511>>9)}}for(var Ct=Ie.FullPaths.length+3>>2,Qa=Oe+7>>3,Qn=Oe+127>>7,xn=Qa+Fe+Ct+Qn,_r=xn+127>>7,Fl=_r<=109?0:Math.ceil((_r-109)/127);xn+_r+Fl+127>>7>_r;)Fl=++_r<=109?0:Math.ceil((_r-109)/127);var ja=[1,Fl,_r,Qn,Ct,Fe,Oe,0];return Ie.FileIndex[0].size=Oe<<6,ja[7]=(Ie.FileIndex[0].start=ja[0]+ja[1]+ja[2]+ja[3]+ja[4]+ja[5])+(ja[6]+7>>3),ja})(C),I=ea(M[7]<<9),P=0,ce=0;{for(P=0;P<8;++P)I.write_shift(1,me[P]);for(P=0;P<8;++P)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),P=0;P<3;++P)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,M[2]),I.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:Ee),I.write_shift(4,M[3]),I.write_shift(-4,M[1]?M[0]-1:Ee),I.write_shift(4,M[1]),P=0;P<109;++P)I.write_shift(-4,P<M[2]?M[1]+P:-1)}if(M[1])for(ce=0;ce<M[1];++ce){for(;P<236+ce*127;++P)I.write_shift(-4,P<M[2]?M[1]+P:-1);I.write_shift(-4,ce===M[1]-1?Ee:ce+1)}var ye=function(Ie){for(ce+=Ie;P<ce-1;++P)I.write_shift(-4,P+1);Ie&&(++P,I.write_shift(-4,Ee))};for(ce=P=0,ce+=M[1];P<ce;++P)I.write_shift(-4,se.DIFSECT);for(ce+=M[2];P<ce;++P)I.write_shift(-4,se.FATSECT);ye(M[3]),ye(M[4]);for(var oe=0,ue=0,de=C.FileIndex[0];oe<C.FileIndex.length;++oe)de=C.FileIndex[oe],de.content&&(ue=de.content.length,!(ue<4096)&&(de.start=ce,ye(ue+511>>9)));for(ye(M[6]+7>>3);I.l&511;)I.write_shift(-4,se.ENDOFCHAIN);for(ce=P=0,oe=0;oe<C.FileIndex.length;++oe)de=C.FileIndex[oe],de.content&&(ue=de.content.length,!(!ue||ue>=4096)&&(de.start=ce,ye(ue+63>>6)));for(;I.l&511;)I.write_shift(-4,se.ENDOFCHAIN);for(P=0;P<M[4]<<2;++P){var je=C.FullPaths[P];if(!je||je.length===0){for(oe=0;oe<17;++oe)I.write_shift(4,0);for(oe=0;oe<3;++oe)I.write_shift(4,-1);for(oe=0;oe<12;++oe)I.write_shift(4,0);continue}de=C.FileIndex[P],P===0&&(de.start=de.size?de.start-1:Ee);var Re=P===0&&F.root||de.name;if(ue=2*(Re.length+1),I.write_shift(64,Re,"utf16le"),I.write_shift(2,ue),I.write_shift(1,de.type),I.write_shift(1,de.color),I.write_shift(-4,de.L),I.write_shift(-4,de.R),I.write_shift(-4,de.C),de.clsid)I.write_shift(16,de.clsid,"hex");else for(oe=0;oe<4;++oe)I.write_shift(4,0);I.write_shift(4,de.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,de.start),I.write_shift(4,de.size),I.write_shift(4,0)}for(P=1;P<C.FileIndex.length;++P)if(de=C.FileIndex[P],de.size>=4096)if(I.l=de.start+1<<9,ut&&Buffer.isBuffer(de.content))de.content.copy(I,I.l,0,de.size),I.l+=de.size+511&-512;else{for(oe=0;oe<de.size;++oe)I.write_shift(1,de.content[oe]);for(;oe&511;++oe)I.write_shift(1,0)}for(P=1;P<C.FileIndex.length;++P)if(de=C.FileIndex[P],de.size>0&&de.size<4096)if(ut&&Buffer.isBuffer(de.content))de.content.copy(I,I.l,0,de.size),I.l+=de.size+63&-64;else{for(oe=0;oe<de.size;++oe)I.write_shift(1,de.content[oe]);for(;oe&63;++oe)I.write_shift(1,0)}if(ut)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function K(C,U){var F=C.FullPaths.map(function(oe){return oe.toUpperCase()}),M=F.map(function(oe){var ue=oe.split("/");return ue[ue.length-(oe.slice(-1)=="/"?2:1)]}),I=!1;U.charCodeAt(0)===47?(I=!0,U=F[0].slice(0,-1)+U):I=U.indexOf("/")!==-1;var P=U.toUpperCase(),ce=I===!0?F.indexOf(P):M.indexOf(P);if(ce!==-1)return C.FileIndex[ce];var ye=!P.match(Ci);for(P=P.replace(_a,""),ye&&(P=P.replace(Ci,"!")),ce=0;ce<F.length;++ce)if((ye?F[ce].replace(Ci,"!"):F[ce]).replace(_a,"")==P||(ye?M[ce].replace(Ci,"!"):M[ce]).replace(_a,"")==P)return C.FileIndex[ce];return null}var ee=64,Ee=-2,Ne="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ee,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ae(C,U,F){x();var M=Q(C,F);m.writeFileSync(U,M)}function ae(C){for(var U=new Array(C.length),F=0;F<C.length;++F)U[F]=String.fromCharCode(C[F]);return U.join("")}function Ce(C,U){var F=Q(C,U);switch(U&&U.type||"buffer"){case"file":return x(),m.writeFileSync(U.filename,F),F;case"binary":return typeof F=="string"?F:ae(F);case"base64":return Lp(typeof F=="string"?F:ae(F));case"buffer":if(ut)return Buffer.isBuffer(F)?F:Ns(F);case"array":return typeof F=="string"?wr(F):F}return F}var B;function A(C){try{var U=C.InflateRaw,F=new U;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)B=C;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function q(C,U){if(!B)return xc(C,U);var F=B.InflateRaw,M=new F,I=M._processChunk(C.slice(C.l),M._finishFlushFlag);return C.l+=M.bytesRead,I}function V(C){return B?B.deflateRawSync(C):et(C)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(C){var U=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(U>>16|U>>8|U)&255}for(var ge=typeof Uint8Array<"u",ke=ge?new Uint8Array(256):[],$e=0;$e<256;++$e)ke[$e]=Te($e);function X(C,U){var F=ke[C&255];return U<=8?F>>>8-U:(F=F<<8|ke[C>>8&255],U<=16?F>>>16-U:(F=F<<8|ke[C>>16&255],F>>>24-U))}function nt(C,U){var F=U&7,M=U>>>3;return(C[M]|(F<=6?0:C[M+1]<<8))>>>F&3}function pe(C,U){var F=U&7,M=U>>>3;return(C[M]|(F<=5?0:C[M+1]<<8))>>>F&7}function we(C,U){var F=U&7,M=U>>>3;return(C[M]|(F<=4?0:C[M+1]<<8))>>>F&15}function be(C,U){var F=U&7,M=U>>>3;return(C[M]|(F<=3?0:C[M+1]<<8))>>>F&31}function xe(C,U){var F=U&7,M=U>>>3;return(C[M]|(F<=1?0:C[M+1]<<8))>>>F&127}function Le(C,U,F){var M=U&7,I=U>>>3,P=(1<<F)-1,ce=C[I]>>>M;return F<8-M||(ce|=C[I+1]<<8-M,F<16-M)||(ce|=C[I+2]<<16-M,F<24-M)||(ce|=C[I+3]<<24-M),ce&P}function De(C,U,F){var M=U&7,I=U>>>3;return M<=5?C[I]|=(F&7)<<M:(C[I]|=F<<M&255,C[I+1]=(F&7)>>8-M),U+3}function Ye(C,U,F){var M=U&7,I=U>>>3;return F=(F&1)<<M,C[I]|=F,U+1}function qe(C,U,F){var M=U&7,I=U>>>3;return F<<=M,C[I]|=F&255,F>>>=8,C[I+1]=F,U+8}function ze(C,U,F){var M=U&7,I=U>>>3;return F<<=M,C[I]|=F&255,F>>>=8,C[I+1]=F&255,C[I+2]=F>>>8,U+16}function Pe(C,U){var F=C.length,M=2*F>U?2*F:U+5,I=0;if(F>=U)return C;if(ut){var P=Ip(M);if(C.copy)C.copy(P);else for(;I<C.length;++I)P[I]=C[I];return P}else if(ge){var ce=new Uint8Array(M);if(ce.set)ce.set(C);else for(;I<F;++I)ce[I]=C[I];return ce}return C.length=M,C}function Ue(C){for(var U=new Array(C),F=0;F<C;++F)U[F]=0;return U}function ha(C,U,F){var M=1,I=0,P=0,ce=0,ye=0,oe=C.length,ue=ge?new Uint16Array(32):Ue(32);for(P=0;P<32;++P)ue[P]=0;for(P=oe;P<F;++P)C[P]=0;oe=C.length;var de=ge?new Uint16Array(oe):Ue(oe);for(P=0;P<oe;++P)ue[I=C[P]]++,M<I&&(M=I),de[P]=0;for(ue[0]=0,P=1;P<=M;++P)ue[P+16]=ye=ye+ue[P-1]<<1;for(P=0;P<oe;++P)ye=C[P],ye!=0&&(de[P]=ue[ye+16]++);var je=0;for(P=0;P<oe;++P)if(je=C[P],je!=0)for(ye=X(de[P],M)>>M-je,ce=(1<<M+4-je)-1;ce>=0;--ce)U[ye|ce<<je]=je&15|P<<4;return M}var zt=ge?new Uint16Array(512):Ue(512),Wa=ge?new Uint16Array(32):Ue(32);if(!ge){for(var Gt=0;Gt<512;++Gt)zt[Gt]=0;for(Gt=0;Gt<32;++Gt)Wa[Gt]=0}(function(){for(var C=[],U=0;U<32;U++)C.push(5);ha(C,Wa,32);var F=[];for(U=0;U<=143;U++)F.push(8);for(;U<=255;U++)F.push(9);for(;U<=279;U++)F.push(7);for(;U<=287;U++)F.push(8);ha(F,zt,288)})();var Za=(function(){for(var U=ge?new Uint8Array(32768):[],F=0,M=0;F<ne.length-1;++F)for(;M<ne[F+1];++M)U[M]=F;for(;M<32768;++M)U[M]=29;var I=ge?new Uint8Array(259):[];for(F=0,M=0;F<z.length-1;++F)for(;M<z[F+1];++M)I[M]=F;function P(ye,oe){for(var ue=0;ue<ye.length;){var de=Math.min(65535,ye.length-ue),je=ue+de==ye.length;for(oe.write_shift(1,+je),oe.write_shift(2,de),oe.write_shift(2,~de&65535);de-- >0;)oe[oe.l++]=ye[ue++]}return oe.l}function ce(ye,oe){for(var ue=0,de=0,je=ge?new Uint16Array(32768):[];de<ye.length;){var Re=Math.min(65535,ye.length-de);if(Re<10){for(ue=De(oe,ue,+(de+Re==ye.length)),ue&7&&(ue+=8-(ue&7)),oe.l=ue/8|0,oe.write_shift(2,Re),oe.write_shift(2,~Re&65535);Re-- >0;)oe[oe.l++]=ye[de++];ue=oe.l*8;continue}ue=De(oe,ue,+(de+Re==ye.length)+2);for(var Ie=0;Re-- >0;){var Oe=ye[de];Ie=(Ie<<5^Oe)&32767;var Fe=-1,He=0;if((Fe=je[Ie])&&(Fe|=de&-32768,Fe>de&&(Fe-=32768),Fe<de))for(;ye[Fe+He]==ye[de+He]&&He<250;)++He;if(He>2){Oe=I[He],Oe<=22?ue=qe(oe,ue,ke[Oe+1]>>1)-1:(qe(oe,ue,3),ue+=5,qe(oe,ue,ke[Oe-23]>>5),ue+=3);var St=Oe<8?0:Oe-4>>2;St>0&&(ze(oe,ue,He-z[Oe]),ue+=St),Oe=U[de-Fe],ue=qe(oe,ue,ke[Oe]>>3),ue-=3;var Et=Oe<4?0:Oe-2>>1;Et>0&&(ze(oe,ue,de-Fe-ne[Oe]),ue+=Et);for(var Ct=0;Ct<He;++Ct)je[Ie]=de&32767,Ie=(Ie<<5^ye[de])&32767,++de;Re-=He-1}else Oe<=143?Oe=Oe+48:ue=Ye(oe,ue,1),ue=qe(oe,ue,ke[Oe]),je[Ie]=de&32767,++de}ue=qe(oe,ue,0)-1}return oe.l=(ue+7)/8|0,oe.l}return function(oe,ue){return oe.length<8?P(oe,ue):ce(oe,ue)}})();function et(C){var U=ea(50+Math.floor(C.length*1.1)),F=Za(C,U);return U.slice(0,F)}var Dt=ge?new Uint16Array(32768):Ue(32768),Ca=ge?new Uint16Array(32768):Ue(32768),Tt=ge?new Uint16Array(128):Ue(128),Ut=1,pr=1;function wa(C,U){var F=be(C,U)+257;U+=5;var M=be(C,U)+1;U+=5;var I=we(C,U)+4;U+=4;for(var P=0,ce=ge?new Uint8Array(19):Ue(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ue=ge?new Uint8Array(8):Ue(8),de=ge?new Uint8Array(8):Ue(8),je=ce.length,Re=0;Re<I;++Re)ce[T[Re]]=P=pe(C,U),oe<P&&(oe=P),ue[P]++,U+=3;var Ie=0;for(ue[0]=0,Re=1;Re<=oe;++Re)de[Re]=Ie=Ie+ue[Re-1]<<1;for(Re=0;Re<je;++Re)(Ie=ce[Re])!=0&&(ye[Re]=de[Ie]++);var Oe=0;for(Re=0;Re<je;++Re)if(Oe=ce[Re],Oe!=0){Ie=ke[ye[Re]]>>8-Oe;for(var Fe=(1<<7-Oe)-1;Fe>=0;--Fe)Tt[Ie|Fe<<Oe]=Oe&7|Re<<3}var He=[];for(oe=1;He.length<F+M;)switch(Ie=Tt[xe(C,U)],U+=Ie&7,Ie>>>=3){case 16:for(P=3+nt(C,U),U+=2,Ie=He[He.length-1];P-- >0;)He.push(Ie);break;case 17:for(P=3+pe(C,U),U+=3;P-- >0;)He.push(0);break;case 18:for(P=11+xe(C,U),U+=7;P-- >0;)He.push(0);break;default:He.push(Ie),oe<Ie&&(oe=Ie);break}var St=He.slice(0,F),Et=He.slice(F);for(Re=F;Re<286;++Re)St[Re]=0;for(Re=M;Re<30;++Re)Et[Re]=0;return Ut=ha(St,Dt,286),pr=ha(Et,Ca,30),U}function Eo(C,U){if(C[0]==3&&!(C[1]&3))return[Xn(U),2];for(var F=0,M=0,I=Ip(U||1<<18),P=0,ce=I.length>>>0,ye=0,oe=0;(M&1)==0;){if(M=pe(C,F),F+=3,M>>>1)M>>1==1?(ye=9,oe=5):(F=wa(C,F),ye=Ut,oe=pr);else{F&7&&(F+=8-(F&7));var ue=C[F>>>3]|C[(F>>>3)+1]<<8;if(F+=32,ue>0)for(!U&&ce<P+ue&&(I=Pe(I,P+ue),ce=I.length);ue-- >0;)I[P++]=C[F>>>3],F+=8;continue}for(;;){!U&&ce<P+32767&&(I=Pe(I,P+32767),ce=I.length);var de=Le(C,F,ye),je=M>>>1==1?zt[de]:Dt[de];if(F+=je&15,je>>>=4,(je>>>8&255)===0)I[P++]=je;else{if(je==256)break;je-=257;var Re=je<8?0:je-4>>2;Re>5&&(Re=0);var Ie=P+z[je];Re>0&&(Ie+=Le(C,F,Re),F+=Re),de=Le(C,F,oe),je=M>>>1==1?Wa[de]:Ca[de],F+=je&15,je>>>=4;var Oe=je<4?0:je-2>>1,Fe=ne[je];for(Oe>0&&(Fe+=Le(C,F,Oe),F+=Oe),!U&&ce<Ie&&(I=Pe(I,Ie+100),ce=I.length);P<Ie;)I[P]=I[P-Fe],++P}}}return U?[I,F+7>>>3]:[I.slice(0,P),F+7>>>3]}function xc(C,U){var F=C.slice(C.l||0),M=Eo(F,U);return C.l+=M[1],M[0]}function mc(C,U){if(C)typeof console<"u"&&console.error(U);else throw new Error(U)}function Wn(C,U){var F=C;ua(F,0);var M=[],I=[],P={FileIndex:M,FullPaths:I};R(P,{root:U.root});for(var ce=F.length-4;(F[ce]!=80||F[ce+1]!=75||F[ce+2]!=5||F[ce+3]!=6)&&ce>=0;)--ce;F.l=ce+4,F.l+=4;var ye=F.read_shift(2);F.l+=6;var oe=F.read_shift(4);for(F.l=oe,ce=0;ce<ye;++ce){F.l+=20;var ue=F.read_shift(4),de=F.read_shift(4),je=F.read_shift(2),Re=F.read_shift(2),Ie=F.read_shift(2);F.l+=8;var Oe=F.read_shift(4),Fe=d(F.slice(F.l+je,F.l+je+Re));F.l+=je+Re+Ie;var He=F.l;F.l=Oe+4,Os(F,ue,de,P,Fe),F.l=He}return P}function Os(C,U,F,M,I){C.l+=2;var P=C.read_shift(2),ce=C.read_shift(2),ye=f(C);if(P&8257)throw new Error("Unsupported ZIP encryption");for(var oe=C.read_shift(4),ue=C.read_shift(4),de=C.read_shift(4),je=C.read_shift(2),Re=C.read_shift(2),Ie="",Oe=0;Oe<je;++Oe)Ie+=String.fromCharCode(C[C.l++]);if(Re){var Fe=d(C.slice(C.l,C.l+Re));(Fe[21589]||{}).mt&&(ye=Fe[21589].mt),((I||{})[21589]||{}).mt&&(ye=I[21589].mt)}C.l+=Re;var He=C.slice(C.l,C.l+ue);switch(ce){case 8:He=q(C,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var St=!1;P&8&&(oe=C.read_shift(4),oe==134695760&&(oe=C.read_shift(4),St=!0),ue=C.read_shift(4),de=C.read_shift(4)),ue!=U&&mc(St,"Bad compressed size: "+U+" != "+ue),de!=F&&mc(St,"Bad uncompressed size: "+F+" != "+de),Fs(M,Ie,He,{unsafe:!0,mt:ye})}function Rs(C,U){var F=U||{},M=[],I=[],P=ea(1),ce=F.compression?8:0,ye=0,oe=0,ue=0,de=0,je=0,Re=C.FullPaths[0],Ie=Re,Oe=C.FileIndex[0],Fe=[],He=0;for(oe=1;oe<C.FullPaths.length;++oe)if(Ie=C.FullPaths[oe].slice(Re.length),Oe=C.FileIndex[oe],!(!Oe.size||!Oe.content||Ie=="Sh33tJ5")){var St=de,Et=ea(Ie.length);for(ue=0;ue<Ie.length;++ue)Et.write_shift(1,Ie.charCodeAt(ue)&127);Et=Et.slice(0,Et.l),Fe[je]=_N.buf(Oe.content,0);var Ct=Oe.content;ce==8&&(Ct=V(Ct)),P=ea(30),P.write_shift(4,67324752),P.write_shift(2,20),P.write_shift(2,ye),P.write_shift(2,ce),Oe.mt?u(P,Oe.mt):P.write_shift(4,0),P.write_shift(-4,Fe[je]),P.write_shift(4,Ct.length),P.write_shift(4,Oe.content.length),P.write_shift(2,Et.length),P.write_shift(2,0),de+=P.length,M.push(P),de+=Et.length,M.push(Et),de+=Ct.length,M.push(Ct),P=ea(46),P.write_shift(4,33639248),P.write_shift(2,0),P.write_shift(2,20),P.write_shift(2,ye),P.write_shift(2,ce),P.write_shift(4,0),P.write_shift(-4,Fe[je]),P.write_shift(4,Ct.length),P.write_shift(4,Oe.content.length),P.write_shift(2,Et.length),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(4,0),P.write_shift(4,St),He+=P.l,I.push(P),He+=Et.length,I.push(Et),++je}return P=ea(22),P.write_shift(4,101010256),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,je),P.write_shift(2,je),P.write_shift(4,He),P.write_shift(4,de),P.write_shift(2,0),Un([Un(M),Un(I),P])}var Ja={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ds(C,U){if(C.ctype)return C.ctype;var F=C.name||"",M=F.match(/\.([^\.]+)$/);return M&&Ja[M[1]]||U&&(M=(F=U).match(/[\.\\]([^\.\\])+$/),M&&Ja[M[1]])?Ja[M[1]]:"application/octet-stream"}function Zn(C){for(var U=Lp(C),F=[],M=0;M<U.length;M+=76)F.push(U.slice(M,M+76));return F.join(`\r
`)+`\r
`}function No(C){var U=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var de=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],M=U.split(`\r
`),I=0;I<M.length;++I){var P=M[I];if(P.length==0){F.push("");continue}for(var ce=0;ce<P.length;){var ye=76,oe=P.slice(ce,ce+ye);oe.charAt(ye-1)=="="?ye--:oe.charAt(ye-2)=="="?ye-=2:oe.charAt(ye-3)=="="&&(ye-=3),oe=P.slice(ce,ce+ye),ce+=ye,ce<P.length&&(oe+="="),F.push(oe)}}return F.join(`\r
`)}function pc(C){for(var U=[],F=0;F<C.length;++F){for(var M=C[F];F<=C.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+C[++F];U.push(M)}for(var I=0;I<U.length;++I)U[I]=U[I].replace(/[=][0-9A-Fa-f]{2}/g,function(P){return String.fromCharCode(parseInt(P.slice(1),16))});return wr(U.join(`\r
`))}function Ol(C,U,F){for(var M="",I="",P="",ce,ye=0;ye<10;++ye){var oe=U[ye];if(!oe||oe.match(/^\s*$/))break;var ue=oe.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":M=ue[2].trim();break;case"content-type":P=ue[2].trim();break;case"content-transfer-encoding":I=ue[2].trim();break}}switch(++ye,I.toLowerCase()){case"base64":ce=wr(qa(U.slice(ye).join("")));break;case"quoted-printable":ce=pc(U.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var de=Fs(C,M.slice(F.length),ce,{unsafe:!0});P&&(de.ctype=P)}function Jn(C,U){if(ae(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=U&&U.root||"",M=(ut&&Buffer.isBuffer(C)?C.toString("binary"):ae(C)).split(`\r
`),I=0,P="";for(I=0;I<M.length;++I)if(P=M[I],!!/^Content-Location:/i.test(P)&&(P=P.slice(P.indexOf("file")),F||(F=P.slice(0,P.lastIndexOf("/")+1)),P.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),P.slice(0,F.length)!=F););var ce=(M[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ye="--"+(ce[1]||""),oe=[],ue=[],de={FileIndex:oe,FullPaths:ue};R(de);var je,Re=0;for(I=0;I<M.length;++I){var Ie=M[I];Ie!==ye&&Ie!==ye+"--"||(Re++&&Ol(de,M.slice(je,I),F),je=I)}return de}function To(C,U){var F=U||{},M=F.boundary||"SheetJS";M="------="+M;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],P=C.FullPaths[0],ce=P,ye=C.FileIndex[0],oe=1;oe<C.FullPaths.length;++oe)if(ce=C.FullPaths[oe].slice(P.length),ye=C.FileIndex[oe],!(!ye.size||!ye.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var ue=ye.content,de=ut&&Buffer.isBuffer(ue)?ue.toString("binary"):ae(ue),je=0,Re=Math.min(1024,de.length),Ie=0,Oe=0;Oe<=Re;++Oe)(Ie=de.charCodeAt(Oe))>=32&&Ie<128&&++je;var Fe=je>=Re*4/5;I.push(M),I.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+ce),I.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),I.push("Content-Type: "+Ds(ye,ce)),I.push(""),I.push(Fe?No(de):Zn(de))}return I.push(M+`--\r
`),I.join(`\r
`)}function gc(C){var U={};return R(U,C),U}function Fs(C,U,F,M){var I=M&&M.unsafe;I||R(C);var P=!I&&ft.find(C,U);if(!P){var ce=C.FullPaths[0];U.slice(0,ce.length)==ce?ce=U:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+U).replace("//","/")),P={name:i(U),type:2},C.FileIndex.push(P),C.FullPaths.push(ce),I||ft.utils.cfb_gc(C)}return P.content=F,P.size=F?F.length:0,M&&(M.CLSID&&(P.clsid=M.CLSID),M.mt&&(P.mt=M.mt),M.ct&&(P.ct=M.ct)),P}function vc(C,U){R(C);var F=ft.find(C,U);if(F){for(var M=0;M<C.FileIndex.length;++M)if(C.FileIndex[M]==F)return C.FileIndex.splice(M,1),C.FullPaths.splice(M,1),!0}return!1}function Rl(C,U,F){R(C);var M=ft.find(C,U);if(M){for(var I=0;I<C.FileIndex.length;++I)if(C.FileIndex[I]==M)return C.FileIndex[I].name=i(F),C.FullPaths[I]=F,!0}return!1}function Dl(C){Y(C,!0)}return n.find=K,n.read=H,n.parse=g,n.write=Ce,n.writeFile=Ae,n.utils={cfb_new:gc,cfb_add:Fs,cfb_del:vc,cfb_mov:Rl,cfb_gc:Dl,ReadShift:Fi,CheckField:c2,prep_blob:ua,bconcat:Un,use_zlib:A,_deflateRaw:et,_inflateRaw:xc,consts:se},n})();function AN(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var a=n.read();return n.close(),a}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Lr(e){for(var n=Object.keys(e),a=[],s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e,n[s])&&a.push(n[s]);return a}function Qd(e){for(var n=[],a=Lr(e),s=0;s!==a.length;++s)n[e[a[s]]]=a[s];return n}var io=new Date(1899,11,30,0,0,0);function Aa(e,n){var a=e.getTime(),s=io.getTime()+(e.getTimezoneOffset()-io.getTimezoneOffset())*6e4;return(a-s)/(1440*60*1e3)}var Pv=new Date,CN=io.getTime()+(Pv.getTimezoneOffset()-io.getTimezoneOffset())*6e4,$p=Pv.getTimezoneOffset();function yo(e){var n=new Date;return n.setTime(e*24*60*60*1e3+CN),n.getTimezoneOffset()!==$p&&n.setTime(n.getTime()+(n.getTimezoneOffset()-$p)*6e4),n}function jN(e){var n=0,a=0,s=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var u=1;u!=i.length;++u)if(i[u]){switch(a=1,u>3&&(s=!0),i[u].slice(i[u].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[u].slice(i[u].length-1));case"D":a*=24;case"H":a*=60;case"M":if(s)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=a*parseInt(i[u],10)}return n}var Xp=new Date("2017-02-19T19:06:09.000Z"),Hv=isNaN(Xp.getFullYear())?new Date("2/19/17"):Xp,ON=Hv.getFullYear()==2017;function sa(e,n){var a=new Date(e);if(ON)return n>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):n<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(Hv.getFullYear()==1917&&!isNaN(a.getFullYear())){var s=a.getFullYear();return e.indexOf(""+s)>-1||a.setFullYear(a.getFullYear()+100),a}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(u=new Date(u.getTime()-u.getTimezoneOffset()*60*1e3)),u}function Ss(e,n){if(ut&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return Oi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Oi(Av(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return Oi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Oi(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(u){return a[u]||u})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function fa(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=fa(e[a]));return n}function Lt(e,n){for(var a="";a.length<n;)a+=e;return a}function Tr(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var a=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,u){return a=-a,u}),!isNaN(n=Number(s)))?n/a:n}var RN=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sl(e){var n=new Date(e),a=new Date(NaN),s=n.getYear(),i=n.getMonth(),u=n.getDate();if(isNaN(u))return a;var f=e.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&RN.indexOf(f)==-1)return a}else if(f.match(/[a-z]/))return a;return s<0||s>8099?a:(i>0||u>1)&&s!=101?n:e.match(/[^-0-9:,\/\\]/)?a:n}var DN=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,s,i){if(e||typeof s=="string")return a.split(s);for(var u=a.split(s),f=[u[0]],d=1;d<u.length;++d)f.push(i),f.push(u[d]);return f}})();function Vv(e){return e?e.content&&e.type?Ss(e.content,!0):e.data?Ai(e.data):e.asNodeBuffer&&ut?Ai(e.asNodeBuffer().toString("binary")):e.asBinary?Ai(e.asBinary()):e._data&&e._data.getContent?Ai(Ss(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Gv(e){if(!e)return null;if(e.data)return Fp(e.data);if(e.asNodeBuffer&&ut)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Fp(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function FN(e){return e&&e.name.slice(-4)===".bin"?Gv(e):Vv(e)}function dr(e,n){for(var a=e.FullPaths||Lr(e.files),s=n.toLowerCase().replace(/[\/]/g,"\\"),i=s.replace(/\\/g,"/"),u=0;u<a.length;++u){var f=a[u].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==f||i==f)return e.files?e.files[a[u]]:e.FileIndex[u]}return null}function eh(e,n){var a=dr(e,n);if(a==null)throw new Error("Cannot find file "+n+" in zip");return a}function Wt(e,n,a){if(!a)return FN(eh(e,n));if(!n)return null;try{return Wt(e,n)}catch{return null}}function Ya(e,n,a){if(!a)return Vv(eh(e,n));if(!n)return null;try{return Ya(e,n)}catch{return null}}function MN(e,n,a){return Gv(eh(e,n))}function Yp(e){for(var n=e.FullPaths||Lr(e.files),a=[],s=0;s<n.length;++s)n[s].slice(-1)!="/"&&a.push(n[s].replace(/^Root Entry[\/]/,""));return a.sort()}function LN(e,n,a){if(e.FullPaths){if(typeof a=="string"){var s;return ut?s=Ns(a):s=tN(a),ft.utils.cfb_add(e,n,s)}ft.utils.cfb_add(e,n,a)}else e.file(n,a)}function $v(e,n){switch(n.type){case"base64":return ft.read(e,{type:"base64"});case"binary":return ft.read(e,{type:"binary"});case"buffer":case"array":return ft.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ji(e,n){if(e.charAt(0)=="/")return e.slice(1);var a=n.split("/");n.slice(-1)!="/"&&a.pop();for(var s=e.split("/");s.length!==0;){var i=s.shift();i===".."?a.pop():i!=="."&&a.push(i)}return a.join("/")}var Xv=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,IN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,BN=/<[^>]*>/g,ka=Xv.match(qp)?qp:BN,zN=/<\w*:/,UN=/<(\/?)\w+:/;function Ke(e,n,a){for(var s={},i=0,u=0;i!==e.length&&!((u=e.charCodeAt(i))===32||u===10||u===13);++i);if(n||(s[0]=e.slice(0,i)),i===e.length)return s;var f=e.match(IN),d=0,m="",x=0,g="",v="",b=1;if(f)for(x=0;x!=f.length;++x){for(v=f[x],u=0;u!=v.length&&v.charCodeAt(u)!==61;++u);for(g=v.slice(0,u).trim();v.charCodeAt(u+1)==32;)++u;for(b=(i=v.charCodeAt(u+1))==34||i==39?1:0,m=v.slice(u+1+b,v.length-b),d=0;d!=g.length&&g.charCodeAt(d)!==58;++d);if(d===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),s[g]=m,s[g.toLowerCase()]=m;else{var k=(d===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(d+1);if(s[k]&&g.slice(d-3,d)=="ext")continue;s[k]=m,s[k.toLowerCase()]=m}}return s}function Br(e){return e.replace(UN,"<$1")}var Yv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},PN=Qd(Yv),ht=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function a(s){var i=s+"",u=i.indexOf("<![CDATA[");if(u==-1)return i.replace(e,function(d,m){return Yv[d]||String.fromCharCode(parseInt(m,d.indexOf("x")>-1?16:10))||d}).replace(n,function(d,m){return String.fromCharCode(parseInt(m,16))});var f=i.indexOf("]]>");return a(i.slice(0,u))+i.slice(u+9,f)+a(i.slice(f+3))}})(),HN=/[&<>'"]/g,VN=/[\u0000-\u001f]/g;function th(e){var n=e+"";return n.replace(HN,function(a){return PN[a]}).replace(/\n/g,"<br/>").replace(VN,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}var Kp=(function(){var e=/&#(\d+);/g;function n(a,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,n)}})();function Ot(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Zf(e){for(var n="",a=0,s=0,i=0,u=0,f=0,d=0;a<e.length;){if(s=e.charCodeAt(a++),s<128){n+=String.fromCharCode(s);continue}if(i=e.charCodeAt(a++),s>191&&s<224){f=(s&31)<<6,f|=i&63,n+=String.fromCharCode(f);continue}if(u=e.charCodeAt(a++),s<240){n+=String.fromCharCode((s&15)<<12|(i&63)<<6|u&63);continue}f=e.charCodeAt(a++),d=((s&7)<<18|(i&63)<<12|(u&63)<<6|f&63)-65536,n+=String.fromCharCode(55296+(d>>>10&1023)),n+=String.fromCharCode(56320+(d&1023))}return n}function Wp(e){var n=Xn(2*e.length),a,s,i=1,u=0,f=0,d;for(s=0;s<e.length;s+=i)i=1,(d=e.charCodeAt(s))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(s+1)&63),i=2):d<240?(a=(d&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,a=(d&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),a-=65536,f=55296+(a>>>10&1023),a=56320+(a&1023)),f!==0&&(n[u++]=f&255,n[u++]=f>>>8,f=0),n[u++]=a%256,n[u++]=a>>>8;return n.slice(0,u).toString("ucs2")}function Zp(e){return Ns(e,"binary").toString("utf8")}var L0="foo bar baz",Nt=ut&&(Zp(L0)==Zf(L0)&&Zp||Wp(L0)==Zf(L0)&&Wp)||Zf,Oi=ut?function(e){return Ns(e,"utf8").toString("binary")}:function(e){for(var n=[],a=0,s=0,i=0;a<e.length;)switch(s=e.charCodeAt(a++),!0){case s<128:n.push(String.fromCharCode(s));break;case s<2048:n.push(String.fromCharCode(192+(s>>6))),n.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(a++)-56320+(s<<10),n.push(String.fromCharCode(240+(i>>18&7))),n.push(String.fromCharCode(144+(i>>12&63))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)));break;default:n.push(String.fromCharCode(224+(s>>12))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)))}return n.join("")},Zi=(function(){var e={};return function(a,s){var i=a+"|"+(s||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",s||"")}})(),qv=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var s=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}})(),GN=(function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}})(),$N=/<\/?(?:vt:)?variant>/g,XN=/<(?:vt:)([^>]*)>([\s\S]*)</;function Jp(e,n){var a=Ke(e),s=e.match(GN(a.baseType))||[],i=[];if(s.length!=a.size){if(n.WTF)throw new Error("unexpected vector length "+s.length+" != "+a.size);return i}return s.forEach(function(u){var f=u.replace($N,"").match(XN);f&&i.push({v:Nt(f[2]),t:f[1]})}),i}var YN=/(^\s|\s$|\n)/;function qN(e){return Lr(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function KN(e,n,a){return"<"+e+(a!=null?qN(a):"")+(n!=null?(n.match(YN)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function ah(e){if(ut&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Nt(Ts(Wd(e)));throw new Error("Bad input format: expected Buffer or string")}var Ji=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,WN={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ZN=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function JN(e,n){for(var a=1-2*(e[n+7]>>>7),s=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),i=e[n+6]&15,u=5;u>=0;--u)i=i*256+e[n+u];return s==2047?i==0?a*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),a*Math.pow(2,s-52)*i)}function QN(e,n,a){var s=(n<0||1/n==-1/0?1:0)<<7,i=0,u=0,f=s?-n:n;isFinite(f)?f==0?i=u=0:(i=Math.floor(Math.log(f)/Math.LN2),u=f*Math.pow(2,52-i),i<=-1023&&(!isFinite(u)||u<Math.pow(2,52))?i=-1022:(u-=Math.pow(2,52),i+=1023)):(i=2047,u=isNaN(n)?26985:0);for(var d=0;d<=5;++d,u/=256)e[a+d]=u&255;e[a+6]=(i&15)<<4|u&15,e[a+7]=i>>4|s}var Qp=function(e){for(var n=[],a=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,u=e[0][s].length;i<u;i+=a)n.push.apply(n,e[0][s].slice(i,i+a));return n},eg=ut?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:Ns(n)})):Qp(e)}:Qp,tg=function(e,n,a){for(var s=[],i=n;i<a;i+=2)s.push(String.fromCharCode(sn(e,i)));return s.join("").replace(_a,"")},rh=ut?function(e,n,a){return Buffer.isBuffer(e)?e.toString("utf16le",n,a).replace(_a,""):tg(e,n,a)}:tg,ag=function(e,n,a){for(var s=[],i=n;i<n+a;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},Kv=ut?function(e,n,a){return Buffer.isBuffer(e)?e.toString("hex",n,n+a):ag(e,n,a)}:ag,rg=function(e,n,a){for(var s=[],i=n;i<a;i++)s.push(String.fromCharCode(pl(e,i)));return s.join("")},cc=ut?function(n,a,s){return Buffer.isBuffer(n)?n.toString("utf8",a,s):rg(n,a,s)}:rg,Wv=function(e,n){var a=Xa(e,n);return a>0?cc(e,n+4,n+4+a-1):""},Zv=Wv,Jv=function(e,n){var a=Xa(e,n);return a>0?cc(e,n+4,n+4+a-1):""},Qv=Jv,e2=function(e,n){var a=2*Xa(e,n);return a>0?cc(e,n+4,n+4+a-1):""},t2=e2,a2=function(n,a){var s=Xa(n,a);return s>0?rh(n,a+4,a+4+s):""},r2=a2,n2=function(e,n){var a=Xa(e,n);return a>0?cc(e,n+4,n+4+a):""},s2=n2,l2=function(e,n){return JN(e,n)},co=l2,i2=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};ut&&(Zv=function(n,a){if(!Buffer.isBuffer(n))return Wv(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},Qv=function(n,a){if(!Buffer.isBuffer(n))return Jv(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},t2=function(n,a){if(!Buffer.isBuffer(n))return e2(n,a);var s=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s-1)},r2=function(n,a){if(!Buffer.isBuffer(n))return a2(n,a);var s=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s)},s2=function(n,a){if(!Buffer.isBuffer(n))return n2(n,a);var s=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+s)},co=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):l2(n,a)},i2=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var pl=function(e,n){return e[n]},sn=function(e,n){return e[n+1]*256+e[n]},e3=function(e,n){var a=e[n+1]*256+e[n];return a<32768?a:(65535-a+1)*-1},Xa=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},ps=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},t3=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function Fi(e,n){var a="",s,i,u=[],f,d,m,x;switch(n){case"dbcs":if(x=this.l,ut&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)a+=String.fromCharCode(sn(this,x)),x+=2;e*=2;break;case"utf8":a=cc(this,this.l,this.l+e);break;case"utf16le":e*=2,a=rh(this,this.l,this.l+e);break;case"wstr":return Fi.call(this,e,"dbcs");case"lpstr-ansi":a=Zv(this,this.l),e=4+Xa(this,this.l);break;case"lpstr-cp":a=Qv(this,this.l),e=4+Xa(this,this.l);break;case"lpwstr":a=t2(this,this.l),e=4+2*Xa(this,this.l);break;case"lpp4":e=4+Xa(this,this.l),a=r2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Xa(this,this.l),a=s2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(f=pl(this,this.l+e++))!==0;)u.push(M0(f));a=u.join("");break;case"_wstr":for(e=0,a="";(f=sn(this,this.l+e))!==0;)u.push(M0(f)),e+=2;e+=2,a=u.join("");break;case"dbcs-cont":for(a="",x=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(x)!==-1)return f=pl(this,x),this.l=x+1,d=Fi.call(this,e-m,f?"dbcs-cont":"sbcs-cont"),u.join("")+d;u.push(M0(sn(this,x))),x+=2}a=u.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",x=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(x)!==-1)return f=pl(this,x),this.l=x+1,d=Fi.call(this,e-m,f?"dbcs-cont":"sbcs-cont"),u.join("")+d;u.push(M0(pl(this,x))),x+=1}a=u.join("");break;default:switch(e){case 1:return s=pl(this,this.l),this.l++,s;case 2:return s=(n==="i"?e3:sn)(this,this.l),this.l+=2,s;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(s=(e>0?ps:t3)(this,this.l),this.l+=4,s):(i=Xa(this,this.l),this.l+=4,i);case 8:case-8:if(n==="f")return e==8?i=co(this,this.l):i=co([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:a=Kv(this,this.l,e);break}}return this.l+=e,a}var a3=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255,e[a+2]=n>>>16&255,e[a+3]=n>>>24&255},r3=function(e,n,a){e[a]=n&255,e[a+1]=n>>8&255,e[a+2]=n>>16&255,e[a+3]=n>>24&255},n3=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255};function s3(e,n,a){var s=0,i=0;if(a==="dbcs"){for(i=0;i!=n.length;++i)n3(this,n.charCodeAt(i),this.l+2*i);s=2*n.length}else if(a==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=n.length;++i)this[this.l+i]=n.charCodeAt(i)&255;s=n.length}else if(a==="hex"){for(;i<e;++i)this[this.l++]=parseInt(n.slice(2*i,2*i+2),16)||0;return this}else if(a==="utf16le"){var u=Math.min(this.l+e,this.length);for(i=0;i<Math.min(n.length,e);++i){var f=n.charCodeAt(i);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<u;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=n&255;break;case 2:s=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:s=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:s=4,a3(this,n,this.l);break;case 8:if(s=8,a==="f"){QN(this,n,this.l);break}case 16:break;case-4:s=4,r3(this,n,this.l);break}return this.l+=s,this}function c2(e,n){var a=Kv(this,this.l,e.length>>1);if(a!==e)throw new Error(n+"Expected "+e+" saw "+a);this.l+=e.length>>1}function ua(e,n){e.l=n,e.read_shift=Fi,e.chk=c2,e.write_shift=s3}function ya(e,n){e.l+=n}function ea(e){var n=Xn(e);return ua(n,0),n}function hn(e,n,a){if(e){var s,i,u;ua(e,e.l||0);for(var f=e.length,d=0,m=0;e.l<f;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var x=mo[d]||mo[65535];for(s=e.read_shift(1),u=s&127,i=1;i<4&&s&128;++i)u+=((s=e.read_shift(1))&127)<<7*i;m=e.l+u;var g=x.f&&x.f(e,u,a);if(e.l=m,n(g,x,d))return}}}function bd(){var e=[],n=ut?256:2048,a=function(x){var g=ea(x);return ua(g,0),g},s=a(n),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},u=function(x){return s&&x<s.length-s.l?s:(i(),s=a(Math.max(x+1,n)))},f=function(){return i(),Un(e)},d=function(x){i(),s=x,s.l==null&&(s.l=s.length),u(n)};return{next:u,push:d,end:f,_bufs:e}}function Mi(e,n,a){var s=fa(e);if(n.s?(s.cRel&&(s.c+=n.s.c),s.rRel&&(s.r+=n.s.r)):(s.cRel&&(s.c+=n.c),s.rRel&&(s.r+=n.r)),!a||a.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function ng(e,n,a){var s=fa(e);return s.s=Mi(s.s,n.s,a),s.e=Mi(s.e,n.s,a),s}function Li(e,n){if(e.cRel&&e.c<0)for(e=fa(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=fa(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var a=Ze(e);return!e.cRel&&e.cRel!=null&&(a=c3(a)),!e.rRel&&e.rRel!=null&&(a=l3(a)),a}function Jf(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ta(e.s.c)+":"+(e.e.cRel?"":"$")+ta(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+da(e.s.r)+":"+(e.e.rRel?"":"$")+da(e.e.r):Li(e.s,n.biff)+":"+Li(e.e,n.biff)}function nh(e){return parseInt(i3(e),10)-1}function da(e){return""+(e+1)}function l3(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function i3(e){return e.replace(/\$(\d+)$/,"$1")}function sh(e){for(var n=o3(e),a=0,s=0;s!==n.length;++s)a=26*a+n.charCodeAt(s)-64;return a-1}function ta(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function c3(e){return e.replace(/^([A-Z])/,"$$$1")}function o3(e){return e.replace(/^\$([A-Z])/,"$1")}function u3(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ta(e){for(var n=0,a=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?n=10*n+(i-48):i>=65&&i<=90&&(a=26*a+(i-64))}return{c:a-1,r:n-1}}function Ze(e){for(var n=e.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(e.r+1)}function Cl(e){var n=e.indexOf(":");return n==-1?{s:Ta(e),e:Ta(e)}:{s:Ta(e.slice(0,n)),e:Ta(e.slice(n+1))}}function dt(e,n){return typeof n>"u"||typeof n=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=Ze(e)),typeof n!="string"&&(n=Ze(n)),e==n?e:e+":"+n)}function Bt(e){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,s=0,i=0,u=e.length;for(a=0;s<u&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)a=26*a+i;for(n.s.c=--a,a=0;s<u&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)a=10*a+i;if(n.s.r=--a,s===u||i!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++s,a=0;s!=u&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)a=26*a+i;for(n.e.c=--a,a=0;s!=u&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)a=10*a+i;return n.e.r=--a,n}function sg(e,n){var a=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=xr(e.z,a?Aa(n):n)}catch{}try{return e.w=xr((e.XF||{}).numFmtId||(a?14:0),a?Aa(n):n)}catch{return""+n}}function fn(e,n,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?Cs[e.v]||e.v:n==null?sg(e,e.v):sg(e,n))}function Kn(e,n){var a=n&&n.sheet?n.sheet:"Sheet1",s={};return s[a]=e,{SheetNames:[a],Sheets:s}}function o2(e,n,a){var s=a||{},i=e?Array.isArray(e):s.dense,u=e||(i?[]:{}),f=0,d=0;if(u&&s.origin!=null){if(typeof s.origin=="number")f=s.origin;else{var m=typeof s.origin=="string"?Ta(s.origin):s.origin;f=m.r,d=m.c}u["!ref"]||(u["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(u["!ref"]){var g=Bt(u["!ref"]);x.s.c=g.s.c,x.s.r=g.s.r,x.e.c=Math.max(x.e.c,g.e.c),x.e.r=Math.max(x.e.r,g.e.r),f==-1&&(x.e.r=f=g.e.r+1)}for(var v=0;v!=n.length;++v)if(n[v]){if(!Array.isArray(n[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var b=0;b!=n[v].length;++b)if(!(typeof n[v][b]>"u")){var k={v:n[v][b]},y=f+v,w=d+b;if(x.s.r>y&&(x.s.r=y),x.s.c>w&&(x.s.c=w),x.e.r<y&&(x.e.r=y),x.e.c<w&&(x.e.c=w),n[v][b]&&typeof n[v][b]=="object"&&!Array.isArray(n[v][b])&&!(n[v][b]instanceof Date))k=n[v][b];else if(Array.isArray(k.v)&&(k.f=n[v][b][1],k.v=k.v[0]),k.v===null)if(k.f)k.t="n";else if(s.nullError)k.t="e",k.v=0;else if(s.sheetStubs)k.t="z";else continue;else typeof k.v=="number"?k.t="n":typeof k.v=="boolean"?k.t="b":k.v instanceof Date?(k.z=s.dateNF||Qe[14],s.cellDates?(k.t="d",k.w=xr(k.z,Aa(k.v))):(k.t="n",k.v=Aa(k.v),k.w=xr(k.z,k.v))):k.t="s";if(i)u[y]||(u[y]=[]),u[y][w]&&u[y][w].z&&(k.z=u[y][w].z),u[y][w]=k;else{var N=Ze({c:w,r:y});u[N]&&u[N].z&&(k.z=u[N].z),u[N]=k}}}return x.s.c<1e7&&(u["!ref"]=dt(x)),u}function jl(e,n){return o2(null,e,n)}function f3(e){return e.read_shift(4,"i")}function ba(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function d3(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lh(e,n){var a=e.l,s=e.read_shift(1),i=ba(e),u=[],f={t:i,h:i};if((s&1)!==0){for(var d=e.read_shift(4),m=0;m!=d;++m)u.push(d3(e));f.r=u}else f.r=[{ich:0,ifnt:0}];return e.l=a+n,f}var h3=lh;function mr(e){var n=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:a}}function _s(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var x3=ba;function ih(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var m3=ba,yd=ih;function ch(e){var n=e.slice(e.l,e.l+4),a=n[0]&1,s=n[0]&2;e.l+=4;var i=s===0?co([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):ps(n,0)>>2;return a?i/100:i}function u2(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var As=u2;function ga(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function p3(e){var n={},a=e.read_shift(1),s=a>>>1,i=e.read_shift(1),u=e.read_shift(2,"i"),f=e.read_shift(1),d=e.read_shift(1),m=e.read_shift(1);switch(e.l++,s){case 0:n.auto=1;break;case 1:n.index=i;var x=ks[i];x&&(n.rgb=ec(x));break;case 2:n.rgb=ec([f,d,m]);break;case 3:n.theme=i;break}return u!=0&&(n.tint=u>0?u/32767:u/32768),n}function g3(e){var n=e.read_shift(1);e.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function f2(e,n){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function v3(e){return f2(e,1)}function b3(e){return f2(e,2)}var oh=2,Ia=3,I0=11,lg=12,oo=19,B0=64,y3=65,k3=71,w3=4108,S3=4126,na=80,d2=81,E3=[na,d2],N3={1:{n:"CodePage",t:oh},2:{n:"Category",t:na},3:{n:"PresentationFormat",t:na},4:{n:"ByteCount",t:Ia},5:{n:"LineCount",t:Ia},6:{n:"ParagraphCount",t:Ia},7:{n:"SlideCount",t:Ia},8:{n:"NoteCount",t:Ia},9:{n:"HiddenCount",t:Ia},10:{n:"MultimediaClipCount",t:Ia},11:{n:"ScaleCrop",t:I0},12:{n:"HeadingPairs",t:w3},13:{n:"TitlesOfParts",t:S3},14:{n:"Manager",t:na},15:{n:"Company",t:na},16:{n:"LinksUpToDate",t:I0},17:{n:"CharacterCount",t:Ia},19:{n:"SharedDoc",t:I0},22:{n:"HyperlinksChanged",t:I0},23:{n:"AppVersion",t:Ia,p:"version"},24:{n:"DigSig",t:y3},26:{n:"ContentType",t:na},27:{n:"ContentStatus",t:na},28:{n:"Language",t:na},29:{n:"Version",t:na},255:{},2147483648:{n:"Locale",t:oo},2147483651:{n:"Behavior",t:oo},1919054434:{}},T3={1:{n:"CodePage",t:oh},2:{n:"Title",t:na},3:{n:"Subject",t:na},4:{n:"Author",t:na},5:{n:"Keywords",t:na},6:{n:"Comments",t:na},7:{n:"Template",t:na},8:{n:"LastAuthor",t:na},9:{n:"RevNumber",t:na},10:{n:"EditTime",t:B0},11:{n:"LastPrinted",t:B0},12:{n:"CreatedDate",t:B0},13:{n:"ModifiedDate",t:B0},14:{n:"PageCount",t:Ia},15:{n:"WordCount",t:Ia},16:{n:"CharCount",t:Ia},17:{n:"Thumbnail",t:k3},18:{n:"Application",t:na},19:{n:"DocSecurity",t:Ia},255:{},2147483648:{n:"Locale",t:oo},2147483651:{n:"Behavior",t:oo},1919054434:{}},ig={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function A3(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var C3=A3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ks=fa(C3),Cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},h2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},cg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function j3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function O3(e){var n=j3();if(!e||!e.match)return n;var a={};if((e.match(ka)||[]).forEach(function(s){var i=Ke(s);switch(i[0].replace(zN,"<")){case"<?xml":break;case"<Types":n.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[i.Extension]=i.ContentType;break;case"<Override":n[cg[i.ContentType]]!==void 0&&n[cg[i.ContentType]].push(i.PartName);break}}),n.xmlns!==WN.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=a,delete n.calcchains,n}var gl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function kd(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Ii(e,n){var a={"!id":{}};if(!e)return a;n.charAt(0)!=="/"&&(n="/"+n);var s={};return(e.match(ka)||[]).forEach(function(i){var u=Ke(i);if(u[0]==="<Relationship"){var f={};f.Type=u.Type,f.Target=u.Target,f.Id=u.Id,u.TargetMode&&(f.TargetMode=u.TargetMode);var d=u.TargetMode==="External"?u.Target:ji(u.Target,n);a[d]=f,s[u.Id]=f}}),a["!id"]=s,a}var R3="application/vnd.oasis.opendocument.spreadsheet";function D3(e,n){for(var a=ah(e),s,i;s=Ji.exec(a);)switch(s[3]){case"manifest":break;case"file-entry":if(i=Ke(s[0],!1),i.path=="/"&&i.type!==R3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw s}}var Bi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],F3=(function(){for(var e=new Array(Bi.length),n=0;n<Bi.length;++n){var a=Bi[n],s="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[n]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e})();function x2(e){var n={};e=Nt(e);for(var a=0;a<Bi.length;++a){var s=Bi[a],i=e.match(F3[a]);i!=null&&i.length>0&&(n[s[1]]=ht(i[1])),s[2]==="date"&&n[s[1]]&&(n[s[1]]=sa(n[s[1]]))}return n}var M3=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function m2(e,n,a,s){var i=[];if(typeof e=="string")i=Jp(e,s);else for(var u=0;u<e.length;++u)i=i.concat(e[u].map(function(g){return{v:g}}));var f=typeof n=="string"?Jp(n,s).map(function(g){return g.v}):n,d=0,m=0;if(f.length>0)for(var x=0;x!==i.length;x+=2){switch(m=+i[x+1].v,i[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=m,a.SheetNames=f.slice(d,d+m);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=m,a.DefinedNames=f.slice(d,d+m);break;case"Charts":case"Diagramme":a.Chartsheets=m,a.ChartNames=f.slice(d,d+m);break}d+=m}}function L3(e,n,a){var s={};return n||(n={}),e=Nt(e),M3.forEach(function(i){var u=(e.match(Zi(i[0]))||[])[1];switch(i[2]){case"string":u&&(n[i[1]]=ht(u));break;case"bool":n[i[1]]=u==="true";break;case"raw":var f=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));f&&f.length>0&&(s[i[1]]=f[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&m2(s.HeadingPairs,s.TitlesOfParts,n,a),n}var I3=/<[^>]+>[^<]*/g;function B3(e,n){var a={},s="",i=e.match(I3);if(i)for(var u=0;u!=i.length;++u){var f=i[u],d=Ke(f);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":s=ht(d.name);break;case"</property>":s=null;break;default:if(f.indexOf("<vt:")===0){var m=f.split(">"),x=m[0].slice(4),g=m[1];switch(x){case"lpstr":case"bstr":case"lpwstr":a[s]=ht(g);break;case"bool":a[s]=Ot(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[s]=parseInt(g,10);break;case"r4":case"r8":case"decimal":a[s]=parseFloat(g);break;case"filetime":case"date":a[s]=sa(g);break;case"cy":case"error":a[s]=ht(g);break;default:if(x.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",f,x,m)}}else if(f.slice(0,2)!=="</"){if(n.WTF)throw new Error(f)}}}return a}var z3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qf;function U3(e,n,a){Qf||(Qf=Qd(z3)),n=Qf[n]||n,e[n]=a}function uh(e){var n=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function p2(e,n,a){var s=e.l,i=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-s&3;)++e.l;return i}function g2(e,n,a){var s=e.read_shift(0,"lpwstr");return s}function v2(e,n,a){return n===31?g2(e):p2(e,n,a)}function wd(e,n,a){return v2(e,n,a===!1?0:4)}function P3(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return v2(e,n,0)}function H3(e){for(var n=e.read_shift(4),a=[],s=0;s!=n;++s){var i=e.l;a[s]=e.read_shift(0,"lpwstr").replace(_a,""),e.l-i&2&&(e.l+=2)}return a}function V3(e){for(var n=e.read_shift(4),a=[],s=0;s!=n;++s)a[s]=e.read_shift(0,"lpstr-cp").replace(_a,"");return a}function G3(e){var n=e.l,a=uo(e,d2);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var s=uo(e,Ia);return[a,s]}function $3(e){for(var n=e.read_shift(4),a=[],s=0;s<n/2;++s)a.push(G3(e));return a}function og(e,n){for(var a=e.read_shift(4),s={},i=0;i!=a;++i){var u=e.read_shift(4),f=e.read_shift(4);s[u]=e.read_shift(f,n===1200?"utf16le":"utf8").replace(_a,"").replace(Ci,"!"),n===1200&&f%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function b2(e){var n=e.read_shift(4),a=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),a}function X3(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function uo(e,n,a){var s=e.read_shift(2),i,u=a||{};if(e.l+=2,n!==lg&&s!==n&&E3.indexOf(n)===-1&&!((n&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+n+" saw "+s);switch(n===lg?s:n){case 2:return i=e.read_shift(2,"i"),u.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return p2(e,s,4).replace(_a,"");case 31:return g2(e);case 64:return uh(e);case 65:return b2(e);case 71:return X3(e);case 80:return wd(e,s,!u.raw).replace(_a,"");case 81:return P3(e,s).replace(_a,"");case 4108:return $3(e);case 4126:case 4127:return s==4127?H3(e):V3(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+s)}}function ug(e,n){var a=e.l,s=e.read_shift(4),i=e.read_shift(4),u=[],f=0,d=0,m=-1,x={};for(f=0;f!=i;++f){var g=e.read_shift(4),v=e.read_shift(4);u[f]=[g,v+a]}u.sort(function(O,E){return O[1]-E[1]});var b={};for(f=0;f!=i;++f){if(e.l!==u[f][1]){var k=!0;if(f>0&&n)switch(n[u[f-1][0]].t){case 2:e.l+2===u[f][1]&&(e.l+=2,k=!1);break;case 80:e.l<=u[f][1]&&(e.l=u[f][1],k=!1);break;case 4108:e.l<=u[f][1]&&(e.l=u[f][1],k=!1);break}if((!n||f==0)&&e.l<=u[f][1]&&(k=!1,e.l=u[f][1]),k)throw new Error("Read Error: Expected address "+u[f][1]+" at "+e.l+" :"+f)}if(n){var y=n[u[f][0]];if(b[y.n]=uo(e,y.t,{raw:!0}),y.p==="version"&&(b[y.n]=String(b[y.n]>>16)+"."+("0000"+String(b[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(b[y.n]){case 0:b[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Sr(d=b[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+b[y.n])}}else if(u[f][0]===1){if(d=b.CodePage=uo(e,oh),Sr(d),m!==-1){var w=e.l;e.l=u[m][1],x=og(e,d),e.l=w}}else if(u[f][0]===0){if(d===0){m=f,e.l=u[f+1][1];continue}x=og(e,d)}else{var N=x[u[f][0]],_;switch(e[e.l]){case 65:e.l+=4,_=b2(e);break;case 30:e.l+=4,_=wd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=wd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=Vt(e,4);break;case 64:e.l+=4,_=sa(uh(e));break;default:throw new Error("unparsed value: "+e[e.l])}b[N]=_}}return e.l=a+s,b}function fg(e,n,a){var s=e.content;if(!s)return{};ua(s,0);var i,u,f,d,m=0;s.chk("feff","Byte Order: "),s.read_shift(2);var x=s.read_shift(4),g=s.read_shift(16);if(g!==ft.utils.consts.HEADER_CLSID&&g!==a)throw new Error("Bad PropertySet CLSID "+g);if(i=s.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(u=s.read_shift(16),d=s.read_shift(4),i===1&&d!==s.l)throw new Error("Length mismatch: "+d+" !== "+s.l);i===2&&(f=s.read_shift(16),m=s.read_shift(4));var v=ug(s,n),b={SystemIdentifier:x};for(var k in v)b[k]=v[k];if(b.FMTID=u,i===1)return b;if(m-s.l==2&&(s.l+=2),s.l!==m)throw new Error("Length mismatch 2: "+s.l+" !== "+m);var y;try{y=ug(s,null)}catch{}for(k in y)b[k]=y[k];return b.FMTID=[u,f],b}function Bn(e,n){return e.read_shift(n),null}function Y3(e,n,a){for(var s=[],i=e.l+n;e.l<i;)s.push(a(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return s}function Vt(e,n){return e.read_shift(n)===1}function Zt(e){return e.read_shift(2,"u")}function y2(e,n){return Y3(e,n,Zt)}function q3(e){var n=e.read_shift(1),a=e.read_shift(1);return a===1?n:n===1}function oc(e,n,a){var s=e.read_shift(a&&a.biff>=12?2:1),i="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var u=e.read_shift(1);u&&(i="dbcs-cont")}else a.biff==12&&(i="wstr");a.biff>=2&&a.biff<=5&&(i="cpstr");var f=s?e.read_shift(s,i):"";return f}function K3(e){var n=e.read_shift(2),a=e.read_shift(1),s=a&4,i=a&8,u=1+(a&1),f=0,d,m={};i&&(f=e.read_shift(2)),s&&(d=e.read_shift(4));var x=u==2?"dbcs-cont":"sbcs-cont",g=n===0?"":e.read_shift(n,x);return i&&(e.l+=4*f),s&&(e.l+=d),m.t=g,i||(m.raw="<t>"+m.t+"</t>",m.r=m.t),m}function Es(e,n,a){var s;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(n,"cpstr");if(a.biff>=12)return e.read_shift(n,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(n,"sbcs-cont"):s=e.read_shift(n,"dbcs-cont"),s}function uc(e,n,a){var s=e.read_shift(a&&a.biff==2?1:2);return s===0?(e.l++,""):Es(e,s,a)}function js(e,n,a){if(a.biff>5)return uc(e,n,a);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function W3(e){var n=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[n,a]}function Z3(e){var n=e.read_shift(4),a=e.l,s=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=a);var i=e.read_shift((s?n-24:n)>>1,"utf16le").replace(_a,"");return s&&(e.l+=24),i}function J3(e){for(var n=e.read_shift(2),a="";n-- >0;)a+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return a+s.replace(/\\/g,"/");var u=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var f=e.read_shift(u>>1,"utf16le").replace(_a,"");return a+f}function Q3(e,n){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return Z3(e);case"0303000000000000c000000000000046":return J3(e);default:throw new Error("Unsupported Moniker "+a)}}function z0(e){var n=e.read_shift(4),a=n>0?e.read_shift(n,"utf16le").replace(_a,""):"";return a}function eT(e,n){var a=e.l+n,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var i=e.read_shift(2);e.l+=2;var u,f,d,m,x="",g,v;i&16&&(u=z0(e,a-e.l)),i&128&&(f=z0(e,a-e.l)),(i&257)===257&&(d=z0(e,a-e.l)),(i&257)===1&&(m=Q3(e,a-e.l)),i&8&&(x=z0(e,a-e.l)),i&32&&(g=e.read_shift(16)),i&64&&(v=uh(e)),e.l=a;var b=f||d||m||"";b&&x&&(b+="#"+x),b||(b="#"+x),i&2&&b.charAt(0)=="/"&&b.charAt(1)!="/"&&(b="file://"+b);var k={Target:b};return g&&(k.guid=g),v&&(k.time=v),u&&(k.Tooltip=u),k}function k2(e){var n=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1),i=e.read_shift(1);return[n,a,s,i]}function w2(e,n){var a=k2(e);return a[3]=0,a}function zr(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{r:n,c:a,ixfe:s}}function tT(e){var n=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:n,flags:a}}function aT(e,n,a){return n===0?"":js(e,n,a)}function rT(e,n,a){var s=a.biff>8?4:2,i=e.read_shift(s),u=e.read_shift(s,"i"),f=e.read_shift(s,"i");return[i,u,f]}function S2(e){var n=e.read_shift(2),a=ch(e);return[n,a]}function nT(e,n,a){e.l+=4,n-=4;var s=e.l+n,i=oc(e,n,a),u=e.read_shift(2);if(s-=e.l,u!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+u);return e.l+=u,i}function ko(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:n},e:{c:i,r:a}}}function E2(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1);return{s:{c:s,r:n},e:{c:i,r:a}}}var sT=E2;function N2(e){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[a,n,s]}function lT(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function iT(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function ma(e){e.l+=2,e.l+=e.read_shift(2)}var cT={0:ma,4:ma,5:ma,6:ma,7:iT,8:ma,9:ma,10:ma,11:ma,12:ma,13:lT,14:ma,15:ma,16:ma,17:ma,18:ma,19:ma,20:ma,21:N2};function oT(e,n){for(var a=e.l+n,s=[];e.l<a;){var i=e.read_shift(2);e.l-=2;try{s.push(cT[i](e,a-e.l))}catch{return e.l=a,s}}return e.l!=a&&(e.l=a),s}function U0(e,n){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),n-=2,n>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(n),a}function uT(e,n){return n===0||e.read_shift(2),1200}function fT(e,n,a){if(a.enc)return e.l+=n,"";var s=e.l,i=js(e,0,a);return e.read_shift(n+s-e.l),i}function dT(e,n,a){var s=a&&a.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function hT(e,n,a){var s=e.read_shift(4),i=e.read_shift(1)&3,u=e.read_shift(1);switch(u){case 0:u="Worksheet";break;case 1:u="Macrosheet";break;case 2:u="Chartsheet";break;case 6:u="VBAModule";break}var f=oc(e,0,a);return f.length===0&&(f="Sheet1"),{pos:s,hs:i,dt:u,name:f}}function xT(e,n){for(var a=e.l+n,s=e.read_shift(4),i=e.read_shift(4),u=[],f=0;f!=i&&e.l<a;++f)u.push(K3(e));return u.Count=s,u.Unique=i,u}function mT(e,n){var a={};return a.dsst=e.read_shift(2),e.l+=n-2,a}function pT(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var a=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(n.level=s&7),s&32&&(n.hidden=!0),s&64&&(n.hpt=a/20),n}function gT(e){var n=tT(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var a=e.read_shift(4);return a!==0}function vT(e){return e.read_shift(2),e.read_shift(4)}function dg(e,n,a){var s=0;a&&a.biff==2||(s=e.read_shift(2));var i=e.read_shift(2);a&&a.biff==2&&(s=1-(i>>15),i&=32767);var u={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[u,i]}function bT(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2),m=e.read_shift(2),x=e.read_shift(2);return{Pos:[n,a],Dim:[s,i],Flags:u,CurTab:f,FirstTab:d,Selected:m,TabRatio:x}}function yT(e,n,a){if(a&&a.biff>=2&&a.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function kT(){}function wT(e,n,a){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=oc(e,0,a),s}function ST(e){var n=zr(e);return n.isst=e.read_shift(4),n}function ET(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=e.l+n,i=zr(e);a.biff==2&&e.l++;var u=uc(e,s-e.l,a);return i.val=u,i}function NT(e,n,a){var s=e.read_shift(2),i=js(e,0,a);return[s,i]}var TT=js;function hg(e,n,a){var s=e.l+n,i=a.biff==8||!a.biff?4:2,u=e.read_shift(i),f=e.read_shift(i),d=e.read_shift(2),m=e.read_shift(2);return e.l=s,{s:{r:u,c:d},e:{r:f,c:m}}}function _T(e){var n=e.read_shift(2),a=e.read_shift(2),s=S2(e);return{r:n,c:a,ixfe:s[0],rknum:s[1]}}function AT(e,n){for(var a=e.l+n-2,s=e.read_shift(2),i=e.read_shift(2),u=[];e.l<a;)u.push(S2(e));if(e.l!==a)throw new Error("MulRK read error");var f=e.read_shift(2);if(u.length!=f-i+1)throw new Error("MulRK length mismatch");return{r:s,c:i,C:f,rkrec:u}}function CT(e,n){for(var a=e.l+n-2,s=e.read_shift(2),i=e.read_shift(2),u=[];e.l<a;)u.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var f=e.read_shift(2);if(u.length!=f-i+1)throw new Error("MulBlank length mismatch");return{r:s,c:i,C:f,ixfe:u}}function jT(e,n,a,s){var i={},u=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(4),m=e.read_shift(2);return i.patternType=_3[d>>26],s.cellStyles&&(i.alc=u&7,i.fWrap=u>>3&1,i.alcV=u>>4&7,i.fJustLast=u>>7&1,i.trot=u>>8&255,i.cIndent=u>>16&15,i.fShrinkToFit=u>>20&1,i.iReadOrder=u>>22&2,i.fAtrNum=u>>26&1,i.fAtrFnt=u>>27&1,i.fAtrAlc=u>>28&1,i.fAtrBdr=u>>29&1,i.fAtrPat=u>>30&1,i.fAtrProt=u>>31&1,i.dgLeft=f&15,i.dgRight=f>>4&15,i.dgTop=f>>8&15,i.dgBottom=f>>12&15,i.icvLeft=f>>16&127,i.icvRight=f>>23&127,i.grbitDiag=f>>30&3,i.icvTop=d&127,i.icvBottom=d>>7&127,i.icvDiag=d>>14&127,i.dgDiag=d>>21&15,i.icvFore=m&127,i.icvBack=m>>7&127,i.fsxButton=m>>14&1),i}function OT(e,n,a){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,n-=6,s.data=jT(e,n,s.fStyle,a),s}function RT(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function xg(e,n,a){var s=zr(e);(a.biff==2||n==9)&&++e.l;var i=q3(e);return s.val=i,s.t=i===!0||i===!1?"b":"e",s}function DT(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=zr(e),i=ga(e);return s.val=i,s}var mg=aT;function FT(e,n,a){var s=e.l+n,i=e.read_shift(2),u=e.read_shift(2);if(a.sbcch=u,u==1025||u==14849)return[u,i];if(u<1||u>255)throw new Error("Unexpected SupBook type: "+u);for(var f=Es(e,u),d=[];s>e.l;)d.push(uc(e));return[u,i,f,d]}function pg(e,n,a){var s=e.read_shift(2),i,u={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return a.sbcch===14849&&(i=nT(e,n-2,a)),u.body=i||e.read_shift(n-2),typeof i=="string"&&(u.Name=i),u}var MT=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gg(e,n,a){var s=e.l+n,i=e.read_shift(2),u=e.read_shift(1),f=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),m=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),m=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var x=Es(e,f,a);i&32&&(x=MT[x.charCodeAt(0)]);var g=s-e.l;a&&a.biff==2&&--g;var v=s==e.l||d===0||!(g>0)?[]:p6(e,g,a,d);return{chKey:u,Name:x,itab:m,rgce:v}}function T2(e,n,a){if(a.biff<8)return LT(e,n,a);for(var s=[],i=e.l+n,u=e.read_shift(a.biff>8?4:2);u--!==0;)s.push(rT(e,a.biff>8?12:6,a));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function LT(e,n,a){e[e.l+1]==3&&e[e.l]++;var s=oc(e,n,a);return s.charCodeAt(0)==3?s.slice(1):s}function IT(e,n,a){if(a.biff<8){e.l+=n;return}var s=e.read_shift(2),i=e.read_shift(2),u=Es(e,s,a),f=Es(e,i,a);return[u,f]}function BT(e,n,a){var s=E2(e);e.l++;var i=e.read_shift(1);return n-=8,[g6(e,n,a),i,s]}function vg(e,n,a){var s=sT(e);switch(a.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[s,x6(e,n,a)]}function zT(e){var n=e.read_shift(4)!==0,a=e.read_shift(4)!==0,s=e.read_shift(4);return[n,a,s]}function UT(e,n,a){if(!(a.biff<8)){var s=e.read_shift(2),i=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2),d=js(e,0,a);return a.biff<8&&e.read_shift(1),[{r:s,c:i},d,f,u]}}function PT(e,n,a){return UT(e,n,a)}function HT(e,n){for(var a=[],s=e.read_shift(2);s--;)a.push(ko(e));return a}function VT(e,n,a){if(a&&a.biff<8)return $T(e,n,a);var s=N2(e),i=oT(e,n-22,s[1]);return{cmo:s,ft:i}}var GT={8:function(e,n){var a=e.l+n;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=a,{fmt:s}}};function $T(e,n,a){e.l+=4;var s=e.read_shift(2),i=e.read_shift(2),u=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var f=[];return f.push((GT[s]||ya)(e,n,a)),{cmo:[i,s,u],ft:f}}function XT(e,n,a){var s=e.l,i="";try{e.l+=4;var u=(a.lastobj||{cmo:[0,0]}).cmo[1],f;[0,5,7,11,12,14].indexOf(u)==-1?e.l+=6:f=W3(e,6,a);var d=e.read_shift(2);e.read_shift(2),Zt(e,2);var m=e.read_shift(2);e.l+=m;for(var x=1;x<e.lens.length-1;++x){if(e.l-s!=e.lens[x])throw new Error("TxO: bad continue record");var g=e[e.l],v=Es(e,e.lens[x+1]-e.lens[x]-1);if(i+=v,i.length>=(g?d:2*d))break}if(i.length!==d&&i.length!==d*2)throw new Error("cchText: "+d+" != "+i.length);return e.l=s+n,{t:i}}catch{return e.l=s+n,{t:i}}}function YT(e,n){var a=ko(e);e.l+=16;var s=eT(e,n-24);return[a,s]}function qT(e,n){e.read_shift(2);var a=ko(e),s=e.read_shift((n-10)/2,"dbcs-cont");return s=s.replace(_a,""),[a,s]}function KT(e){var n=[0,0],a;return a=e.read_shift(2),n[0]=ig[a]||a,a=e.read_shift(2),n[1]=ig[a]||a,n}function WT(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(w2(e));return a}function ZT(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(w2(e));return a}function JT(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function _2(e,n,a){if(!a.cellStyles)return ya(e,n);var s=a&&a.biff>=12?4:2,i=e.read_shift(s),u=e.read_shift(s),f=e.read_shift(s),d=e.read_shift(s),m=e.read_shift(2);s==2&&(e.l+=2);var x={s:i,e:u,w:f,ixfe:d,flags:m};return(a.biff>=5||!a.biff)&&(x.level=m>>8&7),x}function QT(e,n){var a={};return n<32||(e.l+=16,a.header=ga(e),a.footer=ga(e),e.l+=2),a}function e5(e,n,a){var s={area:!1};if(a.biff!=5)return e.l+=n,s;var i=e.read_shift(1);return e.l+=3,i&16&&(s.area=!0),s}var t5=zr,a5=y2,r5=uc;function n5(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),i={fmt:n,env:a,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,i}function s5(e,n,a){a.biffguess&&a.biff==5&&(a.biff=2);var s=zr(e);++e.l;var i=js(e,n-7,a);return s.t="str",s.val=i,s}function l5(e){var n=zr(e);++e.l;var a=ga(e);return n.t="n",n.val=a,n}function i5(e){var n=zr(e);++e.l;var a=e.read_shift(2);return n.t="n",n.val=a,n}function c5(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function o5(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function u5(e,n,a){var s=e.l+n,i=zr(e),u=e.read_shift(2),f=Es(e,u,a);return e.l=s,i.t="str",i.val=f,i}var f5=[2,3,48,49,131,139,140,245],bg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=Qd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,m){var x=[],g=Xn(1);switch(m.type){case"base64":g=wr(qa(d));break;case"binary":g=wr(d);break;case"buffer":case"array":g=d;break}ua(g,0);var v=g.read_shift(1),b=!!(v&136),k=!1,y=!1;switch(v){case 2:break;case 3:break;case 48:k=!0,b=!0;break;case 49:k=!0,b=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,N=521;v==2&&(w=g.read_shift(2)),g.l+=3,v!=2&&(w=g.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(N=g.read_shift(2));var _=g.read_shift(2),O=m.codepage||1252;v!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(O=e[g[g.l]]),g.l+=1,g.l+=2),y&&(g.l+=36);for(var E=[],L={},G=Math.min(g.length,v==2?521:N-10-(k?264:0)),H=y?32:11;g.l<G&&g[g.l]!=13;)switch(L={},L.name=Ki.utils.decode(O,g.slice(g.l,g.l+H)).replace(/[\u0000\r\n].*$/g,""),g.l+=H,L.type=String.fromCharCode(g.read_shift(1)),v!=2&&!y&&(L.offset=g.read_shift(4)),L.len=g.read_shift(1),v==2&&(L.offset=g.read_shift(2)),L.dec=g.read_shift(1),L.name.length&&E.push(L),v!=2&&(g.l+=y?13:14),L.type){case"B":(!k||L.len!=8)&&m.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(g[g.l]!==13&&(g.l=N-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=N;var R=0,Z=0;for(x[0]=[],Z=0;Z!=E.length;++Z)x[0][Z]=E[Z].name;for(;w-- >0;){if(g[g.l]===42){g.l+=_;continue}for(++g.l,x[++R]=[],Z=0,Z=0;Z!=E.length;++Z){var Y=g.slice(g.l,g.l+E[Z].len);g.l+=E[Z].len,ua(Y,0);var Q=Ki.utils.decode(O,Y);switch(E[Z].type){case"C":Q.trim().length&&(x[R][Z]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?x[R][Z]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):x[R][Z]=Q;break;case"F":x[R][Z]=parseFloat(Q.trim());break;case"+":case"I":x[R][Z]=y?Y.read_shift(-4,"i")^2147483648:Y.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":x[R][Z]=!0;break;case"N":case"F":x[R][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!b)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));x[R][Z]="##MEMO##"+(y?parseInt(Q.trim(),10):Y.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(x[R][Z]=+Q||0);break;case"@":x[R][Z]=new Date(Y.read_shift(-8,"f")-621356832e5);break;case"T":x[R][Z]=new Date((Y.read_shift(4)-2440588)*864e5+Y.read_shift(4));break;case"Y":x[R][Z]=Y.read_shift(4,"i")/1e4+Y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[R][Z]=-Y.read_shift(-8,"f");break;case"B":if(k&&E[Z].len==8){x[R][Z]=Y.read_shift(8,"f");break}case"G":case"P":Y.l+=E[Z].len;break;case"0":if(E[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[Z].type)}}}if(v!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),m.DBF=E,x}function s(d,m){var x=m||{};x.dateNF||(x.dateNF="yyyymmdd");var g=jl(a(d,x),x);return g["!cols"]=x.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete x.DBF,g}function i(d,m){try{return Kn(s(d,m),m)}catch(x){if(m&&m.WTF)throw x}return{SheetNames:[],Sheets:{}}}var u={B:8,C:250,L:1,D:8,"?":0,"":0};function f(d,m){var x=m||{};if(+x.codepage>=0&&Sr(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var g=bd(),v=Cd(d,{header:1,raw:!0,cellDates:!0}),b=v[0],k=v.slice(1),y=d["!cols"]||[],w=0,N=0,_=0,O=1;for(w=0;w<b.length;++w){if(((y[w]||{}).DBF||{}).name){b[w]=y[w].DBF.name,++_;continue}if(b[w]!=null){if(++_,typeof b[w]=="number"&&(b[w]=b[w].toString(10)),typeof b[w]!="string")throw new Error("DBF Invalid column name "+b[w]+" |"+typeof b[w]+"|");if(b.indexOf(b[w])!==w){for(N=0;N<1024;++N)if(b.indexOf(b[w]+"_"+N)==-1){b[w]+="_"+N;break}}}}var E=Bt(d["!ref"]),L=[],G=[],H=[];for(w=0;w<=E.e.c-E.s.c;++w){var R="",Z="",Y=0,Q=[];for(N=0;N<k.length;++N)k[N][w]!=null&&Q.push(k[N][w]);if(Q.length==0||b[w]==null){L[w]="?";continue}for(N=0;N<Q.length;++N){switch(typeof Q[N]){case"number":Z="B";break;case"string":Z="C";break;case"boolean":Z="L";break;case"object":Z=Q[N]instanceof Date?"D":"C";break;default:Z="C"}Y=Math.max(Y,String(Q[N]).length),R=R&&R!=Z?"C":Z}Y>250&&(Y=250),Z=((y[w]||{}).DBF||{}).type,Z=="C"&&y[w].DBF.len>Y&&(Y=y[w].DBF.len),R=="B"&&Z=="N"&&(R="N",H[w]=y[w].DBF.dec,Y=y[w].DBF.len),G[w]=R=="C"||Z=="N"?Y:u[R]||0,O+=G[w],L[w]=R}var K=g.next(32);for(K.write_shift(4,318902576),K.write_shift(4,k.length),K.write_shift(2,296+32*_),K.write_shift(2,O),w=0;w<4;++w)K.write_shift(4,0);for(K.write_shift(4,0|(+n[Tv]||3)<<8),w=0,N=0;w<b.length;++w)if(b[w]!=null){var ee=g.next(32),Ee=(b[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,Ee,"sbcs"),ee.write_shift(1,L[w]=="?"?"C":L[w],"sbcs"),ee.write_shift(4,N),ee.write_shift(1,G[w]||u[L[w]]||0),ee.write_shift(1,H[w]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),N+=G[w]||u[L[w]]||0}var Ne=g.next(264);for(Ne.write_shift(4,13),w=0;w<65;++w)Ne.write_shift(4,0);for(w=0;w<k.length;++w){var me=g.next(O);for(me.write_shift(1,0),N=0;N<b.length;++N)if(b[N]!=null)switch(L[N]){case"L":me.write_shift(1,k[w][N]==null?63:k[w][N]?84:70);break;case"B":me.write_shift(8,k[w][N]||0,"f");break;case"N":var J="0";for(typeof k[w][N]=="number"&&(J=k[w][N].toFixed(H[N]||0)),_=0;_<G[N]-J.length;++_)me.write_shift(1,32);me.write_shift(1,J,"sbcs");break;case"D":k[w][N]?(me.write_shift(4,("0000"+k[w][N].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(k[w][N].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+k[w][N].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var se=String(k[w][N]!=null?k[w][N]:"").slice(0,G[N]);for(me.write_shift(1,se,"sbcs"),_=0;_<G[N]-se.length;++_)me.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:s,from_sheet:f}})(),d5=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Lr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(b,k){var y=e[k];return typeof y=="number"?Mp(y):y},s=function(b,k,y){var w=k.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return w==59?b:Mp(w)};e["|"]=254;function i(b,k){switch(k.type){case"base64":return u(qa(b),k);case"binary":return u(b,k);case"buffer":return u(ut&&Buffer.isBuffer(b)?b.toString("binary"):Ts(b),k);case"array":return u(Ss(b),k)}throw new Error("Unrecognized type "+k.type)}function u(b,k){var y=b.split(/[\n\r]+/),w=-1,N=-1,_=0,O=0,E=[],L=[],G=null,H={},R=[],Z=[],Y=[],Q=0,K;for(+k.codepage>=0&&Sr(+k.codepage);_!==y.length;++_){Q=0;var ee=y[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(n,a),Ee=ee.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),Ne=Ee[0],me;if(ee.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ee[1].charAt(0)=="P"&&L.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,se=!1,Ae=!1,ae=!1,Ce=-1,B=-1;for(O=1;O<Ee.length;++O)switch(Ee[O].charAt(0)){case"A":break;case"X":N=parseInt(Ee[O].slice(1))-1,se=!0;break;case"Y":for(w=parseInt(Ee[O].slice(1))-1,se||(N=0),K=E.length;K<=w;++K)E[K]=[];break;case"K":me=Ee[O].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(Tr(me))?isNaN(Sl(me).getDate())||(me=sa(me)):(me=Tr(me),G!==null&&Al(G)&&(me=yo(me))),J=!0;break;case"E":ae=!0;var A=yl(Ee[O].slice(1),{r:w,c:N});E[w][N]=[E[w][N],A];break;case"S":Ae=!0,E[w][N]=[E[w][N],"S5S"];break;case"G":break;case"R":Ce=parseInt(Ee[O].slice(1))-1;break;case"C":B=parseInt(Ee[O].slice(1))-1;break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+ee)}if(J&&(E[w][N]&&E[w][N].length==2?E[w][N][0]=me:E[w][N]=me,G=null),Ae){if(ae)throw new Error("SYLK shared formula cannot have own formula");var q=Ce>-1&&E[Ce][B];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");E[w][N][1]=I2(q[1],{r:w-Ce,c:N-B})}break;case"F":var V=0;for(O=1;O<Ee.length;++O)switch(Ee[O].charAt(0)){case"X":N=parseInt(Ee[O].slice(1))-1,++V;break;case"Y":for(w=parseInt(Ee[O].slice(1))-1,K=E.length;K<=w;++K)E[K]=[];break;case"M":Q=parseInt(Ee[O].slice(1))/20;break;case"F":break;case"G":break;case"P":G=L[parseInt(Ee[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Y=Ee[O].slice(1).split(" "),K=parseInt(Y[0],10);K<=parseInt(Y[1],10);++K)Q=parseInt(Y[2],10),Z[K-1]=Q===0?{hidden:!0}:{wch:Q},El(Z[K-1]);break;case"C":N=parseInt(Ee[O].slice(1))-1,Z[N]||(Z[N]={});break;case"R":w=parseInt(Ee[O].slice(1))-1,R[w]||(R[w]={}),Q>0?(R[w].hpt=Q,R[w].hpx=tc(Q)):Q===0&&(R[w].hidden=!0);break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+ee)}V<1&&(G=null);break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+ee)}}return R.length>0&&(H["!rows"]=R),Z.length>0&&(H["!cols"]=Z),k&&k.sheetRows&&(E=E.slice(0,k.sheetRows)),[E,H]}function f(b,k){var y=i(b,k),w=y[0],N=y[1],_=jl(w,k);return Lr(N).forEach(function(O){_[O]=N[O]}),_}function d(b,k){return Kn(f(b,k),k)}function m(b,k,y,w){var N="C;Y"+(y+1)+";X"+(w+1)+";K";switch(b.t){case"n":N+=b.v||0,b.f&&!b.F&&(N+=";E"+J_(b.f,{r:y,c:w}));break;case"b":N+=b.v?"TRUE":"FALSE";break;case"e":N+=b.w||b.v;break;case"d":N+='"'+(b.w||b.v)+'"';break;case"s":N+='"'+b.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function x(b,k){k.forEach(function(y,w){var N="F;W"+(w+1)+" "+(w+1)+" ";y.hidden?N+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=ho(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=xo(y.wpx)),typeof y.wch=="number"&&(N+=Math.round(y.wch))),N.charAt(N.length-1)!=" "&&b.push(N)})}function g(b,k){k.forEach(function(y,w){var N="F;";y.hidden?N+="M0;":y.hpt?N+="M"+20*y.hpt+";":y.hpx&&(N+="M"+20*F2(y.hpx)+";"),N.length>2&&b.push(N+"R"+(w+1))})}function v(b,k){var y=["ID;PWXL;N;E"],w=[],N=Bt(b["!ref"]),_,O=Array.isArray(b),E=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),b["!cols"]&&x(y,b["!cols"]),b["!rows"]&&g(y,b["!rows"]),y.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var L=N.s.r;L<=N.e.r;++L)for(var G=N.s.c;G<=N.e.c;++G){var H=Ze({r:L,c:G});_=O?(b[L]||[])[G]:b[H],!(!_||_.v==null&&(!_.f||_.F))&&w.push(m(_,b,L,G))}return y.join(E)+E+w.join(E)+E+"E"+E}return{to_workbook:d,to_sheet:f,from_sheet:v}})(),h5=(function(){function e(u,f){switch(f.type){case"base64":return n(qa(u),f);case"binary":return n(u,f);case"buffer":return n(ut&&Buffer.isBuffer(u)?u.toString("binary"):Ts(u),f);case"array":return n(Ss(u),f)}throw new Error("Unrecognized type "+f.type)}function n(u,f){for(var d=u.split(`
`),m=-1,x=-1,g=0,v=[];g!==d.length;++g){if(d[g].trim()==="BOT"){v[++m]=[],x=0;continue}if(!(m<0)){var b=d[g].trim().split(","),k=b[0],y=b[1];++g;for(var w=d[g]||"";(w.match(/["]/g)||[]).length&1&&g<d.length-1;)w+=`
`+d[++g];switch(w=w.trim(),+k){case-1:if(w==="BOT"){v[++m]=[],x=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[m][x]=!0:w==="FALSE"?v[m][x]=!1:isNaN(Tr(y))?isNaN(Sl(y).getDate())?v[m][x]=y:v[m][x]=sa(y):v[m][x]=Tr(y),++x;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[m][x++]=w!==""?w:null;break}if(w==="EOD")break}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function a(u,f){return jl(e(u,f),f)}function s(u,f){return Kn(a(u,f),f)}var i=(function(){var u=function(m,x,g,v,b){m.push(x),m.push(g+","+v),m.push('"'+b.replace(/"/g,'""')+'"')},f=function(m,x,g,v){m.push(x+","+g),m.push(x==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(m){var x=[],g=Bt(m["!ref"]),v,b=Array.isArray(m);u(x,"TABLE",0,1,"sheetjs"),u(x,"VECTORS",0,g.e.r-g.s.r+1,""),u(x,"TUPLES",0,g.e.c-g.s.c+1,""),u(x,"DATA",0,0,"");for(var k=g.s.r;k<=g.e.r;++k){f(x,-1,0,"BOT");for(var y=g.s.c;y<=g.e.c;++y){var w=Ze({r:k,c:y});if(v=b?(m[k]||[])[y]:m[w],!v){f(x,1,0,"");continue}switch(v.t){case"n":var N=v.w;!N&&v.v!=null&&(N=v.v),N==null?v.f&&!v.F?f(x,1,0,"="+v.f):f(x,1,0,""):f(x,0,N,"V");break;case"b":f(x,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":f(x,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=xr(v.z||Qe[14],Aa(sa(v.v)))),f(x,0,v.w,"V");break;default:f(x,1,0,"")}}}f(x,-1,0,"EOD");var _=`\r
`,O=x.join(_);return O}})();return{to_workbook:s,to_sheet:a,from_sheet:i}})(),x5=(function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(v,b){for(var k=v.split(`
`),y=-1,w=-1,N=0,_=[];N!==k.length;++N){var O=k[N].trim().split(":");if(O[0]==="cell"){var E=Ta(O[1]);if(_.length<=E.r)for(y=_.length;y<=E.r;++y)_[y]||(_[y]=[]);switch(y=E.r,w=E.c,O[2]){case"t":_[y][w]=e(O[3]);break;case"v":_[y][w]=+O[3];break;case"vtf":var L=O[O.length-1];case"vtc":switch(O[3]){case"nl":_[y][w]=!!+O[4];break;default:_[y][w]=+O[4];break}O[2]=="vtf"&&(_[y][w]=[_[y][w],L])}}}return b&&b.sheetRows&&(_=_.slice(0,b.sheetRows)),_}function s(v,b){return jl(a(v,b),b)}function i(v,b){return Kn(s(v,b),b)}var u=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function x(v){if(!v||!v["!ref"])return"";for(var b=[],k=[],y,w="",N=Cl(v["!ref"]),_=Array.isArray(v),O=N.s.r;O<=N.e.r;++O)for(var E=N.s.c;E<=N.e.c;++E)if(w=Ze({r:O,c:E}),y=_?(v[O]||[])[E]:v[w],!(!y||y.v==null||y.t==="z")){switch(k=["cell",w,"t"],y.t){case"s":case"str":k.push(n(y.v));break;case"n":y.f?(k[2]="vtf",k[3]="n",k[4]=y.v,k[5]=n(y.f)):(k[2]="v",k[3]=y.v);break;case"b":k[2]="vt"+(y.f?"f":"c"),k[3]="nl",k[4]=y.v?"1":"0",k[5]=n(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var L=Aa(sa(y.v));k[2]="vtc",k[3]="nd",k[4]=""+L,k[5]=y.w||xr(y.z||Qe[14],L);break;case"e":continue}b.push(k.join(":"))}return b.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),b.push("valueformat:1:text-wiki"),b.join(`
`)}function g(v){return[u,f,d,f,x(v),m].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:g}})(),Qi=(function(){function e(g,v,b,k,y){y.raw?v[b][k]=g:g===""||(g==="TRUE"?v[b][k]=!0:g==="FALSE"?v[b][k]=!1:isNaN(Tr(g))?isNaN(Sl(g).getDate())?v[b][k]=g:v[b][k]=sa(g):v[b][k]=Tr(g))}function n(g,v){var b=v||{},k=[];if(!g||g.length===0)return k;for(var y=g.split(/[\r\n]/),w=y.length-1;w>=0&&y[w].length===0;)--w;for(var N=10,_=0,O=0;O<=w;++O)_=y[O].indexOf(" "),_==-1?_=y[O].length:_++,N=Math.max(N,_);for(O=0;O<=w;++O){k[O]=[];var E=0;for(e(y[O].slice(0,N).trim(),k,O,E,b),E=1;E<=(y[O].length-N)/10+1;++E)e(y[O].slice(N+(E-1)*10,N+E*10).trim(),k,O,E,b)}return b.sheetRows&&(k=k.slice(0,b.sheetRows)),k}var a={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(g){for(var v={},b=!1,k=0,y=0;k<g.length;++k)(y=g.charCodeAt(k))==34?b=!b:!b&&y in a&&(v[y]=(v[y]||0)+1);y=[];for(k in v)Object.prototype.hasOwnProperty.call(v,k)&&y.push([v[k],k]);if(!y.length){v=s;for(k in v)Object.prototype.hasOwnProperty.call(v,k)&&y.push([v[k],k])}return y.sort(function(w,N){return w[0]-N[0]||s[w[1]]-s[N[1]]}),a[y.pop()[1]]||44}function u(g,v){var b=v||{},k="",y=b.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(k=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(k=g.charAt(4),g=g.slice(6)):k=i(g.slice(0,1024)):b&&b.FS?k=b.FS:k=i(g.slice(0,1024));var N=0,_=0,O=0,E=0,L=0,G=k.charCodeAt(0),H=!1,R=0,Z=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var Y=b.dateNF!=null?NN(b.dateNF):null;function Q(){var K=g.slice(E,L),ee={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)ee.t="z";else if(b.raw)ee.t="s",ee.v=K;else if(K.trim().length===0)ee.t="s",ee.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(ee.t="s",ee.v=K.slice(2,-1).replace(/""/g,'"')):eA(K)?(ee.t="n",ee.f=K.slice(1)):(ee.t="s",ee.v=K);else if(K=="TRUE")ee.t="b",ee.v=!0;else if(K=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(O=Tr(K)))ee.t="n",b.cellText!==!1&&(ee.w=K),ee.v=O;else if(!isNaN(Sl(K).getDate())||Y&&K.match(Y)){ee.z=b.dateNF||Qe[14];var Ee=0;Y&&K.match(Y)&&(K=TN(K,b.dateNF,K.match(Y)||[]),Ee=1),b.cellDates?(ee.t="d",ee.v=sa(K,Ee)):(ee.t="n",ee.v=Aa(sa(K,Ee))),b.cellText!==!1&&(ee.w=xr(ee.z,ee.v instanceof Date?Aa(ee.v):ee.v)),b.cellNF||delete ee.z}else ee.t="s",ee.v=K;if(ee.t=="z"||(b.dense?(y[N]||(y[N]=[]),y[N][_]=ee):y[Ze({c:_,r:N})]=ee),E=L+1,Z=g.charCodeAt(E),w.e.c<_&&(w.e.c=_),w.e.r<N&&(w.e.r=N),R==G)++_;else if(_=0,++N,b.sheetRows&&b.sheetRows<=N)return!0}e:for(;L<g.length;++L)switch(R=g.charCodeAt(L)){case 34:Z===34&&(H=!H);break;case G:case 10:case 13:if(!H&&Q())break e;break}return L-E>0&&Q(),y["!ref"]=dt(w),y}function f(g,v){return!(v&&v.PRN)||v.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?u(g,v):jl(n(g,v),v)}function d(g,v){var b="",k=v.type=="string"?[0,0,0,0]:vh(g,v);switch(v.type){case"base64":b=qa(g);break;case"binary":b=g;break;case"buffer":v.codepage==65001?b=g.toString("utf8"):v.codepage&&typeof Ki<"u"||(b=ut&&Buffer.isBuffer(g)?g.toString("binary"):Ts(g));break;case"array":b=Ss(g);break;case"string":b=g;break;default:throw new Error("Unrecognized type "+v.type)}return k[0]==239&&k[1]==187&&k[2]==191?b=Nt(b.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?b=Nt(b):v.type=="binary"&&typeof Ki<"u",b.slice(0,19)=="socialcalc:version:"?x5.to_sheet(v.type=="string"?b:Nt(b),v):f(b,v)}function m(g,v){return Kn(d(g,v),v)}function x(g){for(var v=[],b=Bt(g["!ref"]),k,y=Array.isArray(g),w=b.s.r;w<=b.e.r;++w){for(var N=[],_=b.s.c;_<=b.e.c;++_){var O=Ze({r:w,c:_});if(k=y?(g[w]||[])[_]:g[O],!k||k.v==null){N.push("          ");continue}for(var E=(k.w||(fn(k),k.w)||"").slice(0,10);E.length<10;)E+=" ";N.push(E+(_===0?" ":""))}v.push(N.join(""))}return v.join(`
`)}return{to_workbook:m,to_sheet:d,from_sheet:x}})();function m5(e,n){var a=n||{},s=!!a.WTF;a.WTF=!0;try{var i=d5.to_workbook(e,a);return a.WTF=s,i}catch(u){if(a.WTF=s,!u.message.match(/SYLK bad record ID/)&&s)throw u;return Qi.to_workbook(e,n)}}var zi=(function(){function e(A,q,V){if(A){ua(A,A.l||0);for(var T=V.Enum||Ce;A.l<A.length;){var z=A.read_shift(2),ne=T[z]||T[65535],Te=A.read_shift(2),ge=A.l+Te,ke=ne.f&&ne.f(A,Te,V);if(A.l=ge,q(ke,ne,z))return}}}function n(A,q){switch(q.type){case"base64":return a(wr(qa(A)),q);case"binary":return a(wr(A),q);case"buffer":case"array":return a(A,q)}throw"Unsupported type "+q.type}function a(A,q){if(!A)return A;var V=q||{},T=V.dense?[]:{},z="Sheet1",ne="",Te=0,ge={},ke=[],$e=[],X={s:{r:0,c:0},e:{r:0,c:0}},nt=V.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)V.Enum=Ce,e(A,function(xe,Le,De){switch(De){case 0:V.vers=xe,xe>=4096&&(V.qpro=!0);break;case 6:X=xe;break;case 204:xe&&(ne=xe);break;case 222:ne=xe;break;case 15:case 51:V.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:De==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=V.dateNF||Qe[14],V.cellDates&&(xe[1].t="d",xe[1].v=yo(xe[1].v))),V.qpro&&xe[3]>Te&&(T["!ref"]=dt(X),ge[z]=T,ke.push(z),T=V.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Te=xe[3],z=ne||"Sheet"+(Te+1),ne="");var Ye=V.dense?(T[xe[0].r]||[])[xe[0].c]:T[Ze(xe[0])];if(Ye){Ye.t=xe[1].t,Ye.v=xe[1].v,xe[1].z!=null&&(Ye.z=xe[1].z),xe[1].f!=null&&(Ye.f=xe[1].f);break}V.dense?(T[xe[0].r]||(T[xe[0].r]=[]),T[xe[0].r][xe[0].c]=xe[1]):T[Ze(xe[0])]=xe[1];break}},V);else if(A[2]==26||A[2]==14)V.Enum=B,A[2]==14&&(V.qpro=!0,A.l=0),e(A,function(xe,Le,De){switch(De){case 204:z=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>Te&&(T["!ref"]=dt(X),ge[z]=T,ke.push(z),T=V.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Te=xe[3],z="Sheet"+(Te+1)),nt>0&&xe[0].r>=nt)break;V.dense?(T[xe[0].r]||(T[xe[0].r]=[]),T[xe[0].r][xe[0].c]=xe[1]):T[Ze(xe[0])]=xe[1],X.e.c<xe[0].c&&(X.e.c=xe[0].c),X.e.r<xe[0].r&&(X.e.r=xe[0].r);break;case 27:xe[14e3]&&($e[xe[14e3][0]]=xe[14e3][1]);break;case 1537:$e[xe[0]]=xe[1],xe[0]==Te&&(z=xe[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(T["!ref"]=dt(X),ge[ne||z]=T,ke.push(ne||z),!$e.length)return{SheetNames:ke,Sheets:ge};for(var pe={},we=[],be=0;be<$e.length;++be)ge[ke[be]]?(we.push($e[be]||ke[be]),pe[$e[be]]=ge[$e[be]]||ge[ke[be]]):(we.push($e[be]),pe[$e[be]]={"!ref":"A1"});return{SheetNames:we,Sheets:pe}}function s(A,q){var V=q||{};if(+V.codepage>=0&&Sr(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var T=bd(),z=Bt(A["!ref"]),ne=Array.isArray(A),Te=[];kr(T,0,u(1030)),kr(T,6,m(z));for(var ge=Math.min(z.e.r,8191),ke=z.s.r;ke<=ge;++ke)for(var $e=da(ke),X=z.s.c;X<=z.e.c;++X){ke===z.s.r&&(Te[X]=ta(X));var nt=Te[X]+$e,pe=ne?(A[ke]||[])[X]:A[nt];if(!(!pe||pe.t=="z"))if(pe.t=="n")(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?kr(T,13,k(ke,X,pe.v)):kr(T,14,w(ke,X,pe.v));else{var we=fn(pe);kr(T,15,v(ke,X,we.slice(0,239)))}}return kr(T,1),T.end()}function i(A,q){var V=q||{};if(+V.codepage>=0&&Sr(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var T=bd();kr(T,0,f(A));for(var z=0,ne=0;z<A.SheetNames.length;++z)(A.Sheets[A.SheetNames[z]]||{})["!ref"]&&kr(T,27,ae(A.SheetNames[z],ne++));var Te=0;for(z=0;z<A.SheetNames.length;++z){var ge=A.Sheets[A.SheetNames[z]];if(!(!ge||!ge["!ref"])){for(var ke=Bt(ge["!ref"]),$e=Array.isArray(ge),X=[],nt=Math.min(ke.e.r,8191),pe=ke.s.r;pe<=nt;++pe)for(var we=da(pe),be=ke.s.c;be<=ke.e.c;++be){pe===ke.s.r&&(X[be]=ta(be));var xe=X[be]+we,Le=$e?(ge[pe]||[])[be]:ge[xe];if(!(!Le||Le.t=="z"))if(Le.t=="n")kr(T,23,Q(pe,be,Te,Le.v));else{var De=fn(Le);kr(T,22,R(pe,be,Te,De.slice(0,239)))}}++Te}}return kr(T,1),T.end()}function u(A){var q=ea(2);return q.write_shift(2,A),q}function f(A){var q=ea(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var V=0,T=0,z=0,ne=0;ne<A.SheetNames.length;++ne){var Te=A.SheetNames[ne],ge=A.Sheets[Te];if(!(!ge||!ge["!ref"])){++z;var ke=Cl(ge["!ref"]);V<ke.e.r&&(V=ke.e.r),T<ke.e.c&&(T=ke.e.c)}}return V>8191&&(V=8191),q.write_shift(2,V),q.write_shift(1,z),q.write_shift(1,T),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function d(A,q,V){var T={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&V.qpro?(T.s.c=A.read_shift(1),A.l++,T.s.r=A.read_shift(2),T.e.c=A.read_shift(1),A.l++,T.e.r=A.read_shift(2),T):(T.s.c=A.read_shift(2),T.s.r=A.read_shift(2),q==12&&V.qpro&&(A.l+=2),T.e.c=A.read_shift(2),T.e.r=A.read_shift(2),q==12&&V.qpro&&(A.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function m(A){var q=ea(8);return q.write_shift(2,A.s.c),q.write_shift(2,A.s.r),q.write_shift(2,A.e.c),q.write_shift(2,A.e.r),q}function x(A,q,V){var T=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(T[0].c=A.read_shift(1),T[3]=A.read_shift(1),T[0].r=A.read_shift(2),A.l+=2):(T[2]=A.read_shift(1),T[0].c=A.read_shift(2),T[0].r=A.read_shift(2)),T}function g(A,q,V){var T=A.l+q,z=x(A,q,V);if(z[1].t="s",V.vers==20768){A.l++;var ne=A.read_shift(1);return z[1].v=A.read_shift(ne,"utf8"),z}return V.qpro&&A.l++,z[1].v=A.read_shift(T-A.l,"cstr"),z}function v(A,q,V){var T=ea(7+V.length);T.write_shift(1,255),T.write_shift(2,q),T.write_shift(2,A),T.write_shift(1,39);for(var z=0;z<T.length;++z){var ne=V.charCodeAt(z);T.write_shift(1,ne>=128?95:ne)}return T.write_shift(1,0),T}function b(A,q,V){var T=x(A,q,V);return T[1].v=A.read_shift(2,"i"),T}function k(A,q,V){var T=ea(7);return T.write_shift(1,255),T.write_shift(2,q),T.write_shift(2,A),T.write_shift(2,V,"i"),T}function y(A,q,V){var T=x(A,q,V);return T[1].v=A.read_shift(8,"f"),T}function w(A,q,V){var T=ea(13);return T.write_shift(1,255),T.write_shift(2,q),T.write_shift(2,A),T.write_shift(8,V,"f"),T}function N(A,q,V){var T=A.l+q,z=x(A,q,V);if(z[1].v=A.read_shift(8,"f"),V.qpro)A.l=T;else{var ne=A.read_shift(2);L(A.slice(A.l,A.l+ne),z),A.l+=ne}return z}function _(A,q,V){var T=q&32768;return q&=-32769,q=(T?A:0)+(q>=8192?q-16384:q),(T?"":"$")+(V?ta(q):da(q))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(A,q){ua(A,0);for(var V=[],T=0,z="",ne="",Te="",ge="";A.l<A.length;){var ke=A[A.l++];switch(ke){case 0:V.push(A.read_shift(8,"f"));break;case 1:ne=_(q[0].c,A.read_shift(2),!0),z=_(q[0].r,A.read_shift(2),!1),V.push(ne+z);break;case 2:{var $e=_(q[0].c,A.read_shift(2),!0),X=_(q[0].r,A.read_shift(2),!1);ne=_(q[0].c,A.read_shift(2),!0),z=_(q[0].r,A.read_shift(2),!1),V.push($e+X+":"+ne+z)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(A.read_shift(2));break;case 6:{for(var nt="";ke=A[A.l++];)nt+=String.fromCharCode(ke);V.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:ge=V.pop(),Te=V.pop(),V.push(["AND","OR"][ke-20]+"("+Te+","+ge+")");break;default:if(ke<32&&E[ke])ge=V.pop(),Te=V.pop(),V.push(Te+E[ke]+ge);else if(O[ke]){if(T=O[ke][1],T==69&&(T=A[A.l++]),T>V.length){console.error("WK1 bad formula parse 0x"+ke.toString(16)+":|"+V.join("|")+"|");return}var pe=V.slice(-T);V.length-=T,V.push(O[ke][0]+"("+pe.join(",")+")")}else return ke<=7?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=24?console.error("WK1 unsupported op "+ke.toString(16)):ke<=30?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=115?console.error("WK1 unsupported function opcode "+ke.toString(16)):console.error("WK1 unrecognized opcode "+ke.toString(16))}}V.length==1?q[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function G(A){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=A.read_shift(2),q[3]=A[A.l++],q[0].c=A[A.l++],q}function H(A,q){var V=G(A);return V[1].t="s",V[1].v=A.read_shift(q-4,"cstr"),V}function R(A,q,V,T){var z=ea(6+T.length);z.write_shift(2,A),z.write_shift(1,V),z.write_shift(1,q),z.write_shift(1,39);for(var ne=0;ne<T.length;++ne){var Te=T.charCodeAt(ne);z.write_shift(1,Te>=128?95:Te)}return z.write_shift(1,0),z}function Z(A,q){var V=G(A);V[1].v=A.read_shift(2);var T=V[1].v>>1;if(V[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return V[1].v=T,V}function Y(A,q){var V=G(A),T=A.read_shift(4),z=A.read_shift(4),ne=A.read_shift(2);if(ne==65535)return T===0&&z===3221225472?(V[1].t="e",V[1].v=15):T===0&&z===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var Te=ne&32768;return ne=(ne&32767)-16446,V[1].v=(1-Te*2)*(z*Math.pow(2,ne+32)+T*Math.pow(2,ne)),V}function Q(A,q,V,T){var z=ea(14);if(z.write_shift(2,A),z.write_shift(1,V),z.write_shift(1,q),T==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var ne=0,Te=0,ge=0,ke=0;return T<0&&(ne=1,T=-T),Te=Math.log2(T)|0,T/=Math.pow(2,Te-31),ke=T>>>0,(ke&2147483648)==0&&(T/=2,++Te,ke=T>>>0),T-=ke,ke|=2147483648,ke>>>=0,T*=Math.pow(2,32),ge=T>>>0,z.write_shift(4,ge),z.write_shift(4,ke),Te+=16383+(ne?32768:0),z.write_shift(2,Te),z}function K(A,q){var V=Y(A);return A.l+=q-14,V}function ee(A,q){var V=G(A),T=A.read_shift(4);return V[1].v=T>>6,V}function Ee(A,q){var V=G(A),T=A.read_shift(8,"f");return V[1].v=T,V}function Ne(A,q){var V=Ee(A);return A.l+=q-10,V}function me(A,q){return A[A.l+q-1]==0?A.read_shift(q,"cstr"):""}function J(A,q){var V=A[A.l++];V>q-1&&(V=q-1);for(var T="";T.length<V;)T+=String.fromCharCode(A[A.l++]);return T}function se(A,q,V){if(!(!V.qpro||q<21)){var T=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var z=A.read_shift(q-21,"cstr");return[T,z]}}function Ae(A,q){for(var V={},T=A.l+q;A.l<T;){var z=A.read_shift(2);if(z==14e3){for(V[z]=[0,""],V[z][0]=A.read_shift(2);A[A.l];)V[z][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return V}function ae(A,q){var V=ea(5+A.length);V.write_shift(2,14e3),V.write_shift(2,q);for(var T=0;T<A.length;++T){var z=A.charCodeAt(T);V[V.l++]=z>127?95:z}return V[V.l++]=0,V}var Ce={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:b},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},B={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:Y},24:{n:"NUMBER18",f:Z},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:Ee},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:n}})();function p5(e){var n={},a=e.match(ka),s=0,i=!1;if(a)for(;s!=a.length;++s){var u=Ke(a[s]);switch(u[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!u.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(u.val=="1")break;n.cp=qd[parseInt(u.val,10)];break;case"<outline":if(!u.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=u.val;break;case"<sz":n.sz=u.val;break;case"<strike":if(!u.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!u.val)break;switch(u.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(u.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(u.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":u.rgb&&(n.color=u.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=u.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=u.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(u[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+u[0])}}return n}var g5=(function(){var e=Zi("t"),n=Zi("rPr");function a(u){var f=u.match(e);if(!f)return{t:"s",v:""};var d={t:"s",v:ht(f[1])},m=u.match(n);return m&&(d.s=p5(m[1])),d}var s=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(f){return f.replace(s,"").split(i).map(a).filter(function(d){return d.v})}})(),v5=(function(){var n=/(\r\n|\n)/g;function a(i,u,f){var d=[];i.u&&d.push("text-decoration: underline;"),i.uval&&d.push("text-underline-style:"+i.uval+";"),i.sz&&d.push("font-size:"+i.sz+"pt;"),i.outline&&d.push("text-effect: outline;"),i.shadow&&d.push("text-shadow: auto;"),u.push('<span style="'+d.join("")+'">'),i.b&&(u.push("<b>"),f.push("</b>")),i.i&&(u.push("<i>"),f.push("</i>")),i.strike&&(u.push("<s>"),f.push("</s>"));var m=i.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(u.push("<"+m+">"),f.push("</"+m+">")),f.push("</span>"),i}function s(i){var u=[[],i.v,[]];return i.v?(i.s&&a(i.s,u[0],u[2]),u[0].join("")+u[1].replace(n,"<br/>")+u[2].join("")):""}return function(u){return u.map(s).join("")}})(),b5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,y5=/<(?:\w+:)?r>/,k5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fh(e,n){var a=n?n.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=ht(Nt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Nt(e),a&&(s.h=th(s.t))):e.match(y5)&&(s.r=Nt(e),s.t=ht(Nt((e.replace(k5,"").match(b5)||[]).join("").replace(ka,""))),a&&(s.h=v5(g5(s.r)))),s):{t:""}}var w5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,S5=/<(?:\w+:)?(?:si|sstItem)>/g,E5=/<\/(?:\w+:)?(?:si|sstItem)>/;function N5(e,n){var a=[],s="";if(!e)return a;var i=e.match(w5);if(i){s=i[2].replace(S5,"").split(E5);for(var u=0;u!=s.length;++u){var f=fh(s[u].trim(),n);f!=null&&(a[a.length]=f)}i=Ke(i[1]),a.Count=i.count,a.Unique=i.uniqueCount}return a}function T5(e){return[e.read_shift(4),e.read_shift(4)]}function _5(e,n){var a=[],s=!1;return hn(e,function(u,f,d){switch(d){case 159:a.Count=u[0],a.Unique=u[1];break;case 19:a.push(u);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(f.T,!s||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function A2(e){for(var n=[],a=e.split(""),s=0;s<a.length;++s)n[s]=a[s].charCodeAt(0);return n}function on(e,n){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),a}function A5(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=on(e,4),n.U=on(e,4),n.W=on(e,4),n}function C5(e){for(var n=e.read_shift(4),a=e.l+n-4,s={},i=e.read_shift(4),u=[];i-- >0;)u.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=u,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return s}function j5(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(C5(e));return n}function O5(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function R5(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=on(e,4),n.U=on(e,4),n.W=on(e,4),n}function D5(e){var n=R5(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function C2(e,n){var a=e.l+n,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var i=!1;switch(s.AlgID){case 26126:case 26127:case 26128:i=s.Flags==36;break;case 26625:i=s.Flags==4;break;case 0:i=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,s}function j2(e,n){var a={},s=e.l+n;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,s),e.l=s,a}function F5(e){var n=on(e);switch(n.Minor){case 2:return[n.Minor,M5(e)];case 3:return[n.Minor,L5()];case 4:return[n.Minor,I5(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function M5(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),s=C2(e,a),i=j2(e,e.length-e.l);return{t:"Std",h:s,v:i}}function L5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function I5(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),s={};return a.replace(ka,function(u){var f=Ke(u);switch(Br(f[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(d){s[d]=f[d]});break;case"<dataIntegrity":s.encryptedHmacKey=f.encryptedHmacKey,s.encryptedHmacValue=f.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=f.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(f);break;default:throw f[0]}}),s}function B5(e,n){var a={},s=a.EncryptionVersionInfo=on(e,4);if(n-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);a.Flags=e.read_shift(4),n-=4;var i=e.read_shift(4);return n-=4,a.EncryptionHeader=C2(e,i),n-=i,a.EncryptionVerifier=j2(e,n),a}function z5(e){var n={},a=n.EncryptionVersionInfo=on(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function U5(e){var n=0,a,s=A2(e),i=s.length+1,u,f,d,m,x;for(a=Xn(i),a[0]=s.length,u=1;u!=i;++u)a[u]=s[u-1];for(u=i-1;u>=0;--u)f=a[u],d=(n&16384)===0?0:1,m=n<<1&32767,x=d|m,n=x^f;return n^52811}var O2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(f){return(f/2|f*128)&255},i=function(f,d){return s(f^d)},u=function(f){for(var d=n[f.length-1],m=104,x=f.length-1;x>=0;--x)for(var g=f[x],v=0;v!=7;++v)g&64&&(d^=a[m]),g*=2,--m;return d};return function(f){for(var d=A2(f),m=u(d),x=d.length,g=Xn(16),v=0;v!=16;++v)g[v]=0;var b,k,y;for((x&1)===1&&(b=m>>8,g[x]=i(e[0],b),--x,b=m&255,k=d[d.length-1],g[x]=i(k,b));x>0;)--x,b=m>>8,g[x]=i(d[x],b),--x,b=m&255,g[x]=i(d[x],b);for(x=15,y=15-d.length;y>0;)b=m>>8,g[x]=i(e[y],b),--x,--y,b=m&255,g[x]=i(d[x],b),--x,--y;return g}})(),P5=function(e,n,a,s,i){i||(i=n),s||(s=O2(e));var u,f;for(u=0;u!=n.length;++u)f=n[u],f^=s[a],f=(f>>5|f<<3)&255,i[u]=f,++a;return[i,a,s]},H5=function(e){var n=0,a=O2(e);return function(s){var i=P5("",s,n,a);return n=i[1],i[0]}};function V5(e,n,a,s){var i={key:Zt(e),verificationBytes:Zt(e)};return a.password&&(i.verifier=U5(a.password)),s.valid=i.verificationBytes===i.verifier,s.valid&&(s.insitu=H5(a.password)),i}function G5(e,n,a){var s=a||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=z5(e):s.Data=B5(e,n),s}function $5(e,n,a){var s={Type:a.biff>=8?e.read_shift(2):0};return s.Type?G5(e,n-2,s):V5(e,a.biff>=8?n:n-2,a,s),s}var X5=(function(){function e(i,u){switch(u.type){case"base64":return n(qa(i),u);case"binary":return n(i,u);case"buffer":return n(ut&&Buffer.isBuffer(i)?i.toString("binary"):Ts(i),u);case"array":return n(Ss(i),u)}throw new Error("Unrecognized type "+u.type)}function n(i,u){var f=u||{},d=f.dense?[]:{},m=i.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(g,v){Array.isArray(d)&&(d[v]=[]);for(var b=/\\\w+\b/g,k=0,y,w=-1;y=b.exec(g);){switch(y[0]){case"\\cell":var N=g.slice(k,b.lastIndex-y[0].length);if(N[0]==" "&&(N=N.slice(1)),++w,N.length){var _={v:N,t:"s"};Array.isArray(d)?d[v][w]=_:d[Ze({r:v,c:w})]=_}break}k=b.lastIndex}w>x.e.c&&(x.e.c=w)}),d["!ref"]=dt(x),d}function a(i,u){return Kn(e(i,u),u)}function s(i){for(var u=["{\\rtf1\\ansi"],f=Bt(i["!ref"]),d,m=Array.isArray(i),x=f.s.r;x<=f.e.r;++x){u.push("\\trowd\\trautofit1");for(var g=f.s.c;g<=f.e.c;++g)u.push("\\cellx"+(g+1));for(u.push("\\pard\\intbl"),g=f.s.c;g<=f.e.c;++g){var v=Ze({r:x,c:g});d=m?(i[x]||[])[g]:i[v],!(!d||d.v==null&&(!d.f||d.F))&&(u.push(" "+(d.w||(fn(d),d.w))),u.push("\\cell"))}u.push("\\pard\\intbl\\row")}return u.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:s}})();function Y5(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function ec(e){for(var n=0,a=1;n!=3;++n)a=a*256+(e[n]>255?255:e[n]<0?0:e[n]);return a.toString(16).toUpperCase().slice(1)}function q5(e){var n=e[0]/255,a=e[1]/255,s=e[2]/255,i=Math.max(n,a,s),u=Math.min(n,a,s),f=i-u;if(f===0)return[0,0,n];var d=0,m=0,x=i+u;switch(m=f/(x>1?2-x:x),i){case n:d=((a-s)/f+6)%6;break;case a:d=(s-n)/f+2;break;case s:d=(n-a)/f+4;break}return[d/6,m,x/2]}function K5(e){var n=e[0],a=e[1],s=e[2],i=a*2*(s<.5?s:1-s),u=s-i/2,f=[u,u,u],d=6*n,m;if(a!==0)switch(d|0){case 0:case 6:m=i*d,f[0]+=i,f[1]+=m;break;case 1:m=i*(2-d),f[0]+=m,f[1]+=i;break;case 2:m=i*(d-2),f[1]+=i,f[2]+=m;break;case 3:m=i*(4-d),f[1]+=m,f[2]+=i;break;case 4:m=i*(d-4),f[2]+=i,f[0]+=m;break;case 5:m=i*(6-d),f[2]+=m,f[0]+=i;break}for(var x=0;x!=3;++x)f[x]=Math.round(f[x]*255);return f}function fo(e,n){if(n===0)return e;var a=q5(Y5(e));return n<0?a[2]=a[2]*(1+n):a[2]=1-(1-a[2])*(1-n),ec(K5(a))}var R2=6,W5=15,Z5=1,Na=R2;function ho(e){return Math.floor((e+Math.round(128/Na)/256)*Na)}function xo(e){return Math.floor((e-5)/Na*100+.5)/100}function Sd(e){return Math.round((e*Na+5)/Na*256)/256}function ed(e){return Sd(xo(ho(e)))}function dh(e){var n=Math.abs(e-ed(e)),a=Na;if(n>.005)for(Na=Z5;Na<W5;++Na)Math.abs(e-ed(e))<=n&&(n=Math.abs(e-ed(e)),a=Na);Na=a}function El(e){e.width?(e.wpx=ho(e.width),e.wch=xo(e.wpx),e.MDW=Na):e.wpx?(e.wch=xo(e.wpx),e.width=Sd(e.wch),e.MDW=Na):typeof e.wch=="number"&&(e.width=Sd(e.wch),e.wpx=ho(e.width),e.MDW=Na),e.customWidth&&delete e.customWidth}var J5=96,D2=J5;function F2(e){return e*96/D2}function tc(e){return e*D2/96}var Q5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function e_(e,n,a,s){n.Borders=[];var i={},u=!1;(e[0].match(ka)||[]).forEach(function(f){var d=Ke(f);switch(Br(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},d.diagonalUp&&(i.diagonalUp=Ot(d.diagonalUp)),d.diagonalDown&&(i.diagonalDown=Ot(d.diagonalDown)),n.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(s&&s.WTF&&!u)throw new Error("unrecognized "+d[0]+" in borders")}})}function t_(e,n,a,s){n.Fills=[];var i={},u=!1;(e[0].match(ka)||[]).forEach(function(f){var d=Ke(f);switch(Br(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},n.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":d.patternType&&(i.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),d.indexed&&(i.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(i.bgColor.theme=parseInt(d.theme,10)),d.tint&&(i.bgColor.tint=parseFloat(d.tint)),d.rgb&&(i.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),d.theme&&(i.fgColor.theme=parseInt(d.theme,10)),d.tint&&(i.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(i.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(s&&s.WTF&&!u)throw new Error("unrecognized "+d[0]+" in fills")}})}function a_(e,n,a,s){n.Fonts=[];var i={},u=!1;(e[0].match(ka)||[]).forEach(function(f){var d=Ke(f);switch(Br(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(i),i={};break;case"<name":d.val&&(i.name=Nt(d.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=d.val?Ot(d.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=d.val?Ot(d.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(d.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=d.val?Ot(d.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=d.val?Ot(d.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=d.val?Ot(d.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=d.val?Ot(d.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=d.val?Ot(d.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":d.val&&(i.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(i.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(i.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(i.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=qd[parseInt(d.val,10)];break;case"<color":if(i.color||(i.color={}),d.auto&&(i.color.auto=Ot(d.auto)),d.rgb)i.color.rgb=d.rgb.slice(-6);else if(d.indexed){i.color.index=parseInt(d.indexed,10);var m=ks[i.color.index];i.color.index==81&&(m=ks[1]),m||(m=ks[1]),i.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else d.theme&&(i.color.theme=parseInt(d.theme,10),d.tint&&(i.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(i.color.rgb=fo(a.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":u=!0;break;case"</AlternateContent>":u=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(s&&s.WTF&&!u)throw new Error("unrecognized "+d[0]+" in fonts")}})}function r_(e,n,a){n.NumberFmt=[];for(var s=Lr(Qe),i=0;i<s.length;++i)n.NumberFmt[s[i]]=Qe[s[i]];var u=e[0].match(ka);if(u)for(i=0;i<u.length;++i){var f=Ke(u[i]);switch(Br(f[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=ht(Nt(f.formatCode)),m=parseInt(f.numFmtId,10);if(n.NumberFmt[m]=d,m>0){if(m>392){for(m=392;m>60&&n.NumberFmt[m]!=null;--m);n.NumberFmt[m]=d}ys(d,m)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+f[0]+" in numFmts")}}}var P0=["numFmtId","fillId","fontId","borderId","xfId"],H0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function n_(e,n,a){n.CellXf=[];var s,i=!1;(e[0].match(ka)||[]).forEach(function(u){var f=Ke(u),d=0;switch(Br(f[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=f,delete s[0],d=0;d<P0.length;++d)s[P0[d]]&&(s[P0[d]]=parseInt(s[P0[d]],10));for(d=0;d<H0.length;++d)s[H0[d]]&&(s[H0[d]]=Ot(s[H0[d]]));if(n.NumberFmt&&s.numFmtId>392){for(d=392;d>60;--d)if(n.NumberFmt[s.numFmtId]==n.NumberFmt[d]){s.numFmtId=d;break}}n.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};f.vertical&&(m.vertical=f.vertical),f.horizontal&&(m.horizontal=f.horizontal),f.textRotation!=null&&(m.textRotation=f.textRotation),f.indent&&(m.indent=f.indent),f.wrapText&&(m.wrapText=Ot(f.wrapText)),s.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+f[0]+" in cellXfs")}})}var s_=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,u=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,m,x){var g={};if(!d)return g;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=d.match(n))&&r_(v,g,x),(v=d.match(i))&&a_(v,g,m,x),(v=d.match(s))&&t_(v,g,m,x),(v=d.match(u))&&e_(v,g,m,x),(v=d.match(a))&&n_(v,g,x),g}})();function l_(e,n){var a=e.read_shift(2),s=ba(e);return[a,s]}function i_(e,n,a){var s={};s.sz=e.read_shift(2)/20;var i=g3(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var u=e.read_shift(2);switch(u===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var f=e.read_shift(1);f!=0&&(s.underline=f);var d=e.read_shift(1);d>0&&(s.family=d);var m=e.read_shift(1);switch(m>0&&(s.charset=m),e.l++,s.color=p3(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=ba(e),s}var c_=ya;function o_(e,n){var a=e.l+n,s=e.read_shift(2),i=e.read_shift(2);return e.l=a,{ixfe:s,numFmtId:i}}var u_=ya;function f_(e,n,a){var s={};s.NumberFmt=[];for(var i in Qe)s.NumberFmt[i]=Qe[i];s.CellXf=[],s.Fonts=[];var u=[],f=!1;return hn(e,function(m,x,g){switch(g){case 44:s.NumberFmt[m[0]]=m[1],ys(m[1],m[0]);break;case 43:s.Fonts.push(m),m.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(m.color.rgb=fo(n.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:u[u.length-1]==617&&s.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:u.push(g),f=!0;break;case 38:u.pop(),f=!1;break;default:if(x.T>0)u.push(g);else if(x.T<0)u.pop();else if(!f||a.WTF&&u[u.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),s}var d_=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function h_(e,n,a){n.themeElements.clrScheme=[];var s={};(e[0].match(ka)||[]).forEach(function(i){var u=Ke(i);switch(u[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=u.val;break;case"<a:sysClr":s.rgb=u.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":u[0].charAt(1)==="/"?(n.themeElements.clrScheme[d_.indexOf(u[0])]=s,s={}):s.name=u[0].slice(3,u[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+u[0]+" in clrScheme")}})}function x_(){}function m_(){}var p_=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,g_=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,v_=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function b_(e,n,a){n.themeElements={};var s;[["clrScheme",p_,h_],["fontScheme",g_,x_],["fmtScheme",v_,m_]].forEach(function(i){if(!(s=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](s,n,a)})}var y_=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function M2(e,n){(!e||e.length===0)&&(e=k_());var a,s={};if(!(a=e.match(y_)))throw new Error("themeElements not found in theme");return b_(a[0],s,n),s.raw=e,s}function k_(e,n){var a=[Xv];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function w_(e,n,a){var s=e.l+n,i=e.read_shift(4);if(i!==124226){if(!a.cellStyles){e.l=s;return}var u=e.slice(e.l);e.l=s;var f;try{f=$v(u,{type:"array"})}catch{return}var d=Ya(f,"theme/theme/theme1.xml",!0);if(d)return M2(d,a)}}function S_(e){return e.read_shift(4)}function E_(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=N_(e,4);break;case 2:n.xclrValue=k2(e);break;case 3:n.xclrValue=S_(e);break;case 4:e.l+=4;break}return e.l+=8,n}function N_(e,n){return ya(e,n)}function T_(e,n){return ya(e,n)}function __(e){var n=e.read_shift(2),a=e.read_shift(2)-4,s=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=E_(e);break;case 6:s[1]=T_(e,a);break;case 14:case 15:s[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+a)}return s}function A_(e,n){var a=e.l+n;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),u=[];i-- >0;)u.push(__(e,a-e.l));return{ixfe:s,ext:u}}function C_(e,n){n.forEach(function(a){a[0]})}function j_(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:ba(e)}}function O_(e){for(var n=[],a=e.read_shift(4);a-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function R_(e){return e.l+=4,e.read_shift(4)!=0}function D_(e,n,a){var s={Types:[],Cell:[],Value:[]},i=a||{},u=[],f=!1,d=2;return hn(e,function(m,x,g){switch(g){case 335:s.Types.push({name:m.name});break;case 51:m.forEach(function(v){d==1?s.Cell.push({type:s.Types[v[0]-1].name,index:v[1]}):d==0&&s.Value.push({type:s.Types[v[0]-1].name,index:v[1]})});break;case 337:d=m?1:0;break;case 338:d=2;break;case 35:u.push(g),f=!0;break;case 36:u.pop(),f=!1;break;default:if(!x.T){if(!f||i.WTF&&u[u.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),s}function F_(e,n,a){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var i=!1,u=2,f;return e.replace(ka,function(d){var m=Ke(d);switch(Br(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<s.Types.length;++x)s.Types[x].name==m.name&&(f=s.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":u==1?s.Cell.push({type:s.Types[m.t-1].name,index:+m.v}):u==0&&s.Value.push({type:s.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":u=1;break;case"</cellMetadata>":u=2;break;case"<valueMetadata":u=0;break;case"</valueMetadata>":u=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!f)break;f.offsets||(f.offsets=[]),f.offsets.push(+m.i);break;default:if(!i&&a.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return d}),s}function M_(e){var n=[];if(!e)return n;var a=1;return(e.match(ka)||[]).forEach(function(s){var i=Ke(s);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?a=i.i:i.i=a,n.push(i);break}}),n}function L_(e){var n={};n.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),n.r=Ze(a);var s=e.read_shift(1);return s&2&&(n.l="1"),s&8&&(n.a="1"),n}function I_(e,n,a){var s=[];return hn(e,function(u,f,d){switch(d){case 63:s.push(u);break;default:if(!f.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function B_(e,n,a,s){if(!e)return e;var i=s||{},u=!1;hn(e,function(d,m,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:u=!0;break;case 36:u=!1;break;default:if(!m.T){if(!u||i.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},i)}function z_(e,n){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][a].Target}function yg(e,n,a,s){var i=Array.isArray(e),u;n.forEach(function(f){var d=Ta(f.ref);if(i?(e[d.r]||(e[d.r]=[]),u=e[d.r][d.c]):u=e[f.ref],!u){u={t:"z"},i?e[d.r][d.c]=u:e[f.ref]=u;var m=Bt(e["!ref"]||"BDWGO1000001:A1");m.s.r>d.r&&(m.s.r=d.r),m.e.r<d.r&&(m.e.r=d.r),m.s.c>d.c&&(m.s.c=d.c),m.e.c<d.c&&(m.e.c=d.c);var x=dt(m);x!==e["!ref"]&&(e["!ref"]=x)}u.c||(u.c=[]);var g={a:f.author,t:f.t,r:f.r,T:a};f.h&&(g.h=f.h);for(var v=u.c.length-1;v>=0;--v){if(!a&&u.c[v].T)return;a&&!u.c[v].T&&u.c.splice(v,1)}if(a&&s){for(v=0;v<s.length;++v)if(g.a==s[v].id){g.a=s[v].name||g.a;break}}u.c.push(g)})}function U_(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],s=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(f){if(!(f===""||f.trim()==="")){var d=f.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var u=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return u&&u[1]&&u[1].split(/<\/\w*:?comment>/).forEach(function(f){if(!(f===""||f.trim()==="")){var d=f.match(/<(?:\w+:)?comment[^>]*>/);if(d){var m=Ke(d[0]),x={author:m.authorId&&a[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},g=Ta(m.ref);if(!(n.sheetRows&&n.sheetRows<=g.r)){var v=f.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),b=!!v&&!!v[1]&&fh(v[1])||{r:"",t:"",h:""};x.r=b.r,b.r=="<t></t>"&&(b.t=b.h=""),x.t=(b.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(x.h=b.h),s.push(x)}}}}),s}function P_(e,n){var a=[],s=!1,i={},u=0;return e.replace(ka,function(d,m){var x=Ke(d);switch(Br(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":i.t!=null&&a.push(i);break;case"<text>":case"<text":u=m+d.length;break;case"</text>":i.t=e.slice(u,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return d}),a}function H_(e,n){var a=[],s=!1;return e.replace(ka,function(u){var f=Ke(u);switch(Br(f[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:f.displayname,id:f.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return u}),a}function V_(e){var n={};n.iauthor=e.read_shift(4);var a=As(e);return n.rfx=a.s,n.ref=Ze(a.s),e.l+=16,n}var G_=ba;function $_(e,n){var a=[],s=[],i={},u=!1;return hn(e,function(d,m,x){switch(x){case 632:s.push(d);break;case 635:i=d;break;case 637:i.t=d.t,i.h=d.h,i.r=d.r;break;case 636:if(i.author=s[i.iauthor],delete i.iauthor,n.sheetRows&&i.rfx&&n.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,a.push(i);break;case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!u||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),a}var X_="application/vnd.ms-office.vbaProject";function Y_(e){var n=ft.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,s){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var i=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ft.utils.cfb_add(n,i,e.FileIndex[s].content)}}),ft.write(n)}function q_(){return{"!type":"dialog"}}function K_(){return{"!type":"dialog"}}function W_(){return{"!type":"macro"}}function Z_(){return{"!type":"macro"}}var yl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(s,i,u,f){var d=!1,m=!1;u.length==0?m=!0:u.charAt(0)=="["&&(m=!0,u=u.slice(1,-1)),f.length==0?d=!0:f.charAt(0)=="["&&(d=!0,f=f.slice(1,-1));var x=u.length>0?parseInt(u,10)|0:0,g=f.length>0?parseInt(f,10)|0:0;return d?g+=n.c:--g,m?x+=n.r:--x,i+(d?"":"$")+ta(g)+(m?"":"$")+da(x)}return function(i,u){return n=u,i.replace(e,a)}})(),L2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,J_=(function(){return function(n,a){return n.replace(L2,function(s,i,u,f,d,m){var x=sh(f)-(u?0:a.c),g=nh(m)-(d?0:a.r),v=g==0?"":d?g+1:"["+g+"]",b=x==0?"":u?x+1:"["+x+"]";return i+"R"+v+"C"+b})}})();function I2(e,n){return e.replace(L2,function(a,s,i,u,f,d){return s+(i=="$"?i+u:ta(sh(u)+n.c))+(f=="$"?f+d:da(nh(d)+n.r))})}function Q_(e,n,a){var s=Cl(n),i=s.s,u=Ta(a),f={r:u.r-i.r,c:u.c-i.c};return I2(e,f)}function eA(e){return e.length!=1}function kg(e){return e.replace(/_xlfn\./g,"")}function Kt(e){e.l+=1}function Yn(e,n){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function B2(e,n,a){var s=2;if(a){if(a.biff>=2&&a.biff<=5)return z2(e);a.biff==12&&(s=4)}var i=e.read_shift(s),u=e.read_shift(s),f=Yn(e),d=Yn(e);return{s:{r:i,c:f[0],cRel:f[1],rRel:f[2]},e:{r:u,c:d[0],cRel:d[1],rRel:d[2]}}}function z2(e){var n=Yn(e),a=Yn(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:n[0],c:s,cRel:n[1],rRel:n[2]},e:{r:a[0],c:i,cRel:a[1],rRel:a[2]}}}function tA(e,n,a){if(a.biff<8)return z2(e);var s=e.read_shift(a.biff==12?4:2),i=e.read_shift(a.biff==12?4:2),u=Yn(e),f=Yn(e);return{s:{r:s,c:u[0],cRel:u[1],rRel:u[2]},e:{r:i,c:f[0],cRel:f[1],rRel:f[2]}}}function U2(e,n,a){if(a&&a.biff>=2&&a.biff<=5)return aA(e);var s=e.read_shift(a&&a.biff==12?4:2),i=Yn(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function aA(e){var n=Yn(e),a=e.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function rA(e){var n=e.read_shift(2),a=e.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function nA(e,n,a){var s=a&&a.biff?a.biff:8;if(s>=2&&s<=5)return sA(e);var i=e.read_shift(s>=12?4:2),u=e.read_shift(2),f=(u&16384)>>14,d=(u&32768)>>15;if(u&=16383,d==1)for(;i>524287;)i-=1048576;if(f==1)for(;u>8191;)u=u-16384;return{r:i,c:u,cRel:f,rRel:d}}function sA(e){var n=e.read_shift(2),a=e.read_shift(1),s=(n&32768)>>15,i=(n&16384)>>14;return n&=16383,s==1&&n>=8192&&(n=n-16384),i==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:i,rRel:s}}function lA(e,n,a){var s=(e[e.l++]&96)>>5,i=B2(e,a.biff>=2&&a.biff<=5?6:8,a);return[s,i]}function iA(e,n,a){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),u=8;if(a)switch(a.biff){case 5:e.l+=12,u=6;break;case 12:u=12;break}var f=B2(e,u,a);return[s,i,f]}function cA(e,n,a){var s=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[s]}function oA(e,n,a){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),u=8;if(a)switch(a.biff){case 5:e.l+=12,u=6;break;case 12:u=12;break}return e.l+=u,[s,i]}function uA(e,n,a){var s=(e[e.l++]&96)>>5,i=tA(e,n-1,a);return[s,i]}function fA(e,n,a){var s=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[s]}function wg(e){var n=e[e.l+1]&1,a=1;return e.l+=4,[n,a]}function dA(e,n,a){e.l+=2;for(var s=e.read_shift(a&&a.biff==2?1:2),i=[],u=0;u<=s;++u)i.push(e.read_shift(a&&a.biff==2?1:2));return i}function hA(e,n,a){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(a&&a.biff==2?1:2)]}function xA(e,n,a){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(a&&a.biff==2?1:2)]}function mA(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function pA(e,n,a){var s=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[s]}function P2(e){var n=e.read_shift(1),a=e.read_shift(1);return[n,a]}function gA(e){return e.read_shift(2),P2(e)}function vA(e){return e.read_shift(2),P2(e)}function bA(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=U2(e,0,a);return[s,i]}function yA(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=nA(e,0,a);return[s,i]}function kA(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var u=U2(e,0,a);return[s,i,u]}function wA(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(a&&a.biff<=3?1:2);return[S6[i],G2[i],s]}function SA(e,n,a){var s=e[e.l++],i=e.read_shift(1),u=a&&a.biff<=3?[s==88?-1:0,e.read_shift(1)]:EA(e);return[i,(u[0]===0?G2:w6)[u[1]]]}function EA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function NA(e,n,a){e.l+=a&&a.biff==2?3:4}function TA(e,n,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(a&&a.biff==2?1:2);return[s,i]}function _A(e){return e.l++,Cs[e.read_shift(1)]}function AA(e){return e.l++,e.read_shift(2)}function CA(e){return e.l++,e.read_shift(1)!==0}function jA(e){return e.l++,ga(e)}function OA(e,n,a){return e.l++,oc(e,n-1,a)}function RA(e,n){var a=[e.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=Vt(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:a[1]=Cs[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=ga(e);break;case 2:a[1]=js(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function DA(e,n,a){for(var s=e.read_shift(a.biff==12?4:2),i=[],u=0;u!=s;++u)i.push((a.biff==12?As:ko)(e));return i}function FA(e,n,a){var s=0,i=0;a.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--s,--i==0&&(i=256));for(var u=0,f=[];u!=s&&(f[u]=[]);++u)for(var d=0;d!=i;++d)f[u][d]=RA(e,a.biff);return f}function MA(e,n,a){var s=e.read_shift(1)>>>5&3,i=!a||a.biff>=8?4:2,u=e.read_shift(i);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,u]}function LA(e,n,a){if(a.biff==5)return IA(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),u=e.read_shift(4);return[s,i,u]}function IA(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[n,a,s]}function BA(e,n,a){var s=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var i=e.read_shift(a&&a.biff==2?1:2);return[s,i]}function zA(e,n,a){var s=e.read_shift(1)>>>5&3,i=e.read_shift(a&&a.biff==2?1:2);return[s,i]}function UA(e,n,a){var s=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[s]}function PA(e,n,a){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),u=4;if(a)switch(a.biff){case 5:u=15;break;case 12:u=6;break}return e.l+=u,[s,i]}var HA=ya,VA=ya,GA=ya;function fc(e,n,a){return e.l+=2,[rA(e)]}function hh(e){return e.l+=6,[]}var $A=fc,XA=hh,YA=hh,qA=fc;function H2(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var KA=fc,WA=H2,ZA=hh,JA=fc,QA=fc,e6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function t6(e){e.l+=2;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),u=e.read_shift(2),f=e6[a>>2&31];return{ixti:n,coltype:a&3,rt:f,idx:s,c:i,C:u}}function a6(e){return e.l+=2,[e.read_shift(4)]}function r6(e,n,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function n6(e,n,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function s6(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function l6(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function i6(e){return e.l+=4,[0,0]}var Sg={1:{n:"PtgExp",f:TA},2:{n:"PtgTbl",f:GA},3:{n:"PtgAdd",f:Kt},4:{n:"PtgSub",f:Kt},5:{n:"PtgMul",f:Kt},6:{n:"PtgDiv",f:Kt},7:{n:"PtgPower",f:Kt},8:{n:"PtgConcat",f:Kt},9:{n:"PtgLt",f:Kt},10:{n:"PtgLe",f:Kt},11:{n:"PtgEq",f:Kt},12:{n:"PtgGe",f:Kt},13:{n:"PtgGt",f:Kt},14:{n:"PtgNe",f:Kt},15:{n:"PtgIsect",f:Kt},16:{n:"PtgUnion",f:Kt},17:{n:"PtgRange",f:Kt},18:{n:"PtgUplus",f:Kt},19:{n:"PtgUminus",f:Kt},20:{n:"PtgPercent",f:Kt},21:{n:"PtgParen",f:Kt},22:{n:"PtgMissArg",f:Kt},23:{n:"PtgStr",f:OA},26:{n:"PtgSheet",f:r6},27:{n:"PtgEndSheet",f:n6},28:{n:"PtgErr",f:_A},29:{n:"PtgBool",f:CA},30:{n:"PtgInt",f:AA},31:{n:"PtgNum",f:jA},32:{n:"PtgArray",f:fA},33:{n:"PtgFunc",f:wA},34:{n:"PtgFuncVar",f:SA},35:{n:"PtgName",f:MA},36:{n:"PtgRef",f:bA},37:{n:"PtgArea",f:lA},38:{n:"PtgMemArea",f:BA},39:{n:"PtgMemErr",f:HA},40:{n:"PtgMemNoMem",f:VA},41:{n:"PtgMemFunc",f:zA},42:{n:"PtgRefErr",f:UA},43:{n:"PtgAreaErr",f:cA},44:{n:"PtgRefN",f:yA},45:{n:"PtgAreaN",f:uA},46:{n:"PtgMemAreaN",f:s6},47:{n:"PtgMemNoMemN",f:l6},57:{n:"PtgNameX",f:LA},58:{n:"PtgRef3d",f:kA},59:{n:"PtgArea3d",f:iA},60:{n:"PtgRefErr3d",f:PA},61:{n:"PtgAreaErr3d",f:oA},255:{}},c6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},o6={1:{n:"PtgElfLel",f:H2},2:{n:"PtgElfRw",f:JA},3:{n:"PtgElfCol",f:$A},6:{n:"PtgElfRwV",f:QA},7:{n:"PtgElfColV",f:qA},10:{n:"PtgElfRadical",f:KA},11:{n:"PtgElfRadicalS",f:ZA},13:{n:"PtgElfColS",f:XA},15:{n:"PtgElfColSV",f:YA},16:{n:"PtgElfRadicalLel",f:WA},25:{n:"PtgList",f:t6},29:{n:"PtgSxName",f:a6},255:{}},u6={0:{n:"PtgAttrNoop",f:i6},1:{n:"PtgAttrSemi",f:pA},2:{n:"PtgAttrIf",f:xA},4:{n:"PtgAttrChoose",f:dA},8:{n:"PtgAttrGoto",f:hA},16:{n:"PtgAttrSum",f:NA},32:{n:"PtgAttrBaxcel",f:wg},33:{n:"PtgAttrBaxcel",f:wg},64:{n:"PtgAttrSpace",f:gA},65:{n:"PtgAttrSpaceSemi",f:vA},128:{n:"PtgAttrIfError",f:mA},255:{}};function dc(e,n,a,s){if(s.biff<8)return ya(e,n);for(var i=e.l+n,u=[],f=0;f!==a.length;++f)switch(a[f][0]){case"PtgArray":a[f][1]=FA(e,0,s),u.push(a[f][1]);break;case"PtgMemArea":a[f][2]=DA(e,a[f][1],s),u.push(a[f][2]);break;case"PtgExp":s&&s.biff==12&&(a[f][1][1]=e.read_shift(4),u.push(a[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[f][0]}return n=i-e.l,n!==0&&u.push(ya(e,n)),u}function hc(e,n,a){for(var s=e.l+n,i,u,f=[];s!=e.l;)n=s-e.l,u=e[e.l],i=Sg[u]||Sg[c6[u]],(u===24||u===25)&&(i=(u===24?o6:u6)[e[e.l+1]]),!i||!i.f?ya(e,n):f.push([i.n,i.f(e,n,a)]);return f}function f6(e){for(var n=[],a=0;a<e.length;++a){for(var s=e[a],i=[],u=0;u<s.length;++u){var f=s[u];if(f)switch(f[0]){case 2:i.push('"'+f[1].replace(/"/g,'""')+'"');break;default:i.push(f[1])}else i.push("")}n.push(i.join(","))}return n.join(";")}var d6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function h6(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function V2(e,n,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!s)return"SH33TJSERR1";var i="";if(a.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(u){return u.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Eg(e,n,a){var s=V2(e,n,a);return s=="#REF"?s:h6(s,a)}function pa(e,n,a,s,i){var u=i&&i.biff||8,f={s:{c:0,r:0}},d=[],m,x,g,v=0,b=0,k,y="";if(!e[0]||!e[0][0])return"";for(var w=-1,N="",_=0,O=e[0].length;_<O;++_){var E=e[0][_];switch(E[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=d.pop(),x=d.pop(),w>=0){switch(e[0][w][1][0]){case 0:N=Lt(" ",e[0][w][1][1]);break;case 1:N=Lt("\r",e[0][w][1][1]);break;default:if(N="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}x=x+N,w=-1}d.push(x+d6[E[0]]+m);break;case"PtgIsect":m=d.pop(),x=d.pop(),d.push(x+" "+m);break;case"PtgUnion":m=d.pop(),x=d.pop(),d.push(x+","+m);break;case"PtgRange":m=d.pop(),x=d.pop(),d.push(x+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Mi(E[1][1],f,i),d.push(Li(g,u));break;case"PtgRefN":g=a?Mi(E[1][1],a,i):E[1][1],d.push(Li(g,u));break;case"PtgRef3d":v=E[1][1],g=Mi(E[1][2],f,i),y=Eg(s,v,i),d.push(y+"!"+Li(g,u));break;case"PtgFunc":case"PtgFuncVar":var L=E[1][0],G=E[1][1];L||(L=0),L&=127;var H=L==0?[]:d.slice(-L);d.length-=L,G==="User"&&(G=H.shift()),d.push(G+"("+H.join(",")+")");break;case"PtgBool":d.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(E[1]);break;case"PtgNum":d.push(String(E[1]));break;case"PtgStr":d.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(E[1]);break;case"PtgAreaN":k=ng(E[1][1],a?{s:a}:f,i),d.push(Jf(k,i));break;case"PtgArea":k=ng(E[1][1],f,i),d.push(Jf(k,i));break;case"PtgArea3d":v=E[1][1],k=E[1][2],y=Eg(s,v,i),d.push(y+"!"+Jf(k,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":b=E[1][2];var R=(s.names||[])[b-1]||(s[0]||[])[b],Z=R?R.Name:"SH33TJSNAME"+String(b);Z&&Z.slice(0,6)=="_xlfn."&&!i.xlfn&&(Z=Z.slice(6)),d.push(Z);break;case"PtgNameX":var Y=E[1][1];b=E[1][2];var Q;if(i.biff<=5)Y<0&&(Y=-Y),s[Y]&&(Q=s[Y][b]);else{var K="";if(((s[Y]||[])[0]||[])[0]==14849||(((s[Y]||[])[0]||[])[0]==1025?s[Y][b]&&s[Y][b].itab>0&&(K=s.SheetNames[s[Y][b].itab-1]+"!"):K=s.SheetNames[b-1]+"!"),s[Y]&&s[Y][b])K+=s[Y][b].Name;else if(s[0]&&s[0][b])K+=s[0][b].Name;else{var ee=(V2(s,Y,i)||"").split(";;");ee[b-1]?K=ee[b-1]:K+="SH33TJSERRX"}d.push(K);break}Q||(Q={Name:"SH33TJSERRY"}),d.push(Q.Name);break;case"PtgParen":var Ee="(",Ne=")";if(w>=0){switch(N="",e[0][w][1][0]){case 2:Ee=Lt(" ",e[0][w][1][1])+Ee;break;case 3:Ee=Lt("\r",e[0][w][1][1])+Ee;break;case 4:Ne=Lt(" ",e[0][w][1][1])+Ne;break;case 5:Ne=Lt("\r",e[0][w][1][1])+Ne;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}d.push(Ee+d.pop()+Ne);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":g={c:E[1][1],r:E[1][0]};var me={c:a.c,r:a.r};if(s.sharedf[Ze(g)]){var J=s.sharedf[Ze(g)];d.push(pa(J,f,me,s,i))}else{var se=!1;for(m=0;m!=s.arrayf.length;++m)if(x=s.arrayf[m],!(g.c<x[0].s.c||g.c>x[0].e.c)&&!(g.r<x[0].s.r||g.r>x[0].e.r)){d.push(pa(x[1],f,me,s,i)),se=!0;break}se||d.push(E[1])}break;case"PtgArray":d.push("{"+f6(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&w>=0&&Ae.indexOf(e[0][_][0])==-1){E=e[0][w];var ae=!0;switch(E[1][0]){case 4:ae=!1;case 0:N=Lt(" ",E[1][1]);break;case 5:ae=!1;case 1:N=Lt("\r",E[1][1]);break;default:if(N="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}d.push((ae?N:"")+d.pop()+(ae?"":N)),w=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function x6(e,n,a){var s=e.l+n,i=a.biff==2?1:2,u,f=e.read_shift(i);if(f==65535)return[[],ya(e,n-2)];var d=hc(e,f,a);return n!==f+i&&(u=dc(e,n-f-i,d,a)),e.l=s,[d,u]}function m6(e,n,a){var s=e.l+n,i=a.biff==2?1:2,u,f=e.read_shift(i);if(f==65535)return[[],ya(e,n-2)];var d=hc(e,f,a);return n!==f+i&&(u=dc(e,n-f-i,d,a)),e.l=s,[d,u]}function p6(e,n,a,s){var i=e.l+n,u=hc(e,s,a),f;return i!==e.l&&(f=dc(e,i-e.l,u,a)),[u,f]}function g6(e,n,a){var s=e.l+n,i,u=e.read_shift(2),f=hc(e,u,a);return u==65535?[[],ya(e,n-2)]:(n!==u+2&&(i=dc(e,s-u-2,f,a)),[f,i])}function v6(e){var n;if(sn(e,e.l+6)!==65535)return[ga(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function td(e,n,a){var s=e.l+n,i=zr(e);a.biff==2&&++e.l;var u=v6(e),f=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=m6(e,s-e.l,a);return{cell:i,val:u[0],formula:d,shared:f>>3&1,tt:u[1]}}function wo(e,n,a){var s=e.read_shift(4),i=hc(e,s,a),u=e.read_shift(4),f=u>0?dc(e,u,i,a):null;return[i,f]}var b6=wo,So=wo,y6=wo,k6=wo,w6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},G2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},S6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ng(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ad(e){var n=e.split(":"),a=n[0].split(".")[0];return[a,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var Ui={},kl={};function Pi(e,n){if(e){var a=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function $2(e,n,a,s,i,u){try{s.cellNF&&(e.z=Qe[n])}catch(d){if(s.WTF)throw d}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=sa(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(Qe[n]==null&&ys(EN[n]||"General",n),e.t==="e")e.w=e.w||Cs[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wi(e.v);else if(e.t==="d"){var f=Aa(e.v);(f|0)===f?e.w=f.toString(10):e.w=Wi(f)}else{if(e.v===void 0)return"";e.w=ws(e.v,kl)}else e.t==="d"?e.w=xr(n,Aa(e.v),kl):e.w=xr(n,e.v,kl)}catch(d){if(s.WTF)throw d}if(s.cellStyles&&a!=null)try{e.s=u.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fo(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fo(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(s.WTF&&u.Fills)throw d}}}function E6(e,n){var a=Bt(n);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=dt(a))}var N6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,T6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_6=/<(?:\w:)?hyperlink [^>]*>/mg,A6=/"(\w*:\w*)"/,C6=/<(?:\w:)?col\b[^>]*[\/]?>/g,j6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,O6=/<(?:\w:)?pageMargins[^>]*\/>/g,X2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,R6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,D6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function F6(e,n,a,s,i,u,f){if(!e)return e;s||(s={"!id":{}});var d=n.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",g="",v=e.match(T6);v?(x=e.slice(0,v.index),g=e.slice(v.index+v[0].length)):x=g=e;var b=x.match(X2);b?xh(b[0],d,i,a):(b=x.match(R6))&&M6(b[0],b[1]||"",d,i,a);var k=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(k>0){var y=x.slice(k,k+50).match(A6);y&&E6(d,y[1])}var w=x.match(D6);w&&w[1]&&P6(w[1],i);var N=[];if(n.cellStyles){var _=x.match(C6);_&&B6(N,_)}v&&H6(v[1],d,n,m,u,f);var O=g.match(j6);O&&(d["!autofilter"]=z6(O[0]));var E=[],L=g.match(N6);if(L)for(k=0;k!=L.length;++k)E[k]=Bt(L[k].slice(L[k].indexOf('"')+1));var G=g.match(_6);G&&L6(d,G,s);var H=g.match(O6);if(H&&(d["!margins"]=I6(Ke(H[0]))),!d["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(d["!ref"]=dt(m)),n.sheetRows>0&&d["!ref"]){var R=Bt(d["!ref"]);n.sheetRows<=+R.e.r&&(R.e.r=n.sheetRows-1,R.e.r>m.e.r&&(R.e.r=m.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>m.e.c&&(R.e.c=m.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),d["!fullref"]=d["!ref"],d["!ref"]=dt(R))}return N.length>0&&(d["!cols"]=N),E.length>0&&(d["!merges"]=E),d}function xh(e,n,a,s){var i=Ke(e);a.Sheets[s]||(a.Sheets[s]={}),i.codeName&&(a.Sheets[s].CodeName=ht(Nt(i.codeName)))}function M6(e,n,a,s,i){xh(e.slice(0,e.indexOf(">")),a,s,i)}function L6(e,n,a){for(var s=Array.isArray(e),i=0;i!=n.length;++i){var u=Ke(Nt(n[i]),!0);if(!u.ref)return;var f=((a||{})["!id"]||[])[u.id];f?(u.Target=f.Target,u.location&&(u.Target+="#"+ht(u.location))):(u.Target="#"+ht(u.location),f={Target:u.Target,TargetMode:"Internal"}),u.Rel=f,u.tooltip&&(u.Tooltip=u.tooltip,delete u.tooltip);for(var d=Bt(u.ref),m=d.s.r;m<=d.e.r;++m)for(var x=d.s.c;x<=d.e.c;++x){var g=Ze({c:x,r:m});s?(e[m]||(e[m]=[]),e[m][x]||(e[m][x]={t:"z",v:void 0}),e[m][x].l=u):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=u)}}}function I6(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(n[a]=parseFloat(e[a]))}),n}function B6(e,n){for(var a=!1,s=0;s!=n.length;++s){var i=Ke(n[s],!0);i.hidden&&(i.hidden=Ot(i.hidden));var u=parseInt(i.min,10)-1,f=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!a&&i.width&&(a=!0,dh(i.width)),El(i);u<=f;)e[u++]=fa(i)}}function z6(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var U6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function P6(e,n){n.Views||(n.Views=[{}]),(e.match(U6)||[]).forEach(function(a,s){var i=Ke(a);n.Views[s]||(n.Views[s]={}),+i.zoomScale&&(n.Views[s].zoom=+i.zoomScale),Ot(i.rightToLeft)&&(n.Views[s].RTL=!0)})}var H6=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,u=Zi("v"),f=Zi("f");return function(m,x,g,v,b,k){for(var y=0,w="",N=[],_=[],O=0,E=0,L=0,G="",H,R,Z=0,Y=0,Q,K,ee=0,Ee=0,Ne=Array.isArray(k.CellXf),me,J=[],se=[],Ae=Array.isArray(x),ae=[],Ce={},B=!1,A=!!g.sheetStubs,q=m.split(n),V=0,T=q.length;V!=T;++V){w=q[V].trim();var z=w.length;if(z!==0){var ne=0;e:for(y=0;y<z;++y)switch(w[y]){case">":if(w[y-1]!="/"){++y;break e}if(g&&g.cellStyles){if(R=Ke(w.slice(ne,y),!0),Z=R.r!=null?parseInt(R.r,10):Z+1,Y=-1,g.sheetRows&&g.sheetRows<Z)continue;Ce={},B=!1,R.ht&&(B=!0,Ce.hpt=parseFloat(R.ht),Ce.hpx=tc(Ce.hpt)),R.hidden=="1"&&(B=!0,Ce.hidden=!0),R.outlineLevel!=null&&(B=!0,Ce.level=+R.outlineLevel),B&&(ae[Z-1]=Ce)}break;case"<":ne=y;break}if(ne>=y)break;if(R=Ke(w.slice(ne,y),!0),Z=R.r!=null?parseInt(R.r,10):Z+1,Y=-1,!(g.sheetRows&&g.sheetRows<Z)){v.s.r>Z-1&&(v.s.r=Z-1),v.e.r<Z-1&&(v.e.r=Z-1),g&&g.cellStyles&&(Ce={},B=!1,R.ht&&(B=!0,Ce.hpt=parseFloat(R.ht),Ce.hpx=tc(Ce.hpt)),R.hidden=="1"&&(B=!0,Ce.hidden=!0),R.outlineLevel!=null&&(B=!0,Ce.level=+R.outlineLevel),B&&(ae[Z-1]=Ce)),N=w.slice(y).split(e);for(var Te=0;Te!=N.length&&N[Te].trim().charAt(0)=="<";++Te);for(N=N.slice(Te),y=0;y!=N.length;++y)if(w=N[y].trim(),w.length!==0){if(_=w.match(a),O=y,E=0,L=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,_!=null&&_.length===2){for(O=0,G=_[1],E=0;E!=G.length&&!((L=G.charCodeAt(E)-64)<1||L>26);++E)O=26*O+L;--O,Y=O}else++Y;for(E=0;E!=w.length&&w.charCodeAt(E)!==62;++E);if(++E,R=Ke(w.slice(0,E),!0),R.r||(R.r=Ze({r:Z-1,c:Y})),G=w.slice(E),H={t:""},(_=G.match(u))!=null&&_[1]!==""&&(H.v=ht(_[1])),g.cellFormula){if((_=G.match(f))!=null&&_[1]!==""){if(H.f=ht(Nt(_[1])).replace(/\r\n/g,`
`),g.xlfn||(H.f=kg(H.f)),_[0].indexOf('t="array"')>-1)H.F=(G.match(i)||[])[1],H.F.indexOf(":")>-1&&J.push([Bt(H.F),H.F]);else if(_[0].indexOf('t="shared"')>-1){K=Ke(_[0]);var ge=ht(Nt(_[1]));g.xlfn||(ge=kg(ge)),se[parseInt(K.si,10)]=[K,ge,R.r]}}else(_=G.match(/<f[^>]*\/>/))&&(K=Ke(_[0]),se[K.si]&&(H.f=Q_(se[K.si][1],se[K.si][2],R.r)));var ke=Ta(R.r);for(E=0;E<J.length;++E)ke.r>=J[E][0].s.r&&ke.r<=J[E][0].e.r&&ke.c>=J[E][0].s.c&&ke.c<=J[E][0].e.c&&(H.F=J[E][1])}if(R.t==null&&H.v===void 0)if(H.f||H.F)H.v=0,H.t="n";else if(A)H.t="z";else continue;else H.t=R.t||"n";switch(v.s.c>Y&&(v.s.c=Y),v.e.c<Y&&(v.e.c=Y),H.t){case"n":if(H.v==""||H.v==null){if(!A)continue;H.t="z"}else H.v=parseFloat(H.v);break;case"s":if(typeof H.v>"u"){if(!A)continue;H.t="z"}else Q=Ui[parseInt(H.v,10)],H.v=Q.t,H.r=Q.r,g.cellHTML&&(H.h=Q.h);break;case"str":H.t="s",H.v=H.v!=null?Nt(H.v):"",g.cellHTML&&(H.h=th(H.v));break;case"inlineStr":_=G.match(s),H.t="s",_!=null&&(Q=fh(_[1]))?(H.v=Q.t,g.cellHTML&&(H.h=Q.h)):H.v="";break;case"b":H.v=Ot(H.v);break;case"d":g.cellDates?H.v=sa(H.v,1):(H.v=Aa(sa(H.v,1)),H.t="n");break;case"e":(!g||g.cellText!==!1)&&(H.w=H.v),H.v=h2[H.v];break}if(ee=Ee=0,me=null,Ne&&R.s!==void 0&&(me=k.CellXf[R.s],me!=null&&(me.numFmtId!=null&&(ee=me.numFmtId),g.cellStyles&&me.fillId!=null&&(Ee=me.fillId))),$2(H,ee,Ee,g,b,k),g.cellDates&&Ne&&H.t=="n"&&Al(Qe[ee])&&(H.t="d",H.v=yo(H.v)),R.cm&&g.xlmeta){var $e=(g.xlmeta.Cell||[])[+R.cm-1];$e&&$e.type=="XLDAPR"&&(H.D=!0)}if(Ae){var X=Ta(R.r);x[X.r]||(x[X.r]=[]),x[X.r][X.c]=H}else x[R.r]=H}}}}ae.length>0&&(x["!rows"]=ae)}})();function V6(e,n){var a={},s=e.l+n;a.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var u=e.read_shift(1);return e.l=s,u&7&&(a.level=u&7),u&16&&(a.hidden=!0),u&32&&(a.hpt=i/20),a}var G6=As;function $6(){}function X6(e,n){var a={},s=e[e.l];return++e.l,a.above=!(s&64),a.left=!(s&128),e.l+=18,a.name=x3(e),a}function Y6(e){var n=mr(e);return[n]}function q6(e){var n=_s(e);return[n]}function K6(e){var n=mr(e),a=e.read_shift(1);return[n,a,"b"]}function W6(e){var n=_s(e),a=e.read_shift(1);return[n,a,"b"]}function Z6(e){var n=mr(e),a=e.read_shift(1);return[n,a,"e"]}function J6(e){var n=_s(e),a=e.read_shift(1);return[n,a,"e"]}function Q6(e){var n=mr(e),a=e.read_shift(4);return[n,a,"s"]}function e8(e){var n=_s(e),a=e.read_shift(4);return[n,a,"s"]}function t8(e){var n=mr(e),a=ga(e);return[n,a,"n"]}function Y2(e){var n=_s(e),a=ga(e);return[n,a,"n"]}function a8(e){var n=mr(e),a=ch(e);return[n,a,"n"]}function r8(e){var n=_s(e),a=ch(e);return[n,a,"n"]}function n8(e){var n=mr(e),a=lh(e);return[n,a,"is"]}function s8(e){var n=mr(e),a=ba(e);return[n,a,"str"]}function l8(e){var n=_s(e),a=ba(e);return[n,a,"str"]}function i8(e,n,a){var s=e.l+n,i=mr(e);i.r=a["!row"];var u=e.read_shift(1),f=[i,u,"b"];if(a.cellFormula){e.l+=2;var d=So(e,s-e.l,a);f[3]=pa(d,null,i,a.supbooks,a)}else e.l=s;return f}function c8(e,n,a){var s=e.l+n,i=mr(e);i.r=a["!row"];var u=e.read_shift(1),f=[i,u,"e"];if(a.cellFormula){e.l+=2;var d=So(e,s-e.l,a);f[3]=pa(d,null,i,a.supbooks,a)}else e.l=s;return f}function o8(e,n,a){var s=e.l+n,i=mr(e);i.r=a["!row"];var u=ga(e),f=[i,u,"n"];if(a.cellFormula){e.l+=2;var d=So(e,s-e.l,a);f[3]=pa(d,null,i,a.supbooks,a)}else e.l=s;return f}function u8(e,n,a){var s=e.l+n,i=mr(e);i.r=a["!row"];var u=ba(e),f=[i,u,"str"];if(a.cellFormula){e.l+=2;var d=So(e,s-e.l,a);f[3]=pa(d,null,i,a.supbooks,a)}else e.l=s;return f}var f8=As;function d8(e,n){var a=e.l+n,s=As(e),i=ih(e),u=ba(e),f=ba(e),d=ba(e);e.l=a;var m={rfx:s,relId:i,loc:u,display:d};return f&&(m.Tooltip=f),m}function h8(){}function x8(e,n,a){var s=e.l+n,i=u2(e),u=e.read_shift(1),f=[i];if(f[2]=u,a.cellFormula){var d=b6(e,s-e.l,a);f[1]=d}else e.l=s;return f}function m8(e,n,a){var s=e.l+n,i=As(e),u=[i];if(a.cellFormula){var f=k6(e,s-e.l,a);u[1]=f,e.l=s}else e.l=s;return u}var p8=["left","right","top","bottom","header","footer"];function g8(e){var n={};return p8.forEach(function(a){n[a]=ga(e)}),n}function v8(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function b8(){}function y8(){}function k8(e,n,a,s,i,u,f){if(!e)return e;var d=n||{};s||(s={"!id":{}});var m=d.dense?[]:{},x,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,b=!1,k,y,w,N,_,O,E,L,G,H=[];d.biff=12,d["!row"]=0;var R=0,Z=!1,Y=[],Q={},K=d.supbooks||i.supbooks||[[]];if(K.sharedf=Q,K.arrayf=Y,K.SheetNames=i.SheetNames||i.Sheets.map(function(Ae){return Ae.name}),!d.supbooks&&(d.supbooks=K,i.Names))for(var ee=0;ee<i.Names.length;++ee)K[0][ee+1]=i.Names[ee];var Ee=[],Ne=[],me=!1;mo[16]={n:"BrtShortReal",f:Y2};var J;if(hn(e,function(ae,Ce,B){if(!b)switch(B){case 148:x=ae;break;case 0:k=ae,d.sheetRows&&d.sheetRows<=k.r&&(b=!0),L=da(N=k.r),d["!row"]=k.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=tc(ae.hpt)),Ne[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ae[2]},ae[2]){case"n":y.v=ae[1];break;case"s":E=Ui[ae[1]],y.v=E.t,y.r=E.r;break;case"b":y.v=!!ae[1];break;case"e":y.v=ae[1],d.cellText!==!1&&(y.w=Cs[y.v]);break;case"str":y.t="s",y.v=ae[1];break;case"is":y.t="s",y.v=ae[1].t;break}if((w=f.CellXf[ae[0].iStyleRef])&&$2(y,w.numFmtId,null,d,u,f),_=ae[0].c==-1?_+1:ae[0].c,d.dense?(m[N]||(m[N]=[]),m[N][_]=y):m[ta(_)+L]=y,d.cellFormula){for(Z=!1,R=0;R<Y.length;++R){var A=Y[R];k.r>=A[0].s.r&&k.r<=A[0].e.r&&_>=A[0].s.c&&_<=A[0].e.c&&(y.F=dt(A[0]),Z=!0)}!Z&&ae.length>3&&(y.f=ae[3])}if(g.s.r>k.r&&(g.s.r=k.r),g.s.c>_&&(g.s.c=_),g.e.r<k.r&&(g.e.r=k.r),g.e.c<_&&(g.e.c=_),d.cellDates&&w&&y.t=="n"&&Al(Qe[w.numFmtId])){var q=vs(y.v);q&&(y.t="d",y.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}J&&(J.type=="XLDAPR"&&(y.D=!0),J=void 0);break;case 1:case 12:if(!d.sheetStubs||v)break;y={t:"z",v:void 0},_=ae[0].c==-1?_+1:ae[0].c,d.dense?(m[N]||(m[N]=[]),m[N][_]=y):m[ta(_)+L]=y,g.s.r>k.r&&(g.s.r=k.r),g.s.c>_&&(g.s.c=_),g.e.r<k.r&&(g.e.r=k.r),g.e.c<_&&(g.e.c=_),J&&(J.type=="XLDAPR"&&(y.D=!0),J=void 0);break;case 176:H.push(ae);break;case 49:J=((d.xlmeta||{}).Cell||[])[ae-1];break;case 494:var V=s["!id"][ae.relId];for(V?(ae.Target=V.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=V):ae.relId==""&&(ae.Target="#"+ae.loc),N=ae.rfx.s.r;N<=ae.rfx.e.r;++N)for(_=ae.rfx.s.c;_<=ae.rfx.e.c;++_)d.dense?(m[N]||(m[N]=[]),m[N][_]||(m[N][_]={t:"z",v:void 0}),m[N][_].l=ae):(O=Ze({c:_,r:N}),m[O]||(m[O]={t:"z",v:void 0}),m[O].l=ae);break;case 426:if(!d.cellFormula)break;Y.push(ae),G=d.dense?m[N][_]:m[ta(_)+L],G.f=pa(ae[1],g,{r:k.r,c:_},K,d),G.F=dt(ae[0]);break;case 427:if(!d.cellFormula)break;Q[Ze(ae[0].s)]=ae[1],G=d.dense?m[N][_]:m[ta(_)+L],G.f=pa(ae[1],g,{r:k.r,c:_},K,d);break;case 60:if(!d.cellStyles)break;for(;ae.e>=ae.s;)Ee[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},me||(me=!0,dh(ae.w/256)),El(Ee[ae.e+1]);break;case 161:m["!autofilter"]={ref:dt(ae)};break;case 476:m["!margins"]=ae;break;case 147:i.Sheets[a]||(i.Sheets[a]={}),ae.name&&(i.Sheets[a].CodeName=ae.name),(ae.above||ae.left)&&(m["!outline"]={above:ae.above,left:ae.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ae.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Ce.T){if(!v||d.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},d),delete d.supbooks,delete d["!row"],!m["!ref"]&&(g.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(m["!ref"]=dt(x||g)),d.sheetRows&&m["!ref"]){var se=Bt(m["!ref"]);d.sheetRows<=+se.e.r&&(se.e.r=d.sheetRows-1,se.e.r>g.e.r&&(se.e.r=g.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>g.e.c&&(se.e.c=g.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),m["!fullref"]=m["!ref"],m["!ref"]=dt(se))}return H.length>0&&(m["!merges"]=H),Ee.length>0&&(m["!cols"]=Ee),Ne.length>0&&(m["!rows"]=Ne),m}function w8(e){var n=[],a=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(u){var f=u.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);f&&(n[+f[1]]=a?+f[2]:f[2])});var i=ht((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(u){s=u.replace(/<.*?>/g,"")}),[n,i,s]}function S8(e,n,a,s,i,u){var f=u||{"!type":"chart"};if(!e)return u;var d=0,m=0,x="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var b=w8(v);g.s.r=g.s.c=0,g.e.c=d,x=ta(d),b[0].forEach(function(k,y){f[x+da(y)]={t:"n",v:k,z:b[1]},m=y}),g.e.r<m&&(g.e.r=m),++d}),d>0&&(f["!ref"]=dt(g)),f}function E8(e,n,a,s,i){if(!e)return e;s||(s={"!id":{}});var u={"!type":"chart","!drawel":null,"!rel":""},f,d=e.match(X2);return d&&xh(d[0],u,i,a),(f=e.match(/drawing r:id="(.*?)"/))&&(u["!rel"]=f[1]),s["!id"][u["!rel"]]&&(u["!drawel"]=s["!id"][u["!rel"]]),u}function N8(e,n){e.l+=10;var a=ba(e);return{name:a}}function T8(e,n,a,s,i){if(!e)return e;s||(s={"!id":{}});var u={"!type":"chart","!drawel":null,"!rel":""},f=!1;return hn(e,function(m,x,g){switch(g){case 550:u["!rel"]=m;break;case 651:i.Sheets[a]||(i.Sheets[a]={}),m.name&&(i.Sheets[a].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!f||n.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},n),s["!id"][u["!rel"]]&&(u["!drawel"]=s["!id"][u["!rel"]]),u}var q2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_8=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],A8=[],C8=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Tg(e,n){for(var a=0;a!=e.length;++a)for(var s=e[a],i=0;i!=n.length;++i){var u=n[i];if(s[u[0]]==null)s[u[0]]=u[1];else switch(u[2]){case"bool":typeof s[u[0]]=="string"&&(s[u[0]]=Ot(s[u[0]]));break;case"int":typeof s[u[0]]=="string"&&(s[u[0]]=parseInt(s[u[0]],10));break}}}function _g(e,n){for(var a=0;a!=n.length;++a){var s=n[a];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=Ot(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function K2(e){_g(e.WBProps,q2),_g(e.CalcPr,C8),Tg(e.WBView,_8),Tg(e.Sheets,A8),kl.date1904=Ot(e.WBProps.date1904)}var j8="][*?/\\".split("");function O8(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return j8.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}var R8=/<\w+:workbook/;function D8(e,n){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,i="xmlns",u={},f=0;if(e.replace(ka,function(m,x){var g=Ke(m);switch(Br(g[0])){case"<?xml":break;case"<workbook":m.match(R8)&&(i="xmlns"+m.match(/<(\w+):/)[1]),a.xmlns=g[i];break;case"</workbook>":break;case"<fileVersion":delete g[0],a.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":q2.forEach(function(v){if(g[v[0]]!=null)switch(v[2]){case"bool":a.WBProps[v[0]]=Ot(g[v[0]]);break;case"int":a.WBProps[v[0]]=parseInt(g[v[0]],10);break;default:a.WBProps[v[0]]=g[v[0]]}}),g.codeName&&(a.WBProps.CodeName=Nt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],a.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=ht(Nt(g.name)),delete g[0],a.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":u={},u.Name=Nt(g.name),g.comment&&(u.Comment=g.comment),g.localSheetId&&(u.Sheet=+g.localSheetId),Ot(g.hidden||"0")&&(u.Hidden=!0),f=x+m.length;break;case"</definedName>":u.Ref=ht(Nt(e.slice(f,x))),a.Names.push(u);break;case"<definedName/>":break;case"<calcPr":delete g[0],a.CalcPr=g;break;case"<calcPr/>":delete g[0],a.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&n.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return m}),ZN.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return K2(a),a}function F8(e,n){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=yd(e),a.name=ba(e),a}function M8(e,n){var a={},s=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var i=n>8?ba(e):"";return i.length>0&&(a.CodeName=i),a.autoCompressPictures=!!(s&65536),a.backupFile=!!(s&64),a.checkCompatibility=!!(s&4096),a.date1904=!!(s&1),a.filterPrivacy=!!(s&8),a.hidePivotFieldList=!!(s&1024),a.promptedSolutions=!!(s&16),a.publishItems=!!(s&2048),a.refreshAllConnections=!!(s&262144),a.saveExternalLinkValues=!!(s&128),a.showBorderUnselectedTables=!!(s&4),a.showInkAnnotation=!!(s&32),a.showObjects=["all","placeholders","none"][s>>13&3],a.showPivotChartFilter=!!(s&32768),a.updateLinks=["userSet","never","always"][s>>8&3],a}function L8(e,n){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=n-8,a}function I8(e,n,a){var s=e.l+n;e.l+=4,e.l+=1;var i=e.read_shift(4),u=m3(e),f=y6(e,0,a),d=ih(e);e.l=s;var m={Name:u,Ptg:f};return i<268435455&&(m.Sheet=i),d&&(m.Comment=d),m}function B8(e,n){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],i=!1;n||(n={}),n.biff=12;var u=[],f=[[]];return f.SheetNames=[],f.XTI=[],mo[16]={n:"BrtFRTArchID$",f:L8},hn(e,function(m,x,g){switch(g){case 156:f.SheetNames.push(m.name),a.Sheets.push(m);break;case 153:a.WBProps=m;break;case 39:m.Sheet!=null&&(n.SID=m.Sheet),m.Ref=pa(m.Ptg,null,null,f,n),delete n.SID,delete m.Ptg,u.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:f[0].length?f.push([g,m]):f[0]=[g,m],f[f.length-1].XTI=[];break;case 362:f.length===0&&(f[0]=[],f[0].XTI=[]),f[f.length-1].XTI=f[f.length-1].XTI.concat(m),f.XTI=f.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(g),i=!0;break;case 36:s.pop(),i=!1;break;case 37:s.push(g),i=!0;break;case 38:s.pop(),i=!1;break;case 16:break;default:if(!x.T){if(!i||n.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},n),K2(a),a.Names=u,a.supbooks=f,a}function z8(e,n,a){return n.slice(-4)===".bin"?B8(e,a):D8(e,a)}function U8(e,n,a,s,i,u,f,d){return n.slice(-4)===".bin"?k8(e,s,a,i,u,f,d):F6(e,s,a,i,u,f,d)}function P8(e,n,a,s,i,u,f,d){return n.slice(-4)===".bin"?T8(e,s,a,i,u):E8(e,s,a,i,u)}function H8(e,n,a,s,i,u,f,d){return n.slice(-4)===".bin"?W_():Z_()}function V8(e,n,a,s,i,u,f,d){return n.slice(-4)===".bin"?q_():K_()}function G8(e,n,a,s){return n.slice(-4)===".bin"?f_(e,a,s):s_(e,a,s)}function $8(e,n,a){return M2(e,a)}function X8(e,n,a){return n.slice(-4)===".bin"?_5(e,a):N5(e,a)}function Y8(e,n,a){return n.slice(-4)===".bin"?$_(e,a):U_(e,a)}function q8(e,n,a){return n.slice(-4)===".bin"?I_(e):M_(e)}function K8(e,n,a,s){return a.slice(-4)===".bin"?B_(e,n,a,s):void 0}function W8(e,n,a){return n.slice(-4)===".bin"?D_(e,n,a):F_(e,n,a)}var W2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Z2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function yr(e,n){var a=e.split(/\s+/),s=[];if(s[0]=a[0],a.length===1)return s;var i=e.match(W2),u,f,d,m;if(i)for(m=0;m!=i.length;++m)u=i[m].match(Z2),(f=u[1].indexOf(":"))===-1?s[u[1]]=u[2].slice(1,u[2].length-1):(u[1].slice(0,6)==="xmlns:"?d="xmlns"+u[1].slice(6):d=u[1].slice(f+1),s[d]=u[2].slice(1,u[2].length-1));return s}function Z8(e){var n=e.split(/\s+/),a={};if(n.length===1)return a;var s=e.match(W2),i,u,f,d;if(s)for(d=0;d!=s.length;++d)i=s[d].match(Z2),(u=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?f="xmlns"+i[1].slice(6):f=i[1].slice(u+1),a[f]=i[2].slice(1,i[2].length-1));return a}var Hi;function J8(e,n){var a=Hi[e]||ht(e);return a==="General"?ws(n):xr(a,n)}function Q8(e,n,a,s){var i=s;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ot(s);break;case"i2":case"int":i=parseInt(s,10);break;case"r4":case"float":i=parseFloat(s);break;case"date":case"dateTime.tz":i=sa(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[ht(n)]=i}function eC(e,n,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||Cs[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wi(e.v):e.w=ws(e.v):e.w=J8(n||"General",e.v)}catch(u){if(a.WTF)throw u}try{var s=Hi[n]||n||"General";if(a.cellNF&&(e.z=s),a.cellDates&&e.t=="n"&&Al(s)){var i=vs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(u){if(a.WTF)throw u}}}function tC(e,n,a){if(a.cellStyles&&n.Interior){var s=n.Interior;s.Pattern&&(s.patternType=Q5[s.Pattern]||s.Pattern)}e[n.ID]=n}function aC(e,n,a,s,i,u,f,d,m,x){var g="General",v=s.StyleID,b={};x=x||{};var k=[],y=0;for(v===void 0&&d&&(v=d.StyleID),v===void 0&&f&&(v=f.StyleID);u[v]!==void 0&&(u[v].nf&&(g=u[v].nf),u[v].Interior&&k.push(u[v].Interior),!!u[v].Parent);)v=u[v].Parent;switch(a.Type){case"Boolean":s.t="b",s.v=Ot(e);break;case"String":s.t="s",s.r=Kp(ht(e)),s.v=e.indexOf("<")>-1?ht(n||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(sa(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=ht(e):s.v<60&&(s.v=s.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=h2[e],x.cellText!==!1&&(s.w=e);break;default:e==""&&n==""?s.t="z":(s.t="s",s.v=Kp(n||e));break}if(eC(s,g,x),x.cellFormula!==!1)if(s.Formula){var w=ht(s.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),s.f=yl(w,i),delete s.Formula,s.ArrayRange=="RC"?s.F=yl("RC:RC",i):s.ArrayRange&&(s.F=yl(s.ArrayRange,i),m.push([Bt(s.F),s.F]))}else for(y=0;y<m.length;++y)i.r>=m[y][0].s.r&&i.r<=m[y][0].e.r&&i.c>=m[y][0].s.c&&i.c<=m[y][0].e.c&&(s.F=m[y][1]);x.cellStyles&&(k.forEach(function(N){!b.patternType&&N.patternType&&(b.patternType=N.patternType)}),s.s=b),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function rC(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function rd(e,n){var a=n||{};zv();var s=Ai(ah(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(s=Nt(s));var i=s.slice(0,1024).toLowerCase(),u=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var f=fa(a);return f.type="string",Qi.to_workbook(s,f)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Le){i.indexOf("<"+Le)>=0&&(u=!0)}),u)return dC(s,a);Hi={"General Number":"General","General Date":Qe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Qe[15],"Short Date":Qe[14],"Long Time":Qe[19],"Medium Time":Qe[18],"Short Time":Qe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Qe[2],Standard:Qe[4],Percent:Qe[10],Scientific:Qe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,m=[],x,g={},v=[],b=a.dense?[]:{},k="",y={},w={},N=yr('<Data ss:Type="String">'),_=0,O=0,E=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},H={},R="",Z=0,Y=[],Q={},K={},ee=0,Ee=[],Ne=[],me={},J=[],se,Ae=!1,ae=[],Ce=[],B={},A=0,q=0,V={Sheets:[],WBProps:{date1904:!1}},T={};Ji.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";d=Ji.exec(s);)switch(d[3]=(z=d[3]).toLowerCase()){case"data":if(z=="data"){if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break}if(m[m.length-1][1])break;d[1]==="/"?aC(s.slice(_,d.index),R,N,m[m.length-1][0]=="comment"?me:y,{c:O,r:E},G,J[O],w,ae,a):(R="",N=yr(d[0]),_=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(Ne.length>0&&(y.c=Ne),(!a.sheetRows||a.sheetRows>E)&&y.v!==void 0&&(a.dense?(b[E]||(b[E]=[]),b[E][O]=y):b[ta(O)+da(E)]=y),y.HRef&&(y.l={Target:ht(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(A=O+(parseInt(y.MergeAcross,10)|0),q=E+(parseInt(y.MergeDown,10)|0),Y.push({s:{c:O,r:E},e:{c:A,r:q}})),!a.sheetStubs)y.MergeAcross?O=A+1:++O;else if(y.MergeAcross||y.MergeDown){for(var ne=O;ne<=A;++ne)for(var Te=E;Te<=q;++Te)(ne>O||Te>E)&&(a.dense?(b[Te]||(b[Te]=[]),b[Te][ne]={t:"z"}):b[ta(ne)+da(Te)]={t:"z"});O=A+1}else++O;else y=Z8(d[0]),y.Index&&(O=+y.Index-1),O<L.s.c&&(L.s.c=O),O>L.e.c&&(L.e.c=O),d[0].slice(-2)==="/>"&&++O,Ne=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(E<L.s.r&&(L.s.r=E),E>L.e.r&&(L.e.r=E),d[0].slice(-2)==="/>"&&(w=yr(d[0]),w.Index&&(E=+w.Index-1)),O=0,++E):(w=yr(d[0]),w.Index&&(E=+w.Index-1),B={},(w.AutoFitHeight=="0"||w.Height)&&(B.hpx=parseInt(w.Height,10),B.hpt=F2(B.hpx),Ce[E]=B),w.Hidden=="1"&&(B.hidden=!0,Ce[E]=B));break;case"worksheet":if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));v.push(k),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(b["!ref"]=dt(L),a.sheetRows&&a.sheetRows<=L.e.r&&(b["!fullref"]=b["!ref"],L.e.r=a.sheetRows-1,b["!ref"]=dt(L))),Y.length&&(b["!merges"]=Y),J.length>0&&(b["!cols"]=J),Ce.length>0&&(b["!rows"]=Ce),g[k]=b}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=O=0,m.push([d[3],!1]),x=yr(d[0]),k=ht(x.Name),b=a.dense?[]:{},Y=[],ae=[],Ce=[],T={name:k,Hidden:0},V.Sheets.push(T);break;case"table":if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else{if(d[0].slice(-2)=="/>")break;m.push([d[3],!1]),J=[],Ae=!1}break;case"style":d[1]==="/"?tC(G,H,a):H=yr(d[0]);break;case"numberformat":H.nf=ht(yr(d[0]).Format||"General"),Hi[H.nf]&&(H.nf=Hi[H.nf]);for(var ge=0;ge!=392&&Qe[ge]!=H.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(Qe[ge]==null){ys(H.nf,ge);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(se=yr(d[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!Ae&&se.wpx>10){Ae=!0,Na=R2;for(var ke=0;ke<J.length;++ke)J[ke]&&El(J[ke])}Ae&&El(se),J[se.Index-1||J.length]=se;for(var $e=0;$e<+se.Span;++$e)J[J.length]=fa(se);break;case"namedrange":if(d[1]==="/")break;V.Names||(V.Names=[]);var X=Ke(d[0]),nt={Name:X.Name,Ref:yl(X.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(nt.Sheet=V.Sheets.length-1),V.Names.push(nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?R+=s.slice(Z,d.index):Z=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;H.Interior=yr(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?U3(Q,z,s.slice(ee,d.index)):ee=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else m.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));rC(me),Ne.push(me)}else m.push([d[3],!1]),x=yr(d[0]),me={a:x.Author};break;case"autofilter":if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var pe=yr(d[0]);b["!autofilter"]={ref:yl(pe.Range).replace(/\$/g,"")},m.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((x=m.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"null":break;default:if(m.length==0&&d[3]=="document"||m.length==0&&d[3]=="uof")return Dg(s,a);var we=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:we=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:we=!1}break;case"excelworkbook":switch(d[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:we=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:we=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(s.slice(ee,d.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else ee=d.index+d[0].length;break;case"header":b["!margins"]||Pi(b["!margins"]={},"xlml"),isNaN(+Ke(d[0]).Margin)||(b["!margins"].header=+Ke(d[0]).Margin);break;case"footer":b["!margins"]||Pi(b["!margins"]={},"xlml"),isNaN(+Ke(d[0]).Margin)||(b["!margins"].footer=+Ke(d[0]).Margin);break;case"pagemargins":var be=Ke(d[0]);b["!margins"]||Pi(b["!margins"]={},"xlml"),isNaN(+be.Top)||(b["!margins"].top=+be.Top),isNaN(+be.Left)||(b["!margins"].left=+be.Left),isNaN(+be.Right)||(b["!margins"].right=+be.Right),isNaN(+be.Bottom)||(b["!margins"].bottom=+be.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:we=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:we=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:we=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:we=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:we=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:we=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:we=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:we=!1}break;case"smarttags":break;default:we=!1;break}if(we||d[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?Q8(K,z,Ee,s.slice(ee,d.index)):(Ee=d,ee=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+m.join("|")}var xe={};return!a.bookSheets&&!a.bookProps&&(xe.Sheets=g),xe.SheetNames=v,xe.Workbook=V,xe.SSF=fa(Qe),xe.Props=Q,xe.Custprops=K,xe}function Ed(e,n){switch(gh(n=n||{}),n.type||"base64"){case"base64":return rd(qa(e),n);case"binary":case"buffer":case"file":return rd(e,n);case"array":return rd(Ts(e),n)}}function nC(e){var n={},a=e.content;if(a.l=28,n.AnsiUserType=a.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=v3(a),a.length-a.l<=4)return n;var s=a.read_shift(4);if(s==0||s>40||(a.l-=4,n.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(s=a.read_shift(4),s!==1907505652)||(n.UnicodeClipboardFormat=b3(a),s=a.read_shift(4),s==0||s>40))return n;a.l-=4,n.Reserved2=a.read_shift(0,"lpwstr")}var sC=[60,1084,2066,2165,2175];function lC(e,n,a,s,i){var u=s,f=[],d=a.slice(a.l,a.l+u);if(i&&i.enc&&i.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(d)}f.push(d),a.l+=u;for(var m=sn(a,a.l),x=Nd[m],g=0;x!=null&&sC.indexOf(m)>-1;)u=sn(a,a.l+2),g=a.l+4,m==2066?g+=4:(m==2165||m==2175)&&(g+=12),d=a.slice(g,a.l+4+u),f.push(d),a.l+=4+u,x=Nd[m=sn(a,a.l)];var v=Un(f);ua(v,0);var b=0;v.lens=[];for(var k=0;k<f.length;++k)v.lens.push(b),b+=f[k].length;if(v.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+s;return n.f(v,v.length,i)}function Rr(e,n,a){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=Qe[s])}catch(u){if(n.WTF)throw u}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Cs[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wi(e.v):e.w=ws(e.v):e.w=xr(s,e.v,{date1904:!!a,dateNF:n&&n.dateNF})}catch(u){if(n.WTF)throw u}if(n.cellDates&&s&&e.t=="n"&&Al(Qe[s]||String(s))){var i=vs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function V0(e,n,a){return{v:e,ixfe:n,t:a}}function iC(e,n){var a={opts:{}},s={},i=n.dense?[]:{},u={},f={},d=null,m=[],x="",g={},v,b="",k,y,w,N,_={},O=[],E,L,G=[],H=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Z={},Y=function(et){return et<8?ks[et]:et<64&&H[et-8]||ks[et]},Q=function(et,Dt,Ca){var Tt=Dt.XF.data;if(!(!Tt||!Tt.patternType||!Ca||!Ca.cellStyles)){Dt.s={},Dt.s.patternType=Tt.patternType;var Ut;(Ut=ec(Y(Tt.icvFore)))&&(Dt.s.fgColor={rgb:Ut}),(Ut=ec(Y(Tt.icvBack)))&&(Dt.s.bgColor={rgb:Ut})}},K=function(et,Dt,Ca){if(!(B>1)&&!(Ca.sheetRows&&et.r>=Ca.sheetRows)){if(Ca.cellStyles&&Dt.XF&&Dt.XF.data&&Q(et,Dt,Ca),delete Dt.ixfe,delete Dt.XF,v=et,b=Ze(et),(!f||!f.s||!f.e)&&(f={s:{r:0,c:0},e:{r:0,c:0}}),et.r<f.s.r&&(f.s.r=et.r),et.c<f.s.c&&(f.s.c=et.c),et.r+1>f.e.r&&(f.e.r=et.r+1),et.c+1>f.e.c&&(f.e.c=et.c+1),Ca.cellFormula&&Dt.f){for(var Tt=0;Tt<O.length;++Tt)if(!(O[Tt][0].s.c>et.c||O[Tt][0].s.r>et.r)&&!(O[Tt][0].e.c<et.c||O[Tt][0].e.r<et.r)){Dt.F=dt(O[Tt][0]),(O[Tt][0].s.c!=et.c||O[Tt][0].s.r!=et.r)&&delete Dt.f,Dt.f&&(Dt.f=""+pa(O[Tt][1],f,et,ae,ee));break}}Ca.dense?(i[et.r]||(i[et.r]=[]),i[et.r][et.c]=Dt):i[b]=Dt}},ee={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(ee.password=n.password);var Ee,Ne=[],me=[],J=[],se=[],Ae=!1,ae=[];ae.SheetNames=ee.snames,ae.sharedf=ee.sharedf,ae.arrayf=ee.arrayf,ae.names=[],ae.XTI=[];var Ce=0,B=0,A=0,q=[],V=[],T;ee.codepage=1200,Sr(1200);for(var z=!1;e.l<e.length-1;){var ne=e.l,Te=e.read_shift(2);if(Te===0&&Ce===10)break;var ge=e.l===e.length?0:e.read_shift(2),ke=Nd[Te];if(ke&&ke.f){if(n.bookSheets&&Ce===133&&Te!==133)break;if(Ce=Te,ke.r===2||ke.r==12){var $e=e.read_shift(2);if(ge-=2,!ee.enc&&$e!==Te&&(($e&255)<<8|$e>>8)!==Te)throw new Error("rt mismatch: "+$e+"!="+Te);ke.r==12&&(e.l+=10,ge-=10)}var X={};if(Te===10?X=ke.f(e,ge,ee):X=lC(Te,ke,e,ge,ee),B==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(Te){case 34:a.opts.Date1904=R.WBProps.date1904=X;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(ee.enc||(e.l=0),ee.enc=X,!n.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=X;break;case 66:var nt=Number(X);switch(nt){case 21010:nt=1200;break;case 32768:nt=1e4;break;case 32769:nt=1252;break}Sr(ee.codepage=nt),z=!0;break;case 317:ee.rrtabid=X;break;case 25:ee.winlocked=X;break;case 439:a.opts.RefreshAll=X;break;case 12:a.opts.CalcCount=X;break;case 16:a.opts.CalcDelta=X;break;case 17:a.opts.CalcIter=X;break;case 13:a.opts.CalcMode=X;break;case 14:a.opts.CalcPrecision=X;break;case 95:a.opts.CalcSaveRecalc=X;break;case 15:ee.CalcRefMode=X;break;case 2211:a.opts.FullCalc=X;break;case 129:X.fDialog&&(i["!type"]="dialog"),X.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),X.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:G.push(X);break;case 430:ae.push([X]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(X);break;case 24:case 536:T={Name:X.Name,Ref:pa(X.rgce,f,null,ae,ee)},X.itab>0&&(T.Sheet=X.itab-1),ae.names.push(T),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(V[X.itab-1]={ref:dt(X.rgce[0][0][1][2])});break;case 22:ee.ExternCount=X;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(X),ae.XTI=ae.XTI.concat(X);break;case 2196:if(ee.biff<8)break;T!=null&&(T.Comment=X[1]);break;case 18:i["!protect"]=X;break;case 19:X!==0&&ee.WTF&&console.error("Password verifier: "+X);break;case 133:u[X.pos]=X,ee.snames.push(X.name);break;case 10:{if(--B)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,i["!ref"]=dt(f),n.sheetRows&&n.sheetRows<=f.e.r){var pe=f.e.r;f.e.r=n.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=dt(f),f.e.r=pe}f.e.r++,f.e.c++}Ne.length>0&&(i["!merges"]=Ne),me.length>0&&(i["!objects"]=me),J.length>0&&(i["!cols"]=J),se.length>0&&(i["!rows"]=se),R.Sheets.push(Z)}x===""?g=i:s[x]=i,i=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[Te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),ee.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(ee.biff=5,z=!0,Sr(ee.codepage=28591)),ee.biff==8&&X.BIFFVer==0&&X.dt==16&&(ee.biff=2),B++)break;if(i=n.dense?[]:{},ee.biff<8&&!z&&(z=!0,Sr(ee.codepage=n.codepage||1252)),ee.biff<5||X.BIFFVer==0&&X.dt==4096){x===""&&(x="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var we={pos:e.l-ge,name:x};u[we.pos]=we,ee.snames.push(x)}else x=(u[ne]||{name:""}).name;X.dt==32&&(i["!type"]="chart"),X.dt==64&&(i["!type"]="macro"),Ne=[],me=[],ee.arrayf=O=[],J=[],se=[],Ae=!1,Z={Hidden:(u[ne]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(n.dense?(i[X.r]||[])[X.c]:i[Ze({c:X.c,r:X.r})])&&++X.c,E={ixfe:X.ixfe,XF:G[X.ixfe]||{},v:X.val,t:"n"},A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:X.c,r:X.r},E,n);break;case 5:case 517:E={ixfe:X.ixfe,XF:G[X.ixfe],v:X.val,t:X.t},A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:X.c,r:X.r},E,n);break;case 638:E={ixfe:X.ixfe,XF:G[X.ixfe],v:X.rknum,t:"n"},A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:X.c,r:X.r},E,n);break;case 189:for(var be=X.c;be<=X.C;++be){var xe=X.rkrec[be-X.c][0];E={ixfe:xe,XF:G[xe],v:X.rkrec[be-X.c][1],t:"n"},A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:be,r:X.r},E,n)}break;case 6:case 518:case 1030:{if(X.val=="String"){d=X;break}if(E=V0(X.val,X.cell.ixfe,X.tt),E.XF=G[E.ixfe],n.cellFormula){var Le=X.formula;if(Le&&Le[0]&&Le[0][0]&&Le[0][0][0]=="PtgExp"){var De=Le[0][0][1][0],Ye=Le[0][0][1][1],qe=Ze({r:De,c:Ye});_[qe]?E.f=""+pa(X.formula,f,X.cell,ae,ee):E.F=((n.dense?(i[De]||[])[Ye]:i[qe])||{}).F}else E.f=""+pa(X.formula,f,X.cell,ae,ee)}A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K(X.cell,E,n),d=X}break;case 7:case 519:if(d)d.val=X,E=V0(X,d.cell.ixfe,"s"),E.XF=G[E.ixfe],n.cellFormula&&(E.f=""+pa(d.formula,f,d.cell,ae,ee)),A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K(d.cell,E,n),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(X);var ze=Ze(X[0].s);if(k=n.dense?(i[X[0].s.r]||[])[X[0].s.c]:i[ze],n.cellFormula&&k){if(!d||!ze||!k)break;k.f=""+pa(X[1],f,X[0],ae,ee),k.F=dt(X[0])}}break;case 1212:{if(!n.cellFormula)break;if(b){if(!d)break;_[Ze(d.cell)]=X[0],k=n.dense?(i[d.cell.r]||[])[d.cell.c]:i[Ze(d.cell)],(k||{}).f=""+pa(X[0],f,v,ae,ee)}}break;case 253:E=V0(m[X.isst].t,X.ixfe,"s"),m[X.isst].h&&(E.h=m[X.isst].h),E.XF=G[E.ixfe],A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:X.c,r:X.r},E,n);break;case 513:n.sheetStubs&&(E={ixfe:X.ixfe,XF:G[X.ixfe],t:"z"},A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:X.c,r:X.r},E,n));break;case 190:if(n.sheetStubs)for(var Pe=X.c;Pe<=X.C;++Pe){var Ue=X.ixfe[Pe-X.c];E={ixfe:Ue,XF:G[Ue],t:"z"},A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:Pe,r:X.r},E,n)}break;case 214:case 516:case 4:E=V0(X.val,X.ixfe,"s"),E.XF=G[E.ixfe],A>0&&(E.z=q[E.ixfe>>8&63]),Rr(E,n,a.opts.Date1904),K({c:X.c,r:X.r},E,n);break;case 0:case 512:B===1&&(f=X);break;case 252:m=X;break;case 1054:if(ee.biff==4){q[A++]=X[1];for(var ha=0;ha<A+163&&Qe[ha]!=X[1];++ha);ha>=163&&ys(X[1],A+163)}else ys(X[1],X[0]);break;case 30:{q[A++]=X;for(var zt=0;zt<A+163&&Qe[zt]!=X;++zt);zt>=163&&ys(X,A+163)}break;case 229:Ne=Ne.concat(X);break;case 93:me[X.cmo[0]]=ee.lastobj=X;break;case 438:ee.lastobj.TxO=X;break;case 127:ee.lastobj.ImData=X;break;case 440:for(N=X[0].s.r;N<=X[0].e.r;++N)for(w=X[0].s.c;w<=X[0].e.c;++w)k=n.dense?(i[N]||[])[w]:i[Ze({c:w,r:N})],k&&(k.l=X[1]);break;case 2048:for(N=X[0].s.r;N<=X[0].e.r;++N)for(w=X[0].s.c;w<=X[0].e.c;++w)k=n.dense?(i[N]||[])[w]:i[Ze({c:w,r:N})],k&&k.l&&(k.l.Tooltip=X[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;k=n.dense?(i[X[0].r]||[])[X[0].c]:i[Ze(X[0])];var Wa=me[X[2]];k||(n.dense?(i[X[0].r]||(i[X[0].r]=[]),k=i[X[0].r][X[0].c]={t:"z"}):k=i[Ze(X[0])]={t:"z"},f.e.r=Math.max(f.e.r,X[0].r),f.s.r=Math.min(f.s.r,X[0].r),f.e.c=Math.max(f.e.c,X[0].c),f.s.c=Math.min(f.s.c,X[0].c)),k.c||(k.c=[]),y={a:X[1],t:Wa.TxO.t},k.c.push(y)}break;case 2173:C_(G[X.ixfe],X.ext);break;case 125:{if(!ee.cellStyles)break;for(;X.e>=X.s;)J[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},Ae||(Ae=!0,dh(X.w/256)),El(J[X.e+1])}break;case 520:{var Gt={};X.level!=null&&(se[X.r]=Gt,Gt.level=X.level),X.hidden&&(se[X.r]=Gt,Gt.hidden=!0),X.hpt&&(se[X.r]=Gt,Gt.hpt=X.hpt,Gt.hpx=tc(X.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Pi(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Te]]=X;break;case 161:i["!margins"]||Pi(i["!margins"]={}),i["!margins"].header=X.header,i["!margins"].footer=X.footer;break;case 574:X.RTL&&(R.Views[0].RTL=!0);break;case 146:H=X;break;case 2198:Ee=X;break;case 140:L=X;break;case 442:x?Z.CodeName=X||Z.name:R.WBProps.CodeName=X||"ThisWorkbook";break}}else ke||console.error("Missing Info for XLS Record 0x"+Te.toString(16)),e.l+=ge}return a.SheetNames=Lr(u).sort(function(Za,et){return Number(Za)-Number(et)}).map(function(Za){return u[Za].name}),n.bookSheets||(a.Sheets=s),!a.SheetNames.length&&g["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=g)):a.Preamble=g,a.Sheets&&V.forEach(function(Za,et){a.Sheets[a.SheetNames[et]]["!autofilter"]=Za}),a.Strings=m,a.SSF=fa(Qe),ee.enc&&(a.Encryption=ee.enc),Ee&&(a.Themes=Ee),a.Metadata={},L!==void 0&&(a.Metadata.Country=L),ae.names.length>0&&(R.Names=ae.names),a.Workbook=R,a}var Ag={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cC(e,n,a){var s=ft.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var i=fg(s,N3,Ag.DSI);for(var u in i)n[u]=i[u]}catch(x){if(a.WTF)throw x}var f=ft.find(e,"/!SummaryInformation");if(f&&f.size>0)try{var d=fg(f,T3,Ag.SI);for(var m in d)n[m]==null&&(n[m]=d[m])}catch(x){if(a.WTF)throw x}n.HeadingPairs&&n.TitlesOfParts&&(m2(n.HeadingPairs,n.TitlesOfParts,n,a),delete n.HeadingPairs,delete n.TitlesOfParts)}function J2(e,n){n||(n={}),gh(n),_v(),n.codepage&&Kd(n.codepage);var a,s;if(e.FullPaths){if(ft.find(e,"/encryption"))throw new Error("File is password-protected");a=ft.find(e,"!CompObj"),s=ft.find(e,"/Workbook")||ft.find(e,"/Book")}else{switch(n.type){case"base64":e=wr(qa(e));break;case"binary":e=wr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ua(e,0),s={content:e}}var i,u;if(a&&nC(a),n.bookProps&&!n.bookSheets)i={};else{var f=ut?"buffer":"array";if(s&&s.content)i=iC(s.content,n);else if((u=ft.find(e,"PerfectOffice_MAIN"))&&u.content)i=zi.to_workbook(u.content,(n.type=f,n));else if((u=ft.find(e,"NativeContent_MAIN"))&&u.content)i=zi.to_workbook(u.content,(n.type=f,n));else throw(u=ft.find(e,"MN0"))&&u.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&ft.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=Y_(e))}var d={};return e.FullPaths&&cC(e,d,n),i.Props=i.Custprops=d,n.bookFiles&&(i.cfb=e),i}var mo={0:{f:V6},1:{f:Y6},2:{f:a8},3:{f:Z6},4:{f:K6},5:{f:t8},6:{f:s8},7:{f:Q6},8:{f:u8},9:{f:o8},10:{f:i8},11:{f:c8},12:{f:q6},13:{f:r8},14:{f:J6},15:{f:W6},16:{f:Y2},17:{f:l8},18:{f:e8},19:{f:lh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:I8},40:{},42:{},43:{f:i_},44:{f:l_},45:{f:c_},46:{f:u_},47:{f:o_},48:{},49:{f:f3},50:{},51:{f:O_},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:_2},62:{f:n8},63:{f:L_},64:{f:b8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ya,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:v8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:X6},148:{f:G6,p:16},151:{f:h8},152:{},153:{f:M8},154:{},155:{},156:{f:F8},157:{},158:{},159:{T:1,f:T5},160:{T:-1},161:{T:1,f:As},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:f8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:j_},336:{T:-1},337:{f:R_,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:T2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:x8},427:{f:m8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:g8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:d8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:G_},633:{T:1},634:{T:-1},635:{T:1,f:V_},636:{T:-1},637:{f:h3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:N8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:y8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Nd={6:{f:td},10:{f:Bn},12:{f:Zt},13:{f:Zt},14:{f:Vt},15:{f:Vt},16:{f:ga},17:{f:Vt},18:{f:Vt},19:{f:Zt},20:{f:mg},21:{f:mg},23:{f:T2},24:{f:gg},25:{f:Vt},26:{},27:{},28:{f:PT},29:{},34:{f:Vt},35:{f:pg},38:{f:ga},39:{f:ga},40:{f:ga},41:{f:ga},42:{f:Vt},43:{f:Vt},47:{f:$5},49:{f:wT},51:{f:Zt},60:{},61:{f:bT},64:{f:Vt},65:{f:kT},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:fT},93:{f:VT},94:{},95:{f:Vt},96:{},97:{},99:{f:Vt},125:{f:_2},128:{f:RT},129:{f:dT},130:{f:Zt},131:{f:Vt},132:{f:Vt},133:{f:hT},134:{},140:{f:KT},141:{f:Zt},144:{},146:{f:ZT},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:a5},161:{f:QT},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:AT},190:{f:CT},193:{f:Bn},197:{},198:{},199:{},200:{},201:{},202:{f:Vt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:Vt},222:{},224:{f:OT},225:{f:uT},226:{f:Bn},227:{},229:{f:HT},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:xT},253:{f:ST},255:{f:mT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:y2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Vt},353:{f:Bn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:FT},431:{f:Vt},432:{},433:{},434:{},437:{},438:{f:XT},439:{f:Vt},440:{f:YT},441:{},442:{f:uc},443:{},444:{f:Zt},445:{},446:{},448:{f:Bn},449:{f:vT,r:2},450:{f:Bn},512:{f:hg},513:{f:t5},515:{f:DT},516:{f:ET},517:{f:xg},519:{f:r5},520:{f:pT},523:{},545:{f:vg},549:{f:dg},566:{},574:{f:yT},638:{f:_T},659:{},1048:{},1054:{f:NT},1084:{},1212:{f:BT},2048:{f:qT},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:U0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JT,r:12},2173:{f:A_,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Vt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:IT,r:12},2197:{},2198:{f:w_,r:12},2199:{},2200:{},2201:{},2202:{f:zT,r:12},2203:{f:Bn},2204:{},2205:{},2206:{},2207:{},2211:{f:gT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:e5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:WT},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:hg},1:{},2:{f:i5},3:{f:l5},4:{f:s5},5:{f:xg},7:{f:c5},8:{},9:{f:U0},11:{},22:{f:Zt},30:{f:TT},31:{},32:{},33:{f:vg},36:{},37:{f:dg},50:{f:o5},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:n5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:u5},223:{},234:{},354:{},421:{},518:{f:td},521:{f:U0},536:{f:gg},547:{f:pg},561:{},579:{},1030:{f:td},1033:{f:U0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function kr(e,n,a,s){var i=n;if(!isNaN(i)){var u=(a||[]).length||0,f=e.next(4);f.write_shift(2,i),f.write_shift(2,u),u>0&&i2(a)&&e.push(a)}}function Cg(e,n){var a=n||{},s=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var u=e.match(/<\/table/i),f=i.index,d=u&&u.index||e.length,m=DN(e.slice(f,d),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,g=0,v=0,b=0,k={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(f=0;f<m.length;++f){var w=m[f].trim(),N=w.slice(0,3).toLowerCase();if(N=="<tr"){if(++x,a.sheetRows&&a.sheetRows<=x){--x;break}g=0;continue}if(!(N!="<td"&&N!="<th")){var _=w.split(/<\/t[dh]>/i);for(d=0;d<_.length;++d){var O=_[d].trim();if(O.match(/<t[dh]/i)){for(var E=O,L=0;E.charAt(0)=="<"&&(L=E.indexOf(">"))>-1;)E=E.slice(L+1);for(var G=0;G<y.length;++G){var H=y[G];H.s.c==g&&H.s.r<x&&x<=H.e.r&&(g=H.e.c+1,G=-1)}var R=Ke(O.slice(0,O.indexOf(">")));b=R.colspan?+R.colspan:1,((v=+R.rowspan)>1||b>1)&&y.push({s:{r:x,c:g},e:{r:x+(v||1)-1,c:g+b-1}});var Z=R.t||R["data-t"]||"";if(!E.length){g+=b;continue}if(E=qv(E),k.s.r>x&&(k.s.r=x),k.e.r<x&&(k.e.r=x),k.s.c>g&&(k.s.c=g),k.e.c<g&&(k.e.c=g),!E.length){g+=b;continue}var Y={t:"s",v:E};a.raw||!E.trim().length||Z=="s"||(E==="TRUE"?Y={t:"b",v:!0}:E==="FALSE"?Y={t:"b",v:!1}:isNaN(Tr(E))?isNaN(Sl(E).getDate())||(Y={t:"d",v:sa(E)},a.cellDates||(Y={t:"n",v:Aa(Y.v)}),Y.z=a.dateNF||Qe[14]):Y={t:"n",v:Tr(E)}),a.dense?(s[x]||(s[x]=[]),s[x][g]=Y):s[Ze({r:x,c:g})]=Y,g+=b}}}}return s["!ref"]=dt(k),y.length&&(s["!merges"]=y),s}function oC(e,n,a,s){for(var i=e["!merges"]||[],u=[],f=n.s.c;f<=n.e.c;++f){for(var d=0,m=0,x=0;x<i.length;++x)if(!(i[x].s.r>a||i[x].s.c>f)&&!(i[x].e.r<a||i[x].e.c<f)){if(i[x].s.r<a||i[x].s.c<f){d=-1;break}d=i[x].e.r-i[x].s.r+1,m=i[x].e.c-i[x].s.c+1;break}if(!(d<0)){var g=Ze({r:a,c:f}),v=s.dense?(e[a]||[])[f]:e[g],b=v&&v.v!=null&&(v.h||th(v.w||(fn(v),v.w)||""))||"",k={};d>1&&(k.rowspan=d),m>1&&(k.colspan=m),s.editable?b='<span contenteditable="true">'+b+"</span>":v&&(k["data-t"]=v&&v.t||"z",v.v!=null&&(k["data-v"]=v.v),v.z!=null&&(k["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+v.l.Target+'">'+b+"</a>")),k.id=(s.id||"sjs")+"-"+g,u.push(KN("td",b,k))}}var y="<tr>";return y+u.join("")+"</tr>"}var uC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fC="</body></html>";function dC(e,n){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return Kn(Cg(a[0],n),n);var s=bh();return a.forEach(function(i,u){yh(s,Cg(i,n),"Sheet"+(u+1))}),s}function hC(e,n,a){var s=[];return s.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function xC(e,n){var a=n||{},s=a.header!=null?a.header:uC,i=a.footer!=null?a.footer:fC,u=[s],f=Cl(e["!ref"]);a.dense=Array.isArray(e),u.push(hC(e,f,a));for(var d=f.s.r;d<=f.e.r;++d)u.push(oC(e,f,d,a));return u.push("</table>"+i),u.join("")}function Q2(e,n,a){var s=a||{},i=0,u=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var f=typeof s.origin=="string"?Ta(s.origin):s.origin;i=f.r,u=f.c}var d=n.getElementsByTagName("tr"),m=Math.min(s.sheetRows||1e7,d.length),x={s:{r:0,c:0},e:{r:i,c:u}};if(e["!ref"]){var g=Cl(e["!ref"]);x.s.r=Math.min(x.s.r,g.s.r),x.s.c=Math.min(x.s.c,g.s.c),x.e.r=Math.max(x.e.r,g.e.r),x.e.c=Math.max(x.e.c,g.e.c),i==-1&&(x.e.r=i=g.e.r+1)}var v=[],b=0,k=e["!rows"]||(e["!rows"]=[]),y=0,w=0,N=0,_=0,O=0,E=0;for(e["!cols"]||(e["!cols"]=[]);y<d.length&&w<m;++y){var L=d[y];if(jg(L)){if(s.display)continue;k[w]={hidden:!0}}var G=L.children;for(N=_=0;N<G.length;++N){var H=G[N];if(!(s.display&&jg(H))){var R=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):qv(H.innerHTML),Z=H.getAttribute("data-z")||H.getAttribute("z");for(b=0;b<v.length;++b){var Y=v[b];Y.s.c==_+u&&Y.s.r<w+i&&w+i<=Y.e.r&&(_=Y.e.c+1-u,b=-1)}E=+H.getAttribute("colspan")||1,((O=+H.getAttribute("rowspan")||1)>1||E>1)&&v.push({s:{r:w+i,c:_+u},e:{r:w+i+(O||1)-1,c:_+u+(E||1)-1}});var Q={t:"s",v:R},K=H.getAttribute("data-t")||H.getAttribute("t")||"";R!=null&&(R.length==0?Q.t=K||"z":s.raw||R.trim().length==0||K=="s"||(R==="TRUE"?Q={t:"b",v:!0}:R==="FALSE"?Q={t:"b",v:!1}:isNaN(Tr(R))?isNaN(Sl(R).getDate())||(Q={t:"d",v:sa(R)},s.cellDates||(Q={t:"n",v:Aa(Q.v)}),Q.z=s.dateNF||Qe[14]):Q={t:"n",v:Tr(R)})),Q.z===void 0&&Z!=null&&(Q.z=Z);var ee="",Ee=H.getElementsByTagName("A");if(Ee&&Ee.length)for(var Ne=0;Ne<Ee.length&&!(Ee[Ne].hasAttribute("href")&&(ee=Ee[Ne].getAttribute("href"),ee.charAt(0)!="#"));++Ne);ee&&ee.charAt(0)!="#"&&(Q.l={Target:ee}),s.dense?(e[w+i]||(e[w+i]=[]),e[w+i][_+u]=Q):e[Ze({c:_+u,r:w+i})]=Q,x.e.c<_+u&&(x.e.c=_+u),_+=E}}++w}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),x.e.r=Math.max(x.e.r,w-1+i),e["!ref"]=dt(x),w>=m&&(e["!fullref"]=dt((x.e.r=d.length-y+w-1+i,x))),e}function eb(e,n){var a=n||{},s=a.dense?[]:{};return Q2(s,e,n)}function mC(e,n){return Kn(eb(e,n),n)}function jg(e){var n="",a=pC(e);return a&&(n=a(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function pC(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function gC(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=ht(n.replace(/<[^>]*>/g,""));return[a]}var Og={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tb(e,n){var a=n||{},s=ah(e),i=[],u,f,d={name:""},m="",x=0,g,v,b={},k=[],y=a.dense?[]:{},w,N,_={value:""},O="",E=0,L=[],G=-1,H=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},Z=0,Y={},Q=[],K={},ee=0,Ee=0,Ne=[],me=1,J=1,se=[],Ae={Names:[]},ae={},Ce=["",""],B=[],A={},q="",V=0,T=!1,z=!1,ne=0;for(Ji.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=Ji.exec(s);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?y["!ref"]=dt(R):y["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=R.e.r&&(y["!fullref"]=y["!ref"],R.e.r=a.sheetRows-1,y["!ref"]=dt(R)),Q.length&&(y["!merges"]=Q),Ne.length&&(y["!rows"]=Ne),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),k.push(g.name),b[g.name]=y,z=!1):w[0].charAt(w[0].length-2)!=="/"&&(g=Ke(w[0],!1),G=H=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,y=a.dense?[]:{},Q=[],Ne=[],z=!0);break;case"table-row-group":w[1]==="/"?--Z:++Z;break;case"table-row":case"":if(w[1]==="/"){G+=me,me=1;break}if(v=Ke(w[0],!1),v.?G=v.-1:G==-1&&(G=0),me=+v["number-rows-repeated"]||1,me<10)for(ne=0;ne<me;++ne)Z>0&&(Ne[G+ne]={level:Z});H=-1;break;case"covered-table-cell":w[1]!=="/"&&++H,a.sheetStubs&&(a.dense?(y[G]||(y[G]=[]),y[G][H]={t:"z"}):y[Ze({r:G,c:H})]={t:"z"}),O="",L=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++H,_=Ke(w[0],!1),J=parseInt(_["number-columns-repeated"]||"1",10),N={t:"z",v:null},_.formula&&a.cellFormula!=!1&&(N.f=Ng(ht(_.formula))),(_.||_["value-type"])=="string"&&(N.t="s",N.v=ht(_["string-value"]||""),a.dense?(y[G]||(y[G]=[]),y[G][H]=N):y[Ze({r:G,c:H})]=N),H+=J-1;else if(w[1]!=="/"){++H,O="",E=0,L=[],J=1;var Te=me?G+me-1:G;if(H>R.e.c&&(R.e.c=H),H<R.s.c&&(R.s.c=H),G<R.s.r&&(R.s.r=G),Te>R.e.r&&(R.e.r=Te),_=Ke(w[0],!1),B=[],A={},N={t:_.||_["value-type"],v:null},a.cellFormula)if(_.formula&&(_.formula=ht(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(ee=parseInt(_["number-matrix-rows-spanned"],10)||0,Ee=parseInt(_["number-matrix-columns-spanned"],10)||0,K={s:{r:G,c:H},e:{r:G+ee-1,c:H+Ee-1}},N.F=dt(K),se.push([K,N.F])),_.formula)N.f=Ng(_.formula);else for(ne=0;ne<se.length;++ne)G>=se[ne][0].s.r&&G<=se[ne][0].e.r&&H>=se[ne][0].s.c&&H<=se[ne][0].e.c&&(N.F=se[ne][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(ee=parseInt(_["number-rows-spanned"],10)||0,Ee=parseInt(_["number-columns-spanned"],10)||0,K={s:{r:G,c:H},e:{r:G+ee-1,c:H+Ee-1}},Q.push(K)),_["number-columns-repeated"]&&(J=parseInt(_["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=Ot(_["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(_.value);break;case"percentage":N.t="n",N.v=parseFloat(_.value);break;case"currency":N.t="n",N.v=parseFloat(_.value);break;case"date":N.t="d",N.v=sa(_["date-value"]),a.cellDates||(N.t="n",N.v=Aa(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=jN(_["time-value"])/86400,a.cellDates&&(N.t="d",N.v=yo(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(_.);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",_["string-value"]!=null&&(O=ht(_["string-value"]),L=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(T=!1,N.t==="s"&&(N.v=O||"",L.length&&(N.R=L),T=E==0),ae.Target&&(N.l=ae),B.length>0&&(N.c=B,B=[]),O&&a.cellText!==!1&&(N.w=O),T&&(N.t="z",delete N.v),(!T||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=G))for(var ge=0;ge<me;++ge){if(J=parseInt(_["number-columns-repeated"]||"1",10),a.dense)for(y[G+ge]||(y[G+ge]=[]),y[G+ge][H]=ge==0?N:fa(N);--J>0;)y[G+ge][H+J]=fa(N);else for(y[Ze({r:G+ge,c:H})]=N;--J>0;)y[Ze({r:G+ge,c:H+J})]=fa(N);R.e.c<=H&&(R.e.c=H)}J=parseInt(_["number-columns-repeated"]||"1",10),H+=J-1,J=0,N={},O="",L=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((u=i.pop())[0]!==w[3])throw"Bad state: "+u}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((u=i.pop())[0]!==w[3])throw"Bad state: "+u;A.t=O,L.length&&(A.R=L),A.a=q,B.push(A)}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!1]);q="",V=0,O="",E=0,L=[];break;case"creator":w[1]==="/"?q=s.slice(V,w.index):V=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((u=i.pop())[0]!==w[3])throw"Bad state: "+u}else w[0].charAt(w[0].length-2)!=="/"&&i.push([w[3],!1]);O="",E=0,L=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(Y[d.name]=m,(u=i.pop())[0]!==w[3])throw"Bad state: "+u}else w[0].charAt(w[0].length-2)!=="/"&&(m="",d=Ke(w[0],!1),i.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":f=Ke(w[0],!1),m+=Og[w[3]][f.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":f=Ke(w[0],!1),m+=Og[w[3]][f.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":m+=s.slice(x,w.index);break}else x=w.index+w[0].length;break;case"named-range":f=Ke(w[0],!1),Ce=ad(f["cell-range-address"]);var ke={Name:f.name,Ref:Ce[0]+"!"+Ce[1]};z&&(ke.Sheet=k.length),Ae.Names.push(ke);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(w[1]==="/"&&(!_||!_["string-value"])){var $e=gC(s.slice(E,w.index));O=(O.length>0?O+`
`:"")+$e[0]}else Ke(w[0],!1),E=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Ce=ad(Ke(w[0])["target-range-address"]),b[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ae=Ke(w[0],!1),!ae.href)break;ae.Target=ht(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Ce=ad(ae.Target.slice(1)),ae.Target="#"+Ce[0]+"!"+Ce[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(w)}}var X={Sheets:b,SheetNames:k,Workbook:Ae};return a.bookSheets&&delete X.Sheets,X}function Rg(e,n){n=n||{},dr(e,"META-INF/manifest.xml")&&D3(Wt(e,"META-INF/manifest.xml"),n);var a=Ya(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=tb(Nt(a),n);return dr(e,"meta.xml")&&(s.Props=x2(Wt(e,"meta.xml"))),s}function Dg(e,n){return tb(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function mh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Td(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Nt(Ts(e))}function _d(e){var n=e.reduce(function(i,u){return i+u.length},0),a=new Uint8Array(n),s=0;return e.forEach(function(i){a.set(i,s),s+=i.length}),a}function Fg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function vC(e,n){for(var a=(e[n+15]&127)<<7|e[n+14]>>1,s=e[n+14]&1,i=n+13;i>=n;--i)s=s*256+e[i];return(e[n+15]&128?-s:s)*Math.pow(10,a-6176)}function ac(e,n){var a=n?n[0]:0,s=e[a]&127;e:if(e[a++]>=128&&(s|=(e[a]&127)<<7,e[a++]<128||(s|=(e[a]&127)<<14,e[a++]<128)||(s|=(e[a]&127)<<21,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return n&&(n[0]=a),s}function aa(e){var n=0,a=e[n]&127;e:if(e[n++]>=128){if(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128))break e;a|=(e[n]&127)<<28}return a}function va(e){for(var n=[],a=[0];a[0]<e.length;){var s=a[0],i=ac(e,a),u=i&7;i=Math.floor(i/8);var f=0,d;if(i==0)break;switch(u){case 0:{for(var m=a[0];e[a[0]++]>=128;);d=e.slice(m,a[0])}break;case 5:f=4,d=e.slice(a[0],a[0]+f),a[0]+=f;break;case 1:f=8,d=e.slice(a[0],a[0]+f),a[0]+=f;break;case 2:f=ac(e,a),d=e.slice(a[0],a[0]+f),a[0]+=f;break;case 3:case 4:default:throw new Error("PB Type ".concat(u," for Field ").concat(i," at offset ").concat(s))}var x={data:d,type:u};n[i]==null?n[i]=[x]:n[i].push(x)}return n}function ph(e,n){return(e==null?void 0:e.map(function(a){return n(a.data)}))||[]}function bC(e){for(var n,a=[],s=[0];s[0]<e.length;){var i=ac(e,s),u=va(e.slice(s[0],s[0]+i));s[0]+=i;var f={id:aa(u[1][0].data),messages:[]};u[2].forEach(function(d){var m=va(d.data),x=aa(m[3][0].data);f.messages.push({meta:m,data:e.slice(s[0],s[0]+x)}),s[0]+=x}),(n=u[3])!=null&&n[0]&&(f.merge=aa(u[3][0].data)>>>0>0),a.push(f)}return a}function yC(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],s=ac(n,a),i=[];a[0]<n.length;){var u=n[a[0]]&3;if(u==0){var f=n[a[0]++]>>2;if(f<60)++f;else{var d=f-59;f=n[a[0]],d>1&&(f|=n[a[0]+1]<<8),d>2&&(f|=n[a[0]+2]<<16),d>3&&(f|=n[a[0]+3]<<24),f>>>=0,f++,a[0]+=d}i.push(n.slice(a[0],a[0]+f)),a[0]+=f;continue}else{var m=0,x=0;if(u==1?(x=(n[a[0]]>>2&7)+4,m=(n[a[0]++]&224)<<3,m|=n[a[0]++]):(x=(n[a[0]++]>>2)+1,u==2?(m=n[a[0]]|n[a[0]+1]<<8,a[0]+=2):(m=(n[a[0]]|n[a[0]+1]<<8|n[a[0]+2]<<16|n[a[0]+3]<<24)>>>0,a[0]+=4)),i=[_d(i)],m==0)throw new Error("Invalid offset 0");if(m>i[0].length)throw new Error("Invalid offset beyond length");if(x>=m)for(i.push(i[0].slice(-m)),x-=m;x>=i[i.length-1].length;)i.push(i[i.length-1]),x-=i[i.length-1].length;i.push(i[0].slice(-m,-m+x))}}var g=_d(i);if(g.length!=s)throw new Error("Unexpected length: ".concat(g.length," != ").concat(s));return g}function kC(e){for(var n=[],a=0;a<e.length;){var s=e[a++],i=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,n.push(yC(s,e.slice(a,a+i))),a+=i}if(a!==e.length)throw new Error("data is not a valid framed stream!");return _d(n)}function wC(e,n,a,s){var i=mh(e),u=i.getUint32(4,!0),f=(s>1?12:8)+Fg(u&(s>1?3470:398))*4,d=-1,m=-1,x=NaN,g=new Date(2001,0,1);u&512&&(d=i.getUint32(f,!0),f+=4),f+=Fg(u&(s>1?12288:4096))*4,u&16&&(m=i.getUint32(f,!0),f+=4),u&32&&(x=i.getFloat64(f,!0),f+=8),u&64&&(g.setTime(g.getTime()+i.getFloat64(f,!0)*1e3),f+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:x};break;case 3:v={t:"s",v:n[m]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:x>0};break;case 7:v={t:"n",v:x/86400};break;case 8:v={t:"e",v:0};break;case 9:if(d>-1)v={t:"s",v:a[d]};else if(m>-1)v={t:"s",v:n[m]};else if(!isNaN(x))v={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function SC(e,n,a){var s=mh(e),i=s.getUint32(8,!0),u=12,f=-1,d=-1,m=NaN,x=NaN,g=new Date(2001,0,1);i&1&&(m=vC(e,u),u+=16),i&2&&(x=s.getFloat64(u,!0),u+=8),i&4&&(g.setTime(g.getTime()+s.getFloat64(u,!0)*1e3),u+=8),i&8&&(d=s.getUint32(u,!0),u+=4),i&16&&(f=s.getUint32(u,!0),u+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:n[d]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:x>0};break;case 7:v={t:"n",v:x/86400};break;case 8:v={t:"e",v:0};break;case 9:if(f>-1)v={t:"s",v:a[f]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return v}function EC(e,n,a){switch(e[0]){case 0:case 1:case 2:case 3:return wC(e,n,a,e[0]);case 5:return SC(e,n,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function $n(e){var n=va(e);return ac(n[1][0].data)}function Mg(e,n){var a=va(n.data),s=aa(a[1][0].data),i=a[3],u=[];return(i||[]).forEach(function(f){var d=va(f.data),m=aa(d[1][0].data)>>>0;switch(s){case 1:u[m]=Td(d[3][0].data);break;case 8:{var x=e[$n(d[9][0].data)][0],g=va(x.data),v=e[$n(g[1][0].data)][0],b=aa(v.meta[1][0].data);if(b!=2001)throw new Error("2000 unexpected reference to ".concat(b));var k=va(v.data);u[m]=k[3].map(function(y){return Td(y.data)}).join("")}break}}),u}function NC(e,n){var a,s,i,u,f,d,m,x,g,v,b,k,y,w,N=va(e),_=aa(N[1][0].data)>>>0,O=aa(N[2][0].data)>>>0,E=((s=(a=N[8])==null?void 0:a[0])==null?void 0:s.data)&&aa(N[8][0].data)>0||!1,L,G;if((u=(i=N[7])==null?void 0:i[0])!=null&&u.data&&n!=0)L=(d=(f=N[7])==null?void 0:f[0])==null?void 0:d.data,G=(x=(m=N[6])==null?void 0:m[0])==null?void 0:x.data;else if((v=(g=N[4])==null?void 0:g[0])!=null&&v.data&&n!=1)L=(k=(b=N[4])==null?void 0:b[0])==null?void 0:k.data,G=(w=(y=N[3])==null?void 0:y[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var H=E?4:1,R=mh(L),Z=[],Y=0;Y<L.length/2;++Y){var Q=R.getUint16(Y*2,!0);Q<65535&&Z.push([Y,Q])}if(Z.length!=O)throw"Expected ".concat(O," cells, found ").concat(Z.length);var K=[];for(Y=0;Y<Z.length-1;++Y)K[Z[Y][0]]=G.subarray(Z[Y][1]*H,Z[Y+1][1]*H);return Z.length>=1&&(K[Z[Z.length-1][0]]=G.subarray(Z[Z.length-1][1]*H)),{R:_,cells:K}}function TC(e,n){var a,s=va(n.data),i=(a=s==null?void 0:s[7])!=null&&a[0]?aa(s[7][0].data)>>>0>0?1:0:-1,u=ph(s[5],function(f){return NC(f,i)});return{nrows:aa(s[4][0].data)>>>0,data:u.reduce(function(f,d){return f[d.R]||(f[d.R]=[]),d.cells.forEach(function(m,x){if(f[d.R][x])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(x));f[d.R][x]=m}),f},[])}}function _C(e,n,a){var s,i=va(n.data),u={s:{r:0,c:0},e:{r:0,c:0}};if(u.e.r=(aa(i[6][0].data)>>>0)-1,u.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(u.e.c=(aa(i[7][0].data)>>>0)-1,u.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));a["!ref"]=dt(u);var f=va(i[4][0].data),d=Mg(e,e[$n(f[4][0].data)][0]),m=(s=f[17])!=null&&s[0]?Mg(e,e[$n(f[17][0].data)][0]):[],x=va(f[3][0].data),g=0;x[1].forEach(function(v){var b=va(v.data),k=e[$n(b[2][0].data)][0],y=aa(k.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var w=TC(e,k);w.data.forEach(function(N,_){N.forEach(function(O,E){var L=Ze({r:g+_,c:E}),G=EC(O,d,m);G&&(a[L]=G)})}),g+=w.nrows})}function AC(e,n){var a=va(n.data),s={"!ref":"A1"},i=e[$n(a[2][0].data)],u=aa(i[0].meta[1][0].data);if(u!=6001)throw new Error("6000 unexpected reference to ".concat(u));return _C(e,i[0],s),s}function CC(e,n){var a,s=va(n.data),i={name:(a=s[1])!=null&&a[0]?Td(s[1][0].data):"",sheets:[]},u=ph(s[2],$n);return u.forEach(function(f){e[f].forEach(function(d){var m=aa(d.meta[1][0].data);m==6e3&&i.sheets.push(AC(e,d))})}),i}function jC(e,n){var a=bh(),s=va(n.data),i=ph(s[1],$n);if(i.forEach(function(u){e[u].forEach(function(f){var d=aa(f.meta[1][0].data);if(d==2){var m=CC(e,f);m.sheets.forEach(function(x,g){yh(a,x,g==0?m.name:m.name+"_"+g,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function nd(e){var n,a,s,i,u={},f=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var x;try{x=kC(m.content)}catch(v){return console.log("?? "+m.content.length+" "+(v.message||v))}var g;try{g=bC(x)}catch(v){return console.log("## "+(v.message||v))}g.forEach(function(v){u[v.id]=v.messages,f.push(v.id)})}}),!f.length)throw new Error("File has no messages");var d=((i=(s=(a=(n=u==null?void 0:u[1])==null?void 0:n[0])==null?void 0:a.meta)==null?void 0:s[1])==null?void 0:i[0].data)&&aa(u[1][0].meta[1][0].data)==1&&u[1][0];if(d||f.forEach(function(m){u[m].forEach(function(x){var g=aa(x.meta[1][0].data)>>>0;if(g==1)if(!d)d=x;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return jC(u,d)}function OC(e){return function(a){for(var s=0;s!=e.length;++s){var i=e[s];a[i[0]]===void 0&&(a[i[0]]=i[1]),i[2]==="n"&&(a[i[0]]=Number(a[i[0]]))}}}function gh(e){OC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function RC(e){return gl.WS.indexOf(e)>-1?"sheet":e==gl.CS?"chart":e==gl.DS?"dialog":e==gl.MS?"macro":e&&e.length?e:"sheet"}function DC(e,n){if(!e)return 0;try{e=n.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,RC(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function FC(e,n,a,s,i,u,f,d,m,x,g,v){try{u[s]=Ii(Ya(e,a,!0),n);var b=Wt(e,n),k;switch(d){case"sheet":k=U8(b,n,i,m,u[s],x,g,v);break;case"chart":if(k=P8(b,n,i,m,u[s],x,g,v),!k||!k["!drawel"])break;var y=ji(k["!drawel"].Target,n),w=kd(y),N=z_(Ya(e,y,!0),Ii(Ya(e,w,!0),y)),_=ji(N,y),O=kd(_);k=S8(Ya(e,_,!0),_,m,Ii(Ya(e,O,!0),_),x,k);break;case"macro":k=H8(b,n,i,m,u[s],x,g,v);break;case"dialog":k=V8(b,n,i,m,u[s],x,g,v);break;default:throw new Error("Unrecognized sheet type "+d)}f[s]=k;var E=[];u&&u[s]&&Lr(u[s]).forEach(function(L){var G="";if(u[s][L].Type==gl.CMNT){G=ji(u[s][L].Target,n);var H=Y8(Wt(e,G,!0),G,m);if(!H||!H.length)return;yg(k,H,!1)}u[s][L].Type==gl.TCMNT&&(G=ji(u[s][L].Target,n),E=E.concat(P_(Wt(e,G,!0),m)))}),E&&E.length&&yg(k,E,!0,m.people||[])}catch(L){if(m.WTF)throw L}}function ur(e){return e.charAt(0)=="/"?e.slice(1):e}function MC(e,n){if(zv(),n=n||{},gh(n),dr(e,"META-INF/manifest.xml")||dr(e,"objectdata.xml"))return Rg(e,n);if(dr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof nd<"u"){if(e.FileIndex)return nd(e);var a=ft.utils.cfb_new();return Yp(e).forEach(function(Ne){LN(a,Ne,MN(e,Ne))}),nd(a)}throw new Error("Unsupported NUMBERS file")}if(!dr(e,"[Content_Types].xml"))throw dr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):dr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=Yp(e),i=O3(Ya(e,"[Content_Types].xml")),u=!1,f,d;if(i.workbooks.length===0&&(d="xl/workbook.xml",Wt(e,d,!0)&&i.workbooks.push(d)),i.workbooks.length===0){if(d="xl/workbook.bin",!Wt(e,d,!0))throw new Error("Could not find workbook");i.workbooks.push(d),u=!0}i.workbooks[0].slice(-3)=="bin"&&(u=!0);var m={},x={};if(!n.bookSheets&&!n.bookProps){if(Ui=[],i.sst)try{Ui=X8(Wt(e,ur(i.sst)),i.sst,n)}catch(Ne){if(n.WTF)throw Ne}n.cellStyles&&i.themes.length&&(m=$8(Ya(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],n)),i.style&&(x=G8(Wt(e,ur(i.style)),i.style,m,n))}i.links.map(function(Ne){try{var me=Ii(Ya(e,kd(ur(Ne))),Ne);return K8(Wt(e,ur(Ne)),me,Ne,n)}catch{}});var g=z8(Wt(e,ur(i.workbooks[0])),i.workbooks[0],n),v={},b="";i.coreprops.length&&(b=Wt(e,ur(i.coreprops[0]),!0),b&&(v=x2(b)),i.extprops.length!==0&&(b=Wt(e,ur(i.extprops[0]),!0),b&&L3(b,v,n)));var k={};(!n.bookSheets||n.bookProps)&&i.custprops.length!==0&&(b=Ya(e,ur(i.custprops[0]),!0),b&&(k=B3(b,n)));var y={};if((n.bookSheets||n.bookProps)&&(g.Sheets?f=g.Sheets.map(function(me){return me.name}):v.Worksheets&&v.SheetNames.length>0&&(f=v.SheetNames),n.bookProps&&(y.Props=v,y.Custprops=k),n.bookSheets&&typeof f<"u"&&(y.SheetNames=f),n.bookSheets?y.SheetNames:n.bookProps))return y;f={};var w={};n.bookDeps&&i.calcchain&&(w=q8(Wt(e,ur(i.calcchain)),i.calcchain));var N=0,_={},O,E;{var L=g.Sheets;v.Worksheets=L.length,v.SheetNames=[];for(var G=0;G!=L.length;++G)v.SheetNames[G]=L[G].name}var H=u?"bin":"xml",R=i.workbooks[0].lastIndexOf("/"),Z=(i.workbooks[0].slice(0,R+1)+"_rels/"+i.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");dr(e,Z)||(Z="xl/_rels/workbook."+H+".rels");var Y=Ii(Ya(e,Z,!0),Z.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(n.xlmeta=W8(Wt(e,ur(i.metadata[0])),i.metadata[0],n)),(i.people||[]).length>=1&&(n.people=H_(Wt(e,ur(i.people[0])),n)),Y&&(Y=DC(Y,g.Sheets));var Q=Wt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=v.Worksheets;++N){var K="sheet";if(Y&&Y[N]?(O="xl/"+Y[N][1].replace(/[\/]?xl\//,""),dr(e,O)||(O=Y[N][1]),dr(e,O)||(O=Z.replace(/_rels\/.*$/,"")+Y[N][1]),K=Y[N][2]):(O="xl/worksheets/sheet"+(N+1-Q)+"."+H,O=O.replace(/sheet0\./,"sheet.")),E=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(N!=n.sheets)continue e;break;case"string":if(v.SheetNames[N].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var ee=!1,Ee=0;Ee!=n.sheets.length;++Ee)typeof n.sheets[Ee]=="number"&&n.sheets[Ee]==N&&(ee=1),typeof n.sheets[Ee]=="string"&&n.sheets[Ee].toLowerCase()==v.SheetNames[N].toLowerCase()&&(ee=1);if(!ee)continue e}}FC(e,O,E,v.SheetNames[N],N,_,f,K,n,g,m,x)}return y={Directory:i,Workbook:g,Props:v,Custprops:k,Deps:w,Sheets:f,SheetNames:v.SheetNames,Strings:Ui,Styles:x,Themes:m,SSF:fa(Qe)},n&&n.bookFiles&&(e.files?(y.keys=s,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(Ne,me){Ne=Ne.replace(/^Root Entry[\/]/,""),y.keys.push(Ne),y.files[Ne]=e.FileIndex[me]}))),n&&n.bookVBA&&(i.vba.length>0?y.vbaraw=Wt(e,ur(i.vba[0]),!0):i.defaults&&i.defaults.bin===X_&&(y.vbaraw=Wt(e,"xl/vbaProject.bin",!0))),y}function LC(e,n){var a=n||{},s="Workbook",i=ft.find(e,s);try{if(s="/!DataSpaces/Version",i=ft.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(A5(i.content),s="/!DataSpaces/DataSpaceMap",i=ft.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var u=j5(i.content);if(u.length!==1||u[0].comps.length!==1||u[0].comps[0].t!==0||u[0].name!=="StrongEncryptionDataSpace"||u[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=ft.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var f=O5(i.content);if(f.length!=1||f[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=ft.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);D5(i.content)}catch{}if(s="/EncryptionInfo",i=ft.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var d=F5(i.content);if(s="/EncryptedPackage",i=ft.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],i.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],i.content,a.password||"",a);throw new Error("File is password-protected")}function vh(e,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=qa(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function IC(e,n){return ft.find(e,"EncryptedPackage")?LC(e,n):J2(e,n)}function BC(e,n){var a,s=e,i=n||{};return i.type||(i.type=ut&&Buffer.isBuffer(e)?"buffer":"base64"),a=$v(s,i),MC(a,i)}function ab(e,n){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Ed(e.slice(a),n);default:break e}return Qi.to_workbook(e,n)}function zC(e,n){var a="",s=vh(e,n);switch(n.type){case"base64":a=qa(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=Ss(e);break;default:throw new Error("Unrecognized type "+n.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(a=Nt(a)),n.type="binary",ab(a,n)}function UC(e,n){var a=e;return n.type=="base64"&&(a=qa(a)),a=Ki.utils.decode(1200,a.slice(2),"str"),n.type="binary",ab(a,n)}function PC(e){return e.match(/[^\x00-\x7F]/)?Oi(e):e}function sd(e,n,a,s){return s?(a.type="string",Qi.to_workbook(e,a)):Qi.to_workbook(n,a)}function Ad(e,n){_v();var a=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ad(new Uint8Array(e),(a=fa(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var s=e,i=[0,0,0,0],u=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),kl={},a.dateNF&&(kl.dateNF=a.dateNF),a.type||(a.type=ut&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=ut?"buffer":"binary",s=AN(e),typeof Uint8Array<"u"&&!ut&&(a.type="array")),a.type=="string"&&(u=!0,a.type="binary",a.codepage=65001,s=PC(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var f=new ArrayBuffer(3),d=new Uint8Array(f);if(d.foo="bar",!d.foo)return a=fa(a),a.type="array",Ad(Wd(s),a)}switch((i=vh(s,a))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return IC(ft.read(s,a),a);break;case 9:if(i[1]<=8)return J2(s,a);break;case 60:return Ed(s,a);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return m5(s,a);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return h5.to_workbook(s,a);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?BC(s,a):sd(e,s,a,u);case 239:return i[3]===60?Ed(s,a):sd(e,s,a,u);case 255:if(i[1]===254)return UC(s,a);if(i[1]===0&&i[2]===2&&i[3]===0)return zi.to_workbook(s,a);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return zi.to_workbook(s,a);break;case 3:case 131:case 139:case 140:return bg.to_workbook(s,a);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return X5.to_workbook(s,a);break;case 10:case 13:case 32:return zC(s,a);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return f5.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?bg.to_workbook(s,a):sd(e,s,a,u)}function HC(e,n,a,s,i,u,f,d){var m=da(a),x=d.defval,g=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),v=!0,b=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(b,"__rowNum__",{value:a,enumerable:!1})}catch{b.__rowNum__=a}else b.__rowNum__=a;if(!f||e[a])for(var k=n.s.c;k<=n.e.c;++k){var y=f?e[a][k]:e[s[k]+m];if(y===void 0||y.t===void 0){if(x===void 0)continue;u[k]!=null&&(b[u[k]]=x);continue}var w=y.v;switch(y.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(u[k]!=null){if(w==null)if(y.t=="e"&&w===null)b[u[k]]=null;else if(x!==void 0)b[u[k]]=x;else if(g&&w===null)b[u[k]]=null;else continue;else b[u[k]]=g&&(y.t!=="n"||y.t==="n"&&d.rawNumbers!==!1)?w:fn(y,w,d);w!=null&&(v=!1)}}return{row:b,isempty:v}}function Cd(e,n){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},s=0,i=1,u=[],f=0,d="",m={s:{r:0,c:0},e:{r:0,c:0}},x=n||{},g=x.range!=null?x.range:e["!ref"];switch(x.header===1?s=1:x.header==="A"?s=2:Array.isArray(x.header)?s=3:x.header==null&&(s=0),typeof g){case"string":m=Bt(g);break;case"number":m=Bt(e["!ref"]),m.s.r=g;break;default:m=g}s>0&&(i=0);var v=da(m.s.r),b=[],k=[],y=0,w=0,N=Array.isArray(e),_=m.s.r,O=0,E={};N&&!e[_]&&(e[_]=[]);var L=x.skipHidden&&e["!cols"]||[],G=x.skipHidden&&e["!rows"]||[];for(O=m.s.c;O<=m.e.c;++O)if(!(L[O]||{}).hidden)switch(b[O]=ta(O),a=N?e[_][O]:e[b[O]+v],s){case 1:u[O]=O-m.s.c;break;case 2:u[O]=b[O];break;case 3:u[O]=x.header[O-m.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=f=fn(a,null,x),w=E[f]||0,!w)E[f]=1;else{do d=f+"_"+w++;while(E[d]);E[f]=w,E[d]=1}u[O]=d}for(_=m.s.r+i;_<=m.e.r;++_)if(!(G[_]||{}).hidden){var H=HC(e,m,_,b,s,u,N,x);(H.isempty===!1||(s===1?x.blankrows!==!1:x.blankrows))&&(k[y++]=H.row)}return k.length=y,k}var Lg=/"/g;function VC(e,n,a,s,i,u,f,d){for(var m=!0,x=[],g="",v=da(a),b=n.s.c;b<=n.e.c;++b)if(s[b]){var k=d.dense?(e[a]||[])[b]:e[s[b]+v];if(k==null)g="";else if(k.v!=null){m=!1,g=""+(d.rawNumbers&&k.t=="n"?k.v:fn(k,null,d));for(var y=0,w=0;y!==g.length;++y)if((w=g.charCodeAt(y))===i||w===u||w===34||d.forceQuotes){g='"'+g.replace(Lg,'""')+'"';break}g=="ID"&&(g='"ID"')}else k.f!=null&&!k.F?(m=!1,g="="+k.f,g.indexOf(",")>=0&&(g='"'+g.replace(Lg,'""')+'"')):g="";x.push(g)}return d.blankrows===!1&&m?null:x.join(f)}function rb(e,n){var a=[],s=n??{};if(e==null||e["!ref"]==null)return"";var i=Bt(e["!ref"]),u=s.FS!==void 0?s.FS:",",f=u.charCodeAt(0),d=s.RS!==void 0?s.RS:`
`,m=d.charCodeAt(0),x=new RegExp((u=="|"?"\\|":u)+"+$"),g="",v=[];s.dense=Array.isArray(e);for(var b=s.skipHidden&&e["!cols"]||[],k=s.skipHidden&&e["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(b[y]||{}).hidden||(v[y]=ta(y));for(var w=0,N=i.s.r;N<=i.e.r;++N)(k[N]||{}).hidden||(g=VC(e,i,N,v,f,m,u,s),g!=null&&(s.strip&&(g=g.replace(x,"")),(g||s.blankrows!==!1)&&a.push((w++?d:"")+g)));return delete s.dense,a.join("")}function GC(e,n){n||(n={}),n.FS="	",n.RS=`
`;var a=rb(e,n);return a}function $C(e){var n="",a,s="";if(e==null||e["!ref"]==null)return[];var i=Bt(e["!ref"]),u="",f=[],d,m=[],x=Array.isArray(e);for(d=i.s.c;d<=i.e.c;++d)f[d]=ta(d);for(var g=i.s.r;g<=i.e.r;++g)for(u=da(g),d=i.s.c;d<=i.e.c;++d)if(n=f[d]+u,a=x?(e[g]||[])[d]:e[n],s="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;s=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)s=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)s=""+a.v;else if(a.t=="b")s=a.v?"TRUE":"FALSE";else if(a.w!==void 0)s="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?s="'"+a.v:s=""+a.v}}m[m.length]=n+"="+s}return m}function nb(e,n,a){var s=a||{},i=+!s.skipHeader,u=e||{},f=0,d=0;if(u&&s.origin!=null)if(typeof s.origin=="number")f=s.origin;else{var m=typeof s.origin=="string"?Ta(s.origin):s.origin;f=m.r,d=m.c}var x,g={s:{c:0,r:0},e:{c:d,r:f+n.length-1+i}};if(u["!ref"]){var v=Bt(u["!ref"]);g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),f==-1&&(f=v.e.r+1,g.e.r=f+n.length-1+i)}else f==-1&&(f=0,g.e.r=n.length-1+i);var b=s.header||[],k=0;n.forEach(function(w,N){Lr(w).forEach(function(_){(k=b.indexOf(_))==-1&&(b[k=b.length]=_);var O=w[_],E="z",L="",G=Ze({c:d+k,r:f+N+i});x=rc(u,G),O&&typeof O=="object"&&!(O instanceof Date)?u[G]=O:(typeof O=="number"?E="n":typeof O=="boolean"?E="b":typeof O=="string"?E="s":O instanceof Date?(E="d",s.cellDates||(E="n",O=Aa(O)),L=s.dateNF||Qe[14]):O===null&&s.nullError&&(E="e",O=0),x?(x.t=E,x.v=O,delete x.w,delete x.R,L&&(x.z=L)):u[G]=x={t:E,v:O},L&&(x.z=L))})}),g.e.c=Math.max(g.e.c,d+b.length-1);var y=da(f);if(i)for(k=0;k<b.length;++k)u[ta(k+d)+y]={t:"s",v:b[k]};return u["!ref"]=dt(g),u}function XC(e,n){return nb(null,e,n)}function rc(e,n,a){if(typeof n=="string"){if(Array.isArray(e)){var s=Ta(n);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?rc(e,Ze(n)):rc(e,Ze({r:n,c:a||0}))}function YC(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=e.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function bh(){return{SheetNames:[],Sheets:{}}}function yh(e,n,a,s){var i=1;if(!a)for(;i<=65535&&e.SheetNames.indexOf(a="Sheet"+i)!=-1;++i,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(a)>=0){var u=a.match(/(^.*?)(\d+)$/);i=u&&+u[2]||0;var f=u&&u[1]||a;for(++i;i<=65535&&e.SheetNames.indexOf(a=f+i)!=-1;++i);}if(O8(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=n,a}function qC(e,n,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=YC(e,n);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[s].Hidden=a}function KC(e,n){return e.z=n,e}function sb(e,n,a){return n?(e.l={Target:n},a&&(e.l.Tooltip=a)):delete e.l,e}function WC(e,n,a){return sb(e,"#"+n,a)}function ZC(e,n,a){e.c||(e.c=[]),e.c.push({t:n,a:a||"SheetJS"})}function JC(e,n,a,s){for(var i=typeof n!="string"?n:Bt(n),u=typeof n=="string"?n:dt(n),f=i.s.r;f<=i.e.r;++f)for(var d=i.s.c;d<=i.e.c;++d){var m=rc(e,f,d);m.t="n",m.F=u,delete m.v,f==i.s.r&&d==i.s.c&&(m.f=a,s&&(m.D=!0))}return e}var QC={encode_col:ta,encode_row:da,encode_cell:Ze,encode_range:dt,decode_col:sh,decode_row:nh,split_cell:u3,decode_cell:Ta,decode_range:Cl,format_cell:fn,sheet_add_aoa:o2,sheet_add_json:nb,sheet_add_dom:Q2,aoa_to_sheet:jl,json_to_sheet:XC,table_to_sheet:eb,table_to_book:mC,sheet_to_csv:rb,sheet_to_txt:GC,sheet_to_json:Cd,sheet_to_html:xC,sheet_to_formulae:$C,sheet_to_row_object_array:Cd,sheet_get_cell:rc,book_new:bh,book_append_sheet:yh,book_set_sheet_visibility:qC,cell_set_number_format:KC,cell_set_hyperlink:sb,cell_set_internal_link:WC,cell_add_comment:ZC,sheet_set_array_formula:JC,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ej=({isOpen:e,onClose:n,onSuccess:a,targetStoreId:s})=>{const[i,u]=D.useState(null),[f,d]=D.useState(null),[m,x]=D.useState([]),[g,v]=D.useState(!1),[b,k]=D.useState(!1),[y,w]=D.useState(0),[N,_]=D.useState(null),[O,E]=D.useState(!1),[L,G]=D.useState(null),H=D.useRef(null),R=D.useRef(null),Z=()=>{const Ne=["SKU","Nombre","Precio","Costo","Existencia","Categoria"],me=[["CAM-001","Camiseta Bsica Negra","250.00","120.00","50","Ropa"],["TEN-XYZ","Tenis Deportivos","1200.50","800.00","15","Calzado"],["GOR-RED","Gorra Roja","300.00","150.00","20","Accesorios"]],J=[Ne.join(","),...me.map(Ce=>Ce.join(","))].join(`
`),se=new Blob([J],{type:"text/csv;charset=utf-8;"}),Ae=URL.createObjectURL(se),ae=document.createElement("a");ae.href=Ae,ae.setAttribute("download","plantilla_teikon.csv"),document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(Ae)},Y=Ne=>{const me=Ne.toLowerCase().trim();return{sku:"sku",cdigo:"sku",codigo:"sku",barcode:"sku",clave:"sku",nombre:"nombre",name:"nombre",producto:"nombre",categora:"categoria",categoria:"categoria",category:"categoria",costo:"costPrice","costo compra":"costPrice","precio costo":"costPrice",cost:"costPrice",precio:"salePrice","precio venta":"salePrice",venta:"salePrice",price:"salePrice","sale price":"salePrice",saleprice:"salePrice",stock:"stock",existencia:"stock",inventario:"stock","stock mnimo":"minStock","stock minimo":"minStock","min stock":"minStock",mnimo:"minStock",minimo:"minStock"}[me]||me},Q=Ne=>new Promise((me,J)=>{const se=new FileReader;se.onloadend=()=>me(se.result),se.onerror=J,se.readAsDataURL(Ne)}),K=async()=>{if(!i){_("Por favor selecciona un archivo Excel");return}v(!0),_(null);try{const Ne=await i.arrayBuffer(),me=Ad(Ne),J=me.Sheets[me.SheetNames[0]],se=QC.sheet_to_json(J);if(se.length===0)throw new Error("El archivo Excel est vaco");const Ae=new Map;if(f)for(let Ce=0;Ce<f.length;Ce++){const B=f[Ce],A=B.name.split(".")[0].toUpperCase();Ae.set(A,B)}const ae=[];for(const Ce of se){const B={};for(const[Te,ge]of Object.entries(Ce)){const ke=Y(Te);B[ke]=ge}const A=String(B.sku||"").trim().toUpperCase();if(!A)continue;const q=Number(B.costPrice||0),V=Number(B.salePrice||0);let T;V<q&&V>0&&q>0?T=" Precio menor al costo":V===0&&(T=" Precio es 0");const z={sku:A,nombre:String(B.nombre||"").trim(),categoria:String(B.categoria||"General").trim(),costPrice:q,salePrice:V,stock:Number(B.stock||0),minStock:Number(B.minStock||5),warning:T},ne=Ae.get(A);if(ne)try{z.imagen=await Q(ne)}catch(Te){console.warn(`No se pudo convertir imagen para SKU ${A}:`,Te)}ae.push(z)}x(ae),console.log(` Procesados ${ae.length} productos`)}catch(Ne){console.error("Error al procesar archivo:",Ne),_(Ne.message||"Error al procesar el archivo")}finally{v(!1)}},ee=async()=>{var Ne,me;if(m.length===0){_("No hay productos para importar");return}k(!0),w(0),_(null);try{const J=setInterval(()=>{w(Ae=>Math.min(Ae+10,90))},200),se=await zn.bulkImport({products:m,storeId:s});clearInterval(J),w(100),console.log(" Importacin exitosa:",se),G(se),setTimeout(()=>{a(),Ee()},2e3)}catch(J){console.error("Error al importar productos:",J),_(((me=(Ne=J.response)==null?void 0:Ne.data)==null?void 0:me.error)||"Error al importar productos"),w(0)}finally{k(!1)}},Ee=()=>{u(null),d(null),x([]),v(!1),k(!1),w(0),_(null),E(!1),G(null),n()};return e?c.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"p-5 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-950",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:c.jsx(pd,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),c.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Importacin Masiva"}),c.jsx("button",{onClick:()=>E(!O),className:"text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",title:"Ayuda",children:c.jsx(iS,{className:"w-5 h-5"})})]}),c.jsx("button",{onClick:Ee,className:"text-slate-400 hover:text-red-500 transition-colors",children:c.jsx(Nr,{className:"w-6 h-6"})})]}),O&&c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/30 p-4 text-sm text-blue-800 dark:text-blue-300 border-b border-blue-100 dark:border-blue-900",children:[c.jsx("p",{className:"font-bold mb-2",children:" Gua Rpida:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700 dark:text-blue-400",children:[c.jsxs("li",{children:["El Excel debe tener columnas: ",c.jsx("b",{children:"SKU, Nombre, Precio, Costo"})]}),c.jsx("li",{children:"Para imgenes automticas, el nombre del archivo debe ser igual al SKU"}),c.jsx("li",{children:'Ejemplo: SKU "CAM-001"  Imagen "CAM-001.jpg"'}),c.jsx("li",{children:"Descarga la plantilla de ejemplo para ver el formato correcto"})]})]}),c.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[L?c.jsxs("div",{className:"text-center py-10 animate-in fade-in zoom-in duration-300",children:[c.jsx(q0,{className:"w-20 h-20 text-green-500 mx-auto mb-4"}),c.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:"Importacin Completada!"}),c.jsxs("div",{className:"mt-6 flex justify-center gap-8 text-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-4xl font-black text-green-600",children:L.imported||0}),c.jsx("p",{className:"text-xs text-slate-500 uppercase font-bold mt-1",children:"Importados"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-4xl font-black text-slate-400",children:L.skipped||0}),c.jsx("p",{className:"text-xs text-slate-500 uppercase font-bold mt-1",children:"Omitidos"})]})]})]}):m.length>0?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex justify-between items-center bg-blue-50 dark:bg-blue-950/30 p-4 rounded-xl border border-blue-100 dark:border-blue-900",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Gi,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),c.jsxs("span",{className:"font-bold text-blue-800 dark:text-blue-300",children:["Se detectaron ",c.jsx("b",{className:"text-blue-600 dark:text-blue-400",children:m.length})," productos"]})]})}),c.jsx("div",{className:"border border-slate-200 dark:border-slate-800 rounded-xl overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-slate-100 dark:bg-slate-900 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-600 dark:text-slate-400 uppercase",children:"Img"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-600 dark:text-slate-400 uppercase",children:"SKU"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-600 dark:text-slate-400 uppercase",children:"Nombre"}),c.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-600 dark:text-slate-400 uppercase",children:"Costo"}),c.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-600 dark:text-slate-400 uppercase",children:"Precio"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-slate-600 dark:text-slate-400 uppercase",children:"Status"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-800 bg-white dark:bg-slate-900",children:m.slice(0,50).map((Ne,me)=>c.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[c.jsx("td",{className:"px-4 py-2",children:Ne.imagen?c.jsx("img",{src:Ne.imagen,alt:Ne.sku,className:"w-10 h-10 object-cover rounded border border-slate-200 dark:border-slate-700"}):c.jsx("div",{className:"w-10 h-10 bg-slate-100 dark:bg-slate-800 rounded flex items-center justify-center",children:c.jsx(W0,{className:"w-4 h-4 text-slate-400"})})}),c.jsx("td",{className:"px-4 py-2 font-mono text-xs font-bold text-slate-700 dark:text-slate-300",children:Ne.sku}),c.jsx("td",{className:"px-4 py-2 text-xs text-slate-700 dark:text-slate-300 truncate max-w-[200px]",children:Ne.nombre}),c.jsxs("td",{className:"px-4 py-2 text-right text-xs text-slate-600 dark:text-slate-400",children:["$",Ne.costPrice.toFixed(2)]}),c.jsxs("td",{className:"px-4 py-2 text-right text-xs font-bold text-slate-900 dark:text-white",children:["$",Ne.salePrice.toFixed(2)]}),c.jsx("td",{className:"px-4 py-2 text-center",children:Ne.warning?c.jsxs("div",{className:"group relative inline-block",children:[c.jsx(Ba,{className:"w-5 h-5 text-amber-500 cursor-help mx-auto"}),c.jsx("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1 bg-slate-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-20 pointer-events-none",children:Ne.warning})]}):c.jsx(q0,{className:"w-5 h-5 text-green-500 mx-auto opacity-30"})})]},me))})]})})}),m.length>50&&c.jsxs("p",{className:"text-xs text-slate-500 text-center",children:["Mostrando primeros 50 de ",m.length," productos"]}),b&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between text-xs font-bold text-slate-600 dark:text-slate-400",children:[c.jsx("span",{children:"Importando productos..."}),c.jsxs("span",{children:[y,"%"]})]}),c.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-800 rounded-full h-3 overflow-hidden",children:c.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 h-full transition-all duration-300 rounded-full",style:{width:`${y}%`}})})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx(at,{onClick:()=>{x([]),u(null),d(null)},className:"flex-1 bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 py-3 rounded-xl font-bold uppercase tracking-wider hover:bg-slate-300 dark:hover:bg-slate-700",disabled:b,children:"Cancelar"}),c.jsx(at,{onClick:ee,disabled:b,className:"flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-xl font-bold uppercase tracking-wider disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?"Importando...":c.jsxs(c.Fragment,{children:[c.jsx(q0,{size:18}),"Importar ",m.length," Productos"]})})]})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("label",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider",children:"Paso 1: Archivo Excel"}),c.jsxs("button",{onClick:Z,className:"flex items-center gap-1 text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium py-1 px-3 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-950/30 transition-colors",children:[c.jsx(xS,{className:"w-3 h-3"}),"Descargar plantilla"]})]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:Ne=>{var me;return u(((me=Ne.target.files)==null?void 0:me[0])||null)},className:"hidden",id:"excel-upload",ref:H}),c.jsxs("label",{htmlFor:"excel-upload",className:"flex items-center justify-center gap-3 w-full p-6 border-2 border-dashed border-orange-300 dark:border-orange-700 rounded-xl cursor-pointer hover:border-orange-500 dark:hover:border-orange-500 transition-colors bg-orange-50/50 dark:bg-orange-950/20",children:[c.jsx(pd,{className:"text-orange-500",size:32}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300",children:i?i.name:"Click para seleccionar archivo Excel"}),c.jsx("span",{className:"block text-xs text-slate-500 mt-1",children:"Formatos: .xlsx, .xls, .csv"})]})]})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider",children:"Paso 2: Carpeta de Imgenes (Opcional)"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"file",webkitdirectory:"true",multiple:!0,onChange:Ne=>d(Ne.target.files),className:"hidden",id:"images-upload",ref:R}),c.jsxs("label",{htmlFor:"images-upload",className:"flex items-center justify-center gap-3 w-full p-6 border-2 border-dashed border-blue-300 dark:border-blue-700 rounded-xl cursor-pointer hover:border-blue-500 dark:hover:border-blue-500 transition-colors bg-blue-50/50 dark:bg-blue-950/20",children:[c.jsx(kS,{className:"text-blue-500",size:32}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300",children:f?`${f.length} imgenes seleccionadas`:"Click para seleccionar carpeta de imgenes"}),c.jsx("span",{className:"block text-xs text-slate-500 mt-1",children:"Las imgenes deben nombrarse igual que el SKU"})]})]})]})]}),c.jsx(at,{onClick:K,disabled:!i||g,className:"w-full bg-orange-600 hover:bg-orange-500 text-white py-4 rounded-xl font-bold uppercase tracking-wider disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:g?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Procesando..."]}):c.jsxs(c.Fragment,{children:[c.jsx(kv,{size:18}),"Procesar Datos"]})})]}),N&&c.jsxs("div",{className:"mt-4 flex items-center gap-2 p-4 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-900 rounded-xl",children:[c.jsx(Gi,{className:"text-red-500 flex-shrink-0",size:20}),c.jsx("span",{className:"text-sm font-bold text-red-700 dark:text-red-400",children:N})]})]})]})}):null},tj=({isOpen:e,onClose:n,product:a,onSuccess:s,targetStoreId:i})=>{const{currentUser:u}=Jt(),[f,d]=D.useState("ADJUST"),[m,x]=D.useState("ADMIN_CORRECTION"),[g,v]=D.useState(""),[b,k]=D.useState(""),[y,w]=D.useState(!1);if(!a)return null;const N=async E=>{if(E.preventDefault(),!g||isNaN(Number(g))||Number(g)===0){alert("Por favor, ingresa una cantidad vlida distinta de cero.");return}w(!0);try{await iv.createMovement({productId:a.id,type:f,reason:m,quantity:Number(g),notes:b,storeId:i||(u==null?void 0:u.storeId)}),s(),n(),v(""),k(""),d("ADJUST"),x("ADMIN_CORRECTION")}catch(L){console.error("Error ajustando inventario:",L),alert("Error al ajustar el inventario. Por favor intenta nuevamente.")}finally{w(!1)}},_=E=>{d(E),E==="IN"&&x("PURCHASE"),E==="OUT"&&x("SHRINKAGE"),E==="ADJUST"&&x("ADMIN_CORRECTION")},O=()=>{const E=Number(g)||0;return f==="IN"?a.stock+Math.abs(E):f==="OUT"?a.stock-Math.abs(E):f==="ADJUST"?a.stock+E:a.stock};return c.jsx(Mr,{isOpen:e,onClose:n,title:"Ajustar Inventario",children:c.jsxs("form",{onSubmit:N,className:"space-y-6",children:[c.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-widest font-black",children:"Producto"}),c.jsx("p",{className:"font-bold text-slate-900 dark:text-white truncate max-w-[200px]",children:a.name}),c.jsx("p",{className:"text-xs text-slate-400",children:a.sku})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-widest font-black",children:"Stock Actual"}),c.jsx("p",{className:"text-2xl font-black text-slate-900 dark:text-white",children:a.stock})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Tipo de Movimiento"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("button",{type:"button",onClick:()=>_("IN"),className:`flex flex-col items-center p-3 rounded-xl border-2 transition-all ${f==="IN"?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600":"border-slate-200 dark:border-slate-800 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[c.jsx(qS,{size:24,className:"mb-1"}),c.jsx("span",{className:"text-[10px] font-black uppercase",children:"Entrada"})]}),c.jsxs("button",{type:"button",onClick:()=>_("OUT"),className:`flex flex-col items-center p-3 rounded-xl border-2 transition-all ${f==="OUT"?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-600":"border-slate-200 dark:border-slate-800 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[c.jsx(WS,{size:24,className:"mb-1"}),c.jsx("span",{className:"text-[10px] font-black uppercase",children:"Salida"})]}),c.jsxs("button",{type:"button",onClick:()=>_("ADJUST"),className:`flex flex-col items-center p-3 rounded-xl border-2 transition-all ${f==="ADJUST"?"border-amber-500 bg-amber-50 dark:bg-amber-900/20 text-amber-600":"border-slate-200 dark:border-slate-800 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[c.jsx(Ba,{size:24,className:"mb-1"}),c.jsx("span",{className:"text-[10px] font-black uppercase",children:"Ajuste"})]})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Motivo / Clasificacin"}),c.jsxs("select",{value:m,onChange:E=>x(E.target.value),className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-sm font-bold focus:border-brand-blue outline-none",children:[f==="IN"&&c.jsxs(c.Fragment,{children:[c.jsx("option",{value:"PURCHASE",children:"Compra a Proveedor"}),c.jsx("option",{value:"RETURN",children:"Devolucin (Manual)"}),c.jsx("option",{value:"TRANSFER",children:"Transferencia / Otros"})]}),f==="OUT"&&c.jsxs(c.Fragment,{children:[c.jsx("option",{value:"SHRINKAGE",children:"Merma / Desperdicio"}),c.jsx("option",{value:"THEFT",children:"Prdida / Robo"}),c.jsx("option",{value:"TRANSFER",children:"Transferencia / Otros"})]}),f==="ADJUST"&&c.jsxs(c.Fragment,{children:[c.jsx("option",{value:"ADMIN_CORRECTION",children:"Correccin Administrativa"}),c.jsx("option",{value:"INITIAL_STOCK",children:"Ajuste de Saldo Inicial"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:f==="ADJUST"?"Diferencia (+ o -)":"Cantidad Movindose"}),c.jsx("input",{type:"number",required:!0,step:"1",value:g,onChange:E=>v(E.target.value),placeholder:f==="ADJUST"?"-5 o 10":"Ej: 5",className:"w-full bg-white dark:bg-slate-950 border-2 border-brand-blue/30 focus:border-brand-blue rounded-xl px-4 py-3 text-xl font-black text-center"})]}),c.jsxs("div",{className:"bg-slate-100 dark:bg-slate-800 rounded-xl p-3 flex flex-col items-center justify-center relative overflow-hidden",children:[c.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-slate-500 mb-1 z-10",children:"Nuevo Stock"}),c.jsx("p",{className:`text-3xl font-black z-10 ${O()<0?"text-red-500":"text-emerald-500"}`,children:O()}),c.jsx("div",{className:"absolute opacity-5 -right-2 -bottom-2",children:c.jsx(DS,{size:80})})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Notas / Documento de Referencia (Opcional)"}),c.jsx("textarea",{value:b,onChange:E=>k(E.target.value),placeholder:"Ej: Factura #1234, o 'Se rompieron 2 botellas...'",className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-sm focus:border-brand-blue outline-none min-h-[80px] resize-none"})]}),c.jsxs("div",{className:"flex gap-4 pt-2",children:[c.jsx(at,{type:"button",variant:"secondary",onClick:n,disabled:y,fullWidth:!0,children:"Cancelar"}),c.jsx(at,{type:"submit",variant:"primary",disabled:y||!g,fullWidth:!0,children:y?"Guardando...":"Confirmar Ajuste"})]})]})})},aj=({targetStoreId:e})=>{const{currentUser:n}=Jt(),[a,s]=D.useState([]),[i,u]=D.useState(!1),[f,d]=D.useState(""),[m,x]=D.useState(""),[g,v]=D.useState(1),[b,k]=D.useState(1),y=50,w=async()=>{u(!0);try{const E={page:g,limit:y};e?E.storeId=e:n!=null&&n.storeId&&(E.storeId=n.storeId),m&&(E.type=m);const L=await iv.getMovements(E);L&&L.data?(s(L.data),k(L.totalPages||1)):s([])}catch(E){console.error("Error al cargar el historial de inventario:",E),s([])}finally{u(!1)}};D.useEffect(()=>{w()},[g,m,e,n==null?void 0:n.storeId]);const N={SALE:{label:"Venta",color:"text-red-500 bg-red-50 cursor-pointer",icon:md},PURCHASE:{label:"Compra",color:"text-emerald-500 bg-emerald-50",icon:xd},ADJUSTMENT:{label:"Ajuste Sist.",color:"text-amber-500 bg-amber-50",icon:Ba},THEFT:{label:"Robo",color:"text-rose-600 bg-rose-50",icon:Ba},RETURN:{label:"Devolucin",color:"text-emerald-600 bg-emerald-50",icon:xd},TRANSFER:{label:"Transferencia",color:"text-blue-500 bg-blue-50",icon:Ri},SHRINKAGE:{label:"Merma",color:"text-orange-500 bg-orange-50",icon:md},ADMIN_CORRECTION:{label:"Correccin Admin.",color:"text-violet-500 bg-violet-50",icon:Ba}},_=E=>N[E]||{label:E,color:"text-gray-500 bg-gray-50",icon:Ri},O=a.filter(E=>{var G,H;if(!f)return!0;const L=f.toLowerCase();return E.motivo.toLowerCase().includes(L)||E.registradoPor.toLowerCase().includes(L)||((G=E.product)==null?void 0:G.nombre)&&E.product.nombre.toLowerCase().includes(L)||((H=E.product)==null?void 0:H.sku)&&E.product.sku.toLowerCase().includes(L)});return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-stretch md:items-center bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm",children:[c.jsxs("div",{className:"relative flex-1 max-w-md",children:[c.jsx(ic,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 h-4 w-4"}),c.jsx("input",{type:"text",placeholder:"Buscar por producto, motivo, usuario...",className:"w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-lg text-sm text-slate-900 dark:text-white focus:outline-none focus:border-brand-blue transition-colors",value:f,onChange:E=>d(E.target.value)})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx(SS,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 h-4 w-4"}),c.jsxs("select",{className:"pl-9 pr-8 py-2 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-lg text-sm font-bold text-slate-700 dark:text-slate-300 focus:outline-none focus:border-brand-blue cursor-pointer appearance-none",value:m,onChange:E=>{x(E.target.value),v(1)},children:[c.jsx("option",{value:"",children:"Todos los Tipos"}),c.jsx("option",{value:"IN",children:"Solo Entradas (Compras/Devs)"}),c.jsx("option",{value:"OUT",children:"Solo Salidas (Ventas/Termas)"}),c.jsx("option",{value:"ADJUST",children:"Ajustes (Manu/Admin)"})]})]}),c.jsx(at,{onClick:w,variant:"secondary",className:"px-3",title:"Refrescar",children:c.jsx(Ri,{size:16,className:i?"animate-spin":""})})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden",children:[c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left border-collapse",children:[c.jsx("thead",{className:"bg-slate-50 dark:bg-slate-950 border-b border-slate-200 dark:border-slate-800",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Fecha y Hora"}),c.jsx("th",{className:"px-4 py-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Producto"}),c.jsx("th",{className:"px-4 py-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Tipo"}),c.jsx("th",{className:"px-4 py-3 text-right text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Variacin"}),c.jsx("th",{className:"px-4 py-3 text-center text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Stock Final"}),c.jsx("th",{className:"px-4 py-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-1/4",children:"Motivo / Operador"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800 text-sm",children:i&&a.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:"Cargando historial..."})}):O.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:"No se encontraron movimientos."})}):O.map(E=>{var R,Z,Y;const L=_(E.tipo),G=L.icon,H=new Date(E.createdAt);return c.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-400",children:[c.jsx(xv,{size:14,className:"opacity-50"}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-200",children:H.toLocaleDateString()}),c.jsx("span",{className:"text-[10px]",children:H.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex flex-col max-w-[200px]",children:[c.jsx("span",{className:"font-bold text-slate-900 dark:text-white truncate",title:((R=E.product)==null?void 0:R.nombre)||"Producto Desconocido",children:((Z=E.product)==null?void 0:Z.nombre)||"Producto Desconocido"}),c.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-tight",children:((Y=E.product)==null?void 0:Y.sku)||"N/A"})]})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[10px] font-bold uppercase tracking-widest ${L.color}`,children:[c.jsx(G,{size:12}),L.label]})}),c.jsx("td",{className:"px-4 py-3 text-right",children:c.jsxs("span",{className:`font-black text-lg ${E.cantidad>0?"text-emerald-500":"text-red-500"}`,children:[E.cantidad>0?"+":"",E.cantidad]})}),c.jsx("td",{className:"px-4 py-3 text-center",children:c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:E.stockNuevo}),c.jsxs("span",{className:"text-[9px] text-slate-400 flex items-center gap-1",children:["(Ant: ",E.stockAnterior,")"]})]})}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300 line-clamp-2",title:E.motivo,children:E.motivo||"Sin detalles"}),c.jsxs("div",{className:"flex justify-between items-center mt-1",children:[c.jsxs("span",{className:"text-[10px] font-bold text-slate-400 flex items-center gap-1",children:[c.jsx(Fr,{size:10})," ",E.registradoPor||"Sistema"]}),E.referenciaId&&c.jsxs("span",{className:"text-[9px] font-black text-brand-blue uppercase bg-blue-50 dark:bg-blue-900/20 px-1.5 py-0.5 rounded",children:["#",E.referenciaId.substring(0,6)]})]})]})})]},E.id)})})]})}),b>1&&c.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-950",children:[c.jsxs("span",{className:"text-xs text-slate-500",children:["Pgina ",g," de ",b]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(at,{variant:"secondary",className:"px-3 py-1 text-xs",disabled:g===1,onClick:()=>v(E=>Math.max(1,E-1)),children:"Anterior"}),c.jsx(at,{variant:"secondary",className:"px-3 py-1 text-xs",disabled:g===b,onClick:()=>v(E=>Math.min(b,E+1)),children:"Siguiente"})]})]})]})]})},lb=({products:e,targetStoreId:n})=>{const{products:a,addProduct:s,updateProduct:i,deleteProduct:u,calculateTotalInventoryValue:f,currentUser:d}=Jt(),[m,x]=D.useState([]),[g,v]=D.useState(!1);D.useEffect(()=>{n&&b()},[n]);const b=async()=>{v(!0);try{console.log(` Fetching products for store: ${n}`);const z=(await zn.getAll({storeId:n})).map(ne=>({...ne,name:ne.nombre||ne.name||"Sin Nombre",category:ne.categoria||ne.category||"General",image:ne.imagen||ne.image,costPrice:Number(ne.costPrice||0),salePrice:Number(ne.salePrice||0),isActive:ne.activo!==void 0?ne.activo:ne.isActive!==void 0?ne.isActive:!0}));x(z),console.log(` Loaded ${z.length} products for store`)}catch(T){console.error("Error fetching store products:",T),x([])}finally{v(!1)}},k=e||(n?m:a)||[],[y,w]=D.useState(""),[N,_]=D.useState(!1),[O,E]=D.useState(!1),[L,G]=D.useState({}),[H,R]=D.useState(!1),[Z,Y]=D.useState(null),[Q,K]=D.useState("CATALOG"),ee=async(T,z)=>{T.stopPropagation(),confirm("Ests seguro de que deseas ARCHIVAR este producto? Dejar de estar visible para la venta, pero se mantendr en el historial.")&&await i({...z,isActive:!1})},Ee=k.reduce((T,z)=>{const ne=Number(z.costPrice)||0,Te=Number(z.stock)||0;return T+ne*Te},0),Ne=k.reduce((T,z)=>T+(z.stock||0),0),me=T=>{T.preventDefault();const z=L.sku,ne=String(z||"").trim().toUpperCase(),Te=k.find(be=>String(be.sku||"").trim().toUpperCase()===ne&&be.id!==L.id);if(Te){const be=document.getElementById("sku-input");be&&(be.setCustomValidity(` EL SKU YA EXISTE EN: ${Te.name}`),be.reportValidity());return}if(!L.name){alert("El Nombre es obligatorio.");return}const ge=parseFloat((L.costPrice||0).toString()),ke=parseFloat((L.salePrice||0).toString()),$e=parseInt((L.stock||0).toString());if(isNaN(ge)||isNaN(ke)||isNaN($e)){alert("Los valores numricos ingresados no son vlidos.");return}if(ke<ge){alert("PRECIO VENTA es menor que COSTO COMPRA. Por favor, revise los precios.");return}const X=ne,nt=(L.name||"").toUpperCase(),pe=ke-ge,we={sku:X,name:nt,category:(L.category||"").toUpperCase(),stock:$e,costPrice:ge,salePrice:ke,unitProfit:pe,minStock:L.minStock||0,taxRate:L.taxRate||0,isActive:L.isActive!==void 0?L.isActive:!0,image:L.image||void 0,storeId:(d==null?void 0:d.storeId)||n||""};L.id?i({...we,id:L.id,storeId:L.storeId||""}):s({...we,storeId:""},n),_(!1)},J=T=>{var ne;const z=(ne=T.target.files)==null?void 0:ne[0];if(z){const Te=new FileReader;Te.onloadend=()=>{G(ge=>({...ge,image:Te.result}))},Te.readAsDataURL(z)}},se=()=>{G({isActive:!0,costPrice:0,salePrice:0,stock:0}),_(!0)},Ae=T=>{G({...T}),_(!0)},ae=T=>{Y(T),R(!0)},Ce=()=>{n?b():window.location.reload()},B=k.filter(T=>T.isActive!==!1).filter(T=>{var z,ne;return(((z=T.name)==null?void 0:z.toLowerCase())||"").includes(y.toLowerCase())||(((ne=T.sku)==null?void 0:ne.toLowerCase())||"").includes(y.toLowerCase())}),A=(L.salePrice||0)-(L.costPrice||0),q=L.salePrice&&L.salePrice>0?A/L.salePrice*100:0,V=D.useMemo(()=>Array.from(new Set(k.map(T=>{var z;return(z=T.category)==null?void 0:z.trim().toUpperCase()}).filter(Boolean))).sort(),[k]);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("div",{className:"card-premium p-5 flex items-center justify-between bg-white dark:bg-slate-900 border-l-4 border-l-orange-500",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-500/10 rounded-xl text-orange-600",children:c.jsx($i,{size:24})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Valor de Inversin"}),c.jsxs("p",{className:"text-2xl font-black text-slate-900 dark:text-white",children:["$",Ee.toLocaleString()]})]})]})}),c.jsx("div",{className:"card-premium p-5 flex items-center justify-between bg-white dark:bg-slate-900 border-l-4 border-l-brand-blue",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-500/10 rounded-xl text-brand-blue",children:c.jsx(Zw,{size:24})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Unidades Totales"}),c.jsx("p",{className:"text-2xl font-black text-slate-900 dark:text-white",children:Ne.toLocaleString()})]})]})})]}),c.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl max-w-sm self-center md:self-start",children:[c.jsxs("button",{onClick:()=>K("CATALOG"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-lg text-xs font-bold transition-all ${Q==="CATALOG"?"bg-white dark:bg-slate-700 text-orange-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[c.jsx(vl,{size:14})," Catlogo"]}),c.jsxs("button",{onClick:()=>K("HISTORY"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-lg text-xs font-bold transition-all ${Q==="HISTORY"?"bg-white dark:bg-slate-700 text-orange-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[c.jsx(History,{size:14})," Historial"]})]}),Q==="HISTORY"?c.jsx(aj,{targetStoreId:n}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-stretch md:items-center gap-4 bg-orange-50 dark:bg-orange-950/20 p-4 rounded-2xl border border-orange-100 dark:border-orange-900/30",children:[c.jsxs("div",{className:"relative w-full md:w-96",children:[c.jsx(ic,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-orange-500 h-5 w-5"}),c.jsx("input",{type:"text",placeholder:"Buscar por SKU o Nombre...",className:"w-full pl-12 pr-4 py-3.5 bg-white dark:bg-slate-900 border border-orange-200 dark:border-orange-800/40 rounded-xl text-sm font-bold text-slate-900 dark:text-white focus:outline-none focus:border-orange-500 shadow-sm transition-all",value:y,onChange:T=>w(T.target.value)})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs(at,{onClick:()=>E(!0),className:"bg-blue-600 hover:bg-blue-500 text-white rounded-xl shadow-lg shadow-blue-600/20 active:scale-95 transition-all py-3.5 px-4",children:[c.jsx(pd,{size:18,className:"mr-2"})," IMPORTAR EXCEL"]}),c.jsxs(at,{onClick:se,className:"bg-orange-600 hover:bg-orange-500 text-white rounded-xl shadow-lg shadow-orange-600/20 active:scale-95 transition-all py-3.5",children:[c.jsx(ao,{size:18,className:"mr-2"})," AGREGAR TEM"]})]})]}),c.jsx("div",{className:"block md:hidden space-y-3",children:B.map(T=>{const z=T.salePrice>0?(T.salePrice-T.costPrice)/T.salePrice*100:0,ne=T.salePrice-T.costPrice;return c.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4 active:scale-[0.98] transition-all",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shrink-0",children:T.image?c.jsx("img",{src:T.image,className:"w-full h-full object-cover",alt:T.name}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:c.jsx(W0,{size:20})})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"font-bold text-sm text-slate-800 dark:text-white truncate mb-1",children:T.name}),c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsxs("span",{className:"text-base font-black text-orange-500",children:["$",T.salePrice.toLocaleString()]}),c.jsxs("span",{className:`px-2 py-1 rounded-lg font-bold ${T.stock===0?"text-red-500 bg-red-50 ring-2 ring-red-500":T.stock<=T.minStock?"bg-red-100 dark:bg-red-950/30 text-red-600 dark:text-red-400":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400"}`,children:["Stock: ",c.jsx("span",{className:"text-2xl font-bold",children:T.stock})]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Vn,{size:10,className:ne>0?"text-emerald-500":"text-red-500"}),c.jsxs("span",{className:`text-[10px] font-bold ${ne>0?"text-emerald-500":"text-red-500"}`,children:[z.toFixed(0),"% MG"]})]})]}),c.jsxs("div",{className:"flex flex-col gap-2 shrink-0",children:[c.jsx("button",{onClick:()=>Ae(T),className:"flex items-center justify-center w-10 h-10 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-xl transition-all active:scale-95","aria-label":`Editar ${T.name}`,children:c.jsx(Rp,{size:16})}),c.jsx("button",{onClick:()=>ae(T),className:"flex items-center justify-center w-10 h-10 bg-amber-100 hover:bg-amber-200 text-amber-600 rounded-xl transition-all active:scale-95","aria-label":`Ajustar ${T.name}`,children:c.jsx(vl,{size:16})})]})]})},T.id)})}),c.jsx("div",{className:"hidden md:block w-full max-w-7xl mx-auto",children:c.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden",children:c.jsx("div",{className:"table-scroll-container",children:c.jsxs("table",{className:"w-full text-left border-collapse",children:[c.jsx("thead",{className:"bg-orange-50/50 dark:bg-orange-950/10 border-b-2 border-orange-200 dark:border-orange-900/20",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-orange-600 dark:text-orange-400 uppercase tracking-widest",children:"TEM"}),c.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-orange-600 dark:text-orange-400 uppercase tracking-widest",children:"SKU"}),c.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-black text-orange-600 dark:text-orange-400 uppercase tracking-widest",children:"PRECIO"}),c.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-black text-orange-600 dark:text-orange-400 uppercase tracking-widest",children:"RENTABILIDAD"}),c.jsx("th",{className:"px-6 py-4 text-center text-[10px] font-black text-orange-600 dark:text-orange-400 uppercase tracking-widest",children:"STOCK"}),c.jsx("th",{className:"px-6 py-4 text-center text-[10px] font-black text-orange-600 dark:text-orange-400 uppercase tracking-widest",children:"ACCIN"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:B.map(T=>{const z=T.salePrice>0?(T.salePrice-T.costPrice)/T.salePrice*100:0,ne=T.salePrice-T.costPrice;return c.jsxs("tr",{className:"hover:bg-orange-50/30 dark:hover:bg-orange-950/5 transition-colors group",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl overflow-hidden bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shrink-0",children:T.image?c.jsx("img",{src:T.image,className:"w-full h-full object-cover",alt:T.name}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:c.jsx(W0,{size:18})})}),c.jsx("span",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 truncate max-w-[200px]",title:T.name,children:T.name})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:"text-xs font-black text-slate-400 uppercase tracking-tight",children:T.sku})}),c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex flex-col items-end",children:[c.jsxs("span",{className:"text-base font-black text-slate-900 dark:text-white",children:["$",T.salePrice.toLocaleString()]}),T.costPrice>0&&c.jsxs("span",{className:"text-[10px] text-slate-400 line-through",children:["Costo: $",T.costPrice.toLocaleString()]})]})}),c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex flex-col items-end gap-1",children:[c.jsxs("span",{className:`text-sm font-black ${ne>0?"text-emerald-500":"text-red-500"}`,children:["$",ne.toLocaleString()]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Vn,{size:12,className:ne>0?"text-emerald-500":"text-red-500"}),c.jsxs("span",{className:`text-[10px] font-bold ${ne>0?"text-emerald-500":"text-red-500"}`,children:[z.toFixed(1),"% MG"]})]})]})}),c.jsx("td",{className:"px-6 py-4 text-center",children:c.jsx("span",{className:`inline-flex items-center justify-center px-4 py-2 rounded-lg font-bold uppercase border-2 ${T.stock===0?"text-red-500 border-red-500 bg-red-50 text-2xl ring-2 ring-red-300":T.stock<=T.minStock?"bg-red-50 dark:bg-red-950/20 text-red-600 dark:text-red-400 border-red-200 dark:border-red-900/50 text-2xl":"bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-slate-700 text-2xl"}`,children:T.stock})}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsxs("button",{onClick:()=>ae(T),className:"flex items-center gap-1 px-3 py-2 bg-amber-500/10 hover:bg-amber-500/20 text-amber-700 dark:text-amber-400 rounded-lg text-[10px] font-bold uppercase transition-all",title:"Ajustar Stock",children:[c.jsx(vl,{size:14})," Ajustar"]}),c.jsxs("button",{onClick:()=>Ae(T),className:"flex items-center gap-1 px-3 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-[10px] font-bold uppercase transition-all",children:[c.jsx(Rp,{size:14})," Editar"]}),c.jsxs("button",{onClick:Te=>ee(Te,T),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-[10px] font-bold uppercase transition-all",title:"Archivar",children:[c.jsx(Bw,{size:14})," Archivar"]})]})})]},T.id)})})]})})})})]}),c.jsx(Mr,{isOpen:N,onClose:()=>_(!1),title:L.id?"Modificar":"Nuevo tem",children:c.jsxs("form",{onSubmit:me,className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 p-4 bg-slate-50 dark:bg-slate-950 rounded-2xl border border-slate-100 dark:border-slate-800",children:[c.jsx("div",{className:"h-24 w-24 bg-white dark:bg-slate-900 border border-orange-100 dark:border-orange-800/40 rounded-2xl flex items-center justify-center overflow-hidden shadow-md shrink-0",children:L.image?c.jsx("img",{src:L.image,className:"h-full w-full object-cover",alt:"Preview"}):c.jsx(W0,{className:"text-orange-200 dark:text-orange-800",size:32})}),c.jsx("div",{className:"flex-1 w-full text-center sm:text-left",children:c.jsxs("label",{className:"cursor-pointer bg-orange-600 text-white px-6 py-3 text-[10px] font-black uppercase tracking-widest hover:bg-orange-500 transition-all active:scale-95 flex items-center justify-center sm:justify-start gap-2 rounded-xl shadow-lg shadow-orange-600/20 min-h-[44px]",children:[c.jsx(kv,{size:16}),c.jsx("span",{children:"Cargar Imagen"}),c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:J})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"SKU"}),c.jsx("input",{id:"sku-input",required:!0,className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-xs font-bold focus:border-orange-500 outline-none uppercase",value:L.sku||"",onChange:T=>G(z=>({...z,sku:T.target.value})),onInput:T=>T.currentTarget.setCustomValidity("")})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Categora"}),c.jsx("input",{list:"categories-list",className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-xs font-bold focus:border-orange-500 outline-none uppercase",value:L.category||"",onChange:T=>G(z=>({...z,category:T.target.value.toUpperCase()})),style:{textTransform:"uppercase"}}),c.jsx("datalist",{id:"categories-list",children:V.map(T=>c.jsx("option",{value:T},T))})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Nombre"}),c.jsx("input",{required:!0,className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-xs font-bold focus:border-orange-500 outline-none uppercase",value:L.name||"",onChange:T=>G(z=>({...z,name:T.target.value}))})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 p-4 bg-emerald-500/5 dark:bg-emerald-500/10 rounded-2xl border border-emerald-500/10",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-[8px] font-black text-emerald-600 uppercase tracking-widest flex items-center gap-1",children:[c.jsx($i,{size:10})," Utilidad Bruta"]}),c.jsxs("p",{className:"text-lg font-black text-emerald-500",children:["$",A.toLocaleString()]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-[8px] font-black text-emerald-600 uppercase tracking-widest flex items-center gap-1",children:[c.jsx(Vn,{size:10})," Margen Bruto"]}),c.jsxs("p",{className:"text-lg font-black text-emerald-500",children:[q.toFixed(2),"%"]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Costo Compra"}),c.jsx("input",{type:"number",step:"0.01",required:!0,className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-xs font-bold",value:L.costPrice||"",onChange:T=>G(z=>({...z,costPrice:parseFloat(T.target.value)}))})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Precio Venta"}),c.jsx("input",{type:"number",step:"0.01",required:!0,className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-xs font-bold",value:L.salePrice||"",onChange:T=>G(z=>({...z,salePrice:parseFloat(T.target.value)}))})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:L.id?"Ajuste Stock":"Stock Inicial"}),c.jsx("input",{type:"number",required:!0,className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-xs font-bold focus:border-orange-500 shadow-sm",value:L.stock||0,onChange:T=>G(z=>({...z,stock:parseInt(T.target.value)||0}))})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Mnimo Crtico"}),c.jsx("input",{type:"number",required:!0,className:"w-full bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 py-3 text-xs font-bold focus:border-orange-500 shadow-sm",value:L.minStock||0,onChange:T=>G(z=>({...z,minStock:parseInt(T.target.value)||0}))})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[c.jsx("button",{onClick:()=>_(!1),type:"button",className:"flex-1 px-6 py-4 text-[10px] font-black uppercase tracking-widest rounded-xl border-2 border-slate-200 dark:border-slate-800 active:scale-95 order-2 sm:order-1 min-h-[44px]",children:"Cancelar"}),c.jsx("button",{type:"submit",className:"flex-1 px-6 py-4 text-[10px] font-black uppercase tracking-widest bg-orange-600 text-white rounded-xl shadow-lg active:scale-95 order-1 sm:order-2 min-h-[44px]",children:"Guardar Item"})]})]})}),c.jsx(ej,{isOpen:O,onClose:()=>E(!1),onSuccess:Ce,targetStoreId:n}),c.jsx(tj,{isOpen:H,onClose:()=>R(!1),product:Z,onSuccess:Ce,targetStoreId:n})]})},rj=()=>{const{settings:e,updateSettings:n,currentSession:a,closeSession:s,currentUser:i,logout:u}=Jt(),{theme:f,toggleTheme:d}=dv(),m=f==="dark",[x,g]=D.useState(e.monthlyFixedCosts),[v,b]=D.useState(!1),[k,y]=D.useState(!1),[w,N]=D.useState(""),_=a?a.startBalance+a.cashSales-a.refunds:0,O=(parseFloat(w)||0)-_,E=()=>{n({monthlyFixedCosts:x})},L=()=>{const H=parseFloat(w)||0;s(H),b(!1),N("")},G=()=>{window.location.href="/login"};return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-20",children:[c.jsxs("div",{className:"card-premium p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-brand-purple/10 rounded-xl",children:c.jsx(gd,{size:18,className:"text-brand-purple"})}),c.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-slate-800 dark:text-white",children:"Apariencia"})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between p-4 bg-slate-50 dark:bg-slate-950 rounded-2xl border border-slate-100 dark:border-slate-800 gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4 w-full",children:[c.jsx("div",{className:`p-3 rounded-xl shrink-0 ${m?"bg-indigo-500/10 text-indigo-400":"bg-amber-500/10 text-amber-500"}`,children:m?c.jsx(vv,{size:20}):c.jsx(gd,{size:20})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-800 dark:text-white",children:"Modo Oscuro"}),c.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mt-0.5",children:"Interfaz optimizada"})]})]}),c.jsx("button",{onClick:d,"aria-label":"Cambiar modo de tema",title:"Cambiar entre modo claro y oscuro",className:`w-16 h-8 rounded-full transition-all duration-300 relative px-1 flex items-center shrink-0 min-h-[44px] ${f==="dark"?"bg-indigo-600":"bg-slate-300 dark:bg-slate-800"}`,children:c.jsx("div",{className:`w-6 h-6 bg-white rounded-full shadow-md transform transition-transform duration-300 ${f==="dark"?"translate-x-8":"translate-x-0"}`})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"card-premium p-6 border-t-4 border-t-brand-blue bg-white dark:bg-slate-900 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-brand-blue/10 rounded-xl",children:c.jsx(Pd,{size:18,className:"text-brand-blue"})}),c.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-slate-800 dark:text-white",children:"Gastos"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Fijo Mensual"}),c.jsx("input",{type:"number",value:x,onChange:H=>g(parseFloat(H.target.value)),placeholder:"0.00","aria-label":"Gastos fijos mensuales",className:"w-full h-12 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-xl px-4 text-sm font-black text-slate-900 dark:text-white outline-none focus:border-brand-blue transition-all"})]}),c.jsx(at,{fullWidth:!0,variant:"finance",onClick:E,className:"py-5",children:"ACTUALIZAR GASTOS"})]})]}),c.jsxs("div",{className:"card-premium p-6 flex flex-col justify-between border-t-4 border-t-brand-emerald bg-white dark:bg-slate-900 shadow-sm",children:[c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-brand-emerald",children:"Arqueo"}),c.jsx("span",{className:"bg-brand-emerald/10 text-brand-emerald px-3 py-1 rounded-full text-[8px] font-black uppercase border border-brand-emerald/20 shrink-0",children:"Turno Activo"})]}),c.jsxs("div",{className:"p-4 bg-emerald-500/5 dark:bg-emerald-500/10 rounded-2xl border border-brand-emerald/10",children:[c.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1 text-center",children:"Terico"}),c.jsxs("p",{className:"text-4xl font-black text-brand-emerald tracking-tighter text-center",children:["$",_.toLocaleString()]})]})]}),c.jsxs("button",{onClick:()=>b(!0),className:"mt-6 w-full h-14 border-2 border-red-500/20 text-red-500 hover:bg-red-500 hover:text-white rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all flex items-center justify-center gap-2 min-h-[56px]",children:[c.jsx(ro,{size:18})," FINALIZAR JORNADA"]})]})]}),c.jsx("div",{className:"card-premium p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 shadow-sm",children:c.jsxs("button",{onClick:()=>y(!0),className:"w-full min-h-[64px] px-6 bg-slate-50 dark:bg-slate-950 rounded-2xl border border-slate-100 dark:border-slate-800 flex items-center justify-between group hover:border-indigo-500/30 transition-all gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4 text-left",children:[c.jsx("div",{className:"p-3 bg-indigo-500 rounded-xl text-white shadow-lg shrink-0",children:c.jsx(gv,{size:20})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-800 dark:text-white",children:"Ayuda Tcnica"}),c.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mt-0.5",children:"Reportar errores o dudas"})]})]}),c.jsx(aS,{size:18,className:"text-slate-300 group-hover:text-indigo-500 transition-colors shrink-0"})]})}),c.jsx("div",{className:"card-premium p-6 bg-red-500/5 dark:bg-red-500/10 border border-red-500/10 shadow-sm",children:c.jsxs("button",{onClick:u,className:"w-full h-16 px-6 bg-white dark:bg-slate-900 rounded-2xl border border-red-500/20 flex items-center justify-center gap-3 text-red-500 hover:bg-red-500 hover:text-white transition-all active:scale-95 shadow-lg shadow-red-500/5 min-h-[64px]",children:[c.jsx(Hd,{size:20}),c.jsx("span",{className:"text-[11px] font-black uppercase tracking-[0.3em]",children:"SALIR DEL SISTEMA"})]})}),c.jsx(Sv,{onStoreDeleted:G}),c.jsx($d,{isOpen:k,onClose:()=>y(!1)}),c.jsx(Mr,{isOpen:v,onClose:()=>b(!1),title:"CIERRE DE TERMINAL",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-950 rounded-xl border border-slate-100 dark:border-slate-800 text-center",children:[c.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:"Esperado"}),c.jsxs("p",{className:"text-2xl font-black text-brand-blue",children:["$",_.toLocaleString()]})]}),c.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-950 rounded-xl border border-slate-100 dark:border-slate-800 text-center",children:[c.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:"Fecha"}),c.jsx("p",{className:"text-[11px] font-black text-slate-800 dark:text-white uppercase",children:new Date().toLocaleDateString()})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Efectivo Real"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-2xl font-black text-slate-300",children:"$"}),c.jsx("input",{type:"number",autoFocus:!0,className:"w-full h-16 pl-12 pr-4 text-4xl font-black bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl outline-none focus:border-brand-blue text-slate-900 dark:text-white transition-all shadow-inner",placeholder:"0.00",value:w,onChange:H=>N(H.target.value)})]})]}),c.jsxs("div",{className:`p-5 rounded-2xl border-2 flex justify-between items-center transition-all ${O<0?"bg-red-500/5 border-red-500/20 text-red-500":"bg-emerald-500/5 border-emerald-500/20 text-emerald-500"}`,children:[c.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:O<0?"Faltante":"Balance"}),c.jsxs("span",{className:"text-3xl font-black",children:["$",Math.abs(O).toFixed(2)]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[c.jsx("button",{className:"flex-1 h-14 text-[10px] font-black uppercase tracking-widest rounded-xl border-2 border-slate-200 dark:border-slate-800 order-2 sm:order-1 min-h-[56px]",onClick:()=>b(!1),children:"Cancelar"}),c.jsx("button",{className:"flex-1 h-14 bg-red-600 text-white rounded-xl text-[10px] font-black uppercase tracking-widest shadow-lg order-1 sm:order-2 min-h-[56px]",onClick:L,children:"Cerrar Turno"})]})]})})]})},nj=e=>{const n=Number(e);return isNaN(n)?"0.00":n.toFixed(2)},ib=({targetStoreId:e})=>{const{sales:n,cancelSale:a,currentUser:s}=Jt(),[i,u]=D.useState(""),[f,d]=D.useState(!0),[m,x]=D.useState(null),[g,v]=D.useState(!1),[b,k]=D.useState(!1),[y,w]=D.useState(null),[N,_]=D.useState(!1),[O,E]=D.useState([]),[L,G]=D.useState(!1);D.useEffect(()=>{e&&(async()=>{G(!0);try{console.log(` Fetching sales for store: ${e}`);const ee=await gs.getAll({storeId:e});E(ee),console.log(` Loaded ${ee.length} sales for store`)}catch(ee){console.error("Error fetching store sales:",ee),E([])}finally{G(!1)}})()},[e]);const R=(e?O:n).filter(K=>{if(!(K.id.toLowerCase().includes(i.toLowerCase())||K.date.includes(i)))return!1;if(f){const Ee=new Date(K.date).toLocaleDateString(),Ne=new Date().toLocaleDateString();return Ee===Ne}return!0}).sort((K,ee)=>new Date(ee.date).getTime()-new Date(K.date).getTime()),Z=K=>{if(!wp()){k(!0);return}x(K),v(!1)},Y=K=>{if(!wp()){k(!0);return}x(K),v(!0)},Q=async()=>{if(y){_(!0);try{if(a)await a(y.id);else throw new Error("Funcin cancelSale no disponible");if(e){const K=await gs.getAll({storeId:e});E(K)}w(null)}catch(K){console.error(" Error al cancelar venta:",K)}finally{_(!1)}}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 bg-pink-50 dark:bg-pink-950/10 p-8 rounded-3xl border border-pink-100 dark:border-pink-900/30 shadow-sm border-t-4 border-t-brand-pink",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"p-3 bg-brand-pink text-white rounded-2xl shadow-lg shadow-brand-pink/20",children:c.jsx(Ri,{className:"h-6 w-6"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Bitcora Global"}),c.jsx("p",{className:"text-[10px] text-brand-muted uppercase tracking-widest font-black",children:f?"Transacciones de HOY":"Historial Completo"})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto items-center",children:[c.jsx(at,{variant:f?"primary":"secondary",onClick:()=>d(!f),className:"text-xs h-12 whitespace-nowrap px-6",children:f?"VER TODO EL HISTORIAL":"VER SOLO HOY"}),c.jsxs("div",{className:"relative w-full sm:w-80",children:[c.jsx(ic,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-brand-pink h-4 w-4"}),c.jsx("input",{type:"text",placeholder:"Buscar por ID o Fecha...",className:"w-full pl-12 pr-6 py-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-2xl text-slate-900 dark:text-white focus:border-brand-pink focus:outline-none text-sm font-bold shadow-sm",value:i,onChange:K=>u(K.target.value)})]})]})]}),c.jsx("div",{className:"card-premium overflow-x-auto md:overflow-visible border-t-2 border-t-brand-pink/20 shadow-lg",children:c.jsxs("div",{className:"table-scroll-container",children:[c.jsxs("table",{className:"min-w-full divide-y divide-brand-border",children:[c.jsx("thead",{className:"bg-pink-50/50 dark:bg-pink-950/20",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-8 py-5 text-left text-[10px] font-black text-brand-pink dark:text-pink-400 uppercase tracking-widest",children:"Fecha y Hora"}),c.jsx("th",{className:"px-8 py-5 text-left text-[10px] font-black text-brand-pink dark:text-pink-400 uppercase tracking-widest",children:"Transaccin"}),c.jsx("th",{className:"px-8 py-5 text-left text-[10px] font-black text-brand-pink dark:text-pink-400 uppercase tracking-widest",children:"Agente"}),c.jsx("th",{className:"px-8 py-5 text-right text-[10px] font-black text-brand-pink dark:text-pink-400 uppercase tracking-widest",children:"Total"}),c.jsx("th",{className:"px-8 py-5 text-center text-[10px] font-black text-brand-pink dark:text-pink-400 uppercase tracking-widest",children:"Estado"}),c.jsx("th",{className:"px-8 py-5 text-center text-[10px] font-black text-brand-pink dark:text-pink-400 uppercase tracking-widest",children:"Accin"})]})}),c.jsx("tbody",{className:"divide-y divide-brand-border",children:L?c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-8 py-16 text-center",children:c.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[c.jsx(to,{className:"h-8 w-8 text-brand-pink animate-spin"}),c.jsx("p",{className:"text-sm font-bold text-brand-muted",children:"Cargando ventas..."})]})})}):R.map(K=>c.jsxs("tr",{className:`transition-all ${K.status==="CANCELLED"?"opacity-40":"hover:bg-brand-pink/5"}`,children:[c.jsx("td",{className:"px-8 py-5 whitespace-nowrap text-sm font-medium text-brand-muted",children:new Date(K.date).toLocaleString()}),c.jsxs("td",{className:"px-8 py-5 whitespace-nowrap text-xs font-black text-slate-800 dark:text-brand-text font-mono",children:["#",String(K.id||K._id||"").slice(0,8).toUpperCase()]}),c.jsx("td",{className:"px-8 py-5 whitespace-nowrap text-xs font-bold text-brand-muted uppercase",children:K.sellerId}),c.jsxs("td",{className:`px-8 py-5 whitespace-nowrap text-lg text-right font-black ${K.status==="CANCELLED"?"line-through":"text-brand-pink"}`,children:["$",nj(K.total)]}),c.jsx("td",{className:"px-8 py-5 whitespace-nowrap text-center",children:c.jsx("span",{className:`px-4 py-1 rounded-full text-[9px] font-black uppercase ${K.status==="ACTIVE"?"bg-emerald-500/10 text-emerald-500":"bg-red-500/10 text-red-500"}`,children:K.status==="ACTIVE"?"Aprobada":"Devolucin"})}),c.jsx("td",{className:"px-8 py-5 whitespace-nowrap text-center",children:c.jsxs("div",{className:"flex justify-center gap-2",children:[c.jsxs(at,{variant:"secondary",onClick:()=>Z(K),className:"h-8 text-[10px]",children:[c.jsx(pv,{size:14,className:"mr-1"}),"DETALLES"]}),c.jsxs(at,{variant:"primary",onClick:()=>Y(K),className:"h-8 text-[10px] bg-slate-900 text-white hover:bg-slate-800",children:[c.jsx(lE,{size:14,className:"mr-1"}),"IMPRIMIR"]}),K.status==="ACTIVE"&&c.jsxs(at,{variant:"secondary",onClick:()=>w(K),className:"h-8 text-[10px] bg-red-500 text-white hover:bg-red-600 border-red-500",children:[c.jsx(qi,{size:14,className:"mr-1"}),"CANCELAR"]})]})})]},K.id))})]}),!L&&R.length===0&&c.jsxs("div",{className:"p-8 text-center text-brand-muted font-bold text-sm",children:["No hay transacciones ",f?"para el da de hoy":"que coincidan con la bsqueda","."]})]})}),m&&c.jsx(Mr,{isOpen:!!m,onClose:()=>{x(null),v(!1)},title:`Detalles de Venta #${String(m.id||m._id||"").slice(0,8).toUpperCase()}`,children:c.jsx("div",{className:"flex flex-col items-center",children:c.jsx(Nv,{items:m.items,total:m.total,paymentMethod:m.paymentMethod,sellerId:m.sellerId,folio:String(m.id||m._id||"").slice(0,8),date:m.date,onClose:()=>{x(null),v(!1)},shouldAutoPrint:g,storeInfo:{name:(s==null?void 0:s.storeName)||"TEIKON OS TERMINAL",address:"NODO OPERATIVO ACTIVO",phone:(s==null?void 0:s.phone)||"N/A"},hideControls:!1})})}),b&&c.jsx(Mr,{isOpen:b,onClose:()=>window.location.href="/login",title:"Sesin Expirada",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-base",children:"Tu sesin ha expirado. Por favor, inicia sesin nuevamente para imprimir tickets."}),c.jsx(at,{variant:"primary",onClick:()=>window.location.href="/login",className:"w-full",children:"Ir a Inicio de Sesin"})]})}),y&&c.jsx(Mr,{isOpen:!!y,onClose:()=>w(null),title:" Cancelar Venta",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("p",{className:"text-base text-slate-700 dark:text-slate-300",children:["Ests seguro de cancelar la venta ",c.jsxs("strong",{children:["#",String(y.id||y._id||"").slice(0,8).toUpperCase()]}),"?"]}),c.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"El inventario ser restaurado automticamente y esta accin no se puede deshacer."}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx(at,{variant:"secondary",onClick:()=>w(null),className:"flex-1",disabled:N,children:"No, mantener venta"}),c.jsx(at,{variant:"primary",onClick:Q,className:"flex-1 bg-red-500 hover:bg-red-600",disabled:N,children:N?c.jsxs(c.Fragment,{children:[c.jsx(to,{className:"mr-2 h-4 w-4 animate-spin"}),"Cancelando..."]}):"S, cancelar venta"})]})]})})]})},sj=({onSuccess:e,onClose:n})=>{const[a,s]=D.useState(""),[i,u]=D.useState(""),[f,d]=D.useState(null),m=x=>{x.preventDefault(),d(null),a==="dev"&&i==="3232"?e():d("Credenciales de desarrollador invlidas. Acceso denegado.")};return c.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[c.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-md transition-opacity",onClick:n}),c.jsxs("div",{className:"relative w-full max-w-md bg-white dark:bg-slate-900 rounded-[2.5rem] shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden transform transition-all",children:[c.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 blur-3xl -mr-16 -mt-16 pointer-events-none"}),c.jsxs("div",{className:"p-10",children:[c.jsxs("div",{className:"flex justify-between items-start mb-8",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2.5 bg-indigo-600 rounded-2xl shadow-lg shadow-indigo-600/20",children:c.jsx(TE,{size:20,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.3em] text-slate-900 dark:text-white",children:"Dev Portal"}),c.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mt-0.5",children:"Mdulo de Ingeniera"})]})]}),c.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl transition-colors text-slate-400 hover:text-slate-900 dark:hover:text-white",children:c.jsx(Nr,{size:20})})]}),c.jsxs("form",{onSubmit:m,className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Usuario"}),c.jsxs("div",{className:"relative group",children:[c.jsx(Fr,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500 transition-colors",size:18}),c.jsx("input",{type:"text",required:!0,value:a,onChange:x=>s(x.target.value),placeholder:"dev_access",className:"w-full pl-12 pr-6 py-4 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl text-xs font-bold focus:outline-none focus:border-indigo-500 dark:focus:border-indigo-500 transition-all text-slate-900 dark:text-white"})]})]}),c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Contrasea"}),c.jsxs("div",{className:"relative group",children:[c.jsx(Xi,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500 transition-colors",size:18}),c.jsx("input",{type:"password",required:!0,value:i,onChange:x=>u(x.target.value),placeholder:"",className:"w-full pl-12 pr-6 py-4 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl text-xs font-bold focus:outline-none focus:border-indigo-500 dark:focus:border-indigo-500 transition-all text-slate-900 dark:text-white"})]})]})]}),f&&c.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-2xl flex items-center gap-3 animate-in fade-in slide-in-from-top-2",children:[c.jsx(Vd,{className:"text-red-500 shrink-0",size:18}),c.jsx("p",{className:"text-[10px] font-black text-red-500 uppercase tracking-widest",children:f})]}),c.jsx("button",{type:"submit",className:"w-full bg-slate-900 dark:bg-indigo-600 hover:bg-slate-800 dark:hover:bg-indigo-500 text-white py-5 rounded-2xl text-[11px] font-black uppercase tracking-[0.3em] shadow-xl shadow-indigo-600/10 transition-all active:scale-[0.98] mt-4",children:"Iniciar Override"})]}),c.jsx("p",{className:"mt-8 text-center text-[8px] font-black text-slate-400 uppercase tracking-[0.4em] opacity-50",children:"TEIKON ENGINEERING SECURE ACCESS"})]})]})]})},lj=()=>{const e=sc(),{login:n}=Jt(),[a,s]=D.useState(!1),[i,u]=D.useState(null),[f,d]=D.useState(!1),[m,x]=D.useState(""),[g,v]=D.useState(""),[b,k]=D.useState(!1),[y,w]=D.useState(!1),[N,_]=D.useState(""),[O,E]=D.useState(""),[L,G]=D.useState(!1),H=async Z=>{Z.preventDefault(),u(null),s(!0);const Y=localStorage.getItem("token");if(Y)try{const K=Y.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),ee=decodeURIComponent(atob(K).split("").map(Ne=>"%"+("00"+Ne.charCodeAt(0).toString(16)).slice(-2)).join("")),Ee=JSON.parse(ee);Ee.exp&&Ee.exp*1e3<Date.now()&&(console.log(" Clearing expired token before login attempt"),localStorage.removeItem("token"),localStorage.removeItem("cashSession"),localStorage.removeItem("selectedStore"))}catch{console.warn(" Clearing corrupted token before login attempt"),localStorage.removeItem("token"),localStorage.removeItem("cashSession"),localStorage.removeItem("selectedStore")}try{const Q=await zd.login(m,g);n(Q.token),Q.user&&Q.user.storeId&&localStorage.setItem("currentStoreId",Q.user.storeId),Q.user.role==="SUPER_ADMIN"?(console.log(" Bienvenido Jefe - Redirigiendo a Panel de Tiendas"),e("/admin/stores")):(console.log(" Bienvenido Cliente - Redirigiendo al Dashboard"),e("/dashboard"))}catch(Q){console.error(Q);const K=Q.message||"";K.includes("401")||K.includes("Credenciales")?u("Usuario o contrasea incorrectos"):K.includes("NETWORK_ERROR")?u("No se pudo conectar al servidor. Verifica tu conexin."):u(K||"Error de autenticacin")}finally{s(!1)}},R=()=>{n("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJkZXYtcm9vdCIsInVzZXJuYW1lIjoiZGV2X2VuZ2luZWVyIiwicm9sZSI6IlNVUEVSX0FETUlOIiwic3RvcmVJZCI6bnVsbCwiZXhwIjo5OTk5OTk5OTk5fQ.mock"),d(!1),e("/admin/dashboard")};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-brand-bg px-4 overflow-hidden relative",children:[c.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-brand-purple/5 blur-[120px] rounded-full -mr-40 -mt-40 pointer-events-none"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-brand-pink/5 blur-[120px] rounded-full -ml-40 -mb-40 pointer-events-none"}),c.jsxs("div",{className:"max-w-md w-full relative z-10",children:[c.jsxs("div",{className:"flex flex-col items-center mb-10 text-center",children:[c.jsx(Xd,{size:80,className:"mb-6"}),c.jsx(zE,{height:24,className:"text-slate-900 dark:text-white"}),c.jsx("p",{className:"text-[10px] font-black text-brand-muted uppercase tracking-[0.4em] mt-4",children:"INVENTORY SOFTWARE"})]}),c.jsx("div",{className:"bg-white dark:bg-brand-panel backdrop-blur-md p-8 border border-slate-200 dark:border-brand-border rounded-3xl shadow-2xl transition-all duration-300",children:c.jsxs("form",{onSubmit:H,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-brand-muted uppercase tracking-widest pl-1",children:"Usuario"}),c.jsxs("div",{className:"relative",children:[c.jsx(Fr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-brand-muted h-4 w-4"}),c.jsx("input",{type:"text",required:!0,value:m,onChange:Z=>x(Z.target.value),className:"w-full bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 rounded-xl pl-10 pr-4 py-3 text-sm focus:border-brand-purple transition-all outline-none font-bold text-slate-900 dark:text-white uppercase placeholder:normal-case",placeholder:"admin_user"})]})]}),c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-brand-muted uppercase tracking-widest pl-1",children:"Contrasea"}),c.jsxs("div",{className:"relative",children:[c.jsx(Xi,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-brand-muted h-4 w-4"}),c.jsx("input",{type:b?"text":"password",required:!0,value:g,onChange:Z=>v(Z.target.value),className:"w-full bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 rounded-xl pl-10 pr-12 py-3 text-sm focus:border-brand-purple transition-all outline-none font-bold text-slate-900 dark:text-white",placeholder:""}),c.jsx("button",{type:"button",onClick:()=>k(!b),className:"absolute right-3 top-1/2 -translate-y-1/2 text-brand-muted hover:text-brand-purple transition-colors p-1 rounded-lg hover:bg-slate-100 dark:hover:bg-white/5 active:scale-95","aria-label":b?"Ocultar contrasea":"Mostrar contrasea",children:b?c.jsx(pS,{className:"h-4 w-4"}):c.jsx(K0,{className:"h-4 w-4"})})]})]}),i&&c.jsxs("div",{className:"flex items-center gap-2 text-red-500 bg-red-500/10 p-3 text-[10px] font-bold rounded-xl border border-red-500/20 animate-in slide-in-from-top-2",children:[c.jsx(Vd,{size:14,className:"shrink-0"}),c.jsx("span",{children:i})]}),c.jsx(at,{type:"submit",variant:"primary",fullWidth:!0,disabled:a,className:"py-4 rounded-xl bg-slate-900 dark:bg-white text-white dark:text-black border-none text-[10px] font-black tracking-widest shadow-xl mt-4 hover:scale-[1.02] active:scale-[0.98] transition-transform",children:a?c.jsx(to,{className:"animate-spin"}):"INICIAR SESIN"})]})})]})]}),f&&c.jsx(sj,{onSuccess:R,onClose:()=>d(!1)})]})},ij=({storeId:e})=>{const[n,a]=D.useState([]),[s,i]=D.useState(!0),[u,f]=D.useState(new Date().getFullYear()),d=Q0();d==null||d.role;const m=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];D.useEffect(()=>{e&&x();const k=()=>{x()};return window.addEventListener("goalUpdated",k),()=>window.removeEventListener("goalUpdated",k)},[e,u]);const x=async()=>{i(!0);try{const k={Authorization:`Bearer ${qn()}`,"Content-Type":"application/json"},y=await fetch(`${rt}/api/stores/${e}/goal-history?year=${u}`,{headers:k}),w=y.ok?await y.json():[],N=await fetch(`${rt}/api/stores/${e}/sales-history?year=${u}`,{headers:k}),_=N.ok?await N.json():[],O=Array.from({length:12},(E,L)=>{const G=L+1,H=w.find(Z=>Z.month===G),R=_.find(Z=>Z.month===G);return{month:G,year:u,goal:H?parseFloat(H.amount):0,sales:R?parseFloat(R.totalSales):0}});a(O)}catch(k){console.error("Error fetching comparative data:",k)}finally{i(!1)}};if(s)return c.jsx("div",{className:"card-premium p-6 md:p-8 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-[2rem] flex items-center justify-center min-h-[300px]",children:c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsx(Lw,{className:"text-indigo-500 animate-pulse",size:32}),c.jsx("p",{className:"text-[10px] font-black tracking-widest uppercase text-slate-400",children:"Analizando Histrico..."})]})});const g=n[new Date().getMonth()],v=(g==null?void 0:g.goal)>0?g.sales/g.goal*100:0,b=Math.max(...n.map(k=>Math.max(k.goal,k.sales)),1e3);return c.jsxs("div",{className:"card-premium p-6 md:p-8 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-[2rem] space-y-8 animate-fade-in-up",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"p-3 rounded-2xl bg-indigo-500/10 text-indigo-500 shrink-0",children:c.jsx(Vn,{size:24})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-black uppercase tracking-tight text-slate-900 dark:text-white",children:"Rendimiento Histrico"}),c.jsx("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Ventas Reales vs. Meta de Equilibrio"})]})]}),c.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 dark:bg-black/20 p-2 rounded-xl border border-slate-100 dark:border-slate-800",children:[c.jsx(xv,{size:16,className:"text-slate-400 ml-2"}),c.jsxs("select",{value:u,onChange:k=>f(parseInt(k.target.value)),className:"bg-transparent text-sm font-bold text-slate-700 dark:text-white outline-none cursor-pointer pr-4",children:[c.jsx("option",{value:new Date().getFullYear(),children:new Date().getFullYear()}),c.jsx("option",{value:new Date().getFullYear()-1,children:new Date().getFullYear()-1})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"p-5 rounded-3xl bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-slate-800 flex flex-col justify-center",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400 mb-1",children:"Meta Este Mes"}),c.jsxs("p",{className:"text-2xl font-black text-slate-800 dark:text-white",children:["$",g==null?void 0:g.goal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),c.jsxs("div",{className:"p-5 rounded-3xl bg-indigo-50 dark:bg-indigo-900/10 border border-indigo-100 dark:border-indigo-900/30 flex flex-col justify-center",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-indigo-500 mb-1",children:"Ventas Reales"}),c.jsxs("div",{className:"flex items-end justify-between",children:[c.jsxs("p",{className:"text-2xl font-black text-indigo-600 dark:text-indigo-400",children:["$",g==null?void 0:g.sales.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),(g==null?void 0:g.sales)>=(g==null?void 0:g.goal)&&(g==null?void 0:g.goal)>0?c.jsx(md,{size:20,className:"text-emerald-500"}):c.jsx(xd,{size:20,className:"text-rose-500"})]})]}),c.jsxs("div",{className:"p-5 rounded-3xl bg-slate-900 dark:bg-black text-white shadow-xl shadow-slate-900/20 flex flex-col justify-center relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/20 rounded-full -translate-y-1/2 translate-x-1/2 blur-2xl pointer-events-none"}),c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400 mb-2 relative z-10",children:"Progreso Mensual"}),c.jsx("div",{className:"flex items-center gap-3 relative z-10",children:c.jsxs("p",{className:"text-3xl font-black",children:[v.toFixed(1),"%"]})}),c.jsx("div",{className:"w-full h-1.5 bg-white/10 rounded-full mt-3 overflow-hidden relative z-10",children:c.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${v>=100?"bg-emerald-400":"bg-indigo-400"}`,style:{width:`${Math.min(v,100)}%`}})})]})]}),c.jsxs("div",{className:"pt-6",children:[c.jsxs("div",{className:"flex items-center justify-end gap-6 mb-8 text-xs font-bold",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200 dark:bg-slate-700"}),c.jsx("span",{className:"text-slate-500",children:"Meta Objetivo"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded-full bg-indigo-500 shadow-sm shadow-indigo-500/30"}),c.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"Ventas Reales"})]})]}),c.jsxs("div",{className:"h-[250px] flex items-end justify-between gap-2 md:gap-4 relative pt-6",children:[c.jsx("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none border-b border-slate-100 dark:border-slate-800",children:[4,3,2,1,0].map((k,y)=>c.jsx("div",{className:"w-full relative h-[1px] bg-slate-50 dark:bg-slate-800/50",children:y!==4&&c.jsxs("span",{className:"absolute -top-2 -left-2 -translate-x-full text-[9px] font-bold text-slate-400",children:["$",(b/4*k).toLocaleString(void 0,{notation:"compact"})]})},y))}),n.map((k,y)=>{const w=Math.max(k.goal/b*100,0),N=Math.max(k.sales/b*100,0),_=new Date().getMonth()===y&&u===new Date().getFullYear();return c.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2 relative group z-10",children:[c.jsxs("div",{className:"absolute -top-12 opacity-0 group-hover:opacity-100 pt-2 transition-all bg-slate-900 text-white text-[10px] font-bold py-1.5 px-3 rounded-lg shadow-xl pointer-events-none z-20 whitespace-nowrap",children:["Meta: $",k.goal.toLocaleString(void 0,{maximumFractionDigits:0}),c.jsx("br",{}),"Real: $",k.sales.toLocaleString(void 0,{maximumFractionDigits:0}),c.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-slate-900 rotate-45"})]}),c.jsxs("div",{className:"w-full flex justify-center items-end h-[200px] gap-0.5 md:gap-1",children:[c.jsx("div",{className:"w-1/2 max-w-[16px] bg-slate-200 dark:bg-slate-700 rounded-t-sm transition-all duration-700 hover:bg-slate-300 dark:hover:bg-slate-600",style:{height:`${w}%`}}),c.jsx("div",{className:`w-1/2 max-w-[16px] rounded-t-sm transition-all duration-700 relative overflow-hidden ${k.sales>=k.goal&&k.goal>0?"bg-emerald-500 hover:bg-emerald-400":"bg-indigo-500 hover:bg-indigo-400"}`,style:{height:`${N}%`},children:c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})})]}),c.jsx("span",{className:`text-[9px] md:text-[10px] font-black uppercase tracking-widest ${_?"text-indigo-600 dark:text-indigo-400":"text-slate-400"}`,children:m[y]})]},y)})]})]})]})},Ig=({storeId:e,mode:n="cash"})=>{var _,O,E,L;const[a,s]=D.useState(""),[i,u]=D.useState(null),[f,d]=D.useState(!1),[m,x]=D.useState(!1),g=Q0(),v=(g==null?void 0:g.role)==="SUPER_ADMIN";D.useEffect(()=>{n==="settings"&&k(),n==="cash"&&y()},[e,n]);const b=()=>({Authorization:`Bearer ${qn()}`,"Content-Type":"application/json"}),k=async()=>{try{const G=new Date,H=G.getFullYear(),R=G.getMonth()+1,Z=await fetch(`${rt}/api/stores/${e}/goal-history?year=${H}`,{headers:b()});if(Z.ok){const Q=(await Z.json()).find(K=>K.month===R&&K.year===H);s(Q?Q.amount:"")}}catch(G){console.error("Error loading goal history:",G)}},y=async()=>{d(!0);try{const G=await fetch(`${rt}/api/sales/cash-close?storeId=${e}`,{headers:b()});if(!G.ok)throw new Error("Error fetching cash close data");const H=await G.json();u(H)}catch(G){console.error("Error cargando corte:",G),v||alert("No se pudo cargar el corte de caja. Por favor intente de nuevo.")}finally{d(!1)}},w=async()=>{x(!0);try{const G=parseFloat(a);if(isNaN(G)||G<0){alert("Por favor ingresa un monto vlido mayor o igual a 0");return}if((await fetch(`${rt}/api/stores/${e}/goal`,{method:"PUT",headers:b(),body:JSON.stringify({amount:G})})).ok)alert("Meta mensual actualizada correctamente"),window.dispatchEvent(new Event("goalUpdated"));else throw new Error("Error en respuesta del servidor")}catch(G){console.error("Error al guardar meta:",G),alert("Error al guardar meta mensual")}finally{x(!1)}},N=()=>{if(!i)return;const G=`Confirmar Cierre de Caja?

Total Recaudado: $${(i.total||0).toLocaleString()}
Transacciones: ${i.count||0}

Esta accin generar el reporte final del da.`;confirm(G)&&alert(` Turno Cerrado Exitosamente.
El reporte ha sido enviado al administrador.`)};return n==="settings"?c.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[c.jsxs("div",{className:"card-premium p-6 md:p-8 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-[2rem]",children:[c.jsxs("div",{className:"flex items-start justify-between mb-6",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"p-3 rounded-2xl bg-indigo-500/10 text-indigo-500",children:c.jsx(Gd,{size:24})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-black uppercase tracking-tight text-slate-900 dark:text-white",children:"Configuracin de Meta"}),c.jsx("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:v?"Vista de auditora - Solo lectura":"Define el punto de equilibrio mensual para esta tienda."})]})]}),v&&c.jsxs("div",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 rounded-lg text-[10px] font-black uppercase flex items-center gap-2",children:[c.jsx(K0,{size:12}),"MODO AUDITORA"]})]}),c.jsxs("div",{className:"flex gap-4 items-end max-w-md",children:[c.jsxs("div",{className:"w-full",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 ml-1 mb-1 block",children:"Meta Mensual ($)"}),c.jsx("input",{type:"number",value:a,onChange:G=>s(G.target.value),disabled:v,className:`w-full text-xl font-bold p-4 bg-slate-50 dark:bg-black/20 border-2 border-slate-100 dark:border-slate-700 rounded-2xl focus:border-indigo-500 outline-none transition-colors ${v?"opacity-60 cursor-not-allowed":""}`,placeholder:"0.00"})]}),!v&&c.jsx(at,{variant:"primary",onClick:w,disabled:m,icon:dE,className:"h-[60px] px-6",children:m?"...":"GUARDAR"})]}),v&&c.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900/50 rounded-xl",children:c.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-400 font-bold flex items-center gap-2",children:[c.jsx(Ba,{size:14}),"Como Super Admin, puedes ver esta configuracin pero no modificarla. Solo el dueo de la tienda puede editar la meta mensual."]})})]}),c.jsx(ij,{storeId:e})]}):v?c.jsx("div",{className:"space-y-6 animate-fade-in-up",children:c.jsxs("div",{className:"card-premium p-6 md:p-8 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-[2rem] relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-blue-500/5 rounded-full -translate-y-1/2 translate-x-1/2 blur-3xl pointer-events-none"}),c.jsxs("div",{className:"flex items-start justify-between mb-8 relative",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"p-3 rounded-2xl bg-blue-500/10 text-blue-500",children:c.jsx(K0,{size:24})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-black uppercase tracking-tight text-slate-900 dark:text-white",children:"Modo Auditora - Estado de Caja"}),c.jsx("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Vista en tiempo real - Solo lectura (Sin permisos operativos)"})]})]}),c.jsxs("div",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 rounded-lg text-[10px] font-black uppercase flex items-center gap-2",children:[c.jsx(K0,{size:12}),"SUPER ADMIN"]})]}),f?c.jsx("div",{className:"h-40 flex items-center justify-center text-slate-400 font-bold uppercase text-xs animate-pulse",children:"Cargando datos de auditora..."}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mb-6 p-6 rounded-2xl bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-950/20 dark:to-green-950/20 border border-emerald-200 dark:border-emerald-900/50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"}),c.jsx("span",{className:"text-sm font-black text-emerald-700 dark:text-emerald-400 uppercase tracking-wider",children:" CAJA ABIERTA"})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase",children:"Turno Actual"}),c.jsx("p",{className:"text-xs text-slate-700 dark:text-slate-300 font-black",children:"Activo desde hoy"})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[c.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-slate-800",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Fr,{size:14,className:"text-slate-400"}),c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400",children:"Abierto Por"})]}),c.jsx("p",{className:"text-sm font-bold text-slate-800 dark:text-white",children:"Usuario de Tienda"})]}),c.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-slate-800",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(oS,{size:14,className:"text-slate-400"}),c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400",children:"Hora de Apertura"})]}),c.jsx("p",{className:"text-sm font-bold text-slate-800 dark:text-white",children:new Date().toLocaleTimeString()})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"p-6 rounded-3xl bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-slate-800",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400 mb-2",children:"Total Efectivo"}),c.jsxs("p",{className:"text-2xl font-black text-slate-800 dark:text-white",children:["$",(((_=i==null?void 0:i.methods)==null?void 0:_.CASH)||0).toLocaleString()]})]}),c.jsxs("div",{className:"p-6 rounded-3xl bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-slate-800",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400 mb-2",children:"Total Tarjeta"}),c.jsxs("p",{className:"text-2xl font-black text-slate-800 dark:text-white",children:["$",(((O=i==null?void 0:i.methods)==null?void 0:O.CARD)||0).toLocaleString()]})]}),c.jsxs("div",{className:"p-6 rounded-3xl bg-blue-500 text-white shadow-lg shadow-blue-500/20",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-blue-100 mb-2",children:"Venta Total"}),c.jsxs("p",{className:"text-3xl font-black",children:["$",((i==null?void 0:i.total)||0).toLocaleString()]})]})]}),c.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900/50 rounded-xl",children:c.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-400 font-bold flex items-center gap-2",children:[c.jsx(Ba,{size:14}),"Modo Auditora Activo: Puedes visualizar el estado de la caja pero no realizar operaciones de apertura/cierre. Solo el personal de la tienda puede ejecutar estas acciones."]})})]})]})}):c.jsx("div",{className:"space-y-6 animate-fade-in-up",children:c.jsxs("div",{className:"card-premium p-6 md:p-8 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-[2rem] relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full -translate-y-1/2 translate-x-1/2 blur-3xl pointer-events-none"}),c.jsxs("div",{className:"flex items-start justify-between mb-8 relative",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"p-3 rounded-2xl bg-emerald-500/10 text-emerald-500",children:c.jsx(Pd,{size:24})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-black uppercase tracking-tight text-slate-900 dark:text-white",children:"Cierre de Caja"}),c.jsx("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Resumen operativo del da en curso (Solo esta tienda)."})]})]}),c.jsx("div",{className:"px-3 py-1 bg-emerald-100 dark:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 rounded-lg text-[10px] font-black uppercase",children:"TURNO ACTIVO"})]}),f?c.jsx("div",{className:"h-40 flex items-center justify-center text-slate-400 font-bold uppercase text-xs animate-pulse",children:"Cargando datos financieros..."}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[c.jsxs("div",{className:"p-6 rounded-3xl bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-slate-800",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400 mb-2",children:"Total Efectivo"}),c.jsxs("p",{className:"text-2xl font-black text-slate-800 dark:text-white",children:["$",(((E=i==null?void 0:i.methods)==null?void 0:E.CASH)||0).toLocaleString()]})]}),c.jsxs("div",{className:"p-6 rounded-3xl bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-slate-800",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400 mb-2",children:"Total Tarjeta"}),c.jsxs("p",{className:"text-2xl font-black text-slate-800 dark:text-white",children:["$",(((L=i==null?void 0:i.methods)==null?void 0:L.CARD)||0).toLocaleString()]})]}),c.jsxs("div",{className:"p-6 rounded-3xl bg-emerald-500 text-white shadow-lg shadow-emerald-500/20",children:[c.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-emerald-100 mb-2",children:"Venta Total"}),c.jsxs("p",{className:"text-3xl font-black",children:["$",((i==null?void 0:i.total)||0).toLocaleString()]})]})]}),c.jsx("div",{className:"flex justify-end pt-6 border-t border-slate-100 dark:border-slate-800",children:c.jsx(at,{variant:"danger",onClick:N,icon:mv,className:"py-4 px-8 text-xs bg-slate-900 hover:bg-black text-white",children:"REALIZAR CIERRE DE TURNO"})})]})]})})},cj=({onExit:e})=>{sc();const{currentUser:n}=Jt(),[a,s]=D.useState("stores"),[i,u]=D.useState(null),[f,d]=D.useState("dashboard"),[m,x]=D.useState([]),[g,v]=D.useState(!1),[b,k]=D.useState(""),[y,w]=D.useState([]),[N,_]=D.useState(!1),[O,E]=D.useState({name:"",email:"",password:"",phone:"",ownerName:""}),[L,G]=D.useState(!1),[H,R]=D.useState(null),[Z,Y]=D.useState("info"),[Q,K]=D.useState({name:"",ownerName:"",email:"",newPassword:""}),[ee,Ee]=D.useState(!1),[Ne,me]=D.useState(null),[J,se]=D.useState("");D.useEffect(()=>{Ae(),ae()},[a,i]);const Ae=async()=>{v(!0);try{const T=await Y0.getAll();x(T)}catch(T){console.error("Error fetching stores:",T)}finally{v(!1)}},ae=async()=>{try{const T=await uw.getAll();w(T)}catch(T){console.error("Error loading tickets",T)}},Ce=async T=>{T.preventDefault();try{if(!O.name||!O.email||!O.password){alert("Por favor complete todos los campos obligatorios");return}await Y0.create({nombre:O.name,usuario:O.email,password:O.password,telefono:O.phone,ownerName:O.ownerName,direccion:"N/A"}),alert(" Tienda y Usuario Admin creados exitosamente"),_(!1),E({name:"",email:"",password:"",phone:"",ownerName:""}),Ae()}catch(z){alert(" Error al crear tienda: "+z.message)}},B=m.filter(T=>T.name.toLowerCase().includes(b.toLowerCase())||T.ownerName.toLowerCase().includes(b.toLowerCase())||T.ownerEmail.toLowerCase().includes(b.toLowerCase())),A=()=>i?c.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right duration-300",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>u(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-full transition-colors","aria-label":"Volver a la lista",children:c.jsx(Kf,{size:24,className:"text-slate-600 dark:text-slate-300"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-black text-slate-900 dark:text-white uppercase",children:i.name}),c.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm font-bold",children:[c.jsx(Fr,{size:14})," ",c.jsx("span",{children:i.ownerName}),c.jsx("span",{className:"mx-1",children:""}),c.jsx(ro,{size:14})," ",c.jsx("span",{children:"Modo Super Admin"})]})]})]}),c.jsx("div",{className:"flex gap-2 mt-4 md:mt-0 bg-slate-100 dark:bg-slate-900/50 p-1 rounded-xl",children:[{id:"dashboard",icon:MS,label:"DASHBOARD"},{id:"products",icon:vl,label:"PRODUCTOS"},{id:"sales",icon:Vn,label:"VENTAS"},{id:"finanzas",icon:$i,label:"FINANZAS"},{id:"configuracion",icon:yv,label:"CONFIGURACIN"}].map(T=>c.jsxs("button",{onClick:()=>d(T.id),className:`px - 4 py - 2 rounded - lg text - xs font - black transition - all flex items - center gap - 2 ${f===T.id?"bg-slate-900 text-white shadow-lg":"text-slate-500 hover:text-slate-900 dark:hover:text-white"} `,children:[c.jsx(T.icon,{size:14}),T.label]},T.id))})]}),c.jsxs("div",{className:"min-h-0",children:[f==="dashboard"&&c.jsx("div",{className:"animate-fade-in-up",children:c.jsx(Ev,{storeId:i.id})}),f==="products"&&c.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 shadow-sm border border-slate-200 dark:border-slate-700 animate-fade-in-up",children:c.jsx(lb,{targetStoreId:i.id})}),f==="sales"&&c.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 shadow-sm border border-slate-200 dark:border-slate-700 animate-fade-in-up",children:c.jsx(ib,{targetStoreId:i.id})}),f==="finanzas"&&c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 shadow-sm border border-slate-200 dark:border-slate-700 animate-fade-in-up",children:[c.jsx("h3",{className:"text-sm font-black text-slate-500 uppercase tracking-widest mb-4",children:"Operaciones de Caja"}),c.jsx(Ig,{storeId:i.id,mode:"cash"})]}),f==="configuracion"&&c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 shadow-sm border border-slate-200 dark:border-slate-700 animate-fade-in-up",children:[c.jsx("h3",{className:"text-sm font-black text-slate-500 uppercase tracking-widest mb-4",children:"Configuracin de Tienda"}),c.jsx(Ig,{storeId:i.id,mode:"settings"})]})]})]}):null,q=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("div",{className:"p-3 bg-emerald-100 dark:bg-emerald-500/10 text-emerald-600 rounded-xl",children:c.jsx(Yi,{size:24})}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-emerald-500 bg-emerald-50 px-2 py-1 rounded-lg",children:"Total Activo"})]}),c.jsx("h3",{className:"text-3xl font-black text-slate-900 dark:text-white",children:m.length}),c.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:"Tiendas Registradas"})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-500/10 text-brand-blue rounded-xl",children:c.jsx(Vn,{size:24})}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-brand-blue bg-blue-50 px-2 py-1 rounded-lg",children:"MRR Actual"})]}),c.jsx("h3",{className:"text-3xl font-black text-slate-900 dark:text-white",children:"$12,450"}),c.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:"Ingresos Recurrentes"})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-500/10 text-amber-600 rounded-xl",children:c.jsx(ro,{size:24})}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-amber-500 bg-amber-50 px-2 py-1 rounded-lg",children:"Seguridad"})]}),c.jsx("h3",{className:"text-3xl font-black text-slate-900 dark:text-white",children:"100%"}),c.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:"Sin Incidentes"})]})]}),c.jsxs("div",{className:"flex justify-between items-center bg-white dark:bg-slate-800 p-4 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[c.jsxs("div",{className:"relative w-96",children:[c.jsx(ic,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:18}),c.jsx("input",{type:"text",placeholder:"Buscar tienda, dueo o ID...",className:"w-full pl-12 pr-4 py-3 bg-slate-50 dark:bg-slate-900 border-none rounded-xl text-xs font-bold focus:ring-2 focus:ring-brand-blue outline-none",value:b,onChange:T=>k(T.target.value)})]}),c.jsxs(at,{variant:"primary",onClick:()=>_(!0),className:"py-3 px-6 shadow-lg shadow-brand-blue/20",children:[c.jsx(ao,{size:18,className:"mr-2"})," NUEVA TIENDA"]})]}),c.jsx("div",{className:"block md:hidden space-y-3",children:g?c.jsx("div",{className:"p-8 text-center text-slate-400 text-xs font-bold",children:"Cargando datos del ecosistema..."}):B.length===0?c.jsx("div",{className:"p-8 text-center text-slate-400 text-xs font-bold",children:"No se encontraron tiendas registradas."}):B.map(T=>c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 p-4 active:scale-[0.98] transition-all",onClick:()=>u(T),children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-brand-blue to-cyan-500 flex items-center justify-center text-white font-black text-sm shadow-lg shadow-brand-blue/20 shrink-0",children:T.name.substring(0,2).toUpperCase()}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"font-bold text-sm text-slate-900 dark:text-white truncate",children:T.name}),c.jsxs("div",{className:"text-xs",children:[c.jsx("p",{className:"font-bold text-slate-900 dark:text-white",children:T.ownerName}),c.jsx("p",{className:"text-[10px] text-slate-400 truncate",children:T.ownerEmail})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:z=>{z.stopPropagation(),R(T),K({name:T.name,ownerName:T.ownerName,email:"",newPassword:""}),Y("info"),G(!0)},className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-blue-50 text-brand-blue hover:bg-blue-100 rounded-xl text-xs font-bold uppercase transition-all active:scale-95 min-h-[44px]","aria-label":`Editar ${T.name}`,children:[c.jsx(jp,{size:16})," EDITAR"]}),(n==null?void 0:n.role)==="SUPER_ADMIN"&&c.jsx("button",{onClick:z=>{z.stopPropagation(),me(T),Ee(!0)},className:"flex items-center justify-center px-3 py-3 bg-red-50 text-red-600 hover:bg-red-100 rounded-xl transition-all active:scale-95 min-h-[44px] min-w-[44px]","aria-label":`Eliminar ${T.name}`,children:c.jsx(Nr,{size:16})})]})]},T.id))}),c.jsx("div",{className:"block md:hidden space-y-3",children:g?c.jsx("div",{className:"p-8 text-center text-slate-400 text-xs font-bold",children:"Cargando tiendas..."}):B.length===0?c.jsx("div",{className:"p-8 text-center text-slate-400 text-xs font-bold",children:"No se encontraron tiendas."}):B.map(T=>c.jsxs("div",{onClick:()=>u(T),className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4 active:scale-[0.98] transition-all",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"relative shrink-0",children:[c.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-brand-blue to-cyan-500 flex items-center justify-center text-white font-black text-lg shadow-lg shadow-brand-blue/20",children:T.name.substring(0,2).toUpperCase()}),c.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-emerald-500 border-2 border-white dark:border-slate-900 rounded-full"})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"font-bold text-base text-slate-900 dark:text-white truncate",children:T.name}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-1",children:[c.jsx(Fr,{size:12}),c.jsx("span",{className:"truncate",children:T.ownerName})]}),c.jsxs("p",{className:"text-[10px] text-slate-400 mt-1",children:["ID: ",T.id.substring(0,8),"..."]})]}),c.jsx("button",{onClick:z=>{z.stopPropagation(),u(T)},className:"flex items-center justify-center w-12 h-12 bg-brand-blue hover:bg-blue-600 text-white rounded-xl transition-all active:scale-95 shadow-sm shrink-0","aria-label":`Gestionar ${T.name}`,children:c.jsx(Kf,{className:"rotate-180",size:18})})]}),c.jsx("div",{className:"flex gap-2 mt-3 pt-3 border-t border-slate-100 dark:border-slate-800",children:(n==null?void 0:n.role)==="SUPER_ADMIN"&&c.jsx("button",{onClick:z=>{z.stopPropagation(),me(T),Ee(!0)},className:"flex items-center justify-center w-12 h-12 bg-red-50 dark:bg-red-950/20 text-red-600 dark:text-red-400 rounded-xl transition-all active:scale-95","aria-label":"Eliminar tienda",children:c.jsx(qi,{size:16})})})]},T.id))}),c.jsx("div",{className:"hidden md:block bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 border-b-2 border-slate-200 dark:border-slate-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Tienda"}),c.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Propietario"}),c.jsx("th",{className:"px-6 py-4 text-center text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Estado"}),c.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Acciones"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:g?c.jsx("tr",{children:c.jsx("td",{colSpan:4,className:"p-8 text-center text-slate-400 text-xs font-bold",children:"Cargando datos del ecosistema..."})}):B.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,className:"p-8 text-center text-slate-400 text-xs font-bold",children:"No se encontraron tiendas registradas."})}):B.map(T=>c.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors group cursor-pointer",onClick:()=>u(T),children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-brand-blue to-cyan-500 flex items-center justify-center text-white font-black text-sm shadow-lg shadow-brand-blue/20 shrink-0",children:T.name.substring(0,2).toUpperCase()}),c.jsxs("div",{children:[c.jsx("p",{className:"font-bold text-sm text-slate-900 dark:text-white group-hover:text-brand-blue transition-colors",children:T.name}),c.jsxs("p",{className:"text-[10px] font-bold text-slate-400",children:["ID: ",T.id.substring(0,8),"..."]})]})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"p-1.5 bg-slate-100 dark:bg-slate-800 rounded-full text-slate-500",children:c.jsx(Fr,{size:12})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-bold text-slate-900 dark:text-white",children:T.ownerName}),c.jsx("p",{className:"text-[10px] text-slate-400",children:T.ownerEmail})]})]})}),c.jsx("td",{className:"px-6 py-4 text-center",children:c.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-50 dark:bg-emerald-950/20 border border-emerald-200 dark:border-emerald-900/50 rounded-full",children:[c.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-emerald-600 dark:text-emerald-400",children:"Activa"})]})}),c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",onClick:z=>z.stopPropagation(),children:[c.jsxs("button",{onClick:z=>{z.stopPropagation(),R(T),K({name:T.name,ownerName:T.ownerName,email:"",newPassword:""}),Y("info"),G(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-950/20 text-brand-blue hover:bg-blue-100 dark:hover:bg-blue-950/30 border border-blue-200 dark:border-blue-900/50 rounded-lg text-xs font-bold uppercase transition-all active:scale-95 shadow-sm hover:shadow-md",children:[c.jsx(jp,{size:14})," EDITAR"]}),(n==null?void 0:n.role)==="SUPER_ADMIN"&&c.jsxs("button",{onClick:z=>{z.stopPropagation(),me(T),Ee(!0)},className:"flex items-center gap-2 px-4 py-2 bg-red-50 dark:bg-red-950/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-950/30 border border-red-200 dark:border-red-900/50 rounded-lg text-xs font-bold uppercase transition-all active:scale-95 shadow-sm hover:shadow-md",children:[c.jsx(qi,{size:14})," ELIMINAR"]}),c.jsxs("button",{onClick:()=>u(T),className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold uppercase transition-all active:scale-95 shadow-sm hover:shadow-md group-hover:border-brand-blue",children:["GESTIONAR ",c.jsx(Kf,{className:"rotate-180",size:12})]})]})})]},T.id))})]})})]}),V=()=>c.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white",children:"Tickets de Soporte"}),c.jsx("p",{className:"text-xs text-slate-500 font-bold",children:"Solicitudes de ayuda de todas las sucursales"})]})}),c.jsx("div",{className:"block md:hidden space-y-3",children:y.length===0?c.jsx("div",{className:"p-10 text-center text-slate-400 font-bold text-xs",children:"No hay tickets pendientes. Buen trabajo! "}):y.map(T=>{var z;return c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 p-4 active:scale-[0.98] transition-all",children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsxs("span",{className:"text-xs font-black text-slate-900 dark:text-white",children:["#",T.id.substring(0,6)]}),c.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-black uppercase ${T.prioridad==="URGENT"?"bg-red-100 text-red-600 dark:bg-red-950/30 dark:text-red-400":T.prioridad==="HIGH"?"bg-orange-100 text-orange-600 dark:bg-orange-950/30 dark:text-orange-400":"bg-blue-100 text-blue-600 dark:bg-blue-950/30 dark:text-blue-400"}`,children:T.prioridad})]}),c.jsx("p",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 mb-1",children:T.titulo}),c.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:T.descripcion})]}),c.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-black uppercase border ml-2 ${T.status==="OPEN"?"bg-green-100 text-green-600 border-green-200 dark:bg-green-950/30 dark:text-green-400 dark:border-green-900":"bg-slate-100 text-slate-500 border-slate-200 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-700"}`,children:T.status})]}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 pt-3 border-t border-slate-100 dark:border-slate-700",children:[c.jsx("span",{className:"font-bold",children:((z=T.store)==null?void 0:z.nombre)||"Tienda Desconocida"}),c.jsx("span",{children:new Date(T.createdAt).toLocaleDateString()})]})]},T.id)})}),c.jsx("div",{className:"hidden md:block bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-slate-500",children:"ID / Tienda"}),c.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Asunto"}),c.jsx("th",{className:"px-6 py-4 text-center text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Prioridad"}),c.jsx("th",{className:"px-6 py-4 text-center text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Estado"}),c.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Fecha"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:y.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:5,className:"p-10 text-center text-slate-400 font-bold text-xs",children:"No hay tickets pendientes. Buen trabajo! "})}):y.map(T=>{var z;return c.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer",children:[c.jsxs("td",{className:"px-6 py-4",children:[c.jsxs("p",{className:"text-xs font-black text-slate-900 dark:text-white",children:["#",T.id.substring(0,6)]}),c.jsx("p",{className:"text-[10px] text-slate-500",children:((z=T.store)==null?void 0:z.nombre)||"Tienda Desconocida"})]}),c.jsxs("td",{className:"px-6 py-4",children:[c.jsx("p",{className:"text-sm font-bold text-slate-800 dark:text-slate-200",children:T.titulo}),c.jsx("p",{className:"text-xs text-slate-500 truncate max-w-[200px]",children:T.descripcion})]}),c.jsx("td",{className:"px-6 py-4 text-center",children:c.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-black uppercase ${T.prioridad==="URGENT"?"bg-red-100 text-red-600":T.prioridad==="HIGH"?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"}`,children:T.prioridad})}),c.jsx("td",{className:"px-6 py-4 text-center",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-black uppercase border ${T.status==="OPEN"?"bg-green-100 text-green-600 border-green-200":"bg-slate-100 text-slate-500 border-slate-200"}`,children:T.status})}),c.jsx("td",{className:"px-6 py-4 text-xs font-bold text-slate-500",children:new Date(T.createdAt).toLocaleDateString()})]},T.id)})})]})})]});return c.jsxs("div",{className:"min - h - screen flex bg-slate-50 ",children:[c.jsxs("aside",{className:"w-64 bg-slate-900 text-white flex flex-col fixed h-full z-20",children:[c.jsxs("div",{className:"p-6 border-b border-slate-800 flex items-center gap-3",children:[c.jsx(Xd,{size:32,className:"text-white"}),c.jsxs("div",{children:[c.jsx("h1",{className:"font-black tracking-tighter text-lg",children:"TEIKON OS"}),c.jsx("p",{className:"text-[10px] uppercase tracking-[0.2em] text-slate-500 font-bold",children:"Super Admin"})]})]}),c.jsxs("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:[c.jsx("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4 px-2",children:"Plataforma"}),c.jsxs("button",{onClick:()=>{s("stores"),u(null)},className:`w - full flex items - center gap - 3 px - 4 py - 3 rounded - xl text - xs font - bold transition - all ${a==="stores"&&!i?"bg-brand-blue text-white shadow-lg shadow-brand-blue/20":"text-slate-400 hover:bg-white/5 hover:text-white"} `,children:[c.jsx(Yi,{size:18}),"TIENDAS ACTIVAS"]}),c.jsxs("button",{onClick:()=>{s("tickets"),u(null)},className:`w - full flex items - center gap - 3 px - 4 py - 3 rounded - xl text - xs font - bold transition - all ${a==="tickets"?"bg-brand-blue text-white shadow-lg shadow-brand-blue/20":"text-slate-400 hover:bg-white/5 hover:text-white"} `,children:[c.jsx(AE,{size:18}),"TICKETS SOPORTE"]})]}),c.jsx("div",{className:"p-4 border-t border-slate-800",children:c.jsxs("button",{onClick:e,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-xs font-bold text-red-400 hover:bg-red-500/10 transition-all",children:[c.jsx(Hd,{size:18}),"CERRAR SESIN MAESTRA"]})})]}),c.jsxs("main",{className:"flex-1 ml-64 p-8 relative overflow-y-auto h-screen",children:[c.jsxs("header",{className:"flex justify-between items-center mb-8",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-black text-slate-900 dark:text-white uppercase tracking-tight",children:i?`Gestionando: ${i.name} `:a==="stores"?"Panel de Control Principal":"Centro de Soporte"}),c.jsxs("p",{className:"text-xs font-bold text-slate-400 mt-1",children:["Bienvenido, ",c.jsx("span",{className:"text-brand-blue",children:"Dragn"}),". Sistema operando al 100%."]})]}),c.jsx("div",{className:"flex items-center gap-4"})]}),i?A():c.jsxs(c.Fragment,{children:[a==="stores"&&q(),a==="tickets"&&V()]})]}),N&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-md p-8 shadow-2xl scale-100 animate-in zoom-in-95 duration-200",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white",children:"Nueva Tienda"}),c.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:"Registrar licenciamiento para nodo"})]}),c.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-400 transition-colors",type:"button","aria-label":"Cerrar modal",children:c.jsx(Nr,{size:20})})]}),c.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Nombre de la Tienda"}),c.jsx("input",{required:!0,type:"text",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all placeholder:font-normal",placeholder:"Ej. Sucursal Centro",value:O.name,onChange:T=>E({...O,name:T.target.value})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Nombre del Dueo/Contacto"}),c.jsx("input",{required:!0,type:"text",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all placeholder:font-normal",placeholder:"Ej. Juan Prez",value:O.ownerName,onChange:T=>E({...O,ownerName:T.target.value})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Email Administrador (Usuario)"}),c.jsx("input",{required:!0,type:"email",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all placeholder:font-normal",placeholder:"admin@tienda.com",value:O.email,onChange:T=>E({...O,email:T.target.value})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Contrasea Inicial"}),c.jsx("input",{required:!0,type:"password",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all placeholder:font-normal",placeholder:"",value:O.password,onChange:T=>E({...O,password:T.target.value})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:["Telfono ",c.jsx("span",{className:"text-slate-300 font-normal normal-case",children:"(Opcional)"})]}),c.jsx("input",{type:"tel",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all placeholder:font-normal",placeholder:"55...",value:O.phone,onChange:T=>E({...O,phone:T.target.value})})]}),c.jsxs("div",{className:"pt-4 flex gap-3",children:[c.jsx(at,{type:"button",variant:"secondary",fullWidth:!0,onClick:()=>_(!1),className:"h-12",children:"CANCELAR"}),c.jsx(at,{type:"submit",variant:"primary",fullWidth:!0,className:"h-12 shadow-lg shadow-brand-blue/20 bg-brand-blue hover:bg-blue-600 text-white",children:"CREAR NODO"})]})]})]})}),L&&H&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-md p-8 shadow-2xl scale-100 animate-in zoom-in-95 duration-200 border border-slate-200 dark:border-slate-800",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white",children:"Editar Tienda"}),c.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:H.name})]}),c.jsx("button",{onClick:()=>{G(!1),R(null),K({name:"",ownerName:"",email:"",newPassword:""})},className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-400 transition-colors",type:"button","aria-label":"Cerrar modal",children:c.jsx(Nr,{size:20})})]}),c.jsxs("div",{className:"flex gap-2 mb-6 bg-slate-100 dark:bg-slate-800 p-1 rounded-xl",children:[c.jsx("button",{onClick:()=>Y("info"),className:`flex-1 px-4 py-2 rounded-lg text-xs font-black transition-all ${Z==="info"?"bg-white dark:bg-slate-700 text-brand-blue shadow-sm":"text-slate-500 hover:text-slate-900 dark:hover:text-white"}`,children:"INFORMACIN GENERAL"}),c.jsx("button",{onClick:()=>Y("security"),className:`flex-1 px-4 py-2 rounded-lg text-xs font-black transition-all ${Z==="security"?"bg-white dark:bg-slate-700 text-brand-blue shadow-sm":"text-slate-500 hover:text-slate-900 dark:hover:text-white"}`,children:"SEGURIDAD"})]}),c.jsxs("div",{className:"space-y-4",children:[Z==="info"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Nombre de la Tienda"}),c.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all",placeholder:"Ej. Sucursal Centro",value:Q.name,onChange:T=>K({...Q,name:T.target.value})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Nombre del Encargado"}),c.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all",placeholder:"Ej. Juan Prez",value:Q.ownerName,onChange:T=>K({...Q,ownerName:T.target.value})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Correo Electrnico (Usuario)"}),c.jsx("input",{type:"email",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all",placeholder:"admin@tienda.com",value:Q.email,onChange:T=>K({...Q,email:T.target.value})}),c.jsx("p",{className:"text-[10px] text-slate-400 ml-1 mt-1",children:"Dejar vaco para mantener el actual"})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Nueva Contrasea"}),c.jsx("input",{type:"password",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-brand-blue outline-none transition-all",placeholder:"Dejar vaco para no cambiar",value:Q.newPassword,onChange:T=>K({...Q,newPassword:T.target.value})}),c.jsx("p",{className:"text-[10px] text-slate-400 ml-1 mt-1",children:"Solo completar si deseas cambiar la contrasea"})]}),c.jsx("div",{className:"bg-amber-50 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/20 rounded-xl p-4",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(Gi,{size:18,className:"text-amber-600 dark:text-amber-400 mt-0.5 shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-bold text-amber-900 dark:text-amber-200",children:"Cambio de Contrasea"}),c.jsx("p",{className:"text-[10px] text-amber-700 dark:text-amber-300 mt-1",children:"Al cambiar la contrasea, el administrador de la tienda deber usar la nueva contrasea en su prximo inicio de sesin."})]})]})})]}),c.jsxs("div",{className:"flex gap-2 pt-2",children:[c.jsx(at,{variant:"secondary",fullWidth:!0,onClick:()=>{G(!1),R(null),K({name:"",ownerName:"",email:"",newPassword:""})},className:"h-12",children:"CANCELAR"}),c.jsx(at,{type:"button",variant:"primary",fullWidth:!0,className:"bg-brand-blue hover:bg-blue-600 text-white h-12 shadow-lg shadow-brand-blue/20",onClick:async()=>{try{const T={};if(Q.name&&Q.name!==H.name&&(T.name=Q.name),Q.ownerName&&Q.ownerName!==H.ownerName&&(T.ownerName=Q.ownerName),Q.email&&(T.email=Q.email),Q.newPassword&&(T.newPassword=Q.newPassword),Object.keys(T).length===0){alert(" No hay cambios para guardar");return}await zd.adminUpdateStore(H.id,T),alert(" Tienda actualizada exitosamente"),G(!1),R(null),K({name:"",ownerName:"",email:"",newPassword:""}),Ae()}catch(T){alert(" Error: "+T.message)}},children:"GUARDAR CAMBIOS"})]})]})]})}),ee&&Ne&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-sm p-8 shadow-2xl scale-100 animate-in zoom-in-95 duration-200 border-2 border-red-500",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-red-500",children:c.jsx(Gi,{size:28})}),c.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white",children:"Eliminar Tienda"}),c.jsxs("p",{className:"text-sm font-bold text-slate-500 mt-1 px-4",children:["Ests a punto de eliminar ",c.jsx("span",{className:"text-red-600",children:Ne.name})]}),c.jsx("p",{className:"text-xs font-bold text-red-500 mt-2",children:" Esta accin NO se puede deshacer"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 ml-1",children:"Tu Contrasea"}),c.jsx("input",{type:"password",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border-none rounded-xl text-sm font-bold focus:ring-2 focus:ring-red-500 outline-none transition-all",placeholder:"Ingrese contrasea",value:J,onChange:T=>se(T.target.value)})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(at,{variant:"secondary",fullWidth:!0,onClick:()=>{Ee(!1),se(""),me(null)},className:"h-12",children:"CANCELAR"}),c.jsx(at,{type:"button",variant:"primary",fullWidth:!0,className:"bg-red-500 hover:bg-red-600 text-white h-12 shadow-lg shadow-red-500/20",onClick:async()=>{if(!J)return alert("Ingrese una contrasea");try{await Y0.delete(Ne.id,J),alert(" Tienda eliminada con xito"),Ee(!1),se(""),me(null),Ae()}catch(T){alert(" Error: "+T.message)}},children:"CONFIRMAR ELIMINACIN"})]})]})]})})]})},Bg=({children:e,requireAdmin:n=!1})=>{const{currentUser:a}=Jt(),s=dn();return a?n&&a.role!=="SUPER_ADMIN"?c.jsx(id,{to:"/dashboard",replace:!0}):c.jsx(c.Fragment,{children:e}):c.jsx(id,{to:"/login",state:{from:s},replace:!0})},oj=()=>{const{updateCurrentUser:e,addProduct:n,currentUser:a}=Jt(),[s,i]=D.useState(""),[u,f]=D.useState(""),[d,m]=D.useState(1),[x,g]=D.useState(!1),[v,b]=D.useState(!1),k=async y=>{if(y.preventDefault(),!(!s.trim()||!u.trim()||!a)){b(!0);try{await new Promise(O=>setTimeout(O,1e3)),e({storeName:s,phone:u});const w=localStorage.getItem("teikon_all_stores"),N=w?JSON.parse(w):[],_={id:`ST-${Math.floor(Math.random()*900+100)}`,name:s,owner:a.username,phone:u,plan:"Premium",status:"active",lastActive:"Recin configurada"};localStorage.setItem("teikon_all_stores",JSON.stringify([_,...N])),await new Promise(O=>setTimeout(O,500)),n({storeId:a.storeId,sku:"DEMO-COKE-01",name:"Coca Cola 600ml (Ejemplo)",category:"Bebidas",costPrice:15,salePrice:22,unitProfit:7,stock:12,minStock:3,taxRate:0,isActive:!0}),console.log(">>> SISTEMA: Onboarding exitoso. Nodo activado.")}catch(w){console.error(">>> ERROR CRTICO EN ONBOARDING:",w),alert("Error de sincronizacin con el servidor central. Reintentando...")}finally{b(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-brand-bg flex items-center justify-center p-6 relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-brand-emerald/5 blur-[120px] rounded-full -mr-40 -mt-40 pointer-events-none"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-brand-purple/5 blur-[120px] rounded-full -ml-40 -mb-40 pointer-events-none"}),c.jsxs("div",{className:"max-w-md w-full relative z-10 animate-in zoom-in duration-500",children:[c.jsxs("div",{className:"flex flex-col items-center mb-8 text-center",children:[c.jsx(Xd,{size:80,className:"mb-4"}),c.jsx("h2",{className:"text-2xl font-black uppercase tracking-tighter text-slate-900 dark:text-white",children:"Configuracin del Nodo"}),c.jsx("p",{className:"text-[10px] font-black text-brand-muted uppercase tracking-[0.4em] mt-2",children:"Paso obligatorio de inicializacin"})]}),c.jsxs("div",{className:"bg-white dark:bg-brand-panel border border-slate-200 dark:border-brand-border p-8 md:p-10 rounded-[2.5rem] shadow-2xl relative",children:[c.jsxs("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-brand-emerald text-white px-4 py-1 rounded-full text-[8px] font-black uppercase tracking-widest flex items-center gap-2 shadow-lg",children:[c.jsx(ro,{size:12})," Acceso Restringido"]}),c.jsxs("form",{onSubmit:k,className:"space-y-6",children:[c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-brand-muted uppercase tracking-widest ml-1",children:"Nombre Comercial de la Tienda"}),c.jsxs("div",{className:"relative group",children:[c.jsx(Yi,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-brand-emerald transition-colors",size:18}),c.jsx("input",{required:!0,type:"text",placeholder:"EJ. MI TIENDA TEIKON",className:"w-full pl-12 pr-6 py-4 bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 rounded-2xl text-xs font-bold focus:outline-none focus:border-brand-emerald transition-all text-slate-900 dark:text-white uppercase",value:s,onChange:y=>i(y.target.value)})]})]}),c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[9px] font-black text-brand-muted uppercase tracking-widest ml-1",children:"Contacto Directo (WhatsApp)"}),c.jsxs("div",{className:"relative group",children:[c.jsx(aE,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-brand-emerald transition-colors",size:18}),c.jsx("input",{required:!0,type:"tel",placeholder:"EJ. 5512345678",className:"w-full pl-12 pr-6 py-4 bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 rounded-2xl text-xs font-bold focus:outline-none focus:border-brand-emerald transition-all text-slate-900 dark:text-white",value:u,onChange:y=>f(y.target.value)})]})]}),c.jsx("div",{className:"pt-4",children:c.jsx(at,{type:"submit",variant:"sales",fullWidth:!0,disabled:v||!s.trim()||!u.trim(),className:"py-5 flex items-center gap-3",children:v?c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"SINCRONIZANDO..."]}):c.jsxs(c.Fragment,{children:[c.jsx(uE,{size:18}),"GUARDAR Y COMENZAR"]})})}),c.jsxs("p",{className:"text-center text-[8px] font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:["Al activar el nodo, aceptas los trminos de servicio de Teikon OS. Usuario: ",c.jsx("span",{className:"text-slate-900 dark:text-white font-black",children:a==null?void 0:a.username})]})]})]}),c.jsx("div",{className:"mt-8 text-center opacity-20",children:c.jsx("p",{className:"text-[8px] font-black text-brand-muted uppercase tracking-[0.5em]",children:"Teikon OS Core // Secure Onboarding v1.1"})})]})]})},uj=({children:e})=>{const{currentUser:n,currentSession:a,openSession:s,isRecoveringSession:i,isOpeningSession:u}=Jt(),[f,d]=D.useState("");return(n==null?void 0:n.role)==="SUPER_ADMIN"?c.jsx(c.Fragment,{children:e}):(n==null?void 0:n.storeName)&&n.storeName.trim()!==""?i?c.jsx("div",{className:"min-h-screen bg-brand-bg flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-purple mx-auto mb-4"}),c.jsx("p",{className:"text-sm text-brand-muted",children:"Verificando sesin..."})]})}):a?c.jsx(c.Fragment,{children:e}):(localStorage.removeItem("cashSession"),c.jsx("div",{className:"min-h-screen bg-brand-bg flex items-center justify-center p-4",children:c.jsx("div",{className:"max-w-md w-full bg-white dark:bg-brand-panel border border-slate-200 dark:border-brand-border p-10 cut-corner shadow-2xl animate-in zoom-in duration-500",children:c.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[c.jsx("div",{className:"p-5 bg-slate-50 dark:bg-white/5 rounded-full border border-slate-200 dark:border-brand-border",children:c.jsx(bv,{className:"h-10 w-10 text-slate-900 dark:text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-black uppercase tracking-[0.3em] text-slate-900 dark:text-white",children:"Apertura de Terminal"}),c.jsxs("p",{className:"text-[10px] font-bold text-brand-muted uppercase tracking-widest mt-2",children:["Nodo Activo: ",n==null?void 0:n.storeName]}),c.jsx("p",{className:"text-[10px] font-medium text-brand-muted uppercase mt-1",children:"Ingrese el fondo de caja inicial para comenzar"})]}),c.jsxs("div",{className:"w-full relative",children:[c.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-3xl font-black text-brand-muted",children:"$"}),c.jsx("input",{type:"number",autoFocus:!0,disabled:u,className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 cut-corner p-6 pl-14 text-4xl font-black text-slate-900 dark:text-white outline-none focus:border-brand-purple transition-all shadow-inner disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"0.00",value:f,onChange:x=>d(x.target.value),onKeyDown:x=>{x.key==="Enter"&&s(parseFloat(f)||0)}})]}),c.jsx(Gn,{fullWidth:!0,variant:"primary",disabled:u,className:"py-5 bg-slate-900 dark:bg-white text-white dark:text-black hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>s(parseFloat(f)||0),children:u?"Iniciando...":"Iniciar Operaciones"}),c.jsx("p",{className:"text-[8px] font-black text-brand-muted uppercase tracking-[0.4em]",children:"SISTEMA TEIKON v2.9.1 SECURE"})]})})})):c.jsx(oj,{})},fj=({children:e})=>{const{isCashRegisterOpen:n,isLoading:a,isRecoveringSession:s,currentUser:i,isOpeningSession:u,openSession:f}=Jt(),[d,m]=D.useState("");return a||s?c.jsx("div",{className:"flex h-full items-center justify-center p-8",children:c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-brand-emerald"}),c.jsx("p",{className:"text-sm font-medium text-slate-500 animate-pulse",children:"Verificando estado de caja..."})]})}):n?c.jsx(c.Fragment,{children:e}):c.jsx("div",{className:"flex h-full items-center justify-center p-4 animate-in fade-in duration-500",children:c.jsx("div",{className:"max-w-md w-full bg-white dark:bg-brand-panel border border-slate-200 dark:border-brand-border p-10 cut-corner shadow-2xl",children:c.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[c.jsx("div",{className:"p-5 bg-slate-50 dark:bg-white/5 rounded-full border border-slate-200 dark:border-brand-border",children:c.jsx(bv,{className:"h-10 w-10 text-slate-900 dark:text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-black uppercase tracking-[0.3em] text-slate-900 dark:text-white",children:"Apertura de Terminal"}),c.jsxs("p",{className:"text-[10px] font-bold text-brand-muted uppercase tracking-widest mt-2",children:["Nodo Activo: ",i==null?void 0:i.storeName]}),c.jsx("p",{className:"text-[10px] font-medium text-brand-muted uppercase mt-1",children:"Ingrese el fondo de caja inicial para comenzar"})]}),c.jsxs("div",{className:"w-full relative",children:[c.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-3xl font-black text-brand-muted",children:"$"}),c.jsx("input",{type:"number",autoFocus:!0,disabled:u,className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 cut-corner p-6 pl-14 text-4xl font-black text-slate-900 dark:text-white outline-none focus:border-brand-purple transition-all shadow-inner disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"0.00",value:d,onChange:x=>m(x.target.value),onKeyDown:x=>{x.key==="Enter"&&!u&&f(parseFloat(d)||0)}})]}),c.jsx(Gn,{fullWidth:!0,variant:"primary",disabled:u,className:"py-5 bg-slate-900 dark:bg-white text-white dark:text-black hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>f(parseFloat(d)||0),children:u?"Iniciando...":"Iniciar Operaciones"}),c.jsx("p",{className:"text-[8px] font-black text-brand-muted uppercase tracking-[0.4em]",children:"SISTEMA TEIKON v2.9.1 SECURE"})]})})})},dj=()=>{const{currentUser:e,logout:n}=Jt(),[a,s]=D.useState("pos");return D.useEffect(()=>{e&&sw()},[e]),c.jsxs(w4,{children:[c.jsx(G0,{path:"/login",element:e?c.jsx(id,{to:e.role==="SUPER_ADMIN"?"/admin/stores":"/pos",replace:!0}):c.jsx(lj,{})}),c.jsx(G0,{path:"/admin/*",element:c.jsx(Bg,{requireAdmin:!0,children:c.jsx(cj,{onExit:n})})}),c.jsx(G0,{path:"/*",element:c.jsx(Bg,{children:c.jsxs(XE,{activeTab:a,onTabChange:s,children:[a==="dashboard"&&c.jsx(Ev,{}),a==="pos"&&c.jsx(uj,{children:c.jsx(fj,{children:c.jsx(ZE,{})})}),a==="history"&&c.jsx(ib,{}),a==="products"&&c.jsx(lb,{}),a==="settings"&&c.jsx(rj,{})]})})})]})},hj=()=>c.jsx(Cw,{children:c.jsx(Aw,{children:c.jsx(dj,{})})}),cb=document.getElementById("app-root");if(!cb)throw new Error("Could not find root element to mount to");const xj=Nk.createRoot(cb);xj.render(c.jsx(zg.StrictMode,{children:c.jsx(X4,{children:c.jsx(hj,{})})}));
